import{a as s,f as g,n as h}from"./chunk-BDJEX5R5.js";import"./chunk-DJJXWOPV.js";import"./chunk-BOMXJJQJ.js";import{g as i}from"./chunk-IESNQYPT.js";import{fa as n}from"./chunk-KPABI5SC.js";import"./chunk-WWX6BADO.js";var C=class extends g{http=n(i);contextManager=n(s);start(){let t=window.debugLogger;t&&(t.info("\uCC57\uD50C\uB85C\uC6B0-ContextChanger","\u{1F504} \uCEE8\uD14D\uC2A4\uD2B8 \uBCC0\uACBD \uC2DC\uC791"),t.info("\uCC57\uD50C\uB85C\uC6B0-ContextChanger",`   \uACBD\uB85C: ${this.readData.data.path}`),t.info("\uCC57\uD50C\uB85C\uC6B0-ContextChanger",`   \uD30C\uC77C: ${this.readData.data.fileName}`),t.info("\uCC57\uD50C\uB85C\uC6B0-ContextChanger",`   \uBCF5\uADC0 \uCEE8\uD14D\uC2A4\uD2B8: ${this.readData.data.returnContextName}`));let o=`./${this.readData.data.path}/${this.readData.data.fileName}.json`;t&&t.info("\uCC57\uD50C\uB85C\uC6B0-ContextChanger",`   \uC804\uCCB4 \uACBD\uB85C: ${o}`),this.http.get(o).subscribe({next:e=>{t&&t.success("\uCC57\uD50C\uB85C\uC6B0-ContextChanger","\u2705 JSON \uD30C\uC77C \uB85C\uB4DC \uC131\uACF5");let r=`${this.readData.data.fileName}_${Date.now()}`,a=new h(r,this.contextManager,this.chatbotActionService);a.chatflowData=e.connected||e,this.contextManager.registerContext(r,a),this.contextManager.changeContext(a,!0),a.$chatflowEnded.subscribe(()=>{t&&t.info("\uCC57\uD50C\uB85C\uC6B0-ContextChanger","\u{1F519} \uC11C\uBE0C \uCC57\uD50C\uB85C\uC6B0 \uC885\uB8CC, \uC774\uC804 \uCEE8\uD14D\uC2A4\uD2B8\uB85C \uBCF5\uADC0"),this.contextManager.getContext(this.readData.data.returnContextName)?(this.contextManager.returnToPreviousContext(),this.end()):console.error(`\uBCF5\uADC0\uD560 \uCEE8\uD14D\uC2A4\uD2B8\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4: ${this.readData.data.returnContextName}`)}),a.start()},error:e=>{console.error("JSON \uD30C\uC77C \uB85C\uB4DC \uC2E4\uD328:",e),t&&t.error("\uCC57\uD50C\uB85C\uC6B0-ContextChanger",`\u274C JSON \uD30C\uC77C \uB85C\uB4DC \uC2E4\uD328: ${e.message}`),this.end()}})}end(){let t=window.debugLogger;t&&t.info("\uCC57\uD50C\uB85C\uC6B0-ContextChanger","\u2705 ContextChanger \uB178\uB4DC \uC885\uB8CC"),super.end()}};export{C as ContextChangerLogic};

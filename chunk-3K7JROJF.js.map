{
  "version": 3,
  "sources": ["src/app/utils/confirm-override.util.ts"],
  "sourcesContent": ["/**\n * Confirm Override Utility\n * \n * 모든 window.confirm을 자동으로 Dialog로 변환\n * 기존 confirm() 호출은 작동하지 않고 Dialog만 표시됨\n * \n * ⚠️ 중요: confirm()은 동기 함수이지만 Dialog는 비동기이므로\n * confirm() 호출 시 항상 false를 반환하고 Dialog만 표시됩니다.\n * \n * 대신 다음 방법 사용:\n * 1. confirmAsync() 함수 사용\n * 2. ConfirmationDialogService 사용\n * 3. MatDialog 직접 사용\n */\n\n// 원본 confirm 메서드 저장\nconst originalConfirm = window.confirm.bind(window);\n\n/**\n * DebugLogger 접근 (window 객체를 통해)\n */\nfunction getDebugLogger(): any {\n  return (window as any).debugLogger;\n}\n\n/**\n * 디버그 로그 출력 (console.log 사용)\n */\nfunction debugLog(category: string, message: string): void {\n  const logger = getDebugLogger();\n  if (logger) {\n    logger.info(category, message);\n  } else {\n    // 폴백: console.log 사용 (debugMode에 따라 표시 여부 결정됨)\n    console.log(`[${category}] ${message}`);\n  }\n}\n\n/**\n * MatDialog 인스턴스를 저장할 변수\n * Angular가 부트스트랩된 후에 설정됨\n */\nlet matDialogInstance: any = null;\n\n/**\n * 무한 루프 방지 플래그\n */\nlet isProcessingConfirm = false;\n\n/**\n * 오버라이드 활성화 플래그\n */\nlet isConfirmOverrideEnabled = true;\n\n/**\n * MatDialog 인스턴스를 설정\n */\nexport function setConfirmDialogInstance(instance: any): void {\n  matDialogInstance = instance;\n  // 메시지 숨김 (개발 시에만 필요)\n  if (false) {\n    debugLog('Confirm Override', '🎯 MatDialog 인스턴스가 설정되었습니다.');\n  }\n}\n\n/**\n * Confirm Override 활성화/비활성화\n */\nexport function setConfirmOverrideEnabled(enabled: boolean): void {\n  isConfirmOverrideEnabled = enabled;\n  debugLog('Confirm Override', `🎯 ${enabled ? '활성화' : '비활성화'}`);\n}\n\n/**\n * Confirm 타입 자동 감지\n */\nfunction detectConfirmType(message: string): 'warning' | 'danger' | 'info' {\n  const lowerMessage = message.toLowerCase();\n  \n  if (lowerMessage.includes('삭제') || lowerMessage.includes('제거') || lowerMessage.includes('delete')) {\n    return 'danger';\n  } else if (lowerMessage.includes('나가') || lowerMessage.includes('취소') || lowerMessage.includes('종료')) {\n    return 'warning';\n  }\n  \n  return 'info';\n}\n\n/**\n * Confirm 오버라이드 초기화\n */\nexport function initializeConfirmOverride(): void {\n  // 초기화 메시지 숨김 (개발 시에만 필요)\n  if (false) {\n    debugLog('Confirm Override', '━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    debugLog('Confirm Override', '🎯 초기화 시작...');\n    debugLog('Confirm Override', '━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n  }\n\n  // 원본 confirm을 백업\n  const nativeConfirm = originalConfirm;\n  \n  if (false) {\n    debugLog('Confirm Override', `🔍 원본 window.confirm 타입: ${typeof window.confirm}`);\n    debugLog('Confirm Override', `🔍 백업된 nativeConfirm 타입: ${typeof nativeConfirm}`);\n  }\n\n  // window.confirm 오버라이드\n  window.confirm = function(message?: string): boolean {\n    // 디버그 로그 숨김 (개발 시에만 필요)\n    if (false) {\n      debugLog('Confirm Override', '━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n      debugLog('Confirm Override', '🚨 window.confirm() 호출됨!');\n      debugLog('Confirm Override', `메시지: ${message || ''}`);\n      debugLog('Confirm Override', '━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    }\n    \n    // 오버라이드가 비활성화된 경우 원본 사용\n    if (!isConfirmOverrideEnabled) {\n      if (false) debugLog('Confirm Override', '⚠️ 비활성화되어 있어 원본 confirm을 사용합니다.');\n      return nativeConfirm(message);\n    }\n\n    // 무한 루프 방지\n    if (isProcessingConfirm) {\n      if (false) debugLog('Confirm Override', '⚠️ 이미 처리 중입니다.');\n      return false;\n    }\n\n    // MatDialog가 준비되지 않은 경우 원본 사용\n    if (!matDialogInstance) {\n      if (false) debugLog('Confirm Override', '⚠️ MatDialog가 아직 준비되지 않았습니다.');\n      return nativeConfirm(message);\n    }\n\n    if (false) {\n      debugLog('Confirm Override', `💬 Dialog 표시 - ${message || ''}`);\n      debugLog('Confirm Override', '⚠️ 기존 confirm()은 작동하지 않습니다. Dialog만 표시됩니다.');\n    }\n    \n    // 동기 confirm을 비동기 Dialog로 변환\n    isProcessingConfirm = true;\n    \n    if (false) debugLog('Confirm Override', '🔍 ConfirmDialogComponent import 시작...');\n    \n    try {\n      // ConfirmDialogComponent를 동적으로 import하여 사용\n      import('../shared/components/confirm-dialog/confirm-dialog.component').then(module => {\n        if (false) {\n          debugLog('Confirm Override', '🔍 ✅ Dialog 컴포넌트 import 성공!');\n          debugLog('Confirm Override', `🔍 module 내용: ${Object.keys(module).join(', ')}`);\n          debugLog('Confirm Override', '🔍 matDialogInstance.open() 호출 시작...');\n        }\n        \n        try {\n          const dialogRef = matDialogInstance.open(module.ConfirmDialogComponent, {\n            width: '400px',\n            maxWidth: '90vw',\n            disableClose: false,\n            hasBackdrop: true,\n            closeOnNavigation: true,\n            autoFocus: 'dialog',\n            restoreFocus: true,\n            panelClass: 'confirm-dialog-container',\n            data: {\n              message: message || '확인하시겠습니까?',\n              type: detectConfirmType(message || ''),\n              confirmText: '확인',\n              cancelText: '취소'\n            }\n          });\n\n          if (false) {\n            debugLog('Confirm Override', '🔍 ✅ matDialogInstance.open() 호출 성공!');\n            debugLog('Confirm Override', `🔍 dialogRef id: ${dialogRef.id}`);\n          }\n\n          // backdrop 클릭 시 명시적으로 false로 닫기\n          dialogRef.backdropClick().subscribe(() => {\n            if (false) debugLog('Confirm Override', '🔍 ✅ backdrop 클릭 감지됨!');\n            dialogRef.close(false);\n          });\n\n          // ESC 키 눌림 시 명시적으로 false로 닫기\n          dialogRef.keydownEvents().subscribe((event: KeyboardEvent) => {\n            if (event.key === 'Escape') {\n              if (false) debugLog('Confirm Override', '🔍 ✅ ESC 키 감지됨!');\n              dialogRef.close(false);\n            }\n          });\n\n          dialogRef.afterClosed().subscribe((confirmed: boolean) => {\n            if (false) debugLog('Confirm Override', `🔍 ✅ Dialog 닫힘! 결과: ${confirmed ? '확인' : '취소'}`);\n            isProcessingConfirm = false;\n          });\n        \n          if (false) debugLog('Confirm Override', '🔍 모든 이벤트 구독 완료');\n        } catch (openError) {\n          debugLog('Confirm Override', `❌ matDialogInstance.open() 실패: ${openError}`);\n          isProcessingConfirm = false;\n        }\n      }).catch(err => {\n        debugLog('Confirm Override', `❌ ConfirmDialog import 실패: ${err}`);\n        isProcessingConfirm = false;\n      });\n    } catch (e) {\n      debugLog('Confirm Override', `❌ 동기 예외 발생: ${e}`);\n      isProcessingConfirm = false;\n      return false;\n    }\n\n    // ⚠️ 중요: 동기 confirm API의 한계로 인해 항상 false를 반환\n    // Dialog가 표시되지만 기존 코드의 if (confirm(...)) 블록은 실행되지 않음\n    return false;\n  };\n\n  // 초기화 완료 메시지 숨김 (개발 시에만 필요)\n  if (false) {\n    debugLog('Confirm Override', '✅ 초기화 완료');\n    debugLog('Confirm Override', '━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n  }\n}\n\n/**\n * 비동기 Confirm (Promise 기반)\n * confirm() 대신 이 함수를 사용하는 것을 권장\n */\nexport async function confirmAsync(message: string): Promise<boolean> {\n  if (!matDialogInstance) {\n    console.warn('⚠️ MatDialog가 준비되지 않았습니다. 원본 confirm을 사용합니다.');\n    return originalConfirm(message);\n  }\n\n  try {\n    const module = await import('../shared/components/confirm-dialog/confirm-dialog.component');\n    const dialogRef = matDialogInstance.open(module.ConfirmDialogComponent, {\n      width: '400px',\n      maxWidth: '90vw',\n      disableClose: false,\n      panelClass: 'confirm-dialog-container',\n      data: {\n        message: message || '확인하시겠습니까?',\n        type: detectConfirmType(message || ''),\n        confirmText: '확인',\n        cancelText: '취소'\n      }\n    });\n\n    const result = await dialogRef.afterClosed().toPromise();\n    return result || false;\n  } catch (e) {\n    console.warn('❌ confirmAsync 오류:', e);\n    return originalConfirm(message);\n  }\n}\n\n/**\n * 원본 confirm 직접 호출 (오버라이드 우회)\n */\nexport function nativeConfirm(message?: string): boolean {\n  return originalConfirm(message);\n}\n\n/**\n * Confirm Override Helper\n */\nexport const ConfirmOverrideHelper = {\n  setDialogInstance: setConfirmDialogInstance,\n  setEnabled: setConfirmOverrideEnabled,\n  confirmAsync,\n  nativeConfirm,\n  \n  /**\n   * 오버라이드 상태 확인\n   */\n  isEnabled(): boolean {\n    return isConfirmOverrideEnabled;\n  },\n  \n  /**\n   * MatDialog 준비 상태 확인\n   */\n  isReady(): boolean {\n    return matDialogInstance !== null;\n  }\n};\n\n// 전역 객체에 헬퍼 등록 (디버깅용)\nif (typeof window !== 'undefined') {\n  (window as any).ConfirmOverride = ConfirmOverrideHelper;\n}\n"],
  "mappings": ";;;;;AAgBA,IAAM,kBAAkB,OAAO,QAAQ,KAAK,MAAM;AAKlD,SAAS,iBAAc;AACrB,SAAQ,OAAe;AACzB;AAKA,SAAS,SAAS,UAAkB,SAAe;AACjD,QAAM,SAAS,eAAc;AAC7B,MAAI,QAAQ;AACV,WAAO,KAAK,UAAU,OAAO;EAC/B,OAAO;AAEL,YAAQ,IAAI,IAAI,QAAQ,KAAK,OAAO,EAAE;EACxC;AACF;AAMA,IAAI,oBAAyB;AAK7B,IAAI,sBAAsB;AAK1B,IAAI,2BAA2B;AAKzB,SAAU,yBAAyB,UAAa;AACpD,sBAAoB;AAEpB,MAAI,OAAO;AACT,aAAS,oBAAoB,gGAA6B;EAC5D;AACF;AAKM,SAAU,0BAA0B,SAAgB;AACxD,6BAA2B;AAC3B,WAAS,oBAAoB,aAAM,UAAU,uBAAQ,0BAAM,EAAE;AAC/D;AAKA,SAAS,kBAAkB,SAAe;AACxC,QAAM,eAAe,QAAQ,YAAW;AAExC,MAAI,aAAa,SAAS,cAAI,KAAK,aAAa,SAAS,cAAI,KAAK,aAAa,SAAS,QAAQ,GAAG;AACjG,WAAO;EACT,WAAW,aAAa,SAAS,cAAI,KAAK,aAAa,SAAS,cAAI,KAAK,aAAa,SAAS,cAAI,GAAG;AACpG,WAAO;EACT;AAEA,SAAO;AACT;AAKM,SAAU,4BAAyB;AAEvC,MAAI,OAAO;AACT,aAAS,oBAAoB,kPAA0C;AACvE,aAAS,oBAAoB,8CAAc;AAC3C,aAAS,oBAAoB,kPAA0C;EACzE;AAGA,QAAMA,iBAAgB;AAEtB,MAAI,OAAO;AACT,aAAS,oBAAoB,uDAA4B,OAAO,OAAO,OAAO,EAAE;AAChF,aAAS,oBAAoB,4DAA4B,OAAOA,cAAa,EAAE;EACjF;AAGA,SAAO,UAAU,SAAS,SAAgB;AAExC,QAAI,OAAO;AACT,eAAS,oBAAoB,kPAA0C;AACvE,eAAS,oBAAoB,gDAA0B;AACvD,eAAS,oBAAoB,uBAAQ,WAAW,EAAE,EAAE;AACpD,eAAS,oBAAoB,kPAA0C;IACzE;AAGA,QAAI,CAAC,0BAA0B;AAC7B,UAAI;AAAO,iBAAS,oBAAoB,2HAAiC;AACzE,aAAOA,eAAc,OAAO;IAC9B;AAGA,QAAI,qBAAqB;AACvB,UAAI;AAAO,iBAAS,oBAAoB,kEAAgB;AACxD,aAAO;IACT;AAGA,QAAI,CAAC,mBAAmB;AACtB,UAAI;AAAO,iBAAS,oBAAoB,oGAA8B;AACtE,aAAOA,eAAc,OAAO;IAC9B;AAEA,QAAI,OAAO;AACT,eAAS,oBAAoB,mCAAkB,WAAW,EAAE,EAAE;AAC9D,eAAS,oBAAoB,2IAA4C;IAC3E;AAGA,0BAAsB;AAEtB,QAAI;AAAO,eAAS,oBAAoB,yDAAwC;AAEhF,QAAI;AAEF,aAAO,qBAA8D,EAAE,KAAK,YAAS;AACnF,YAAI,OAAO;AACT,mBAAS,oBAAoB,uEAA6B;AAC1D,mBAAS,oBAAoB,kCAAiB,OAAO,KAAK,MAAM,EAAE,KAAK,IAAI,CAAC,EAAE;AAC9E,mBAAS,oBAAoB,iEAAsC;QACrE;AAEA,YAAI;AACF,gBAAM,YAAY,kBAAkB,KAAK,OAAO,wBAAwB;YACtE,OAAO;YACP,UAAU;YACV,cAAc;YACd,aAAa;YACb,mBAAmB;YACnB,WAAW;YACX,cAAc;YACd,YAAY;YACZ,MAAM;cACJ,SAAS,WAAW;cACpB,MAAM,kBAAkB,WAAW,EAAE;cACrC,aAAa;cACb,YAAY;;WAEf;AAED,cAAI,OAAO;AACT,qBAAS,oBAAoB,sEAAsC;AACnE,qBAAS,oBAAoB,2BAAoB,UAAU,EAAE,EAAE;UACjE;AAGA,oBAAU,cAAa,EAAG,UAAU,MAAK;AACvC,gBAAI;AAAO,uBAAS,oBAAoB,4DAAuB;AAC/D,sBAAU,MAAM,KAAK;UACvB,CAAC;AAGD,oBAAU,cAAa,EAAG,UAAU,CAAC,UAAwB;AAC3D,gBAAI,MAAM,QAAQ,UAAU;AAC1B,kBAAI;AAAO,yBAAS,oBAAoB,iDAAiB;AACzD,wBAAU,MAAM,KAAK;YACvB;UACF,CAAC;AAED,oBAAU,YAAW,EAAG,UAAU,CAAC,cAAsB;AACvD,gBAAI;AAAO,uBAAS,oBAAoB,uDAAuB,YAAY,iBAAO,cAAI,EAAE;AACxF,kCAAsB;UACxB,CAAC;AAED,cAAI;AAAO,qBAAS,oBAAoB,qEAAiB;QAC3D,SAAS,WAAW;AAClB,mBAAS,oBAAoB,iDAAkC,SAAS,EAAE;AAC1E,gCAAsB;QACxB;MACF,CAAC,EAAE,MAAM,SAAM;AACb,iBAAS,oBAAoB,6CAA8B,GAAG,EAAE;AAChE,8BAAsB;MACxB,CAAC;IACH,SAAS,GAAG;AACV,eAAS,oBAAoB,kDAAe,CAAC,EAAE;AAC/C,4BAAsB;AACtB,aAAO;IACT;AAIA,WAAO;EACT;AAGA,MAAI,OAAO;AACT,aAAS,oBAAoB,wCAAU;AACvC,aAAS,oBAAoB,kPAA0C;EACzE;AACF;AAMA,SAAsB,aAAa,SAAe;;AAChD,QAAI,CAAC,mBAAmB;AACtB,cAAQ,KAAK,kJAA8C;AAC3D,aAAO,gBAAgB,OAAO;IAChC;AAEA,QAAI;AACF,YAAM,SAAS,MAAM,OAAO,qBAA8D;AAC1F,YAAM,YAAY,kBAAkB,KAAK,OAAO,wBAAwB;QACtE,OAAO;QACP,UAAU;QACV,cAAc;QACd,YAAY;QACZ,MAAM;UACJ,SAAS,WAAW;UACpB,MAAM,kBAAkB,WAAW,EAAE;UACrC,aAAa;UACb,YAAY;;OAEf;AAED,YAAM,SAAS,MAAM,UAAU,YAAW,EAAG,UAAS;AACtD,aAAO,UAAU;IACnB,SAAS,GAAG;AACV,cAAQ,KAAK,qCAAsB,CAAC;AACpC,aAAO,gBAAgB,OAAO;IAChC;EACF;;AAKM,SAAU,cAAc,SAAgB;AAC5C,SAAO,gBAAgB,OAAO;AAChC;AAKO,IAAM,wBAAwB;EACnC,mBAAmB;EACnB,YAAY;EACZ;EACA;;;;EAKA,YAAS;AACP,WAAO;EACT;;;;EAKA,UAAO;AACL,WAAO,sBAAsB;EAC/B;;AAIF,IAAI,OAAO,WAAW,aAAa;AAChC,SAAe,kBAAkB;AACpC;",
  "names": ["nativeConfirm"]
}

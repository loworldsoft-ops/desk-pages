{
  "version": 3,
  "sources": ["src/app/modules/store/services/user-management.service.ts"],
  "sourcesContent": ["import { Injectable, inject } from '@angular/core';\nimport { HttpClient, HttpParams } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { environment } from '../config/environment';\nimport { IUser, ICustomer, ISeller, IAdmin, UserRole } from '../interfaces/auth.interface';\nimport { DebugLoggerService } from '../../../shared/services/debug-logger.service';\n\nexport interface UserListResponse {\n  users: IUser[];\n  total: number;\n}\n\nexport interface UpdateUserDto {\n  name?: string;\n  email?: string;\n  phone?: string;\n  status?: 'ACTIVE' | 'INACTIVE' | 'DELETED';\n  role?: UserRole;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserManagementService {\n  private baseUrl = environment.baseSyncUrl + '/users';\n  private debugLogger = inject(DebugLoggerService);\n\n  constructor(private http: HttpClient) {}\n\n  /**\n   * ì „ì²´ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ\n   */\n  getAllUsers(): Observable<IUser[]> {\n    this.debugLogger.info('íšŒì›ê´€ë¦¬API', 'ğŸ“ getAllUsers í˜¸ì¶œ');\n    this.debugLogger.info('íšŒì›ê´€ë¦¬API', `URL: ${this.baseUrl}`);\n    \n    return this.http.get<any>(this.baseUrl).pipe(\n      tap(response => {\n        this.debugLogger.info('íšŒì›ê´€ë¦¬API', `ì‘ë‹µ ìˆ˜ì‹  - íƒ€ì…: ${typeof response}, ë°°ì—´: ${Array.isArray(response)}`);\n      }),\n      map((response: any) => {\n        // ë‹¤ì–‘í•œ ì‘ë‹µ êµ¬ì¡° ì²˜ë¦¬\n        if (Array.isArray(response)) {\n          this.debugLogger.success('íšŒì›ê´€ë¦¬API', `âœ… íŒ¨í„´ 1: ì§ì ‘ ë°°ì—´, ê°œìˆ˜: ${response.length}`);\n          return response as IUser[];\n        }\n        \n        if (response?.data?.users && Array.isArray(response.data.users)) {\n          this.debugLogger.success('íšŒì›ê´€ë¦¬API', `âœ… íŒ¨í„´ 2: data.users, ê°œìˆ˜: ${response.data.users.length}`);\n          return response.data.users as IUser[];\n        }\n        \n        if (response?.users && Array.isArray(response.users)) {\n          this.debugLogger.success('íšŒì›ê´€ë¦¬API', `âœ… íŒ¨í„´ 3: users, ê°œìˆ˜: ${response.users.length}`);\n          return response.users as IUser[];\n        }\n        \n        if (response?.data && Array.isArray(response.data)) {\n          this.debugLogger.success('íšŒì›ê´€ë¦¬API', `âœ… íŒ¨í„´ 4: data, ê°œìˆ˜: ${response.data.length}`);\n          return response.data as IUser[];\n        }\n        \n        this.debugLogger.error('íšŒì›ê´€ë¦¬API', `âŒ ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ êµ¬ì¡°: ${JSON.stringify(Object.keys(response || {}))}`);\n        return [];\n      })\n    );\n  }\n\n  /**\n   * ì—­í• ë³„ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ\n   * @param role - CUSTOMER, SELLER, ADMIN, SUPER_ADMIN\n   */\n  getUsersByRole(role: UserRole): Observable<IUser[]> {\n    const params = new HttpParams().set('role', this.mapRoleToRoleId(role).toString());\n    return this.http.get<IUser[]>(`${this.baseUrl}/roles`, { params });\n  }\n\n  /**\n   * íŠ¹ì • ì‚¬ìš©ì ìƒì„¸ ì¡°íšŒ\n   */\n  getUserById(userId: string): Observable<IUser> {\n    return this.http.get<IUser>(`${this.baseUrl}/${userId}`);\n  }\n\n  /**\n   * ì‚¬ìš©ì ì •ë³´ ìˆ˜ì •\n   */\n  updateUser(userId: string, data: UpdateUserDto): Observable<IUser> {\n    this.debugLogger.info('íšŒì›ê´€ë¦¬API', `ğŸ“ ì‚¬ìš©ì ì •ë³´ ìˆ˜ì •: ${userId}`);\n    this.debugLogger.info('íšŒì›ê´€ë¦¬API', `ìˆ˜ì • ë°ì´í„°: ${JSON.stringify(data)}`);\n    \n    return this.http.post<IUser>(`${this.baseUrl}/update`, {\n      userId,\n      ...data\n    }).pipe(\n      tap(user => {\n        this.debugLogger.success('íšŒì›ê´€ë¦¬API', `âœ… ì‚¬ìš©ì ì •ë³´ ìˆ˜ì • ì™„ë£Œ: ${userId}`);\n      })\n    );\n  }\n\n  /**\n   * ì‚¬ìš©ì ì‚­ì œ (soft delete)\n   */\n  deleteUser(userId: string): Observable<void> {\n    this.debugLogger.warn('íšŒì›ê´€ë¦¬API', `ğŸ—‘ï¸ ì‚¬ìš©ì ì‚­ì œ: ${userId}`);\n    const url = `${this.baseUrl}?userId=${userId}`;\n    \n    const params = new HttpParams().set('userId', userId);\n    return this.http.delete<any>(this.baseUrl, { params }).pipe(\n      map((response: any) => {\n        return response;\n      })\n    );\n  }\n\n  /**\n   * ì‚¬ìš©ì ìƒíƒœ ë³€ê²½\n   */\n  updateUserStatus(userId: string, status: 'ACTIVE' | 'INACTIVE' | 'DELETED'): Observable<IUser> {\n    return this.updateUser(userId, { status });\n  }\n\n  /**\n   * Roleì„ RoleIdë¡œ ë§¤í•‘\n   */\n  private mapRoleToRoleId(role: UserRole): number {\n    const roleMap: Record<UserRole, number> = {\n      'CUSTOMER': 100,\n      'SELLER': 200,\n      'ADMIN': 300,\n      'SUPER_ADMIN': 400\n    };\n    return roleMap[role] || 100;\n  }\n\n  /**\n   * RoleIdë¥¼ Role ì´ë¦„ìœ¼ë¡œ ë§¤í•‘\n   */\n  getRoleName(role: UserRole): string {\n    const roleNameMap: Record<UserRole, string> = {\n      'CUSTOMER': 'ê³ ê°',\n      'SELLER': 'íŒë§¤ì',\n      'ADMIN': 'ê´€ë¦¬ì',\n      'SUPER_ADMIN': 'ìµœê³  ê´€ë¦¬ì'\n    };\n    return roleNameMap[role] || 'ì•Œ ìˆ˜ ì—†ìŒ';\n  }\n}\n"],
  "mappings": "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",
  "names": []
}

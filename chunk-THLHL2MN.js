import{a as _t}from"./chunk-SAWA3JHK.js";import"./chunk-7UZYWCAJ.js";import{a as Jo}from"./chunk-UGODGDG6.js";import{c as No,d as ma,f as xa,g as _a,h as Ca}from"./chunk-DUKSTT3K.js";import{a as Ho,b as $o,c as mi,d as dr,e as Xo,f as Go,h as Yo,i as Ko,m as es}from"./chunk-2INUU37C.js";import"./chunk-F6ZRSYO5.js";import{e as Qo}from"./chunk-KDSCINN4.js";import{b as ts}from"./chunk-LCTB47CK.js";import{c as qo}from"./chunk-ACTHFZSI.js";import{va as Zo}from"./chunk-TCIPLG6L.js";import{E as Vo,c as zo,h as jo,m as Wo}from"./chunk-BTFORE5L.js";import{d as Uo,g as va}from"./chunk-IQHB6EBY.js";import{$ as Ot,$a as Oo,Cc as ui,D as Fr,Db as So,Eb as Oe,F as ai,Gb as re,Ha as ci,Ia as fa,Ib as k,Ja as li,La as di,Ma as Mo,Mb as nn,Na as _,Nb as rn,Ob as an,Ra as lt,Rc as lr,S as vo,Sb as Eo,Ta as fi,Tb as De,U as bo,Ub as ve,Uc as Fo,V as wo,Vb as To,W as nt,Wb as dt,Xb as g,Y as Kt,Ya as yt,Yb as ne,Za as pi,Zb as ge,_b as Ir,_c as Io,a as xo,aa as oi,bc as pa,bd as Bo,c as gn,cb as Ut,cc as ga,cd as Ro,da as si,dc as ua,dd as hi,ea as ct,eb as Rt,f as tn,g as st,ha as J,ia as Q,ja as Me,jc as Br,ka as Re,l as Un,m as ii,md as Dn,nb as Lt,nc as qt,ob as ae,oc as gi,od as Lo,pb as oe,pc as Xn,q as Hn,qb as yo,qc as Do,qd as An,rb as ko,sa as $n,sb as ye,tb as ke,ub as we,vb as f,vc as Ao,w as _o,wa as un,wb as p,x as Co,xb as ee,yb as Ze,za as Po,zb as Ye,zc as ha}from"./chunk-KCIJXSXQ.js";import{a as $e,b as ot,h as bn}from"./chunk-WWX6BADO.js";var Hr={};Hr.version="0.18.5";var Yn=1200,br=1252,W0=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],V0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Vs=function(n){W0.indexOf(n)!=-1&&(br=V0[0]=n)};function U0(){Vs(1252)}var $r=function(n){Yn=n,Vs(n)};function H0(){$r(1200),U0()}function $0(n){for(var t=[],e=0;e<n.length>>1;++e)t[e]=String.fromCharCode(n.charCodeAt(2*e+1)+(n.charCodeAt(2*e)<<8));return t.join("")}var xi=function(t){return String.fromCharCode(t)},ns=function(t){return String.fromCharCode(t)},Ue;var xn=null,Rr=!0,In="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xr(n){for(var t="",e=0,r=0,i=0,a=0,o=0,s=0,c=0,l=0;l<n.length;)e=n.charCodeAt(l++),a=e>>2,r=n.charCodeAt(l++),o=(e&3)<<4|r>>4,i=n.charCodeAt(l++),s=(r&15)<<2|i>>6,c=i&63,isNaN(r)?s=c=64:isNaN(i)&&(c=64),t+=In.charAt(a)+In.charAt(o)+In.charAt(s)+In.charAt(c);return t}function yn(n){var t="",e=0,r=0,i=0,a=0,o=0,s=0,c=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<n.length;)a=In.indexOf(n.charAt(l++)),o=In.indexOf(n.charAt(l++)),e=a<<2|o>>4,t+=String.fromCharCode(e),s=In.indexOf(n.charAt(l++)),r=(o&15)<<4|s>>2,s!==64&&(t+=String.fromCharCode(r)),c=In.indexOf(n.charAt(l++)),i=(s&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var Ie=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Sn=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function qn(n){return Ie?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function rs(n){return Ie?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var cn=function(t){return Ie?Sn(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function zi(n){if(typeof ArrayBuffer>"u")return cn(n);for(var t=new ArrayBuffer(n.length),e=new Uint8Array(t),r=0;r!=n.length;++r)e[r]=n.charCodeAt(r)&255;return t}function Zr(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function X0(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var bt=Ie?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:Sn(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var r=new Uint8Array(e),i=0;for(t=0,e=0;t<n.length;e+=i,++t)if(i=n[t].length,n[t]instanceof Uint8Array)r.set(n[t],e);else{if(typeof n[t]=="string")throw"wtf";r.set(new Uint8Array(n[t]),e)}return r}return[].concat.apply([],n.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function G0(n){for(var t=[],e=0,r=n.length+250,i=qn(n.length+255),a=0;a<n.length;++a){var o=n.charCodeAt(a);if(o<128)i[e++]=o;else if(o<2048)i[e++]=192|o>>6&31,i[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=n.charCodeAt(++a)&1023;i[e++]=240|o>>8&7,i[e++]=128|o>>2&63,i[e++]=128|s>>6&15|(o&3)<<4,i[e++]=128|s&63}else i[e++]=224|o>>12&15,i[e++]=128|o>>6&63,i[e++]=128|o&63;e>r&&(t.push(i.slice(0,e)),e=0,i=qn(65535),r=65530)}return t.push(i.slice(0,e)),bt(t)}var mr=/\u0000/g,_i=/[\u0001-\u0006]/g;function xr(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function ln(n,t){var e=""+n;return e.length>=t?e:Ke("0",t-e.length)+e}function Fa(n,t){var e=""+n;return e.length>=t?e:Ke(" ",t-e.length)+e}function yi(n,t){var e=""+n;return e.length>=t?e:e+Ke(" ",t-e.length)}function Y0(n,t){var e=""+Math.round(n);return e.length>=t?e:Ke("0",t-e.length)+e}function K0(n,t){var e=""+n;return e.length>=t?e:Ke("0",t-e.length)+e}var is=Math.pow(2,32);function fr(n,t){if(n>is||n<-is)return Y0(n,t);var e=Math.round(n);return K0(e,t)}function ki(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var as=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ba=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function q0(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',n}var qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},os={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z0={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Si(n,t,e){for(var r=n<0?-1:1,i=n*r,a=0,o=1,s=0,c=1,l=0,d=0,m=Math.floor(i);l<t&&(m=Math.floor(i),s=m*o+a,d=m*l+c,!(i-m<5e-8));)i=1/(i-m),a=o,o=s,c=l,l=d;if(d>t&&(l>t?(d=c,s=a):(d=l,s=o)),!e)return[0,r*s,d];var x=Math.floor(r*s/d);return[x,r*s-x*d,d]}function Ci(n,t,e){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),a=0,o=[],s={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(r+=1462),s.u>.9999&&(s.u=0,++i==86400&&(s.T=i=0,++r,++s.D)),r===60)o=e?[1317,10,29]:[1900,2,29],a=3;else if(r===0)o=e?[1317,8,29]:[1900,1,0],a=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),r<60&&(a=(a+6)%7),e&&(a=il(c,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=a,s}var Us=new Date(1899,11,31,0,0,0),J0=Us.getTime(),Q0=new Date(1900,2,1,0,0,0);function Hs(n,t){var e=n.getTime();return t?e-=1461*24*60*60*1e3:n>=Q0&&(e+=1440*60*1e3),(e-(J0+(n.getTimezoneOffset()-Us.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Ia(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function el(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tl(n){var t=n<0?12:11,e=Ia(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function nl(n){var t=Ia(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function rl(n){var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=tl(n):t===10?e=n.toFixed(10).substr(0,12):e=nl(n),Ia(el(e.toUpperCase()))}function Ea(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):rl(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Rn(14,Hs(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function il(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function al(n,t,e,r){var i="",a=0,o=0,s=e.y,c,l=0;switch(n){case 98:s=e.y+543;case 121:switch(t.length){case 1:case 2:c=s%100,l=2;break;default:c=s%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=e.m,l=t.length;break;case 3:return ba[e.m-1][1];case 5:return ba[e.m-1][0];default:return ba[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=e.d,l=t.length;break;case 3:return as[e.q][0];default:return as[e.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(e.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=e.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=e.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?ln(e.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,a=Math.round(o*(e.S+e.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=ln(a,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=s,l=1;break}var d=l>0?ln(c,l):"";return d}function Bn(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,r=n.substr(0,e);e!=n.length;e+=t)r+=(r.length>0?",":"")+n.substr(e,t);return r}var $s=/%/g;function ol(n,t,e){var r=t.replace($s,""),i=t.length-r.length;return Pn(n,r,e*Math.pow(10,2*i))+Ke("%",i)}function sl(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Pn(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function Xs(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Xs(n,-t);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),e=(t/Math.pow(10,a)).toPrecision(r+1+(i+a)%i),e.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+a):e+="E+"+(o-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,c,l,d){return c+l+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Gs=/# (\?+)( ?)\/( ?)(\d+)/;function cl(n,t,e){var r=parseInt(n[4],10),i=Math.round(t*r),a=Math.floor(i/r),o=i-a*r,s=r;return e+(a===0?"":""+a)+" "+(o===0?Ke(" ",n[1].length+1+n[4].length):Fa(o,n[1].length)+n[2]+"/"+n[3]+ln(s,n[4].length))}function ll(n,t,e){return e+(t===0?"":""+t)+Ke(" ",n[1].length+2+n[4].length)}var Ys=/^#*0*\.([0#]+)/,Ks=/\).*[0#]/,qs=/\(###\) ###\\?-####/;function Tt(n){for(var t="",e,r=0;r!=n.length;++r)switch(e=n.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function ss(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function cs(n,t){var e=n-Math.floor(n),r=Math.pow(10,t);return t<(""+Math.round(e*r)).length?0:Math.round(e*r)}function dl(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function fl(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Zt(n,t,e){if(n.charCodeAt(0)===40&&!t.match(Ks)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Zt("n",r,e):"("+Zt("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return sl(n,t,e);if(t.indexOf("%")!==-1)return ol(n,t,e);if(t.indexOf("E")!==-1)return Xs(t,e);if(t.charCodeAt(0)===36)return"$"+Zt(n,t.substr(t.charAt(1)==" "?2:1),e);var i,a,o,s,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+fr(c,t.length);if(t.match(/^[#?]+$/))return i=fr(e,0),i==="0"&&(i=""),i.length>t.length?i:Tt(t.substr(0,t.length-i.length))+i;if(a=t.match(Gs))return cl(a,c,l);if(t.match(/^#+0+$/))return l+fr(c,t.length-t.indexOf("0"));if(a=t.match(Ys))return i=ss(e,a[1].length).replace(/^([^\.]+)$/,"$1."+Tt(a[1])).replace(/\.$/,"."+Tt(a[1])).replace(/\.(\d*)$/,function(v,h){return"."+h+Ke("0",Tt(a[1]).length-h.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return l+ss(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return l+Bn(fr(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Zt(n,t,-e):Bn(""+(Math.floor(e)+dl(e,a[1].length)))+"."+ln(cs(e,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Zt(n,t.replace(/^#,#*,/,""),e);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=xr(Zt(n,t.replace(/[\\-]/g,""),e)),o=0,xr(xr(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(qs))return i=Zt(n,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=Si(c,Math.pow(10,o)-1,!1),i=""+l,d=Pn("n",a[1],s[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=yi(s[2],o),d.length<a[4].length&&(d=Tt(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=Si(c,Math.pow(10,o)-1,!0),l+(s[0]||(s[1]?"":"0"))+" "+(s[1]?Fa(s[1],o)+a[2]+"/"+a[3]+yi(s[2],o):Ke(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=fr(e,0),t.length<=i.length?i:Tt(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,x=t.length-i.length-m;return Tt(t.substr(0,m)+i+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=cs(e,a[1].length),e<0?"-"+Zt(n,t,-e):Bn(fl(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ln(0,3-v.length):"")+v})+"."+ln(o,a[1].length);switch(t){case"###,##0.00":return Zt(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var u=Bn(fr(c,0));return u!=="0"?l+u:"";case"###,###.00":return Zt(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Zt(n,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function pl(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Pn(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function gl(n,t,e){var r=t.replace($s,""),i=t.length-r.length;return Pn(n,r,e*Math.pow(10,2*i))+Ke("%",i)}function Zs(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Zs(n,-t);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),e=(t/Math.pow(10,a)).toPrecision(r+1+(i+a)%i),!e.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+a):e+="E+"+(o-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,c,l,d){return c+l+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function hn(n,t,e){if(n.charCodeAt(0)===40&&!t.match(Ks)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?hn("n",r,e):"("+hn("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return pl(n,t,e);if(t.indexOf("%")!==-1)return gl(n,t,e);if(t.indexOf("E")!==-1)return Zs(t,e);if(t.charCodeAt(0)===36)return"$"+hn(n,t.substr(t.charAt(1)==" "?2:1),e);var i,a,o,s,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+ln(c,t.length);if(t.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>t.length?i:Tt(t.substr(0,t.length-i.length))+i;if(a=t.match(Gs))return ll(a,c,l);if(t.match(/^#+0+$/))return l+ln(c,t.length-t.indexOf("0"));if(a=t.match(Ys))return i=(""+e).replace(/^([^\.]+)$/,"$1."+Tt(a[1])).replace(/\.$/,"."+Tt(a[1])),i=i.replace(/\.(\d*)$/,function(v,h){return"."+h+Ke("0",Tt(a[1]).length-h.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return l+Bn(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+hn(n,t,-e):Bn(""+e)+"."+Ke("0",a[1].length);if(a=t.match(/^#,#*,#0/))return hn(n,t.replace(/^#,#*,/,""),e);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=xr(hn(n,t.replace(/[\\-]/g,""),e)),o=0,xr(xr(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(qs))return i=hn(n,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=Si(c,Math.pow(10,o)-1,!1),i=""+l,d=Pn("n",a[1],s[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=yi(s[2],o),d.length<a[4].length&&(d=Tt(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=Si(c,Math.pow(10,o)-1,!0),l+(s[0]||(s[1]?"":"0"))+" "+(s[1]?Fa(s[1],o)+a[2]+"/"+a[3]+yi(s[2],o):Ke(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+e,t.length<=i.length?i:Tt(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,x=t.length-i.length-m;return Tt(t.substr(0,m)+i+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+hn(n,t,-e):Bn(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ln(0,3-v.length):"")+v})+"."+ln(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=Bn(""+c);return u!=="0"?l+u:"";default:if(t.match(/\.[0#?]*$/))return hn(n,t.slice(0,t.lastIndexOf(".")),e)+Tt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Pn(n,t,e){return(e|0)===e?hn(n,t,e):Zt(n,t,e)}function ul(n){for(var t=[],e=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:e=!e;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=n.substr(i,r-i),i=r+1}if(t[t.length]=n.substr(i),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var Js=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qs(n){for(var t=0,e="",r="";t<n.length;)switch(e=n.charAt(t)){case"G":ki(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(r=e;n.charAt(t++)!=="]"&&t<n.length;)r+=n.charAt(t);if(r.match(Js))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function hl(n,t,e,r){for(var i=[],a="",o=0,s="",c="t",l,d,m,x="H";o<n.length;)switch(s=n.charAt(o)){case"G":if(!ki(n,o))throw new Error("unrecognized character "+s+" in "+n);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(m=n.charCodeAt(++o))!==34&&o<n.length;)a+=String.fromCharCode(m);i[i.length]={t:"t",v:a},++o;break;case"\\":var u=n.charAt(++o),v=u==="("||u===")"?u:"t";i[i.length]={t:v,v:u},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(l==null&&(l=Ci(t,e,n.charAt(o+1)==="2"),l==null))return"";i[i.length]={t:"X",v:n.substr(o,2)},c=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=Ci(t,e),l==null))return"";for(a=s;++o<n.length&&n.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&c.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=x),i[i.length]={t:s,v:a},c=s;break;case"A":case"a":case"\u4E0A":var h={t:s,v:s};if(l==null&&(l=Ci(t,e)),n.substr(o,3).toUpperCase()==="A/P"?(l!=null&&(h.v=l.H>=12?"P":"A"),h.t="T",x="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(l!=null&&(h.v=l.H>=12?"PM":"AM"),h.t="T",o+=5,x="h"):n.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(h.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),h.t="T",o+=5,x="h"):(h.t="t",++o),l==null&&h.t==="T")return"";i[i.length]=h,c=s;break;case"[":for(a=s;n.charAt(o++)!=="]"&&o<n.length;)a+=n.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Js)){if(l==null&&(l=Ci(t,e),l==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qs(n)||(i[i.length]={t:"t",v:a}));break;case".":if(l!=null){for(a=s;++o<n.length&&(s=n.charAt(o))==="0";)a+=s;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<n.length&&"0#?.,E+-%".indexOf(s=n.charAt(o))>-1;)a+=s;i[i.length]={t:"n",v:a};break;case"?":for(a=s;n.charAt(++o)===s;)a+=s;i[i.length]={t:s,v:a},c=s;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)a+=n.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+n);i[i.length]={t:"t",v:s},++o;break}var w=0,T=0,F;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=x,c="h",w<1&&(w=1);break;case"s":(F=i[o].v.match(/\.0+$/))&&(T=Math.max(T,F[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[o].v.match(/[Hh]/)&&(w=1),w<2&&i[o].v.match(/[Mm]/)&&(w=2),w<3&&i[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var I="",j;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=al(i[o].t.charCodeAt(0),i[o].v,l,T),i[o].t="t";break;case"n":case"?":for(j=o+1;i[j]!=null&&((s=i[j].t)==="?"||s==="D"||(s===" "||s==="t")&&i[j+1]!=null&&(i[j+1].t==="?"||i[j+1].t==="t"&&i[j+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[j].v==="/"||i[j].v===" "&&i[j+1]!=null&&i[j+1].t=="?"));)i[o].v+=i[j].v,i[j]={v:"",t:";"},++j;I+=i[o].v,o=j-1;break;case"G":i[o].t="t",i[o].v=Ea(t,e);break}var W="",pe,A;if(I.length>0){I.charCodeAt(0)==40?(pe=t<0&&I.charCodeAt(0)===45?-t:t,A=Pn("n",I,pe)):(pe=t<0&&r>1?-t:t,A=Pn("n",I,pe),pe<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),j=A.length-1;var X=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){X=o;break}var z=i.length;if(X===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(j>=i[o].v.length-1?(j-=i[o].v.length,i[o].v=A.substr(j+1,i[o].v.length)):j<0?i[o].v="":(i[o].v=A.substr(0,j+1),j=-1),i[o].t="t",z=o);j>=0&&z<i.length&&(i[z].v=A.substr(0,j+1)+i[z].v)}else if(X!==i.length&&A.indexOf("E")===-1){for(j=A.indexOf(".")-1,o=X;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===X?i[o].v.indexOf(".")-1:i[o].v.length-1,W=i[o].v.substr(d+1);d>=0;--d)j>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(W=A.charAt(j--)+W);i[o].v=W,i[o].t="t",z=o}for(j>=0&&z<i.length&&(i[z].v=A.substr(0,j+1)+i[z].v),j=A.indexOf(".")+1,o=X;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==X)){for(d=i[o].v.indexOf(".")>-1&&o===X?i[o].v.indexOf(".")+1:0,W=i[o].v.substr(0,d);d<i[o].v.length;++d)j<A.length&&(W+=A.charAt(j++));i[o].v=W,i[o].t="t",z=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(pe=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Pn(i[o].t,i[o].v,pe),i[o].t="t");var H="";for(o=0;o!==i.length;++o)i[o]!=null&&(H+=i[o].v);return H}var ls=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ds(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function ml(n,t){var e=ul(n),r=e.length,i=e[r-1].indexOf("@");if(r<4&&i>-1&&--r,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var a=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[r,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(ls),s=e[1].match(ls);return ds(t,o)?[r,e[0]]:ds(t,s)?[r,e[1]]:[r,e[o!=null&&s!=null?2:1]]}return[r,a]}function Rn(n,t,e){e==null&&(e={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?r=e.dateNF:r=n;break;case"number":n==14&&e.dateNF?r=e.dateNF:r=(e.table!=null?e.table:qe)[n],r==null&&(r=e.table&&e.table[os[n]]||qe[os[n]]),r==null&&(r=Z0[n]||"General");break}if(ki(r,0))return Ea(t,e);t instanceof Date&&(t=Hs(t,e.date1904));var i=ml(r,t);if(ki(i[1]))return Ea(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return hl(i[1],t,e,i[0])}function ec(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(qe[e]==null){t<0&&(t=e);continue}if(qe[e]==n){t=e;break}}t<0&&(t=391)}return qe[t]=n,t}function ji(n){for(var t=0;t!=392;++t)n[t]!==void 0&&ec(n[t],t)}function Wi(){qe=q0()}var tc=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xl(n){var t=typeof n=="number"?qe[n]:n;return t=t.replace(tc,"(\\d+)"),new RegExp("^"+t+"$")}function _l(n,t,e){var r=-1,i=-1,a=-1,o=-1,s=-1,c=-1;(t.match(tc)||[]).forEach(function(m,x){var u=parseInt(e[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=u;break;case"d":a=u;break;case"h":o=u;break;case"s":c=u;break;case"m":o>=0?s=u:i=u;break}}),c>=0&&s==-1&&i>=0&&(s=i,i=-1);var l=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&s==-1&&c==-1?l:r==-1&&i==-1&&a==-1?d:l+"T"+d}var Cl=(function(){var n={};n.version="1.2.0";function t(){for(var A=0,X=new Array(256),z=0;z!=256;++z)A=z,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,X[z]=A;return typeof Int32Array<"u"?new Int32Array(X):X}var e=t();function r(A){var X=0,z=0,H=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)K[H]=A[H];for(H=0;H!=256;++H)for(z=A[H],X=256+H;X<4096;X+=256)z=K[X]=z>>>8^A[z&255];var Z=[];for(H=1;H!=16;++H)Z[H-1]=typeof Int32Array<"u"?K.subarray(H*256,H*256+256):K.slice(H*256,H*256+256);return Z}var i=r(e),a=i[0],o=i[1],s=i[2],c=i[3],l=i[4],d=i[5],m=i[6],x=i[7],u=i[8],v=i[9],h=i[10],w=i[11],T=i[12],F=i[13],I=i[14];function j(A,X){for(var z=X^-1,H=0,K=A.length;H<K;)z=z>>>8^e[(z^A.charCodeAt(H++))&255];return~z}function W(A,X){for(var z=X^-1,H=A.length-15,K=0;K<H;)z=I[A[K++]^z&255]^F[A[K++]^z>>8&255]^T[A[K++]^z>>16&255]^w[A[K++]^z>>>24]^h[A[K++]]^v[A[K++]]^u[A[K++]]^x[A[K++]]^m[A[K++]]^d[A[K++]]^l[A[K++]]^c[A[K++]]^s[A[K++]]^o[A[K++]]^a[A[K++]]^e[A[K++]];for(H+=15;K<H;)z=z>>>8^e[(z^A[K++])&255];return~z}function pe(A,X){for(var z=X^-1,H=0,K=A.length,Z=0,_e=0;H<K;)Z=A.charCodeAt(H++),Z<128?z=z>>>8^e[(z^Z)&255]:Z<2048?(z=z>>>8^e[(z^(192|Z>>6&31))&255],z=z>>>8^e[(z^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,_e=A.charCodeAt(H++)&1023,z=z>>>8^e[(z^(240|Z>>8&7))&255],z=z>>>8^e[(z^(128|Z>>2&63))&255],z=z>>>8^e[(z^(128|_e>>6&15|(Z&3)<<4))&255],z=z>>>8^e[(z^(128|_e&63))&255]):(z=z>>>8^e[(z^(224|Z>>12&15))&255],z=z>>>8^e[(z^(128|Z>>6&63))&255],z=z>>>8^e[(z^(128|Z&63))&255]);return~z}return n.table=e,n.bstr=j,n.buf=W,n.str=pe,n})(),Ve=(function(){var t={};t.version="1.2.1";function e(C,M){for(var b=C.split("/"),P=M.split("/"),O=0,y=0,B=Math.min(b.length,P.length);O<B;++O){if(y=b[O].length-P[O].length)return y;if(b[O]!=P[O])return b[O]<P[O]?-1:1}return b.length-P.length}function r(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:r(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(0,M+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(M+1)}function a(C,M){typeof M=="string"&&(M=new Date(M));var b=M.getHours();b=b<<6|M.getMinutes(),b=b<<5|M.getSeconds()>>>1,C.write_shift(2,b);var P=M.getFullYear()-1980;P=P<<4|M.getMonth()+1,P=P<<5|M.getDate(),C.write_shift(2,P)}function o(C){var M=C.read_shift(2)&65535,b=C.read_shift(2)&65535,P=new Date,O=b&31;b>>>=5;var y=b&15;b>>>=4,P.setMilliseconds(0),P.setFullYear(b+1980),P.setMonth(y-1),P.setDate(O);var B=M&31;M>>>=5;var U=M&63;return M>>>=6,P.setHours(M),P.setMinutes(U),P.setSeconds(B<<1),P}function s(C){$t(C,0);for(var M={},b=0;C.l<=C.length-4;){var P=C.read_shift(2),O=C.read_shift(2),y=C.l+O,B={};switch(P){case 21589:b=C.read_shift(1),b&1&&(B.mtime=C.read_shift(4)),O>5&&(b&2&&(B.atime=C.read_shift(4)),b&4&&(B.ctime=C.read_shift(4))),B.mtime&&(B.mt=new Date(B.mtime*1e3));break}C.l=y,M[P]=B}return M}var c;function l(){return c||(c={})}function d(C,M){if(C[0]==80&&C[1]==75)return mo(C,M);if((C[0]|32)==109&&(C[1]|32)==105)return B0(C,M);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var b=3,P=512,O=0,y=0,B=0,U=0,L=0,R=[],N=C.slice(0,512);$t(N,0);var te=m(N);switch(b=te[0],b){case 3:P=512;break;case 4:P=4096;break;case 0:if(te[1]==0)return mo(C,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+b)}P!==512&&(N=C.slice(0,P),$t(N,28));var ce=C.slice(0,P);x(N,b);var he=N.read_shift(4,"i");if(b===3&&he!==0)throw new Error("# Directory Sectors: Expected 0 saw "+he);N.l+=4,B=N.read_shift(4,"i"),N.l+=4,N.chk("00100000","Mini Stream Cutoff Size: "),U=N.read_shift(4,"i"),O=N.read_shift(4,"i"),L=N.read_shift(4,"i"),y=N.read_shift(4,"i");for(var le=-1,fe=0;fe<109&&(le=N.read_shift(4,"i"),!(le<0));++fe)R[fe]=le;var Pe=u(C,P);w(L,y,Pe,P,R);var He=F(Pe,B,R,P);He[B].name="!Directory",O>0&&U!==_e&&(He[U].name="!MiniFAT"),He[R[0]].name="!FAT",He.fat_addrs=R,He.ssz=P;var Bt={},Je=[],Vt=[],Dr=[];I(B,He,Pe,Je,O,Bt,Vt,U),v(Vt,Dr,Je),Je.shift();var Ar={FileIndex:Vt,FullPaths:Dr};return M&&M.raw&&(Ar.raw={header:ce,sectors:Pe}),Ar}function m(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Be,"Header Signature: "),C.l+=16;var M=C.read_shift(2,"u");return[C.read_shift(2,"u"),M]}function x(C,M){var b=9;switch(C.l+=2,b=C.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+b);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+b);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+b)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function u(C,M){for(var b=Math.ceil(C.length/M)-1,P=[],O=1;O<b;++O)P[O-1]=C.slice(O*M,(O+1)*M);return P[b-1]=C.slice(b*M),P}function v(C,M,b){for(var P=0,O=0,y=0,B=0,U=0,L=b.length,R=[],N=[];P<L;++P)R[P]=N[P]=P,M[P]=b[P];for(;U<N.length;++U)P=N[U],O=C[P].L,y=C[P].R,B=C[P].C,R[P]===P&&(O!==-1&&R[O]!==O&&(R[P]=R[O]),y!==-1&&R[y]!==y&&(R[P]=R[y])),B!==-1&&(R[B]=P),O!==-1&&P!=R[P]&&(R[O]=R[P],N.lastIndexOf(O)<U&&N.push(O)),y!==-1&&P!=R[P]&&(R[y]=R[P],N.lastIndexOf(y)<U&&N.push(y));for(P=1;P<L;++P)R[P]===P&&(y!==-1&&R[y]!==y?R[P]=R[y]:O!==-1&&R[O]!==O&&(R[P]=R[O]));for(P=1;P<L;++P)if(C[P].type!==0){if(U=P,U!=R[U])do U=R[U],M[P]=M[U]+"/"+M[P];while(U!==0&&R[U]!==-1&&U!=R[U]);R[P]=-1}for(M[0]+="/",P=1;P<L;++P)C[P].type!==2&&(M[P]+="/")}function h(C,M,b){for(var P=C.start,O=C.size,y=[],B=P;b&&O>0&&B>=0;)y.push(M.slice(B*Z,B*Z+Z)),O-=Z,B=Gn(b,B*4);return y.length===0?V(0):bt(y).slice(0,C.size)}function w(C,M,b,P,O){var y=_e;if(C===_e){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var B=b[C],U=(P>>>2)-1;if(!B)return;for(var L=0;L<U&&(y=Gn(B,L*4))!==_e;++L)O.push(y);w(Gn(B,P-4),M-1,b,P,O)}}function T(C,M,b,P,O){var y=[],B=[];O||(O=[]);var U=P-1,L=0,R=0;for(L=M;L>=0;){O[L]=!0,y[y.length]=L,B.push(C[L]);var N=b[Math.floor(L*4/P)];if(R=L*4&U,P<4+R)throw new Error("FAT boundary crossed: "+L+" 4 "+P);if(!C[N])break;L=Gn(C[N],R)}return{nodes:y,data:_s([B])}}function F(C,M,b,P){var O=C.length,y=[],B=[],U=[],L=[],R=P-1,N=0,te=0,ce=0,he=0;for(N=0;N<O;++N)if(U=[],ce=N+M,ce>=O&&(ce-=O),!B[ce]){L=[];var le=[];for(te=ce;te>=0;){le[te]=!0,B[te]=!0,U[U.length]=te,L.push(C[te]);var fe=b[Math.floor(te*4/P)];if(he=te*4&R,P<4+he)throw new Error("FAT boundary crossed: "+te+" 4 "+P);if(!C[fe]||(te=Gn(C[fe],he),le[te]))break}y[ce]={nodes:U,data:_s([L])}}return y}function I(C,M,b,P,O,y,B,U){for(var L=0,R=P.length?2:0,N=M[C].data,te=0,ce=0,he;te<N.length;te+=128){var le=N.slice(te,te+128);$t(le,64),ce=le.read_shift(2),he=Hi(le,0,ce-R),P.push(he);var fe={name:he,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},Pe=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Pe!==0&&(fe.ct=j(le,le.l-8));var He=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);He!==0&&(fe.mt=j(le,le.l-8)),fe.start=le.read_shift(4,"i"),fe.size=le.read_shift(4,"i"),fe.size<0&&fe.start<0&&(fe.size=fe.type=0,fe.start=_e,fe.name=""),fe.type===5?(L=fe.start,O>0&&L!==_e&&(M[L].name="!StreamData")):fe.size>=4096?(fe.storage="fat",M[fe.start]===void 0&&(M[fe.start]=T(b,fe.start,M.fat_addrs,M.ssz)),M[fe.start].name=fe.name,fe.content=M[fe.start].data.slice(0,fe.size)):(fe.storage="minifat",fe.size<0?fe.size=0:L!==_e&&fe.start!==_e&&M[L]&&(fe.content=h(fe,M[L].data,(M[U]||{}).data))),fe.content&&$t(fe.content,0),y[he]=fe,B.push(fe)}}function j(C,M){return new Date((ft(C,M+4)/1e7*Math.pow(2,32)+ft(C,M)/1e7-11644473600)*1e3)}function W(C,M){return l(),d(c.readFileSync(C),M)}function pe(C,M){var b=M&&M.type;switch(b||Ie&&Buffer.isBuffer(C)&&(b="buffer"),b||"base64"){case"file":return W(C,M);case"base64":return d(cn(yn(C)),M);case"binary":return d(cn(C),M)}return d(C,M)}function A(C,M){var b=M||{},P=b.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=P+"/",C.FileIndex[0]={name:P,type:5}),b.CLSID&&(C.FileIndex[0].clsid=b.CLSID),X(C)}function X(C){var M="Sh33tJ5";if(!Ve.find(C,"/"+M)){var b=V(4);b[0]=55,b[1]=b[3]=50,b[2]=54,C.FileIndex.push({name:M,type:2,content:b,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+M),z(C)}}function z(C,M){A(C);for(var b=!1,P=!1,O=C.FullPaths.length-1;O>=0;--O){var y=C.FileIndex[O];switch(y.type){case 0:P?b=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(y.R*y.L*y.C)&&(b=!0),y.R>-1&&y.L>-1&&y.R==y.L&&(b=!0);break;default:b=!0;break}}if(!(!b&&!M)){var B=new Date(1987,1,19),U=0,L=Object.create?Object.create(null):{},R=[];for(O=0;O<C.FullPaths.length;++O)L[C.FullPaths[O]]=!0,C.FileIndex[O].type!==0&&R.push([C.FullPaths[O],C.FileIndex[O]]);for(O=0;O<R.length;++O){var N=r(R[O][0]);P=L[N],P||(R.push([N,{name:i(N).replace("/",""),type:1,clsid:it,ct:B,mt:B,content:null}]),L[N]=!0)}for(R.sort(function(he,le){return e(he[0],le[0])}),C.FullPaths=[],C.FileIndex=[],O=0;O<R.length;++O)C.FullPaths[O]=R[O][0],C.FileIndex[O]=R[O][1];for(O=0;O<R.length;++O){var te=C.FileIndex[O],ce=C.FullPaths[O];if(te.name=i(ce).replace("/",""),te.L=te.R=te.C=-(te.color=1),te.size=te.content?te.content.length:0,te.start=0,te.clsid=te.clsid||it,O===0)te.C=R.length>1?1:-1,te.size=0,te.type=5;else if(ce.slice(-1)=="/"){for(U=O+1;U<R.length&&r(C.FullPaths[U])!=ce;++U);for(te.C=U>=R.length?-1:U,U=O+1;U<R.length&&r(C.FullPaths[U])!=r(ce);++U);te.R=U>=R.length?-1:U,te.type=1}else r(C.FullPaths[O+1]||"")==r(ce)&&(te.R=O+1),te.type=2}}}function H(C,M){var b=M||{};if(b.fileType=="mad")return R0(C,b);switch(z(C),b.fileType){case"zip":return E0(C,b)}var P=(function(he){for(var le=0,fe=0,Pe=0;Pe<he.FileIndex.length;++Pe){var He=he.FileIndex[Pe];if(He.content){var Bt=He.content.length;Bt>0&&(Bt<4096?le+=Bt+63>>6:fe+=Bt+511>>9)}}for(var Je=he.FullPaths.length+3>>2,Vt=le+7>>3,Dr=le+127>>7,Ar=Vt+fe+Je+Dr,Vn=Ar+127>>7,da=Vn<=109?0:Math.ceil((Vn-109)/127);Ar+Vn+da+127>>7>Vn;)da=++Vn<=109?0:Math.ceil((Vn-109)/127);var vn=[1,da,Vn,Dr,Je,fe,le,0];return he.FileIndex[0].size=le<<6,vn[7]=(he.FileIndex[0].start=vn[0]+vn[1]+vn[2]+vn[3]+vn[4]+vn[5])+(vn[6]+7>>3),vn})(C),O=V(P[7]<<9),y=0,B=0;{for(y=0;y<8;++y)O.write_shift(1,Ce[y]);for(y=0;y<8;++y)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),y=0;y<3;++y)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,P[2]),O.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:_e),O.write_shift(4,P[3]),O.write_shift(-4,P[1]?P[0]-1:_e),O.write_shift(4,P[1]),y=0;y<109;++y)O.write_shift(-4,y<P[2]?P[1]+y:-1)}if(P[1])for(B=0;B<P[1];++B){for(;y<236+B*127;++y)O.write_shift(-4,y<P[2]?P[1]+y:-1);O.write_shift(-4,B===P[1]-1?_e:B+1)}var U=function(he){for(B+=he;y<B-1;++y)O.write_shift(-4,y+1);he&&(++y,O.write_shift(-4,_e))};for(B=y=0,B+=P[1];y<B;++y)O.write_shift(-4,at.DIFSECT);for(B+=P[2];y<B;++y)O.write_shift(-4,at.FATSECT);U(P[3]),U(P[4]);for(var L=0,R=0,N=C.FileIndex[0];L<C.FileIndex.length;++L)N=C.FileIndex[L],N.content&&(R=N.content.length,!(R<4096)&&(N.start=B,U(R+511>>9)));for(U(P[6]+7>>3);O.l&511;)O.write_shift(-4,at.ENDOFCHAIN);for(B=y=0,L=0;L<C.FileIndex.length;++L)N=C.FileIndex[L],N.content&&(R=N.content.length,!(!R||R>=4096)&&(N.start=B,U(R+63>>6)));for(;O.l&511;)O.write_shift(-4,at.ENDOFCHAIN);for(y=0;y<P[4]<<2;++y){var te=C.FullPaths[y];if(!te||te.length===0){for(L=0;L<17;++L)O.write_shift(4,0);for(L=0;L<3;++L)O.write_shift(4,-1);for(L=0;L<12;++L)O.write_shift(4,0);continue}N=C.FileIndex[y],y===0&&(N.start=N.size?N.start-1:_e);var ce=y===0&&b.root||N.name;if(R=2*(ce.length+1),O.write_shift(64,ce,"utf16le"),O.write_shift(2,R),O.write_shift(1,N.type),O.write_shift(1,N.color),O.write_shift(-4,N.L),O.write_shift(-4,N.R),O.write_shift(-4,N.C),N.clsid)O.write_shift(16,N.clsid,"hex");else for(L=0;L<4;++L)O.write_shift(4,0);O.write_shift(4,N.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,N.start),O.write_shift(4,N.size),O.write_shift(4,0)}for(y=1;y<C.FileIndex.length;++y)if(N=C.FileIndex[y],N.size>=4096)if(O.l=N.start+1<<9,Ie&&Buffer.isBuffer(N.content))N.content.copy(O,O.l,0,N.size),O.l+=N.size+511&-512;else{for(L=0;L<N.size;++L)O.write_shift(1,N.content[L]);for(;L&511;++L)O.write_shift(1,0)}for(y=1;y<C.FileIndex.length;++y)if(N=C.FileIndex[y],N.size>0&&N.size<4096)if(Ie&&Buffer.isBuffer(N.content))N.content.copy(O,O.l,0,N.size),O.l+=N.size+63&-64;else{for(L=0;L<N.size;++L)O.write_shift(1,N.content[L]);for(;L&63;++L)O.write_shift(1,0)}if(Ie)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function K(C,M){var b=C.FullPaths.map(function(L){return L.toUpperCase()}),P=b.map(function(L){var R=L.split("/");return R[R.length-(L.slice(-1)=="/"?2:1)]}),O=!1;M.charCodeAt(0)===47?(O=!0,M=b[0].slice(0,-1)+M):O=M.indexOf("/")!==-1;var y=M.toUpperCase(),B=O===!0?b.indexOf(y):P.indexOf(y);if(B!==-1)return C.FileIndex[B];var U=!y.match(_i);for(y=y.replace(mr,""),U&&(y=y.replace(_i,"!")),B=0;B<b.length;++B)if((U?b[B].replace(_i,"!"):b[B]).replace(mr,"")==y||(U?P[B].replace(_i,"!"):P[B]).replace(mr,"")==y)return C.FileIndex[B];return null}var Z=64,_e=-2,Be="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],it="00000000000000000000000000000000",at={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:Be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:it,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ft(C,M,b){l();var P=H(C,b);c.writeFileSync(M,P)}function Et(C){for(var M=new Array(C.length),b=0;b<C.length;++b)M[b]=String.fromCharCode(C[b]);return M.join("")}function mt(C,M){var b=H(C,M);switch(M&&M.type||"buffer"){case"file":return l(),c.writeFileSync(M.filename,b),b;case"binary":return typeof b=="string"?b:Et(b);case"base64":return Xr(typeof b=="string"?b:Et(b));case"buffer":if(Ie)return Buffer.isBuffer(b)?b:Sn(b);case"array":return typeof b=="string"?cn(b):b}return b}var It;function S(C){try{var M=C.InflateRaw,b=new M;if(b._processChunk(new Uint8Array([3,0]),b._finishFlushFlag),b.bytesRead)It=C;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function G(C,M){if(!It)return uo(C,M);var b=It.InflateRaw,P=new b,O=P._processChunk(C.slice(C.l),P._finishFlushFlag);return C.l+=P.bytesRead,O}function D(C){return It?It.deflateRawSync(C):so(C)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(C){var M=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(M>>16|M>>8|M)&255}for(var ue=typeof Uint8Array<"u",de=ue?new Uint8Array(256):[],We=0;We<256;++We)de[We]=be(We);function Ee(C,M){var b=de[C&255];return M<=8?b>>>8-M:(b=b<<8|de[C>>8&255],M<=16?b>>>16-M:(b=b<<8|de[C>>16&255],b>>>24-M))}function xt(C,M){var b=M&7,P=M>>>3;return(C[P]|(b<=6?0:C[P+1]<<8))>>>b&3}function Ae(C,M){var b=M&7,P=M>>>3;return(C[P]|(b<=5?0:C[P+1]<<8))>>>b&7}function en(C,M){var b=M&7,P=M>>>3;return(C[P]|(b<=4?0:C[P+1]<<8))>>>b&15}function Ge(C,M){var b=M&7,P=M>>>3;return(C[P]|(b<=3?0:C[P+1]<<8))>>>b&31}function me(C,M){var b=M&7,P=M>>>3;return(C[P]|(b<=1?0:C[P+1]<<8))>>>b&127}function Yt(C,M,b){var P=M&7,O=M>>>3,y=(1<<b)-1,B=C[O]>>>P;return b<8-P||(B|=C[O+1]<<8-P,b<16-P)||(B|=C[O+2]<<16-P,b<24-P)||(B|=C[O+3]<<24-P),B&y}function Cn(C,M,b){var P=M&7,O=M>>>3;return P<=5?C[O]|=(b&7)<<P:(C[O]|=b<<P&255,C[O+1]=(b&7)>>8-P),M+3}function jn(C,M,b){var P=M&7,O=M>>>3;return b=(b&1)<<P,C[O]|=b,M+1}function cr(C,M,b){var P=M&7,O=M>>>3;return b<<=P,C[O]|=b&255,b>>>=8,C[O+1]=b,M+8}function oo(C,M,b){var P=M&7,O=M>>>3;return b<<=P,C[O]|=b&255,b>>>=8,C[O+1]=b&255,C[O+2]=b>>>8,M+16}function oa(C,M){var b=C.length,P=2*b>M?2*b:M+5,O=0;if(b>=M)return C;if(Ie){var y=rs(P);if(C.copy)C.copy(y);else for(;O<C.length;++O)y[O]=C[O];return y}else if(ue){var B=new Uint8Array(P);if(B.set)B.set(C);else for(;O<b;++O)B[O]=C[O];return B}return C.length=P,C}function pn(C){for(var M=new Array(C),b=0;b<C;++b)M[b]=0;return M}function ni(C,M,b){var P=1,O=0,y=0,B=0,U=0,L=C.length,R=ue?new Uint16Array(32):pn(32);for(y=0;y<32;++y)R[y]=0;for(y=L;y<b;++y)C[y]=0;L=C.length;var N=ue?new Uint16Array(L):pn(L);for(y=0;y<L;++y)R[O=C[y]]++,P<O&&(P=O),N[y]=0;for(R[0]=0,y=1;y<=P;++y)R[y+16]=U=U+R[y-1]<<1;for(y=0;y<L;++y)U=C[y],U!=0&&(N[y]=R[U+16]++);var te=0;for(y=0;y<L;++y)if(te=C[y],te!=0)for(U=Ee(N[y],P)>>P-te,B=(1<<P+4-te)-1;B>=0;--B)M[U|B<<te]=te&15|y<<4;return P}var sa=ue?new Uint16Array(512):pn(512),ca=ue?new Uint16Array(32):pn(32);if(!ue){for(var Wn=0;Wn<512;++Wn)sa[Wn]=0;for(Wn=0;Wn<32;++Wn)ca[Wn]=0}(function(){for(var C=[],M=0;M<32;M++)C.push(5);ni(C,ca,32);var b=[];for(M=0;M<=143;M++)b.push(8);for(;M<=255;M++)b.push(9);for(;M<=279;M++)b.push(7);for(;M<=287;M++)b.push(8);ni(b,sa,288)})();var O0=(function(){for(var M=ue?new Uint8Array(32768):[],b=0,P=0;b<xe.length-1;++b)for(;P<xe[b+1];++P)M[P]=b;for(;P<32768;++P)M[P]=29;var O=ue?new Uint8Array(259):[];for(b=0,P=0;b<q.length-1;++b)for(;P<q[b+1];++P)O[P]=b;function y(U,L){for(var R=0;R<U.length;){var N=Math.min(65535,U.length-R),te=R+N==U.length;for(L.write_shift(1,+te),L.write_shift(2,N),L.write_shift(2,~N&65535);N-- >0;)L[L.l++]=U[R++]}return L.l}function B(U,L){for(var R=0,N=0,te=ue?new Uint16Array(32768):[];N<U.length;){var ce=Math.min(65535,U.length-N);if(ce<10){for(R=Cn(L,R,+(N+ce==U.length)),R&7&&(R+=8-(R&7)),L.l=R/8|0,L.write_shift(2,ce),L.write_shift(2,~ce&65535);ce-- >0;)L[L.l++]=U[N++];R=L.l*8;continue}R=Cn(L,R,+(N+ce==U.length)+2);for(var he=0;ce-- >0;){var le=U[N];he=(he<<5^le)&32767;var fe=-1,Pe=0;if((fe=te[he])&&(fe|=N&-32768,fe>N&&(fe-=32768),fe<N))for(;U[fe+Pe]==U[N+Pe]&&Pe<250;)++Pe;if(Pe>2){le=O[Pe],le<=22?R=cr(L,R,de[le+1]>>1)-1:(cr(L,R,3),R+=5,cr(L,R,de[le-23]>>5),R+=3);var He=le<8?0:le-4>>2;He>0&&(oo(L,R,Pe-q[le]),R+=He),le=M[N-fe],R=cr(L,R,de[le]>>3),R-=3;var Bt=le<4?0:le-2>>1;Bt>0&&(oo(L,R,N-fe-xe[le]),R+=Bt);for(var Je=0;Je<Pe;++Je)te[he]=N&32767,he=(he<<5^U[N])&32767,++N;ce-=Pe-1}else le<=143?le=le+48:R=jn(L,R,1),R=cr(L,R,de[le]),te[he]=N&32767,++N}R=cr(L,R,0)-1}return L.l=(R+7)/8|0,L.l}return function(L,R){return L.length<8?y(L,R):B(L,R)}})();function so(C){var M=V(50+Math.floor(C.length*1.1)),b=O0(C,M);return M.slice(0,b)}var co=ue?new Uint16Array(32768):pn(32768),lo=ue?new Uint16Array(32768):pn(32768),fo=ue?new Uint16Array(128):pn(128),po=1,go=1;function y0(C,M){var b=Ge(C,M)+257;M+=5;var P=Ge(C,M)+1;M+=5;var O=en(C,M)+4;M+=4;for(var y=0,B=ue?new Uint8Array(19):pn(19),U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],L=1,R=ue?new Uint8Array(8):pn(8),N=ue?new Uint8Array(8):pn(8),te=B.length,ce=0;ce<O;++ce)B[E[ce]]=y=Ae(C,M),L<y&&(L=y),R[y]++,M+=3;var he=0;for(R[0]=0,ce=1;ce<=L;++ce)N[ce]=he=he+R[ce-1]<<1;for(ce=0;ce<te;++ce)(he=B[ce])!=0&&(U[ce]=N[he]++);var le=0;for(ce=0;ce<te;++ce)if(le=B[ce],le!=0){he=de[U[ce]]>>8-le;for(var fe=(1<<7-le)-1;fe>=0;--fe)fo[he|fe<<le]=le&7|ce<<3}var Pe=[];for(L=1;Pe.length<b+P;)switch(he=fo[me(C,M)],M+=he&7,he>>>=3){case 16:for(y=3+xt(C,M),M+=2,he=Pe[Pe.length-1];y-- >0;)Pe.push(he);break;case 17:for(y=3+Ae(C,M),M+=3;y-- >0;)Pe.push(0);break;case 18:for(y=11+me(C,M),M+=7;y-- >0;)Pe.push(0);break;default:Pe.push(he),L<he&&(L=he);break}var He=Pe.slice(0,b),Bt=Pe.slice(b);for(ce=b;ce<286;++ce)He[ce]=0;for(ce=P;ce<30;++ce)Bt[ce]=0;return po=ni(He,co,286),go=ni(Bt,lo,30),M}function k0(C,M){if(C[0]==3&&!(C[1]&3))return[qn(M),2];for(var b=0,P=0,O=rs(M||1<<18),y=0,B=O.length>>>0,U=0,L=0;(P&1)==0;){if(P=Ae(C,b),b+=3,P>>>1)P>>1==1?(U=9,L=5):(b=y0(C,b),U=po,L=go);else{b&7&&(b+=8-(b&7));var R=C[b>>>3]|C[(b>>>3)+1]<<8;if(b+=32,R>0)for(!M&&B<y+R&&(O=oa(O,y+R),B=O.length);R-- >0;)O[y++]=C[b>>>3],b+=8;continue}for(;;){!M&&B<y+32767&&(O=oa(O,y+32767),B=O.length);var N=Yt(C,b,U),te=P>>>1==1?sa[N]:co[N];if(b+=te&15,te>>>=4,(te>>>8&255)===0)O[y++]=te;else{if(te==256)break;te-=257;var ce=te<8?0:te-4>>2;ce>5&&(ce=0);var he=y+q[te];ce>0&&(he+=Yt(C,b,ce),b+=ce),N=Yt(C,b,L),te=P>>>1==1?ca[N]:lo[N],b+=te&15,te>>>=4;var le=te<4?0:te-2>>1,fe=xe[te];for(le>0&&(fe+=Yt(C,b,le),b+=le),!M&&B<he&&(O=oa(O,he+100),B=O.length);y<he;)O[y]=O[y-fe],++y}}}return M?[O,b+7>>>3]:[O.slice(0,y),b+7>>>3]}function uo(C,M){var b=C.slice(C.l||0),P=k0(b,M);return C.l+=P[1],P[0]}function ho(C,M){if(C)typeof console<"u"&&console.error(M);else throw new Error(M)}function mo(C,M){var b=C;$t(b,0);var P=[],O=[],y={FileIndex:P,FullPaths:O};A(y,{root:M.root});for(var B=b.length-4;(b[B]!=80||b[B+1]!=75||b[B+2]!=5||b[B+3]!=6)&&B>=0;)--B;b.l=B+4,b.l+=4;var U=b.read_shift(2);b.l+=6;var L=b.read_shift(4);for(b.l=L,B=0;B<U;++B){b.l+=20;var R=b.read_shift(4),N=b.read_shift(4),te=b.read_shift(2),ce=b.read_shift(2),he=b.read_shift(2);b.l+=8;var le=b.read_shift(4),fe=s(b.slice(b.l+te,b.l+te+ce));b.l+=te+ce+he;var Pe=b.l;b.l=le+4,S0(b,R,N,y,fe),b.l=Pe}return y}function S0(C,M,b,P,O){C.l+=2;var y=C.read_shift(2),B=C.read_shift(2),U=o(C);if(y&8257)throw new Error("Unsupported ZIP encryption");for(var L=C.read_shift(4),R=C.read_shift(4),N=C.read_shift(4),te=C.read_shift(2),ce=C.read_shift(2),he="",le=0;le<te;++le)he+=String.fromCharCode(C[C.l++]);if(ce){var fe=s(C.slice(C.l,C.l+ce));(fe[21589]||{}).mt&&(U=fe[21589].mt),((O||{})[21589]||{}).mt&&(U=O[21589].mt)}C.l+=ce;var Pe=C.slice(C.l,C.l+R);switch(B){case 8:Pe=G(C,N);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+B)}var He=!1;y&8&&(L=C.read_shift(4),L==134695760&&(L=C.read_shift(4),He=!0),R=C.read_shift(4),N=C.read_shift(4)),R!=M&&ho(He,"Bad compressed size: "+M+" != "+R),N!=b&&ho(He,"Bad uncompressed size: "+b+" != "+N),la(P,he,Pe,{unsafe:!0,mt:U})}function E0(C,M){var b=M||{},P=[],O=[],y=V(1),B=b.compression?8:0,U=0,L=!1;L&&(U|=8);var R=0,N=0,te=0,ce=0,he=C.FullPaths[0],le=he,fe=C.FileIndex[0],Pe=[],He=0;for(R=1;R<C.FullPaths.length;++R)if(le=C.FullPaths[R].slice(he.length),fe=C.FileIndex[R],!(!fe.size||!fe.content||le=="Sh33tJ5")){var Bt=te,Je=V(le.length);for(N=0;N<le.length;++N)Je.write_shift(1,le.charCodeAt(N)&127);Je=Je.slice(0,Je.l),Pe[ce]=Cl.buf(fe.content,0);var Vt=fe.content;B==8&&(Vt=D(Vt)),y=V(30),y.write_shift(4,67324752),y.write_shift(2,20),y.write_shift(2,U),y.write_shift(2,B),fe.mt?a(y,fe.mt):y.write_shift(4,0),y.write_shift(-4,U&8?0:Pe[ce]),y.write_shift(4,U&8?0:Vt.length),y.write_shift(4,U&8?0:fe.content.length),y.write_shift(2,Je.length),y.write_shift(2,0),te+=y.length,P.push(y),te+=Je.length,P.push(Je),te+=Vt.length,P.push(Vt),U&8&&(y=V(12),y.write_shift(-4,Pe[ce]),y.write_shift(4,Vt.length),y.write_shift(4,fe.content.length),te+=y.l,P.push(y)),y=V(46),y.write_shift(4,33639248),y.write_shift(2,0),y.write_shift(2,20),y.write_shift(2,U),y.write_shift(2,B),y.write_shift(4,0),y.write_shift(-4,Pe[ce]),y.write_shift(4,Vt.length),y.write_shift(4,fe.content.length),y.write_shift(2,Je.length),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(4,0),y.write_shift(4,Bt),He+=y.l,O.push(y),He+=Je.length,O.push(Je),++ce}return y=V(22),y.write_shift(4,101010256),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(2,ce),y.write_shift(2,ce),y.write_shift(4,He),y.write_shift(4,te),y.write_shift(2,0),bt([bt(P),bt(O),y])}var ri={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function T0(C,M){if(C.ctype)return C.ctype;var b=C.name||"",P=b.match(/\.([^\.]+)$/);return P&&ri[P[1]]||M&&(P=(b=M).match(/[\.\\]([^\.\\])+$/),P&&ri[P[1]])?ri[P[1]]:"application/octet-stream"}function D0(C){for(var M=Xr(C),b=[],P=0;P<M.length;P+=76)b.push(M.slice(P,P+76));return b.join(`\r
`)+`\r
`}function A0(C){var M=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(R){var N=R.charCodeAt(0).toString(16).toUpperCase();return"="+(N.length==1?"0"+N:N)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var b=[],P=M.split(`\r
`),O=0;O<P.length;++O){var y=P[O];if(y.length==0){b.push("");continue}for(var B=0;B<y.length;){var U=76,L=y.slice(B,B+U);L.charAt(U-1)=="="?U--:L.charAt(U-2)=="="?U-=2:L.charAt(U-3)=="="&&(U-=3),L=y.slice(B,B+U),B+=U,B<y.length&&(L+="="),b.push(L)}}return b.join(`\r
`)}function F0(C){for(var M=[],b=0;b<C.length;++b){for(var P=C[b];b<=C.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+C[++b];M.push(P)}for(var O=0;O<M.length;++O)M[O]=M[O].replace(/[=][0-9A-Fa-f]{2}/g,function(y){return String.fromCharCode(parseInt(y.slice(1),16))});return cn(M.join(`\r
`))}function I0(C,M,b){for(var P="",O="",y="",B,U=0;U<10;++U){var L=M[U];if(!L||L.match(/^\s*$/))break;var R=L.match(/^(.*?):\s*([^\s].*)$/);if(R)switch(R[1].toLowerCase()){case"content-location":P=R[2].trim();break;case"content-type":y=R[2].trim();break;case"content-transfer-encoding":O=R[2].trim();break}}switch(++U,O.toLowerCase()){case"base64":B=cn(yn(M.slice(U).join("")));break;case"quoted-printable":B=F0(M.slice(U));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var N=la(C,P.slice(b.length),B,{unsafe:!0});y&&(N.ctype=y)}function B0(C,M){if(Et(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var b=M&&M.root||"",P=(Ie&&Buffer.isBuffer(C)?C.toString("binary"):Et(C)).split(`\r
`),O=0,y="";for(O=0;O<P.length;++O)if(y=P[O],!!/^Content-Location:/i.test(y)&&(y=y.slice(y.indexOf("file")),b||(b=y.slice(0,y.lastIndexOf("/")+1)),y.slice(0,b.length)!=b))for(;b.length>0&&(b=b.slice(0,b.length-1),b=b.slice(0,b.lastIndexOf("/")+1),y.slice(0,b.length)!=b););var B=(P[1]||"").match(/boundary="(.*?)"/);if(!B)throw new Error("MAD cannot find boundary");var U="--"+(B[1]||""),L=[],R=[],N={FileIndex:L,FullPaths:R};A(N);var te,ce=0;for(O=0;O<P.length;++O){var he=P[O];he!==U&&he!==U+"--"||(ce++&&I0(N,P.slice(te,O),b),te=O)}return N}function R0(C,M){var b=M||{},P=b.boundary||"SheetJS";P="------="+P;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],y=C.FullPaths[0],B=y,U=C.FileIndex[0],L=1;L<C.FullPaths.length;++L)if(B=C.FullPaths[L].slice(y.length),U=C.FileIndex[L],!(!U.size||!U.content||B=="Sh33tJ5")){B=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pe){return"_x"+Pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pe){return"_u"+Pe.charCodeAt(0).toString(16)+"_"});for(var R=U.content,N=Ie&&Buffer.isBuffer(R)?R.toString("binary"):Et(R),te=0,ce=Math.min(1024,N.length),he=0,le=0;le<=ce;++le)(he=N.charCodeAt(le))>=32&&he<128&&++te;var fe=te>=ce*4/5;O.push(P),O.push("Content-Location: "+(b.root||"file:///C:/SheetJS/")+B),O.push("Content-Transfer-Encoding: "+(fe?"quoted-printable":"base64")),O.push("Content-Type: "+T0(U,B)),O.push(""),O.push(fe?A0(N):D0(N))}return O.push(P+`--\r
`),O.join(`\r
`)}function L0(C){var M={};return A(M,C),M}function la(C,M,b,P){var O=P&&P.unsafe;O||A(C);var y=!O&&Ve.find(C,M);if(!y){var B=C.FullPaths[0];M.slice(0,B.length)==B?B=M:(B.slice(-1)!="/"&&(B+="/"),B=(B+M).replace("//","/")),y={name:i(M),type:2},C.FileIndex.push(y),C.FullPaths.push(B),O||Ve.utils.cfb_gc(C)}return y.content=b,y.size=b?b.length:0,P&&(P.CLSID&&(y.clsid=P.CLSID),P.mt&&(y.mt=P.mt),P.ct&&(y.ct=P.ct)),y}function N0(C,M){A(C);var b=Ve.find(C,M);if(b){for(var P=0;P<C.FileIndex.length;++P)if(C.FileIndex[P]==b)return C.FileIndex.splice(P,1),C.FullPaths.splice(P,1),!0}return!1}function z0(C,M,b){A(C);var P=Ve.find(C,M);if(P){for(var O=0;O<C.FileIndex.length;++O)if(C.FileIndex[O]==P)return C.FileIndex[O].name=i(b),C.FullPaths[O]=b,!0}return!1}function j0(C){z(C,!0)}return t.find=K,t.read=pe,t.parse=d,t.write=mt,t.writeFile=Ft,t.utils={cfb_new:L0,cfb_add:la,cfb_del:N0,cfb_mov:z0,cfb_gc:j0,ReadShift:jr,CheckField:uc,prep_blob:$t,bconcat:bt,use_zlib:S,_deflateRaw:so,_inflateRaw:uo,consts:at},t})(),vi;function vl(n){return typeof n=="string"?zi(n):Array.isArray(n)?X0(n):n}function Jr(n,t,e){if(typeof vi<"u"&&vi.writeFileSync)return e?vi.writeFileSync(n,t,e):vi.writeFileSync(n,t);if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=zi(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(n,t)}var r=e=="utf8"?wn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([vl(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:n,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=n,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(n);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=Zr(t)),s.write(t),s.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+n)}function Mt(n){for(var t=Object.keys(n),e=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(n,t[r])&&e.push(t[r]);return e}function fs(n,t){for(var e=[],r=Mt(n),i=0;i!==r.length;++i)e[n[r[i]][t]]==null&&(e[n[r[i]][t]]=r[i]);return e}function Ba(n){for(var t=[],e=Mt(n),r=0;r!==e.length;++r)t[n[e[r]]]=e[r];return t}function Vi(n){for(var t=[],e=Mt(n),r=0;r!==e.length;++r)t[n[e[r]]]=parseInt(e[r],10);return t}function bl(n){for(var t=[],e=Mt(n),r=0;r!==e.length;++r)t[n[e[r]]]==null&&(t[n[e[r]]]=[]),t[n[e[r]]].push(e[r]);return t}var Ei=new Date(1899,11,30,0,0,0);function zt(n,t){var e=n.getTime();t&&(e-=1462*24*60*60*1e3);var r=Ei.getTime()+(n.getTimezoneOffset()-Ei.getTimezoneOffset())*6e4;return(e-r)/(1440*60*1e3)}var nc=new Date,wl=Ei.getTime()+(nc.getTimezoneOffset()-Ei.getTimezoneOffset())*6e4,ps=nc.getTimezoneOffset();function rc(n){var t=new Date;return t.setTime(n*24*60*60*1e3+wl),t.getTimezoneOffset()!==ps&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ps)*6e4),t}var gs=new Date("2017-02-19T19:06:09.000Z"),ic=isNaN(gs.getFullYear())?new Date("2/19/17"):gs,Pl=ic.getFullYear()==2017;function At(n,t){var e=new Date(n);if(Pl)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(n instanceof Date)return n;if(ic.getFullYear()==1917&&!isNaN(e.getFullYear())){var r=e.getFullYear();return n.indexOf(""+r)>-1||e.setFullYear(e.getFullYear()+100),e}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ui(n,t){if(Ie&&Buffer.isBuffer(n)){if(t){if(n[0]==255&&n[1]==254)return wn(n.slice(2).toString("utf16le"));if(n[1]==254&&n[2]==255)return wn($0(n.slice(2).toString("binary")))}return n.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(n[0]==255&&n[1]==254)return wn(new TextDecoder("utf-16le").decode(n.slice(2)));if(n[0]==254&&n[1]==255)return wn(new TextDecoder("utf-16be").decode(n.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return e[a]||a})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function jt(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=jt(n[e]));return t}function Ke(n,t){for(var e="";e.length<t;)e+=n;return e}function Mn(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,a){return e=-e,a}),!isNaN(t=Number(r)))?t/e:t}var Ml=["january","february","march","april","may","june","july","august","september","october","november","december"];function Gr(n){var t=new Date(n),e=new Date(NaN),r=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return e;var o=n.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Ml.indexOf(o)==-1)return e}else if(o.match(/[a-z]/))return e;return r<0||r>8099?e:(i>0||a>1)&&r!=101?t:n.match(/[^-0-9:,\/\\]/)?e:t}function Se(n,t,e){if(n.FullPaths){if(typeof e=="string"){var r;return Ie?r=Sn(e):r=G0(e),Ve.utils.cfb_add(n,t,r)}Ve.utils.cfb_add(n,t,e)}else n.file(t,e)}function Ra(){return Ve.utils.cfb_new()}var tt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var Ol={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},La=Ba(Ol);var Na=/[&<>'"]/g,yl=/[\u0000-\u0008\u000b-\u001f]/g;function ze(n){var t=n+"";return t.replace(Na,function(e){return La[e]}).replace(yl,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function us(n){return ze(n).replace(/ /g,"_x0020_")}var ac=/[\u0000-\u001f]/g;function kl(n){var t=n+"";return t.replace(Na,function(e){return La[e]}).replace(/\n/g,"<br/>").replace(ac,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Sl(n){var t=n+"";return t.replace(Na,function(e){return La[e]}).replace(ac,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function El(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function Tl(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wa(n){for(var t="",e=0,r=0,i=0,a=0,o=0,s=0;e<n.length;){if(r=n.charCodeAt(e++),r<128){t+=String.fromCharCode(r);continue}if(i=n.charCodeAt(e++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=n.charCodeAt(e++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63);continue}o=n.charCodeAt(e++),s=((r&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(s&1023))}return t}function hs(n){var t=qn(2*n.length),e,r,i=1,a=0,o=0,s;for(r=0;r<n.length;r+=i)i=1,(s=n.charCodeAt(r))<128?e=s:s<224?(e=(s&31)*64+(n.charCodeAt(r+1)&63),i=2):s<240?(e=(s&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,e=(s&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=e%256,t[a++]=e>>>8;return t.slice(0,a).toString("ucs2")}function ms(n){return Sn(n,"binary").toString("utf8")}var bi="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",zr=Ie&&(ms(bi)==wa(bi)&&ms||hs(bi)==wa(bi)&&hs)||wa,wn=Ie?function(n){return Sn(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,r=0,i=0;e<n.length;)switch(r=n.charCodeAt(e++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(e++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")};var Dl=(function(){var n=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var r=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})();var oc=/(^\s|\s$|\n)/;function wt(n,t){return"<"+n+(t.match(oc)?' xml:space="preserve"':"")+">"+t+"</"+n+">"}function Yr(n){return Mt(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function ie(n,t,e){return"<"+n+(e!=null?Yr(e):"")+(t!=null?(t.match(oc)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function Ta(n,t){try{return n.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function Al(n,t){switch(typeof n){case"string":var e=ie("vt:lpwstr",ze(n));return t&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return ie((n|0)==n?"vt:i4":"vt:r8",ze(String(n)));case"boolean":return ie("vt:bool",n?"true":"false")}if(n instanceof Date)return ie("vt:filetime",Ta(n));throw new Error("Unable to serialize "+n)}var pt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pr=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Xt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Fl(n,t){for(var e=1-2*(n[t+7]>>>7),r=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),i=n[t+6]&15,a=5;a>=0;--a)i=i*256+n[t+a];return r==2047?i==0?e*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),e*Math.pow(2,r-52)*i)}function Il(n,t,e){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=r?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var s=0;s<=5;++s,a/=256)n[e+s]=a&255;n[e+6]=(i&15)<<4|a&15,n[e+7]=i>>4|r}var xs=function(n){for(var t=[],e=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,a=n[0][r].length;i<a;i+=e)t.push.apply(t,n[0][r].slice(i,i+e));return t},_s=Ie?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:Sn(t)})):xs(n)}:xs,Cs=function(n,t,e){for(var r=[],i=t;i<e;i+=2)r.push(String.fromCharCode(Nr(n,i)));return r.join("").replace(mr,"")},Hi=Ie?function(n,t,e){return Buffer.isBuffer(n)?n.toString("utf16le",t,e).replace(mr,""):Cs(n,t,e)}:Cs,vs=function(n,t,e){for(var r=[],i=t;i<t+e;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},sc=Ie?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):vs(n,t,e)}:vs,bs=function(n,t,e){for(var r=[],i=t;i<e;i++)r.push(String.fromCharCode(ur(n,i)));return r.join("")},Mr=Ie?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf8",e,r):bs(t,e,r)}:bs,cc=function(n,t){var e=ft(n,t);return e>0?Mr(n,t+4,t+4+e-1):""},za=cc,lc=function(n,t){var e=ft(n,t);return e>0?Mr(n,t+4,t+4+e-1):""},ja=lc,dc=function(n,t){var e=2*ft(n,t);return e>0?Mr(n,t+4,t+4+e-1):""},Wa=dc,fc=function(t,e){var r=ft(t,e);return r>0?Hi(t,e+4,e+4+r):""},Va=fc,pc=function(n,t){var e=ft(n,t);return e>0?Mr(n,t+4,t+4+e):""},Ua=pc,gc=function(n,t){return Fl(n,t)},Ti=gc,Ha=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ie&&(za=function(t,e){if(!Buffer.isBuffer(t))return cc(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},ja=function(t,e){if(!Buffer.isBuffer(t))return lc(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},Wa=function(t,e){if(!Buffer.isBuffer(t))return dc(t,e);var r=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r-1)},Va=function(t,e){if(!Buffer.isBuffer(t))return fc(t,e);var r=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r)},Ua=function(t,e){if(!Buffer.isBuffer(t))return pc(t,e);var r=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+r)},Ti=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):gc(t,e)},Ha=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function Bl(){Hi=function(n,t,e){return Ue.utils.decode(1200,n.slice(t,e)).replace(mr,"")},Mr=function(n,t,e){return Ue.utils.decode(65001,n.slice(t,e))},za=function(n,t){var e=ft(n,t);return e>0?Ue.utils.decode(br,n.slice(t+4,t+4+e-1)):""},ja=function(n,t){var e=ft(n,t);return e>0?Ue.utils.decode(Yn,n.slice(t+4,t+4+e-1)):""},Wa=function(n,t){var e=2*ft(n,t);return e>0?Ue.utils.decode(1200,n.slice(t+4,t+4+e-1)):""},Va=function(n,t){var e=ft(n,t);return e>0?Ue.utils.decode(1200,n.slice(t+4,t+4+e)):""},Ua=function(n,t){var e=ft(n,t);return e>0?Ue.utils.decode(65001,n.slice(t+4,t+4+e)):""}}typeof Ue<"u"&&Bl();var ur=function(n,t){return n[t]},Nr=function(n,t){return n[t+1]*256+n[t]},Rl=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},ft=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},Gn=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},Ll=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function jr(n,t){var e="",r,i,a=[],o,s,c,l;switch(t){case"dbcs":if(l=this.l,Ie&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(c=0;c<n;++c)e+=String.fromCharCode(Nr(this,l)),l+=2;n*=2;break;case"utf8":e=Mr(this,this.l,this.l+n);break;case"utf16le":n*=2,e=Hi(this,this.l,this.l+n);break;case"wstr":if(typeof Ue<"u")e=Ue.utils.decode(Yn,this.slice(this.l,this.l+2*n));else return jr.call(this,n,"dbcs");n=2*n;break;case"lpstr-ansi":e=za(this,this.l),n=4+ft(this,this.l);break;case"lpstr-cp":e=ja(this,this.l),n=4+ft(this,this.l);break;case"lpwstr":e=Wa(this,this.l),n=4+2*ft(this,this.l);break;case"lpp4":n=4+ft(this,this.l),e=Va(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+ft(this,this.l),e=Ua(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(o=ur(this,this.l+n++))!==0;)a.push(xi(o));e=a.join("");break;case"_wstr":for(n=0,e="";(o=Nr(this,this.l+n))!==0;)a.push(xi(o)),n+=2;n+=2,e=a.join("");break;case"dbcs-cont":for(e="",l=this.l,c=0;c<n;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return o=ur(this,l),this.l=l+1,s=jr.call(this,n-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(xi(Nr(this,l))),l+=2}e=a.join(""),n*=2;break;case"cpstr":if(typeof Ue<"u"){e=Ue.utils.decode(Yn,this.slice(this.l,this.l+n));break}case"sbcs-cont":for(e="",l=this.l,c=0;c!=n;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return o=ur(this,l),this.l=l+1,s=jr.call(this,n-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(xi(ur(this,l))),l+=1}e=a.join("");break;default:switch(n){case 1:return r=ur(this,this.l),this.l++,r;case 2:return r=(t==="i"?Rl:Nr)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(n>0?Gn:Ll)(this,this.l),this.l+=4,r):(i=ft(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return n==8?i=Ti(this,this.l):i=Ti([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:e=sc(this,this.l,n);break}}return this.l+=n,e}var Nl=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},zl=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},jl=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function Wl(n,t,e){var r=0,i=0;if(e==="dbcs"){for(i=0;i!=t.length;++i)jl(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(e==="sbcs"){if(typeof Ue<"u"&&br==874)for(i=0;i!=t.length;++i){var a=Ue.utils.encode(br,t.charAt(i));this[this.l+i]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(e==="hex"){for(;i<n;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+n,this.length);for(i=0;i<Math.min(t.length,n);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,Nl(this,t,this.l);break;case 8:if(r=8,e==="f"){Il(this,t,this.l);break}case 16:break;case-4:r=4,zl(this,t,this.l);break}return this.l+=r,this}function uc(n,t){var e=sc(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function $t(n,t){n.l=t,n.read_shift=jr,n.chk=uc,n.write_shift=Wl}function _n(n,t){n.l+=t}function V(n){var t=qn(n);return $t(t,0),t}function Nt(){var n=[],t=Ie?256:2048,e=function(l){var d=V(l);return $t(d,0),d},r=e(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},a=function(l){return r&&l<r.length-r.l?r:(i(),r=e(Math.max(l+1,t)))},o=function(){return i(),bt(n)},s=function(l){i(),r=l,r.l==null&&(r.l=r.length),a(t)};return{next:a,push:s,end:o,_bufs:n}}function Y(n,t,e,r){var i=+t,a;if(!isNaN(i)){r||(r=Bh[i].p||(e||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var o=n.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var s=0;s!=4;++s)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Ha(e)&&n.push(e)}}function Wr(n,t,e){var r=jt(n);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!e||e.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ws(n,t,e){var r=jt(n);return r.s=Wr(r.s,t.s,e),r.e=Wr(r.e,t.s,e),r}function Vr(n,t){if(n.cRel&&n.c<0)for(n=jt(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=jt(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=je(n);return!n.cRel&&n.cRel!=null&&(e=Hl(e)),!n.rRel&&n.rRel!=null&&(e=Vl(e)),e}function Pa(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+kt(n.s.c)+":"+(n.e.cRel?"":"$")+kt(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Pt(n.s.r)+":"+(n.e.rRel?"":"$")+Pt(n.e.r):Vr(n.s,t.biff)+":"+Vr(n.e,t.biff)}function $a(n){return parseInt(Ul(n),10)-1}function Pt(n){return""+(n+1)}function Vl(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ul(n){return n.replace(/\$(\d+)$/,"$1")}function Xa(n){for(var t=$l(n),e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function kt(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function Hl(n){return n.replace(/^([A-Z])/,"$$$1")}function $l(n){return n.replace(/^\$([A-Z])/,"$1")}function Xl(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gt(n){for(var t=0,e=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:t-1}}function je(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function Gt(n){var t=n.indexOf(":");return t==-1?{s:gt(n),e:gt(n)}:{s:gt(n.slice(0,t)),e:gt(n.slice(t+1))}}function et(n,t){return typeof t>"u"||typeof t=="number"?et(n.s,n.e):(typeof n!="string"&&(n=je(n)),typeof t!="string"&&(t=je(t)),n==t?n:n+":"+t)}function Xe(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,r=0,i=0,a=n.length;for(e=0;r<a&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(t.s.c=--e,e=0;r<a&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;if(t.s.r=--e,r===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,e=0;r!=a&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(t.e.c=--e,e=0;r!=a&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;return t.e.r=--e,t}function Ps(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=Rn(n.z,e?zt(t):t)}catch{}try{return n.w=Rn((n.XF||{}).numFmtId||(e?14:0),e?zt(t):t)}catch{return""+t}}function kn(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?Qr[n.v]||n.v:t==null?Ps(n,n.v):Ps(n,t))}function Qn(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",r={};return r[e]=n,{SheetNames:[e],Sheets:r}}function hc(n,t,e){var r=e||{},i=n?Array.isArray(n):r.dense;xn!=null&&i==null&&(i=xn);var a=n||(i?[]:{}),o=0,s=0;if(a&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var c=typeof r.origin=="string"?gt(r.origin):r.origin;o=c.r,s=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=Xe(a["!ref"]);l.s.c=d.s.c,l.s.r=d.s.r,l.e.c=Math.max(l.e.c,d.e.c),l.e.r=Math.max(l.e.r,d.e.r),o==-1&&(l.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[m].length;++x)if(!(typeof t[m][x]>"u")){var u={v:t[m][x]},v=o+m,h=s+x;if(l.s.r>v&&(l.s.r=v),l.s.c>h&&(l.s.c=h),l.e.r<v&&(l.e.r=v),l.e.c<h&&(l.e.c=h),t[m][x]&&typeof t[m][x]=="object"&&!Array.isArray(t[m][x])&&!(t[m][x]instanceof Date))u=t[m][x];else if(Array.isArray(u.v)&&(u.f=t[m][x][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(r.nullError)u.t="e",u.v=0;else if(r.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=r.dateNF||qe[14],r.cellDates?(u.t="d",u.w=Rn(u.z,zt(u.v))):(u.t="n",u.v=zt(u.v),u.w=Rn(u.z,u.v))):u.t="s";if(i)a[v]||(a[v]=[]),a[v][h]&&a[v][h].z&&(u.z=a[v][h].z),a[v][h]=u;else{var w=je({c:h,r:v});a[w]&&a[w].z&&(u.z=a[w].z),a[w]=u}}}return l.s.c<1e7&&(a["!ref"]=et(l)),a}function Or(n,t){return hc(null,n,t)}function Gl(n){return n.read_shift(4,"i")}function dn(n,t){return t||(t=V(4)),t.write_shift(4,n),t}function St(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function ut(n,t){var e=!1;return t==null&&(e=!0,t=V(4+2*n.length)),t.write_shift(4,n.length),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}function Yl(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Kl(n,t){return t||(t=V(4)),t.write_shift(2,n.ich||0),t.write_shift(2,n.ifnt||0),t}function Ga(n,t){var e=n.l,r=n.read_shift(1),i=St(n),a=[],o={t:i,h:i};if((r&1)!==0){for(var s=n.read_shift(4),c=0;c!=s;++c)a.push(Yl(n));o.r=a}else o.r=[{ich:0,ifnt:0}];return n.l=e+t,o}function ql(n,t){var e=!1;return t==null&&(e=!0,t=V(15+4*n.t.length)),t.write_shift(1,0),ut(n.t,t),e?t.slice(0,t.l):t}var Zl=Ga;function Jl(n,t){var e=!1;return t==null&&(e=!0,t=V(23+4*n.t.length)),t.write_shift(1,1),ut(n.t,t),t.write_shift(4,1),Kl({ich:0,ifnt:0},t),e?t.slice(0,t.l):t}function Qt(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function er(n,t){return t==null&&(t=V(8)),t.write_shift(-4,n.c),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}function tr(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}function nr(n,t){return t==null&&(t=V(4)),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}var Ql=St,mc=ut;function Ya(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}function Di(n,t){var e=!1;return t==null&&(e=!0,t=V(127)),t.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}var ed=St,Da=Ya,Ka=Di;function xc(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,r=t[0]&2;n.l+=4;var i=r===0?Ti([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Gn(t,0)>>2;return e?i/100:i}function _c(n,t){t==null&&(t=V(4));var e=0,r=0,i=n*100;if(n==(n|0)&&n>=-(1<<29)&&n<1<<29?r=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(r=1,e=1),r)t.write_shift(-4,((e?i:n)<<2)+(e+2));else throw new Error("unsupported RkNumber "+n)}function Cc(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}function td(n,t){return t||(t=V(16)),t.write_shift(4,n.s.r),t.write_shift(4,n.e.r),t.write_shift(4,n.s.c),t.write_shift(4,n.e.c),t}var rr=Cc,yr=td;function kr(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Zn(n,t){return(t||V(8)).write_shift(8,n,"f")}function nd(n){var t={},e=n.read_shift(1),r=e>>>1,i=n.read_shift(1),a=n.read_shift(2,"i"),o=n.read_shift(1),s=n.read_shift(1),c=n.read_shift(1);switch(n.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var l=fd[i];l&&(t.rgb=Is(l));break;case 2:t.rgb=Is([o,s,c]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Ai(n,t){if(t||(t=V(8)),!n||n.auto)return t.write_shift(4,0),t.write_shift(4,0),t;n.index!=null?(t.write_shift(1,2),t.write_shift(1,n.index)):n.theme!=null?(t.write_shift(1,6),t.write_shift(1,n.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=n.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!n.rgb||n.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function rd(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function id(n,t){t||(t=V(2));var e=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var vc=2,Ht=3,wi=11;var Fi=19;var Pi=64,ad=65,od=71;var sd=4108,cd=4126,vt=80;var Ms={1:{n:"CodePage",t:vc},2:{n:"Category",t:vt},3:{n:"PresentationFormat",t:vt},4:{n:"ByteCount",t:Ht},5:{n:"LineCount",t:Ht},6:{n:"ParagraphCount",t:Ht},7:{n:"SlideCount",t:Ht},8:{n:"NoteCount",t:Ht},9:{n:"HiddenCount",t:Ht},10:{n:"MultimediaClipCount",t:Ht},11:{n:"ScaleCrop",t:wi},12:{n:"HeadingPairs",t:sd},13:{n:"TitlesOfParts",t:cd},14:{n:"Manager",t:vt},15:{n:"Company",t:vt},16:{n:"LinksUpToDate",t:wi},17:{n:"CharacterCount",t:Ht},19:{n:"SharedDoc",t:wi},22:{n:"HyperlinksChanged",t:wi},23:{n:"AppVersion",t:Ht,p:"version"},24:{n:"DigSig",t:ad},26:{n:"ContentType",t:vt},27:{n:"ContentStatus",t:vt},28:{n:"Language",t:vt},29:{n:"Version",t:vt},255:{},2147483648:{n:"Locale",t:Fi},2147483651:{n:"Behavior",t:Fi},1919054434:{}},Os={1:{n:"CodePage",t:vc},2:{n:"Title",t:vt},3:{n:"Subject",t:vt},4:{n:"Author",t:vt},5:{n:"Keywords",t:vt},6:{n:"Comments",t:vt},7:{n:"Template",t:vt},8:{n:"LastAuthor",t:vt},9:{n:"RevNumber",t:vt},10:{n:"EditTime",t:Pi},11:{n:"LastPrinted",t:Pi},12:{n:"CreatedDate",t:Pi},13:{n:"ModifiedDate",t:Pi},14:{n:"PageCount",t:Ht},15:{n:"WordCount",t:Ht},16:{n:"CharCount",t:Ht},17:{n:"Thumbnail",t:od},18:{n:"Application",t:vt},19:{n:"DocSecurity",t:Ht},255:{},2147483648:{n:"Locale",t:Fi},2147483651:{n:"Behavior",t:Fi},1919054434:{}};function ld(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var dd=ld([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fd=jt(dd),Qr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var pd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Mi={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bc(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function wc(n,t){var e=bl(pd),r=[],i;r[r.length]=tt,r[r.length]=ie("Types",null,{xmlns:pt.CT,"xmlns:xsd":pt.xsd,"xmlns:xsi":pt.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ie("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){n[c]&&n[c].length>0&&(i=n[c][0],r[r.length]=ie("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Mi[c][t.bookType]||Mi[c].xlsx}))},o=function(c){(n[c]||[]).forEach(function(l){r[r.length]=ie("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:Mi[c][t.bookType]||Mi[c].xlsx})})},s=function(c){(n[c]||[]).forEach(function(l){r[r.length]=ie("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:e[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),s("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),o("metadata"),s("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Fe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Pc(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function _r(n){var t=[tt,ie("Relationships",null,{xmlns:pt.RELS})];return Mt(n["!id"]).forEach(function(e){t[t.length]=ie("Relationship",null,n["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ne(n,t,e,r,i,a){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),t<0)for(t=n["!idx"];n["!id"]["rId"+t];++t);if(n["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=e,a?i.TargetMode=a:[Fe.HLINK,Fe.XPATH,Fe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,t}function gd(n){var t=[tt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<n.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+n[e][0]+'" manifest:media-type="'+n[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ys(n,t,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function ud(n,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function hd(n){var t=[tt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=n.length;++e)t.push(ys(n[e][0],n[e][1])),t.push(ud("",n[e][0]));return t.push(ys("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Mc(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Hr.version+"</meta:generator></office:meta></office:document-meta>"}var Kn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ma(n,t,e,r,i){i[n]!=null||t==null||t===""||(i[n]=t,t=ze(t),r[r.length]=e?ie(n,t,e):wt(n,t))}function Oc(n,t){var e=t||{},r=[tt,ie("cp:coreProperties",null,{"xmlns:cp":pt.CORE_PROPS,"xmlns:dc":pt.dc,"xmlns:dcterms":pt.dcterms,"xmlns:dcmitype":pt.dcmitype,"xmlns:xsi":pt.xsi})],i={};if(!n&&!e.Props)return r.join("");n&&(n.CreatedDate!=null&&Ma("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Ta(n.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&Ma("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Ta(n.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var a=0;a!=Kn.length;++a){var o=Kn[a],s=e.Props&&e.Props[o[1]]!=null?e.Props[o[1]]:n?n[o[1]]:null;s===!0?s="1":s===!1?s="0":typeof s=="number"&&(s=String(s)),s!=null&&Ma(o[0],s,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Cr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yc=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function kc(n){var t=[],e=ie;return n||(n={}),n.Application="SheetJS",t[t.length]=tt,t[t.length]=ie("Properties",null,{xmlns:pt.EXT_PROPS,"xmlns:vt":pt.vt}),Cr.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=ze(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=e(r[0],i))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+ze(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Sc(n){var t=[tt,ie("Properties",null,{xmlns:pt.CUST_PROPS,"xmlns:vt":pt.vt})];if(!n)return t.join("");var e=1;return Mt(n).forEach(function(i){++e,t[t.length]=ie("property",Al(n[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:ze(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ks={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function md(n,t){var e=[];return Mt(ks).map(function(r){for(var i=0;i<Kn.length;++i)if(Kn[i][1]==r)return Kn[i];for(i=0;i<Cr.length;++i)if(Cr[i][1]==r)return Cr[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(wt(ks[r[1]]||r[1],i))}}),ie("DocumentProperties",e.join(""),{xmlns:Xt.o})}function xd(n,t){var e=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Mt(n).forEach(function(a){if(Object.prototype.hasOwnProperty.call(n,a)){for(var o=0;o<Kn.length;++o)if(a==Kn[o][1])return;for(o=0;o<Cr.length;++o)if(a==Cr[o][1])return;for(o=0;o<e.length;++o)if(a==e[o])return;var s=n[a],c="string";typeof s=="number"?(c="float",s=String(s)):s===!0||s===!1?(c="boolean",s=s?"1":"0"):s=String(s),i.push(ie(us(a),s,{"dt:dt":c}))}}),t&&Mt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(n&&Object.prototype.hasOwnProperty.call(n,a))){var o=t[a],s="string";typeof o=="number"?(s="float",o=String(o)):o===!0||o===!1?(s="boolean",o=o?"1":"0"):o instanceof Date?(s="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ie(us(a),o,{"dt:dt":s}))}}),"<"+r+' xmlns="'+Xt.o+'">'+i.join("")+"</"+r+">"}function _d(n){var t=typeof n=="string"?new Date(Date.parse(n)):n,e=t.getTime()/1e3+11644473600,r=e%Math.pow(2,32),i=(e-r)/Math.pow(2,32);r*=1e7,i*=1e7;var a=r/Math.pow(2,32)|0;a>0&&(r=r%Math.pow(2,32),i+=a);var o=V(8);return o.write_shift(4,r),o.write_shift(4,i),o}function Ss(n,t){var e=V(4),r=V(4);switch(e.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,t);break;case 5:r=V(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=_d(t);break;case 31:case 80:for(r=V(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}return bt([e,r])}var Ec=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Cd(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function Es(n,t,e){var r=V(8),i=[],a=[],o=8,s=0,c=V(8),l=V(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),a.push(c),i.push(l),o+=8+c.length,!t){l=V(8),l.write_shift(4,0),i.unshift(l);var d=[V(4)];for(d[0].write_shift(4,n.length),s=0;s<n.length;++s){var m=n[s][0];for(c=V(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,s+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=bt(d),a.unshift(c),o+=8+c.length}for(s=0;s<n.length;++s)if(!(t&&!t[n[s][0]])&&!(Ec.indexOf(n[s][0])>-1||yc.indexOf(n[s][0])>-1)&&n[s][1]!=null){var x=n[s][1],u=0;if(t){u=+t[n[s][0]];var v=e[u];if(v.p=="version"&&typeof x=="string"){var h=x.split(".");x=(+h[0]<<16)+(+h[1]||0)}c=Ss(v.t,x)}else{var w=Cd(x);w==-1&&(w=31,x=String(x)),c=Ss(w,x)}a.push(c),l=V(8),l.write_shift(4,t?u:2+s),i.push(l),o+=8+c.length}var T=8*(a.length+1);for(s=0;s<a.length;++s)i[s].write_shift(4,T),T+=a[s].length;return r.write_shift(4,o),r.write_shift(4,a.length),bt([r].concat(i).concat(a))}function Ts(n,t,e,r,i,a){var o=V(i?68:48),s=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ve.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var c=Es(n,e,r);if(s.push(c),i){var l=Es(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),s.push(l)}return bt(s)}function vd(n,t){t||(t=V(n));for(var e=0;e<n;++e)t.write_shift(1,0);return t}function bd(n,t){return n.read_shift(t)===1}function Dt(n,t){return t||(t=V(2)),t.write_shift(2,+!!n),t}function Tc(n){return n.read_shift(2,"u")}function Jt(n,t){return t||(t=V(2)),t.write_shift(2,n),t}function Dc(n,t,e){return e||(e=V(2)),e.write_shift(1,t=="e"?+n:+!!n),e.write_shift(1,t=="e"?1:0),e}function Ac(n,t,e){var r=n.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",a=Yn;if(e&&e.biff>=8&&(Yn=1200),!e||e.biff==8){var o=n.read_shift(1);o&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var s=r?n.read_shift(r,i):"";return Yn=a,s}function wd(n){var t=n.t||"",e=1,r=V(3+(e>1?2:0));r.write_shift(2,t.length),r.write_shift(1,(e>1?8:0)|1),e>1&&r.write_shift(2,e);var i=V(2*t.length);i.write_shift(2*t.length,t,"utf16le");var a=[r,i];return bt(a)}function Pd(n,t,e){var r;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(t,"sbcs-cont"):r=n.read_shift(t,"dbcs-cont"),r}function Md(n,t,e){var r=n.read_shift(e&&e.biff==2?1:2);return r===0?(n.l++,""):Pd(n,r,e)}function Od(n,t,e){if(e.biff>5)return Md(n,t,e);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function Fc(n,t,e){return e||(e=V(3+2*n.length)),e.write_shift(2,n.length),e.write_shift(1,1),e.write_shift(31,n,"utf16le"),e}function Ds(n,t){t||(t=V(6+n.length*2)),t.write_shift(4,1+n.length);for(var e=0;e<n.length;++e)t.write_shift(2,n.charCodeAt(e));return t.write_shift(2,0),t}function yd(n){var t=V(512),e=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),a=i>-1?31:23;switch(r.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(e=0;e<o.length;++e)t.write_shift(4,o[e]);if(a==28)r=r.slice(1),Ds(r,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<o.length;++e)t.write_shift(1,parseInt(o[e],16));var s=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(s.length+1)),e=0;e<s.length;++e)t.write_shift(2,s.charCodeAt(e));t.write_shift(2,0),a&8&&Ds(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<o.length;++e)t.write_shift(1,parseInt(o[e],16));for(var c=0;r.slice(c*3,c*3+3)=="../"||r.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,r.length-3*c+1),e=0;e<r.length-3*c;++e)t.write_shift(1,r.charCodeAt(e+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function Jn(n,t,e,r){return r||(r=V(6)),r.write_shift(2,n),r.write_shift(2,t),r.write_shift(2,e||0),r}function kd(n,t,e){var r=e.biff>8?4:2,i=n.read_shift(r),a=n.read_shift(r,"i"),o=n.read_shift(r,"i");return[i,a,o]}function Sd(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:e}}}function Ic(n,t){return t||(t=V(8)),t.write_shift(2,n.s.r),t.write_shift(2,n.e.r),t.write_shift(2,n.s.c),t.write_shift(2,n.e.c),t}function qa(n,t,e){var r=1536,i=16;switch(e.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=V(i);return a.write_shift(2,r),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Ed(n,t){var e=!t||t.biff==8,r=V(e?112:54);for(r.write_shift(t.biff==8?2:1,7),e&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(e?0:536870912));r.l<r.length;)r.write_shift(1,e?0:32);return r}function Td(n,t){var e=!t||t.biff>=8?2:1,r=V(8+e*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(e*n.name.length,n.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Dd(n,t){var e=V(8);e.write_shift(4,n.Count),e.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=wd(n[i],t);var a=bt([e].concat(r));return a.parts=[e.length].concat(r.map(function(o){return o.length})),a}function Ad(){var n=V(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Fd(n){var t=V(18),e=1718;return n&&n.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Id(n,t){var e=n.name||"Arial",r=t&&t.biff==5,i=r?15+e.length:16+2*e.length,a=V(i);return a.write_shift(2,(n.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,e.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le"),a}function Bd(n,t,e,r){var i=V(10);return Jn(n,t,r,i),i.write_shift(4,e),i}function Rd(n,t,e,r,i){var a=!i||i.biff==8,o=V(8+ +a+(1+a)*e.length);return Jn(n,t,r,o),o.write_shift(2,e.length),a&&o.write_shift(1,1),o.write_shift((1+a)*e.length,e,a?"utf16le":"sbcs"),o}function Ld(n,t,e,r){var i=e&&e.biff==5;r||(r=V(i?3+t.length:5+2*t.length)),r.write_shift(2,n),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=r.length>r.l?r.slice(0,r.l):r;return a.l==null&&(a.l=a.length),a}function Nd(n,t){var e=t.biff==8||!t.biff?4:2,r=V(2*e+6);return r.write_shift(e,n.s.r),r.write_shift(e,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function As(n,t,e,r){var i=e&&e.biff==5;r||(r=V(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,t<<4));var a=0;return n.numFmtId>0&&i&&(a|=1024),r.write_shift(4,a),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function zd(n){var t=V(8);return t.write_shift(4,0),t.write_shift(2,n[0]?n[0]+1:0),t.write_shift(2,n[1]?n[1]+1:0),t}function jd(n,t,e,r,i,a){var o=V(8);return Jn(n,t,r,o),Dc(e,a,o),o}function Wd(n,t,e,r){var i=V(14);return Jn(n,t,r,i),Zn(e,i),i}function Vd(n,t,e){if(e.biff<8)return Ud(n,t,e);for(var r=[],i=n.l+t,a=n.read_shift(e.biff>8?4:2);a--!==0;)r.push(kd(n,e.biff>8?12:6,e));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function Ud(n,t,e){n[n.l+1]==3&&n[n.l]++;var r=Ac(n,t,e);return r.charCodeAt(0)==3?r.slice(1):r}function Hd(n){var t=V(2+n.length*8);t.write_shift(2,n.length);for(var e=0;e<n.length;++e)Ic(n[e],t);return t}function $d(n){var t=V(24),e=gt(n[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return bt([t,yd(n[1])])}function Xd(n){var t=n[1].Tooltip,e=V(10+2*(t.length+1));e.write_shift(2,2048);var r=gt(n[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var i=0;i<t.length;++i)e.write_shift(2,t.charCodeAt(i));return e.write_shift(2,0),e}function Gd(n){return n||(n=V(4)),n.write_shift(2,1),n.write_shift(2,1),n}function Yd(n,t,e){if(!e.cellStyles)return _n(n,t);var r=e&&e.biff>=12?4:2,i=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),s=n.read_shift(r),c=n.read_shift(2);r==2&&(n.l+=2);var l={s:i,e:a,w:o,ixfe:s,flags:c};return(e.biff>=5||!e.biff)&&(l.level=c>>8&7),l}function Kd(n,t){var e=V(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,n.width*256),e.write_shift(2,0);var r=0;return n.hidden&&(r|=1),e.write_shift(1,r),r=n.level||0,e.write_shift(1,r),e.write_shift(2,0),e}function qd(n){for(var t=V(2*n),e=0;e<n;++e)t.write_shift(2,e+1);return t}function Zd(n,t,e){var r=V(15);return ti(r,n,t),r.write_shift(8,e,"f"),r}function Jd(n,t,e){var r=V(9);return ti(r,n,t),r.write_shift(2,e),r}var Qd=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ba({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(s,c){var l=[],d=qn(1);switch(c.type){case"base64":d=cn(yn(s));break;case"binary":d=cn(s);break;case"buffer":case"array":d=s;break}$t(d,0);var m=d.read_shift(1),x=!!(m&136),u=!1,v=!1;switch(m){case 2:break;case 3:break;case 48:u=!0,x=!0;break;case 49:u=!0,x=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var h=0,w=521;m==2&&(h=d.read_shift(2)),d.l+=3,m!=2&&(h=d.read_shift(4)),h>1048576&&(h=1e6),m!=2&&(w=d.read_shift(2));var T=d.read_shift(2),F=c.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(F=n[d[d.l]]),d.l+=1,d.l+=2),v&&(d.l+=36);for(var I=[],j={},W=Math.min(d.length,m==2?521:w-10-(u?264:0)),pe=v?32:11;d.l<W&&d[d.l]!=13;)switch(j={},j.name=Ue.utils.decode(F,d.slice(d.l,d.l+pe)).replace(/[\u0000\r\n].*$/g,""),d.l+=pe,j.type=String.fromCharCode(d.read_shift(1)),m!=2&&!v&&(j.offset=d.read_shift(4)),j.len=d.read_shift(1),m==2&&(j.offset=d.read_shift(2)),j.dec=d.read_shift(1),j.name.length&&I.push(j),m!=2&&(d.l+=v?13:14),j.type){case"B":(!u||j.len!=8)&&c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var A=0,X=0;for(l[0]=[],X=0;X!=I.length;++X)l[0][X]=I[X].name;for(;h-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,l[++A]=[],X=0,X=0;X!=I.length;++X){var z=d.slice(d.l,d.l+I[X].len);d.l+=I[X].len,$t(z,0);var H=Ue.utils.decode(F,z);switch(I[X].type){case"C":H.trim().length&&(l[A][X]=H.replace(/\s+$/,""));break;case"D":H.length===8?l[A][X]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):l[A][X]=H;break;case"F":l[A][X]=parseFloat(H.trim());break;case"+":case"I":l[A][X]=v?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":l[A][X]=!0;break;case"N":case"F":l[A][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));l[A][X]="##MEMO##"+(v?parseInt(H.trim(),10):z.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(l[A][X]=+H||0);break;case"@":l[A][X]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":l[A][X]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":l[A][X]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[A][X]=-z.read_shift(-8,"f");break;case"B":if(u&&I[X].len==8){l[A][X]=z.read_shift(8,"f");break}case"G":case"P":z.l+=I[X].len;break;case"0":if(I[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[X].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=I,l}function r(s,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var d=Or(e(s,l),l);return d["!cols"]=l.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete l.DBF,d}function i(s,c){try{return Qn(r(s,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,c){var l=c||{};if(+l.codepage>=0&&$r(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var d=Nt(),m=Ni(s,{header:1,raw:!0,cellDates:!0}),x=m[0],u=m.slice(1),v=s["!cols"]||[],h=0,w=0,T=0,F=1;for(h=0;h<x.length;++h){if(((v[h]||{}).DBF||{}).name){x[h]=v[h].DBF.name,++T;continue}if(x[h]!=null){if(++T,typeof x[h]=="number"&&(x[h]=x[h].toString(10)),typeof x[h]!="string")throw new Error("DBF Invalid column name "+x[h]+" |"+typeof x[h]+"|");if(x.indexOf(x[h])!==h){for(w=0;w<1024;++w)if(x.indexOf(x[h]+"_"+w)==-1){x[h]+="_"+w;break}}}}var I=Xe(s["!ref"]),j=[],W=[],pe=[];for(h=0;h<=I.e.c-I.s.c;++h){var A="",X="",z=0,H=[];for(w=0;w<u.length;++w)u[w][h]!=null&&H.push(u[w][h]);if(H.length==0||x[h]==null){j[h]="?";continue}for(w=0;w<H.length;++w){switch(typeof H[w]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=H[w]instanceof Date?"D":"C";break;default:X="C"}z=Math.max(z,String(H[w]).length),A=A&&A!=X?"C":X}z>250&&(z=250),X=((v[h]||{}).DBF||{}).type,X=="C"&&v[h].DBF.len>z&&(z=v[h].DBF.len),A=="B"&&X=="N"&&(A="N",pe[h]=v[h].DBF.dec,z=v[h].DBF.len),W[h]=A=="C"||X=="N"?z:a[A]||0,F+=W[h],j[h]=A}var K=d.next(32);for(K.write_shift(4,318902576),K.write_shift(4,u.length),K.write_shift(2,296+32*T),K.write_shift(2,F),h=0;h<4;++h)K.write_shift(4,0);for(K.write_shift(4,0|(+t[br]||3)<<8),h=0,w=0;h<x.length;++h)if(x[h]!=null){var Z=d.next(32),_e=(x[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,_e,"sbcs"),Z.write_shift(1,j[h]=="?"?"C":j[h],"sbcs"),Z.write_shift(4,w),Z.write_shift(1,W[h]||a[j[h]]||0),Z.write_shift(1,pe[h]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),w+=W[h]||a[j[h]]||0}var Be=d.next(264);for(Be.write_shift(4,13),h=0;h<65;++h)Be.write_shift(4,0);for(h=0;h<u.length;++h){var Ce=d.next(F);for(Ce.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(j[w]){case"L":Ce.write_shift(1,u[h][w]==null?63:u[h][w]?84:70);break;case"B":Ce.write_shift(8,u[h][w]||0,"f");break;case"N":var it="0";for(typeof u[h][w]=="number"&&(it=u[h][w].toFixed(pe[w]||0)),T=0;T<W[w]-it.length;++T)Ce.write_shift(1,32);Ce.write_shift(1,it,"sbcs");break;case"D":u[h][w]?(Ce.write_shift(4,("0000"+u[h][w].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(u[h][w].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+u[h][w].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var at=String(u[h][w]!=null?u[h][w]:"").slice(0,W[w]);for(Ce.write_shift(1,at,"sbcs"),T=0;T<W[w]-at.length;++T)Ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}})(),ef=(function(){var n={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Mt(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(x,u){var v=n[u];return typeof v=="number"?ns(v):v},r=function(x,u,v){var h=u.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return h==59?x:ns(h)};n["|"]=254;function i(x,u){switch(u.type){case"base64":return a(yn(x),u);case"binary":return a(x,u);case"buffer":return a(Ie&&Buffer.isBuffer(x)?x.toString("binary"):Zr(x),u);case"array":return a(Ui(x),u)}throw new Error("Unrecognized type "+u.type)}function a(x,u){var v=x.split(/[\n\r]+/),h=-1,w=-1,T=0,F=0,I=[],j=[],W=null,pe={},A=[],X=[],z=[],H=0,K;for(+u.codepage>=0&&$r(+u.codepage);T!==v.length;++T){H=0;var Z=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,e),_e=Z.replace(/;;/g,"\0").split(";").map(function(E){return E.replace(/\u0000/g,";")}),Be=_e[0],Ce;if(Z.length>0)switch(Be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&j.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var it=!1,at=!1,Ft=!1,Et=!1,mt=-1,It=-1;for(F=1;F<_e.length;++F)switch(_e[F].charAt(0)){case"A":break;case"X":w=parseInt(_e[F].slice(1))-1,at=!0;break;case"Y":for(h=parseInt(_e[F].slice(1))-1,at||(w=0),K=I.length;K<=h;++K)I[K]=[];break;case"K":Ce=_e[F].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Mn(Ce))?isNaN(Gr(Ce).getDate())||(Ce=At(Ce)):(Ce=Mn(Ce),W!==null&&Qs(W)&&(Ce=rc(Ce))),typeof Ue<"u"&&typeof Ce=="string"&&(u||{}).type!="string"&&(u||{}).codepage&&(Ce=Ue.utils.decode(u.codepage,Ce)),it=!0;break;case"E":Et=!0;var S=Qf(_e[F].slice(1),{r:h,c:w});I[h][w]=[I[h][w],S];break;case"S":Ft=!0,I[h][w]=[I[h][w],"S5S"];break;case"G":break;case"R":mt=parseInt(_e[F].slice(1))-1;break;case"C":It=parseInt(_e[F].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+Z)}if(it&&(I[h][w]&&I[h][w].length==2?I[h][w][0]=Ce:I[h][w]=Ce,W=null),Ft){if(Et)throw new Error("SYLK shared formula cannot have own formula");var G=mt>-1&&I[mt][It];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");I[h][w][1]=ep(G[1],{r:h-mt,c:w-It})}break;case"F":var D=0;for(F=1;F<_e.length;++F)switch(_e[F].charAt(0)){case"X":w=parseInt(_e[F].slice(1))-1,++D;break;case"Y":for(h=parseInt(_e[F].slice(1))-1,K=I.length;K<=h;++K)I[K]=[];break;case"M":H=parseInt(_e[F].slice(1))/20;break;case"F":break;case"G":break;case"P":W=j[parseInt(_e[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=_e[F].slice(1).split(" "),K=parseInt(z[0],10);K<=parseInt(z[1],10);++K)H=parseInt(z[2],10),X[K-1]=H===0?{hidden:!0}:{wch:H},Za(X[K-1]);break;case"C":w=parseInt(_e[F].slice(1))-1,X[w]||(X[w]={});break;case"R":h=parseInt(_e[F].slice(1))-1,A[h]||(A[h]={}),H>0?(A[h].hpt=H,A[h].hpx=zc(H)):H===0&&(A[h].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+Z)}D<1&&(W=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+Z)}}return A.length>0&&(pe["!rows"]=A),X.length>0&&(pe["!cols"]=X),u&&u.sheetRows&&(I=I.slice(0,u.sheetRows)),[I,pe]}function o(x,u){var v=i(x,u),h=v[0],w=v[1],T=Or(h,u);return Mt(w).forEach(function(F){T[F]=w[F]}),T}function s(x,u){return Qn(o(x,u),u)}function c(x,u,v,h){var w="C;Y"+(v+1)+";X"+(h+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+Qa(x.f,{r:v,c:h}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function l(x,u){u.forEach(function(v,h){var w="F;W"+(h+1)+" "+(h+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ii(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Bi(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function d(x,u){u.forEach(function(v,h){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*Ri(v.hpx)+";"),w.length>2&&x.push(w+"R"+(h+1))})}function m(x,u){var v=["ID;PWXL;N;E"],h=[],w=Xe(x["!ref"]),T,F=Array.isArray(x),I=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),x["!cols"]&&l(v,x["!cols"]),x["!rows"]&&d(v,x["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var j=w.s.r;j<=w.e.r;++j)for(var W=w.s.c;W<=w.e.c;++W){var pe=je({r:j,c:W});T=F?(x[j]||[])[W]:x[pe],!(!T||T.v==null&&(!T.f||T.F))&&h.push(c(T,x,j,W,u))}return v.join(I)+I+h.join(I)+I+"E"+I}return{to_workbook:s,to_sheet:o,from_sheet:m}})(),tf=(function(){function n(a,o){switch(o.type){case"base64":return t(yn(a),o);case"binary":return t(a,o);case"buffer":return t(Ie&&Buffer.isBuffer(a)?a.toString("binary"):Zr(a),o);case"array":return t(Ui(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var s=a.split(`
`),c=-1,l=-1,d=0,m=[];d!==s.length;++d){if(s[d].trim()==="BOT"){m[++c]=[],l=0;continue}if(!(c<0)){var x=s[d].trim().split(","),u=x[0],v=x[1];++d;for(var h=s[d]||"";(h.match(/["]/g)||[]).length&1&&d<s.length-1;)h+=`
`+s[++d];switch(h=h.trim(),+u){case-1:if(h==="BOT"){m[++c]=[],l=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?m[c][l]=!0:h==="FALSE"?m[c][l]=!1:isNaN(Mn(v))?isNaN(Gr(v).getDate())?m[c][l]=v:m[c][l]=At(v):m[c][l]=Mn(v),++l;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),Rr&&h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),m[c][l++]=h!==""?h:null;break}if(h==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function e(a,o){return Or(n(a,o),o)}function r(a,o){return Qn(e(a,o),o)}var i=(function(){var a=function(c,l,d,m,x){c.push(l),c.push(d+","+m),c.push('"'+x.replace(/"/g,'""')+'"')},o=function(c,l,d,m){c.push(l+","+d),c.push(l==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var l=[],d=Xe(c["!ref"]),m,x=Array.isArray(c);a(l,"TABLE",0,1,"sheetjs"),a(l,"VECTORS",0,d.e.r-d.s.r+1,""),a(l,"TUPLES",0,d.e.c-d.s.c+1,""),a(l,"DATA",0,0,"");for(var u=d.s.r;u<=d.e.r;++u){o(l,-1,0,"BOT");for(var v=d.s.c;v<=d.e.c;++v){var h=je({r:u,c:v});if(m=x?(c[u]||[])[v]:c[h],!m){o(l,1,0,"");continue}switch(m.t){case"n":var w=Rr?m.w:m.v;!w&&m.v!=null&&(w=m.v),w==null?Rr&&m.f&&!m.F?o(l,1,0,"="+m.f):o(l,1,0,""):o(l,0,w,"V");break;case"b":o(l,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(l,1,0,!Rr||isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Rn(m.z||qe[14],zt(At(m.v)))),Rr?o(l,0,m.w,"V"):o(l,1,0,m.w);break;default:o(l,1,0,"")}}}o(l,-1,0,"EOD");var T=`\r
`,F=l.join(T);return F}})();return{to_workbook:r,to_sheet:e,from_sheet:i}})(),Bc=(function(){function n(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(m,x){for(var u=m.split(`
`),v=-1,h=-1,w=0,T=[];w!==u.length;++w){var F=u[w].trim().split(":");if(F[0]==="cell"){var I=gt(F[1]);if(T.length<=I.r)for(v=T.length;v<=I.r;++v)T[v]||(T[v]=[]);switch(v=I.r,h=I.c,F[2]){case"t":T[v][h]=n(F[3]);break;case"v":T[v][h]=+F[3];break;case"vtf":var j=F[F.length-1];case"vtc":switch(F[3]){case"nl":T[v][h]=!!+F[4];break;default:T[v][h]=+F[4];break}F[2]=="vtf"&&(T[v][h]=[T[v][h],j])}}}return x&&x.sheetRows&&(T=T.slice(0,x.sheetRows)),T}function r(m,x){return Or(e(m,x),x)}function i(m,x){return Qn(r(m,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(m){if(!m||!m["!ref"])return"";for(var x=[],u=[],v,h="",w=Gt(m["!ref"]),T=Array.isArray(m),F=w.s.r;F<=w.e.r;++F)for(var I=w.s.c;I<=w.e.c;++I)if(h=je({r:F,c:I}),v=T?(m[F]||[])[I]:m[h],!(!v||v.v==null||v.t==="z")){switch(u=["cell",h,"t"],v.t){case"s":case"str":u.push(t(v.v));break;case"n":v.f?(u[2]="vtf",u[3]="n",u[4]=v.v,u[5]=t(v.f)):(u[2]="v",u[3]=v.v);break;case"b":u[2]="vt"+(v.f?"f":"c"),u[3]="nl",u[4]=v.v?"1":"0",u[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var j=zt(At(v.v));u[2]="vtc",u[3]="nd",u[4]=""+j,u[5]=v.w||Rn(v.z||qe[14],j);break;case"e":continue}x.push(u.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(m){return[a,o,s,o,l(m),c].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:d}})(),nf=(function(){function n(d,m,x,u,v){v.raw?m[x][u]=d:d===""||(d==="TRUE"?m[x][u]=!0:d==="FALSE"?m[x][u]=!1:isNaN(Mn(d))?isNaN(Gr(d).getDate())?m[x][u]=d:m[x][u]=At(d):m[x][u]=Mn(d))}function t(d,m){var x=m||{},u=[];if(!d||d.length===0)return u;for(var v=d.split(/[\r\n]/),h=v.length-1;h>=0&&v[h].length===0;)--h;for(var w=10,T=0,F=0;F<=h;++F)T=v[F].indexOf(" "),T==-1?T=v[F].length:T++,w=Math.max(w,T);for(F=0;F<=h;++F){u[F]=[];var I=0;for(n(v[F].slice(0,w).trim(),u,F,I,x),I=1;I<=(v[F].length-w)/10+1;++I)n(v[F].slice(w+(I-1)*10,w+I*10).trim(),u,F,I,x)}return x.sheetRows&&(u=u.slice(0,x.sheetRows)),u}var e={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(d){for(var m={},x=!1,u=0,v=0;u<d.length;++u)(v=d.charCodeAt(u))==34?x=!x:!x&&v in e&&(m[v]=(m[v]||0)+1);v=[];for(u in m)Object.prototype.hasOwnProperty.call(m,u)&&v.push([m[u],u]);if(!v.length){m=r;for(u in m)Object.prototype.hasOwnProperty.call(m,u)&&v.push([m[u],u])}return v.sort(function(h,w){return h[0]-w[0]||r[h[1]]-r[w[1]]}),e[v.pop()[1]]||44}function a(d,m){var x=m||{},u="";xn!=null&&x.dense==null&&(x.dense=xn);var v=x.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(u=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(u=d.charAt(4),d=d.slice(6)):u=i(d.slice(0,1024)):x&&x.FS?u=x.FS:u=i(d.slice(0,1024));var w=0,T=0,F=0,I=0,j=0,W=u.charCodeAt(0),pe=!1,A=0,X=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var z=x.dateNF!=null?xl(x.dateNF):null;function H(){var K=d.slice(I,j),Z={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)Z.t="z";else if(x.raw)Z.t="s",Z.v=K;else if(K.trim().length===0)Z.t="s",Z.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(Z.t="s",Z.v=K.slice(2,-1).replace(/""/g,'"')):tp(K)?(Z.t="n",Z.f=K.slice(1)):(Z.t="s",Z.v=K);else if(K=="TRUE")Z.t="b",Z.v=!0;else if(K=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(F=Mn(K)))Z.t="n",x.cellText!==!1&&(Z.w=K),Z.v=F;else if(!isNaN(Gr(K).getDate())||z&&K.match(z)){Z.z=x.dateNF||qe[14];var _e=0;z&&K.match(z)&&(K=_l(K,x.dateNF,K.match(z)||[]),_e=1),x.cellDates?(Z.t="d",Z.v=At(K,_e)):(Z.t="n",Z.v=zt(At(K,_e))),x.cellText!==!1&&(Z.w=Rn(Z.z,Z.v instanceof Date?zt(Z.v):Z.v)),x.cellNF||delete Z.z}else Z.t="s",Z.v=K;if(Z.t=="z"||(x.dense?(v[w]||(v[w]=[]),v[w][T]=Z):v[je({c:T,r:w})]=Z),I=j+1,X=d.charCodeAt(I),h.e.c<T&&(h.e.c=T),h.e.r<w&&(h.e.r=w),A==W)++T;else if(T=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;j<d.length;++j)switch(A=d.charCodeAt(j)){case 34:X===34&&(pe=!pe);break;case W:case 10:case 13:if(!pe&&H())break e;break;default:break}return j-I>0&&H(),v["!ref"]=et(h),v}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,m):Or(t(d,m),m)}function s(d,m){var x="",u=m.type=="string"?[0,0,0,0]:h1(d,m);switch(m.type){case"base64":x=yn(d);break;case"binary":x=d;break;case"buffer":m.codepage==65001?x=d.toString("utf8"):m.codepage&&typeof Ue<"u"?x=Ue.utils.decode(m.codepage,d):x=Ie&&Buffer.isBuffer(d)?d.toString("binary"):Zr(d);break;case"array":x=Ui(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+m.type)}return u[0]==239&&u[1]==187&&u[2]==191?x=zr(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=zr(x):m.type=="binary"&&typeof Ue<"u"&&m.codepage&&(x=Ue.utils.decode(m.codepage,Ue.utils.encode(28591,x))),x.slice(0,19)=="socialcalc:version:"?Bc.to_sheet(m.type=="string"?x:zr(x),m):o(x,m)}function c(d,m){return Qn(s(d,m),m)}function l(d){for(var m=[],x=Xe(d["!ref"]),u,v=Array.isArray(d),h=x.s.r;h<=x.e.r;++h){for(var w=[],T=x.s.c;T<=x.e.c;++T){var F=je({r:h,c:T});if(u=v?(d[h]||[])[T]:d[F],!u||u.v==null){w.push("          ");continue}for(var I=(u.w||(kn(u),u.w)||"").slice(0,10);I.length<10;)I+=" ";w.push(I+(T===0?" ":""))}m.push(w.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:s,from_sheet:l}})();var Fs=(function(){function n(S,G,D){if(S){$t(S,S.l||0);for(var E=D.Enum||mt;S.l<S.length;){var q=S.read_shift(2),xe=E[q]||E[65535],be=S.read_shift(2),ue=S.l+be,de=xe.f&&xe.f(S,be,D);if(S.l=ue,G(de,xe,q))return}}}function t(S,G){switch(G.type){case"base64":return e(cn(yn(S)),G);case"binary":return e(cn(S),G);case"buffer":case"array":return e(S,G)}throw"Unsupported type "+G.type}function e(S,G){if(!S)return S;var D=G||{};xn!=null&&D.dense==null&&(D.dense=xn);var E=D.dense?[]:{},q="Sheet1",xe="",be=0,ue={},de=[],We=[],Ee={s:{r:0,c:0},e:{r:0,c:0}},xt=D.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)D.Enum=mt,n(S,function(me,Yt,Cn){switch(Cn){case 0:D.vers=me,me>=4096&&(D.qpro=!0);break;case 6:Ee=me;break;case 204:me&&(xe=me);break;case 222:xe=me;break;case 15:case 51:D.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:Cn==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=D.dateNF||qe[14],D.cellDates&&(me[1].t="d",me[1].v=rc(me[1].v))),D.qpro&&me[3]>be&&(E["!ref"]=et(Ee),ue[q]=E,de.push(q),E=D.dense?[]:{},Ee={s:{r:0,c:0},e:{r:0,c:0}},be=me[3],q=xe||"Sheet"+(be+1),xe="");var jn=D.dense?(E[me[0].r]||[])[me[0].c]:E[je(me[0])];if(jn){jn.t=me[1].t,jn.v=me[1].v,me[1].z!=null&&(jn.z=me[1].z),me[1].f!=null&&(jn.f=me[1].f);break}D.dense?(E[me[0].r]||(E[me[0].r]=[]),E[me[0].r][me[0].c]=me[1]):E[je(me[0])]=me[1];break;default:}},D);else if(S[2]==26||S[2]==14)D.Enum=It,S[2]==14&&(D.qpro=!0,S.l=0),n(S,function(me,Yt,Cn){switch(Cn){case 204:q=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>be&&(E["!ref"]=et(Ee),ue[q]=E,de.push(q),E=D.dense?[]:{},Ee={s:{r:0,c:0},e:{r:0,c:0}},be=me[3],q="Sheet"+(be+1)),xt>0&&me[0].r>=xt)break;D.dense?(E[me[0].r]||(E[me[0].r]=[]),E[me[0].r][me[0].c]=me[1]):E[je(me[0])]=me[1],Ee.e.c<me[0].c&&(Ee.e.c=me[0].c),Ee.e.r<me[0].r&&(Ee.e.r=me[0].r);break;case 27:me[14e3]&&(We[me[14e3][0]]=me[14e3][1]);break;case 1537:We[me[0]]=me[1],me[0]==be&&(q=me[1]);break;default:break}},D);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(E["!ref"]=et(Ee),ue[xe||q]=E,de.push(xe||q),!We.length)return{SheetNames:de,Sheets:ue};for(var Ae={},en=[],Ge=0;Ge<We.length;++Ge)ue[de[Ge]]?(en.push(We[Ge]||de[Ge]),Ae[We[Ge]]=ue[We[Ge]]||ue[de[Ge]]):(en.push(We[Ge]),Ae[We[Ge]]={"!ref":"A1"});return{SheetNames:en,Sheets:Ae}}function r(S,G){var D=G||{};if(+D.codepage>=0&&$r(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var E=Nt(),q=Xe(S["!ref"]),xe=Array.isArray(S),be=[];se(E,0,a(1030)),se(E,6,c(q));for(var ue=Math.min(q.e.r,8191),de=q.s.r;de<=ue;++de)for(var We=Pt(de),Ee=q.s.c;Ee<=q.e.c;++Ee){de===q.s.r&&(be[Ee]=kt(Ee));var xt=be[Ee]+We,Ae=xe?(S[de]||[])[Ee]:S[xt];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?se(E,13,u(de,Ee,Ae.v)):se(E,14,h(de,Ee,Ae.v));else{var en=kn(Ae);se(E,15,m(de,Ee,en.slice(0,239)))}}return se(E,1),E.end()}function i(S,G){var D=G||{};if(+D.codepage>=0&&$r(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var E=Nt();se(E,0,o(S));for(var q=0,xe=0;q<S.SheetNames.length;++q)(S.Sheets[S.SheetNames[q]]||{})["!ref"]&&se(E,27,Et(S.SheetNames[q],xe++));var be=0;for(q=0;q<S.SheetNames.length;++q){var ue=S.Sheets[S.SheetNames[q]];if(!(!ue||!ue["!ref"])){for(var de=Xe(ue["!ref"]),We=Array.isArray(ue),Ee=[],xt=Math.min(de.e.r,8191),Ae=de.s.r;Ae<=xt;++Ae)for(var en=Pt(Ae),Ge=de.s.c;Ge<=de.e.c;++Ge){Ae===de.s.r&&(Ee[Ge]=kt(Ge));var me=Ee[Ge]+en,Yt=We?(ue[Ae]||[])[Ge]:ue[me];if(!(!Yt||Yt.t=="z"))if(Yt.t=="n")se(E,23,H(Ae,Ge,be,Yt.v));else{var Cn=kn(Yt);se(E,22,A(Ae,Ge,be,Cn.slice(0,239)))}}++be}}return se(E,1),E.end()}function a(S){var G=V(2);return G.write_shift(2,S),G}function o(S){var G=V(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var D=0,E=0,q=0,xe=0;xe<S.SheetNames.length;++xe){var be=S.SheetNames[xe],ue=S.Sheets[be];if(!(!ue||!ue["!ref"])){++q;var de=Gt(ue["!ref"]);D<de.e.r&&(D=de.e.r),E<de.e.c&&(E=de.e.c)}}return D>8191&&(D=8191),G.write_shift(2,D),G.write_shift(1,q),G.write_shift(1,E),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function s(S,G,D){var E={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&D.qpro?(E.s.c=S.read_shift(1),S.l++,E.s.r=S.read_shift(2),E.e.c=S.read_shift(1),S.l++,E.e.r=S.read_shift(2),E):(E.s.c=S.read_shift(2),E.s.r=S.read_shift(2),G==12&&D.qpro&&(S.l+=2),E.e.c=S.read_shift(2),E.e.r=S.read_shift(2),G==12&&D.qpro&&(S.l+=2),E.s.c==65535&&(E.s.c=E.e.c=E.s.r=E.e.r=0),E)}function c(S){var G=V(8);return G.write_shift(2,S.s.c),G.write_shift(2,S.s.r),G.write_shift(2,S.e.c),G.write_shift(2,S.e.r),G}function l(S,G,D){var E=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(E[0].c=S.read_shift(1),E[3]=S.read_shift(1),E[0].r=S.read_shift(2),S.l+=2):(E[2]=S.read_shift(1),E[0].c=S.read_shift(2),E[0].r=S.read_shift(2)),E}function d(S,G,D){var E=S.l+G,q=l(S,G,D);if(q[1].t="s",D.vers==20768){S.l++;var xe=S.read_shift(1);return q[1].v=S.read_shift(xe,"utf8"),q}return D.qpro&&S.l++,q[1].v=S.read_shift(E-S.l,"cstr"),q}function m(S,G,D){var E=V(7+D.length);E.write_shift(1,255),E.write_shift(2,G),E.write_shift(2,S),E.write_shift(1,39);for(var q=0;q<E.length;++q){var xe=D.charCodeAt(q);E.write_shift(1,xe>=128?95:xe)}return E.write_shift(1,0),E}function x(S,G,D){var E=l(S,G,D);return E[1].v=S.read_shift(2,"i"),E}function u(S,G,D){var E=V(7);return E.write_shift(1,255),E.write_shift(2,G),E.write_shift(2,S),E.write_shift(2,D,"i"),E}function v(S,G,D){var E=l(S,G,D);return E[1].v=S.read_shift(8,"f"),E}function h(S,G,D){var E=V(13);return E.write_shift(1,255),E.write_shift(2,G),E.write_shift(2,S),E.write_shift(8,D,"f"),E}function w(S,G,D){var E=S.l+G,q=l(S,G,D);if(q[1].v=S.read_shift(8,"f"),D.qpro)S.l=E;else{var xe=S.read_shift(2);j(S.slice(S.l,S.l+xe),q),S.l+=xe}return q}function T(S,G,D){var E=G&32768;return G&=-32769,G=(E?S:0)+(G>=8192?G-16384:G),(E?"":"$")+(D?kt(G):Pt(G))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(S,G){$t(S,0);for(var D=[],E=0,q="",xe="",be="",ue="";S.l<S.length;){var de=S[S.l++];switch(de){case 0:D.push(S.read_shift(8,"f"));break;case 1:xe=T(G[0].c,S.read_shift(2),!0),q=T(G[0].r,S.read_shift(2),!1),D.push(xe+q);break;case 2:{var We=T(G[0].c,S.read_shift(2),!0),Ee=T(G[0].r,S.read_shift(2),!1);xe=T(G[0].c,S.read_shift(2),!0),q=T(G[0].r,S.read_shift(2),!1),D.push(We+Ee+":"+xe+q)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(S.read_shift(2));break;case 6:{for(var xt="";de=S[S.l++];)xt+=String.fromCharCode(de);D.push('"'+xt.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:ue=D.pop(),be=D.pop(),D.push(["AND","OR"][de-20]+"("+be+","+ue+")");break;default:if(de<32&&I[de])ue=D.pop(),be=D.pop(),D.push(be+I[de]+ue);else if(F[de]){if(E=F[de][1],E==69&&(E=S[S.l++]),E>D.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+D.join("|")+"|");return}var Ae=D.slice(-E);D.length-=E,D.push(F[de][0]+"("+Ae.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}D.length==1?G[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function W(S){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=S.read_shift(2),G[3]=S[S.l++],G[0].c=S[S.l++],G}function pe(S,G){var D=W(S,G);return D[1].t="s",D[1].v=S.read_shift(G-4,"cstr"),D}function A(S,G,D,E){var q=V(6+E.length);q.write_shift(2,S),q.write_shift(1,D),q.write_shift(1,G),q.write_shift(1,39);for(var xe=0;xe<E.length;++xe){var be=E.charCodeAt(xe);q.write_shift(1,be>=128?95:be)}return q.write_shift(1,0),q}function X(S,G){var D=W(S,G);D[1].v=S.read_shift(2);var E=D[1].v>>1;if(D[1].v&1)switch(E&7){case 0:E=(E>>3)*5e3;break;case 1:E=(E>>3)*500;break;case 2:E=(E>>3)/20;break;case 3:E=(E>>3)/200;break;case 4:E=(E>>3)/2e3;break;case 5:E=(E>>3)/2e4;break;case 6:E=(E>>3)/16;break;case 7:E=(E>>3)/64;break}return D[1].v=E,D}function z(S,G){var D=W(S,G),E=S.read_shift(4),q=S.read_shift(4),xe=S.read_shift(2);if(xe==65535)return E===0&&q===3221225472?(D[1].t="e",D[1].v=15):E===0&&q===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var be=xe&32768;return xe=(xe&32767)-16446,D[1].v=(1-be*2)*(q*Math.pow(2,xe+32)+E*Math.pow(2,xe)),D}function H(S,G,D,E){var q=V(14);if(q.write_shift(2,S),q.write_shift(1,D),q.write_shift(1,G),E==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var xe=0,be=0,ue=0,de=0;return E<0&&(xe=1,E=-E),be=Math.log2(E)|0,E/=Math.pow(2,be-31),de=E>>>0,(de&2147483648)==0&&(E/=2,++be,de=E>>>0),E-=de,de|=2147483648,de>>>=0,E*=Math.pow(2,32),ue=E>>>0,q.write_shift(4,ue),q.write_shift(4,de),be+=16383+(xe?32768:0),q.write_shift(2,be),q}function K(S,G){var D=z(S,14);return S.l+=G-14,D}function Z(S,G){var D=W(S,G),E=S.read_shift(4);return D[1].v=E>>6,D}function _e(S,G){var D=W(S,G),E=S.read_shift(8,"f");return D[1].v=E,D}function Be(S,G){var D=_e(S,14);return S.l+=G-10,D}function Ce(S,G){return S[S.l+G-1]==0?S.read_shift(G,"cstr"):""}function it(S,G){var D=S[S.l++];D>G-1&&(D=G-1);for(var E="";E.length<D;)E+=String.fromCharCode(S[S.l++]);return E}function at(S,G,D){if(!(!D.qpro||G<21)){var E=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var q=S.read_shift(G-21,"cstr");return[E,q]}}function Ft(S,G){for(var D={},E=S.l+G;S.l<E;){var q=S.read_shift(2);if(q==14e3){for(D[q]=[0,""],D[q][0]=S.read_shift(2);S[S.l];)D[q][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return D}function Et(S,G){var D=V(5+S.length);D.write_shift(2,14e3),D.write_shift(2,G);for(var E=0;E<S.length;++E){var q=S.charCodeAt(E);D[D.l++]=q>127?95:q}return D[D.l++]=0,D}var mt={0:{n:"BOF",f:Tc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:it},65535:{n:""}},It={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:pe},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ft},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:Be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:at},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}})();var rf=/^\s|\s$|[\t\n\r]/;function Rc(n,t){if(!t.bookSST)return"";var e=[tt];e[e.length]=ie("sst",null,{xmlns:Pr[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(rf)&&(a+=' xml:space="preserve"'),a+=">"+ze(i.t)+"</t>"),a+="</si>",e[e.length]=a}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function af(n){return[n.read_shift(4),n.read_shift(4)]}function of(n,t){return t||(t=V(8)),t.write_shift(4,n.Count),t.write_shift(4,n.Unique),t}var sf=ql;function cf(n){var t=Nt();Y(t,159,of(n));for(var e=0;e<n.length;++e)Y(t,19,sf(n[e]));return Y(t,160),t.end()}function lf(n){if(typeof Ue<"u")return Ue.utils.encode(br,n);for(var t=[],e=n.split(""),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0);return t}function Lc(n){var t=0,e,r=lf(n),i=r.length+1,a,o,s,c,l;for(e=qn(i),e[0]=r.length,a=1;a!=i;++a)e[a]=r[a-1];for(a=i-1;a>=0;--a)o=e[a],s=(t&16384)===0?0:1,c=t<<1&32767,l=s|c,t=l^o;return t^52811}var df=(function(){function n(i,a){switch(a.type){case"base64":return t(yn(i),a);case"binary":return t(i,a);case"buffer":return t(Ie&&Buffer.isBuffer(i)?i.toString("binary"):Zr(i),a);case"array":return t(Ui(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},s=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,m){Array.isArray(s)&&(s[m]=[]);for(var x=/\\\w+\b/g,u=0,v,h=-1;v=x.exec(d);){switch(v[0]){case"\\cell":var w=d.slice(u,x.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++h,w.length){var T={v:w,t:"s"};Array.isArray(s)?s[m][h]=T:s[je({r:m,c:h})]=T}break}u=x.lastIndex}h>l.e.c&&(l.e.c=h)}),s["!ref"]=et(l),s}function e(i,a){return Qn(n(i,a),a)}function r(i){for(var a=["{\\rtf1\\ansi"],o=Xe(i["!ref"]),s,c=Array.isArray(i),l=o.s.r;l<=o.e.r;++l){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=je({r:l,c:d});s=c?(i[l]||[])[d]:i[m],!(!s||s.v==null&&(!s.f||s.F))&&(a.push(" "+(s.w||(kn(s),s.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:n,from_sheet:r}})();function Is(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}var ff=6;var On=ff;function Ii(n){return Math.floor((n+Math.round(128/On)/256)*On)}function Bi(n){return Math.floor((n-5)/On*100+.5)/100}function Aa(n){return Math.round((n*On+5)/On*256)/256}function Za(n){n.width?(n.wpx=Ii(n.width),n.wch=Bi(n.wpx),n.MDW=On):n.wpx?(n.wch=Bi(n.wpx),n.width=Aa(n.wch),n.MDW=On):typeof n.wch=="number"&&(n.width=Aa(n.wch),n.wpx=Ii(n.width),n.MDW=On),n.customWidth&&delete n.customWidth}var pf=96,Nc=pf;function Ri(n){return n*96/Nc}function zc(n){return n*Nc/96}function gf(n){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)n[r]!=null&&(t[t.length]=ie("numFmt",null,{numFmtId:r,formatCode:ze(n[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ie("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function uf(n){var t=[];return t[t.length]=ie("cellXfs",null),n.forEach(function(e){t[t.length]=ie("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ie("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function jc(n,t){var e=[tt,ie("styleSheet",null,{xmlns:Pr[0],"xmlns:vt":pt.vt})],r;return n.SSF&&(r=gf(n.SSF))!=null&&(e[e.length]=r),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=uf(t.cellXfs))&&(e[e.length]=r),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function hf(n,t){var e=n.read_shift(2),r=St(n,t-2);return[e,r]}function mf(n,t,e){e||(e=V(6+4*t.length)),e.write_shift(2,n),ut(t,e);var r=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),r}function xf(n,t,e){var r={};r.sz=n.read_shift(2)/20;var i=rd(n,2,e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var a=n.read_shift(2);switch(a===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=n.read_shift(1);o!=0&&(r.underline=o);var s=n.read_shift(1);s>0&&(r.family=s);var c=n.read_shift(1);switch(c>0&&(r.charset=c),n.l++,r.color=nd(n,8),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=St(n,t-21),r}function _f(n,t){t||(t=V(153)),t.write_shift(2,n.sz*20),id(n,t),t.write_shift(2,n.bold?700:400);var e=0;n.vertAlign=="superscript"?e=1:n.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,n.underline||0),t.write_shift(1,n.family||0),t.write_shift(1,n.charset||0),t.write_shift(1,0),Ai(n.color,t);var r=0;return n.scheme=="major"&&(r=1),n.scheme=="minor"&&(r=2),t.write_shift(1,r),ut(n.name,t),t.length>t.l?t.slice(0,t.l):t}var Cf=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Oa,vf=_n;function Bs(n,t){t||(t=V(84)),Oa||(Oa=Ba(Cf));var e=Oa[n.patternType];e==null&&(e=40),t.write_shift(4,e);var r=0;if(e!=40)for(Ai({auto:1},t),Ai({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function bf(n,t){var e=n.l+t,r=n.read_shift(2),i=n.read_shift(2);return n.l=e,{ixfe:r,numFmtId:i}}function Wc(n,t,e){e||(e=V(16)),e.write_shift(2,t||0),e.write_shift(2,n.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var r=0;return e.write_shift(1,r),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Lr(n,t){return t||(t=V(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var wf=_n;function Pf(n,t){return t||(t=V(51)),t.write_shift(1,0),Lr(null,t),Lr(null,t),Lr(null,t),Lr(null,t),Lr(null,t),t.length>t.l?t.slice(0,t.l):t}function Mf(n,t){return t||(t=V(52)),t.write_shift(4,n.xfId),t.write_shift(2,1),t.write_shift(1,+n.builtinId),t.write_shift(1,0),Di(n.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Of(n,t,e){var r=V(2052);return r.write_shift(4,n),Di(t,r),Di(e,r),r.length>r.l?r.slice(0,r.l):r}function yf(n,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++e}),e!=0&&(Y(n,615,dn(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Y(n,44,mf(i,t[i]))}),Y(n,616))}}function kf(n){var t=1;t!=0&&(Y(n,611,dn(t)),Y(n,43,_f({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Y(n,612))}function Sf(n){var t=2;t!=0&&(Y(n,603,dn(t)),Y(n,45,Bs({patternType:"none"})),Y(n,45,Bs({patternType:"gray125"})),Y(n,604))}function Ef(n){var t=1;t!=0&&(Y(n,613,dn(t)),Y(n,46,Pf({})),Y(n,614))}function Tf(n){var t=1;Y(n,626,dn(t)),Y(n,47,Wc({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Y(n,627)}function Df(n,t){Y(n,617,dn(t.length)),t.forEach(function(e){Y(n,47,Wc(e,0))}),Y(n,618)}function Af(n){var t=1;Y(n,619,dn(t)),Y(n,48,Mf({xfId:0,builtinId:0,name:"Normal"})),Y(n,620)}function Ff(n){var t=0;Y(n,505,dn(t)),Y(n,506)}function If(n){var t=0;Y(n,508,Of(t,"TableStyleMedium9","PivotStyleMedium4")),Y(n,509)}function Bf(n,t){var e=Nt();return Y(e,278),yf(e,n.SSF),kf(e,n),Sf(e,n),Ef(e,n),Tf(e,n),Df(e,t.cellXfs),Af(e,n),Ff(e,n),If(e,n),Y(e,279),e.end()}function Vc(n,t){if(t&&t.themeXLSX)return t.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var e=[tt];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Rf(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:St(n,t-8)}}function Lf(n){var t=V(12+2*n.name.length);return t.write_shift(4,n.flags),t.write_shift(4,n.version),ut(n.name,t),t.slice(0,t.l)}function Nf(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function zf(n){var t=V(4+8*n.length);t.write_shift(4,n.length);for(var e=0;e<n.length;++e)t.write_shift(4,n[e][0]),t.write_shift(4,n[e][1]);return t}function jf(n,t){var e=V(8+2*t.length);return e.write_shift(4,n),ut(t,e),e.slice(0,e.l)}function Wf(n){return n.l+=4,n.read_shift(4)!=0}function Vf(n,t){var e=V(8);return e.write_shift(4,n),e.write_shift(4,t?1:0),e}function Uf(){var n=Nt();return Y(n,332),Y(n,334,dn(1)),Y(n,335,Lf({name:"XLDAPR",version:12e4,flags:3496657072})),Y(n,336),Y(n,339,jf(1,"XLDAPR")),Y(n,52),Y(n,35,dn(514)),Y(n,4096,dn(0)),Y(n,4097,Jt(1)),Y(n,36),Y(n,53),Y(n,340),Y(n,337,Vf(1,!0)),Y(n,51,zf([[1,0]])),Y(n,338),Y(n,333),n.end()}function Uc(){var n=[tt];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function Hf(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=je(e);var r=n.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}var hr=1024;function Hc(n,t){for(var e=[21600,21600],r=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),i=[ie("xml",null,{"xmlns:v":Xt.v,"xmlns:o":Xt.o,"xmlns:x":Xt.x,"xmlns:mv":Xt.mv}).replace(/\/>/,">"),ie("o:shapelayout",ie("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),ie("v:shapetype",[ie("v:stroke",null,{joinstyle:"miter"}),ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:r})];hr<n*1e3;)hr+=1e3;return t.forEach(function(a){var o=gt(a[0]),s={color2:"#BEFF82",type:"gradient"};s.type=="gradient"&&(s.angle="-180");var c=s.type=="gradient"?ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ie("v:fill",c,s),d={on:"t",obscured:"t"};++hr,i=i.concat(["<v:shape"+Yr({id:"_x0000_s"+hr,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ie("v:shadow",null,d),ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),wt("x:AutoFill","False"),wt("x:Row",String(o.r)),wt("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function $c(n){var t=[tt,ie("comments",null,{xmlns:Pr[0]})],e=[];return t.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var a=ze(i.a);e.indexOf(a)==-1&&(e.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),n.forEach(function(r){var i=0,a=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=e.indexOf("tc="+r[1][0].ID):r[1].forEach(function(c){c.a&&(i=e.indexOf(ze(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(wt("t",ze(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,s=1;s<a.length;++s)o+=`Reply:
    `+a[s]+`
`;t.push(wt("t",ze(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function $f(n,t,e){var r=[tt,ie("ThreadedComments",null,{xmlns:pt.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,s){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};s==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(ie("threadedComment",wt("text",o.t||""),c))})}),r.push("</ThreadedComments>"),r.join("")}function Xf(n){var t=[tt,ie("personList",null,{xmlns:pt.TCMNT,"xmlns:x":Pr[0]}).replace(/[\/]>/,">")];return n.forEach(function(e,r){t.push(ie("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Gf(n){var t={};t.iauthor=n.read_shift(4);var e=rr(n,16);return t.rfx=e.s,t.ref=je(e.s),n.l+=16,t}function Yf(n,t){return t==null&&(t=V(36)),t.write_shift(4,n[1].iauthor),yr(n[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Kf=St;function qf(n){return ut(n.slice(0,54))}function Zf(n){var t=Nt(),e=[];return Y(t,628),Y(t,630),n.forEach(function(r){r[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),Y(t,632,qf(i.a)))})}),Y(t,631),Y(t,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=e.indexOf(i.a);var a={s:gt(r[0]),e:gt(r[0])};Y(t,635,Yf([a,i])),i.t&&i.t.length>0&&Y(t,637,Jl(i)),Y(t,636),delete i.iauthor})}),Y(t,634),Y(t,629),t.end()}function Jf(n,t){t.FullPaths.forEach(function(e,r){if(r!=0){var i=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ve.utils.cfb_add(n,i,t.FileIndex[r].content)}})}var Xc=["xlsb","xlsm","xlam","biff8","xla"];var Qf=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(r,i,a,o){var s=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var l=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return s?d+=t.c:--d,c?l+=t.r:--l,i+(s?"":"$")+kt(d)+(c?"":"$")+Pt(l)}return function(i,a){return t=a,i.replace(n,e)}})(),Ja=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Qa=(function(){return function(t,e){return t.replace(Ja,function(r,i,a,o,s,c){var l=Xa(o)-(a?0:e.c),d=$a(c)-(s?0:e.r),m=d==0?"":s?d+1:"["+d+"]",x=l==0?"":a?l+1:"["+l+"]";return i+"R"+m+"C"+x})}})();function ep(n,t){return n.replace(Ja,function(e,r,i,a,o,s){return r+(i=="$"?i+a:kt(Xa(a)+t.c))+(o=="$"?o+s:Pt($a(s)+t.r))})}function tp(n){return n.length!=1}function Qe(n){n.l+=1}function Ln(n,t){var e=n.read_shift(t==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function Gc(n,t,e){var r=2;if(e){if(e.biff>=2&&e.biff<=5)return Yc(n,t,e);e.biff==12&&(r=4)}var i=n.read_shift(r),a=n.read_shift(r),o=Ln(n,2),s=Ln(n,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Yc(n){var t=Ln(n,2),e=Ln(n,2),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function np(n,t,e){if(e.biff<8)return Yc(n,t,e);var r=n.read_shift(e.biff==12?4:2),i=n.read_shift(e.biff==12?4:2),a=Ln(n,2),o=Ln(n,2);return{s:{r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Kc(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return rp(n,t,e);var r=n.read_shift(e&&e.biff==12?4:2),i=Ln(n,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function rp(n){var t=Ln(n,2),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function ip(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function ap(n,t,e){var r=e&&e.biff?e.biff:8;if(r>=2&&r<=5)return op(n,t,e);var i=n.read_shift(r>=12?4:2),a=n.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function op(n){var t=n.read_shift(2),e=n.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:i,rRel:r}}function sp(n,t,e){var r=(n[n.l++]&96)>>5,i=Gc(n,e.biff>=2&&e.biff<=5?6:8,e);return[r,i]}function cp(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}var o=Gc(n,a,e);return[r,i,o]}function lp(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[r]}function dp(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),a=8;if(e)switch(e.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}return n.l+=a,[r,i]}function fp(n,t,e){var r=(n[n.l++]&96)>>5,i=np(n,t-1,e);return[r,i]}function pp(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[r]}function Rs(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function gp(n,t,e){n.l+=2;for(var r=n.read_shift(e&&e.biff==2?1:2),i=[],a=0;a<=r;++a)i.push(n.read_shift(e&&e.biff==2?1:2));return i}function up(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function hp(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function mp(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function xp(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[r]}function qc(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function _p(n){return n.read_shift(2),qc(n,2)}function Cp(n){return n.read_shift(2),qc(n,2)}function vp(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=Kc(n,0,e);return[r,i]}function bp(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=ap(n,0,e);return[r,i]}function wp(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var a=Kc(n,0,e);return[r,i,a]}function Pp(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(e&&e.biff<=3?1:2);return[Pg[i],Qc[i],r]}function Mp(n,t,e){var r=n[n.l++],i=n.read_shift(1),a=e&&e.biff<=3?[r==88?-1:0,n.read_shift(1)]:Op(n);return[i,(a[0]===0?Qc:wg)[a[1]]]}function Op(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function yp(n,t,e){n.l+=e&&e.biff==2?3:4}function kp(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function Sp(n){return n.l++,Qr[n.read_shift(1)]}function Ep(n){return n.l++,n.read_shift(2)}function Tp(n){return n.l++,n.read_shift(1)!==0}function Dp(n){return n.l++,kr(n,8)}function Ap(n,t,e){return n.l++,Ac(n,t-1,e)}function Fp(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=bd(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=Qr[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=kr(n,8);break;case 2:e[1]=Od(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Ip(n,t,e){for(var r=n.read_shift(e.biff==12?4:2),i=[],a=0;a!=r;++a)i.push((e.biff==12?rr:Sd)(n,8));return i}function Bp(n,t,e){var r=0,i=0;e.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--r,--i==0&&(i=256));for(var a=0,o=[];a!=r&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=Fp(n,e.biff);return o}function Rp(n,t,e){var r=n.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,a=n.read_shift(i);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,a]}function Lp(n,t,e){if(e.biff==5)return Np(n,t,e);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),a=n.read_shift(4);return[r,i,a]}function Np(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[t,e,r]}function zp(n,t,e){var r=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function jp(n,t,e){var r=n.read_shift(1)>>>5&3,i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function Wp(n,t,e){var r=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[r]}function Vp(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return n.l+=a,[r,i]}var Up=_n,Hp=_n,$p=_n;function ei(n,t,e){return n.l+=2,[ip(n,4,e)]}function eo(n){return n.l+=6,[]}var Xp=ei,Gp=eo,Yp=eo,Kp=ei;function Zc(n){return n.l+=2,[Tc(n),n.read_shift(2)&1]}var qp=ei,Zp=Zc,Jp=eo,Qp=ei,eg=ei,tg=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ng(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),a=n.read_shift(2),o=tg[e>>2&31];return{ixti:t,coltype:e&3,rt:o,idx:r,c:i,C:a}}function rg(n){return n.l+=2,[n.read_shift(4)]}function ig(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function ag(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function og(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function sg(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function cg(n){return n.l+=4,[0,0]}var Ls={1:{n:"PtgExp",f:kp},2:{n:"PtgTbl",f:$p},3:{n:"PtgAdd",f:Qe},4:{n:"PtgSub",f:Qe},5:{n:"PtgMul",f:Qe},6:{n:"PtgDiv",f:Qe},7:{n:"PtgPower",f:Qe},8:{n:"PtgConcat",f:Qe},9:{n:"PtgLt",f:Qe},10:{n:"PtgLe",f:Qe},11:{n:"PtgEq",f:Qe},12:{n:"PtgGe",f:Qe},13:{n:"PtgGt",f:Qe},14:{n:"PtgNe",f:Qe},15:{n:"PtgIsect",f:Qe},16:{n:"PtgUnion",f:Qe},17:{n:"PtgRange",f:Qe},18:{n:"PtgUplus",f:Qe},19:{n:"PtgUminus",f:Qe},20:{n:"PtgPercent",f:Qe},21:{n:"PtgParen",f:Qe},22:{n:"PtgMissArg",f:Qe},23:{n:"PtgStr",f:Ap},26:{n:"PtgSheet",f:ig},27:{n:"PtgEndSheet",f:ag},28:{n:"PtgErr",f:Sp},29:{n:"PtgBool",f:Tp},30:{n:"PtgInt",f:Ep},31:{n:"PtgNum",f:Dp},32:{n:"PtgArray",f:pp},33:{n:"PtgFunc",f:Pp},34:{n:"PtgFuncVar",f:Mp},35:{n:"PtgName",f:Rp},36:{n:"PtgRef",f:vp},37:{n:"PtgArea",f:sp},38:{n:"PtgMemArea",f:zp},39:{n:"PtgMemErr",f:Up},40:{n:"PtgMemNoMem",f:Hp},41:{n:"PtgMemFunc",f:jp},42:{n:"PtgRefErr",f:Wp},43:{n:"PtgAreaErr",f:lp},44:{n:"PtgRefN",f:bp},45:{n:"PtgAreaN",f:fp},46:{n:"PtgMemAreaN",f:og},47:{n:"PtgMemNoMemN",f:sg},57:{n:"PtgNameX",f:Lp},58:{n:"PtgRef3d",f:wp},59:{n:"PtgArea3d",f:cp},60:{n:"PtgRefErr3d",f:Vp},61:{n:"PtgAreaErr3d",f:dp},255:{}},lg={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dg={1:{n:"PtgElfLel",f:Zc},2:{n:"PtgElfRw",f:Qp},3:{n:"PtgElfCol",f:Xp},6:{n:"PtgElfRwV",f:eg},7:{n:"PtgElfColV",f:Kp},10:{n:"PtgElfRadical",f:qp},11:{n:"PtgElfRadicalS",f:Jp},13:{n:"PtgElfColS",f:Gp},15:{n:"PtgElfColSV",f:Yp},16:{n:"PtgElfRadicalLel",f:Zp},25:{n:"PtgList",f:ng},29:{n:"PtgSxName",f:rg},255:{}},fg={0:{n:"PtgAttrNoop",f:cg},1:{n:"PtgAttrSemi",f:xp},2:{n:"PtgAttrIf",f:hp},4:{n:"PtgAttrChoose",f:gp},8:{n:"PtgAttrGoto",f:up},16:{n:"PtgAttrSum",f:yp},32:{n:"PtgAttrBaxcel",f:Rs},33:{n:"PtgAttrBaxcel",f:Rs},64:{n:"PtgAttrSpace",f:_p},65:{n:"PtgAttrSpaceSemi",f:Cp},128:{n:"PtgAttrIfError",f:mp},255:{}};function pg(n,t,e,r){if(r.biff<8)return _n(n,t);for(var i=n.l+t,a=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=Bp(n,0,r),a.push(e[o][1]);break;case"PtgMemArea":e[o][2]=Ip(n,e[o][1],r),a.push(e[o][2]);break;case"PtgExp":r&&r.biff==12&&(e[o][1][1]=n.read_shift(4),a.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0];default:break}return t=i-n.l,t!==0&&a.push(_n(n,t)),a}function gg(n,t,e){for(var r=n.l+t,i,a,o=[];r!=n.l;)t=r-n.l,a=n[n.l],i=Ls[a]||Ls[lg[a]],(a===24||a===25)&&(i=(a===24?dg:fg)[n[n.l+1]]),!i||!i.f?_n(n,t):o.push([i.n,i.f(n,t,e)]);return o}function ug(n){for(var t=[],e=0;e<n.length;++e){for(var r=n[e],i=[],a=0;a<r.length;++a){var o=r[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var hg={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function mg(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function Jc(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(e.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Ns(n,t,e){var r=Jc(n,t,e);return r=="#REF"?r:mg(r,e)}function wr(n,t,e,r,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],c,l,d,m=0,x=0,u,v="";if(!n[0]||!n[0][0])return"";for(var h=-1,w="",T=0,F=n[0].length;T<F;++T){var I=n[0][T];switch(I[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=s.pop(),l=s.pop(),h>=0){switch(n[0][h][1][0]){case 0:w=Ke(" ",n[0][h][1][1]);break;case 1:w=Ke("\r",n[0][h][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][h][1][0])}l=l+w,h=-1}s.push(l+hg[I[0]]+c);break;case"PtgIsect":c=s.pop(),l=s.pop(),s.push(l+" "+c);break;case"PtgUnion":c=s.pop(),l=s.pop(),s.push(l+","+c);break;case"PtgRange":c=s.pop(),l=s.pop(),s.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Wr(I[1][1],o,i),s.push(Vr(d,a));break;case"PtgRefN":d=e?Wr(I[1][1],e,i):I[1][1],s.push(Vr(d,a));break;case"PtgRef3d":m=I[1][1],d=Wr(I[1][2],o,i),v=Ns(r,m,i);var j=v;s.push(v+"!"+Vr(d,a));break;case"PtgFunc":case"PtgFuncVar":var W=I[1][0],pe=I[1][1];W||(W=0),W&=127;var A=W==0?[]:s.slice(-W);s.length-=W,pe==="User"&&(pe=A.shift()),s.push(pe+"("+A.join(",")+")");break;case"PtgBool":s.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(I[1]);break;case"PtgNum":s.push(String(I[1]));break;case"PtgStr":s.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(I[1]);break;case"PtgAreaN":u=ws(I[1][1],e?{s:e}:o,i),s.push(Pa(u,i));break;case"PtgArea":u=ws(I[1][1],o,i),s.push(Pa(u,i));break;case"PtgArea3d":m=I[1][1],u=I[1][2],v=Ns(r,m,i),s.push(v+"!"+Pa(u,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=I[1][2];var X=(r.names||[])[x-1]||(r[0]||[])[x],z=X?X.Name:"SH33TJSNAME"+String(x);z&&z.slice(0,6)=="_xlfn."&&!i.xlfn&&(z=z.slice(6)),s.push(z);break;case"PtgNameX":var H=I[1][1];x=I[1][2];var K;if(i.biff<=5)H<0&&(H=-H),r[H]&&(K=r[H][x]);else{var Z="";if(((r[H]||[])[0]||[])[0]==14849||(((r[H]||[])[0]||[])[0]==1025?r[H][x]&&r[H][x].itab>0&&(Z=r.SheetNames[r[H][x].itab-1]+"!"):Z=r.SheetNames[x-1]+"!"),r[H]&&r[H][x])Z+=r[H][x].Name;else if(r[0]&&r[0][x])Z+=r[0][x].Name;else{var _e=(Jc(r,H,i)||"").split(";;");_e[x-1]?Z=_e[x-1]:Z+="SH33TJSERRX"}s.push(Z);break}K||(K={Name:"SH33TJSERRY"}),s.push(K.Name);break;case"PtgParen":var Be="(",Ce=")";if(h>=0){switch(w="",n[0][h][1][0]){case 2:Be=Ke(" ",n[0][h][1][1])+Be;break;case 3:Be=Ke("\r",n[0][h][1][1])+Be;break;case 4:Ce=Ke(" ",n[0][h][1][1])+Ce;break;case 5:Ce=Ke("\r",n[0][h][1][1])+Ce;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][h][1][0])}h=-1}s.push(Be+s.pop()+Ce);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":d={c:I[1][1],r:I[1][0]};var it={c:e.c,r:e.r};if(r.sharedf[je(d)]){var at=r.sharedf[je(d)];s.push(wr(at,o,it,r,i))}else{var Ft=!1;for(c=0;c!=r.arrayf.length;++c)if(l=r.arrayf[c],!(d.c<l[0].s.c||d.c>l[0].e.c)&&!(d.r<l[0].s.r||d.r>l[0].e.r)){s.push(wr(l[1],o,it,r,i)),Ft=!0;break}Ft||s.push(I[1])}break;case"PtgArray":s.push("{"+ug(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var Et=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&h>=0&&Et.indexOf(n[0][T][0])==-1){I=n[0][h];var mt=!0;switch(I[1][0]){case 4:mt=!1;case 0:w=Ke(" ",I[1][1]);break;case 5:mt=!1;case 1:w=Ke("\r",I[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}s.push((mt?w:"")+s.pop()+(mt?"":w)),h=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function xg(n){if(n==null){var t=V(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof n=="number")return Zn(n);return Zn(0)}function _g(n,t,e,r,i){var a=Jn(t,e,i),o=xg(n.v),s=V(6),c=33;s.write_shift(2,c),s.write_shift(4,0);for(var l=V(n.bf.length),d=0;d<n.bf.length;++d)l[d]=n.bf[d];var m=bt([a,o,s,l]);return m}function $i(n,t,e){var r=n.read_shift(4),i=gg(n,r,e),a=n.read_shift(4),o=a>0?pg(n,a,i,e):null;return[i,o]}var Cg=$i,Xi=$i,vg=$i,bg=$i,wg={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Qc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Pg={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Mg(n){var t="of:="+n.replace(Ja,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Og(n){return n.replace(/\./,"!")}var Ur=typeof Map<"u";function to(n,t,e){var r=0,i=n.length;if(e){if(Ur?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var a=Ur?e.get(t):e[t];r<a.length;++r)if(n[a[r]].t===t)return n.Count++,a[r]}}else for(;r<i;++r)if(n[r].t===t)return n.Count++,r;return n[i]={t},n.Count++,n.Unique++,e&&(Ur?(e.has(t)||e.set(t,[]),e.get(t).push(i)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(i))),i}function Gi(n,t){var e={min:n+1,max:n+1},r=-1;return t.MDW&&(On=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?r=Bi(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(e.width=Aa(r),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function e0(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function zn(n,t,e){var r=e.revssf[t.z!=null?t.z:"General"],i=60,a=n.length;if(r==null&&e.ssf){for(;i<392;++i)if(e.ssf[i]==null){ec(t.z,i),e.ssf[i]=t.z,e.revssf[t.z]=r=i;break}}for(i=0;i!=a;++i)if(n[i].numFmtId===r)return i;return n[a]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function yg(n,t,e){if(n&&n["!ref"]){var r=Xe(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+e+"): "+n["!ref"])}}function kg(n){if(n.length===0)return"";for(var t='<mergeCells count="'+n.length+'">',e=0;e!=n.length;++e)t+='<mergeCell ref="'+et(n[e])+'"/>';return t+"</mergeCells>"}function Sg(n,t,e,r,i){var a=!1,o={},s=null;if(r.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[e];try{t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}a=!0,o.codeName=wn(ze(c))}if(n&&n["!outline"]){var l={summaryBelow:1,summaryRight:1};n["!outline"].above&&(l.summaryBelow=0),n["!outline"].left&&(l.summaryRight=0),s=(s||"")+ie("outlinePr",null,l)}!a&&!s||(i[i.length]=ie("sheetPr",s,o))}var Eg=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Tg=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Dg(n){var t={sheet:1};return Eg.forEach(function(e){n[e]!=null&&n[e]&&(t[e]="1")}),Tg.forEach(function(e){n[e]!=null&&!n[e]&&(t[e]="0")}),n.password&&(t.password=Lc(n.password).toString(16).toUpperCase()),ie("sheetProtection",null,t)}function Ag(n){return e0(n),ie("pageMargins",null,n)}function Fg(n,t){for(var e=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(e[e.length]=ie("col",null,Gi(i,r)));return e[e.length]="</cols>",e.join("")}function Ig(n,t,e,r){var i=typeof n.ref=="string"?n.ref:et(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,o=Gt(i);o.s.r==o.e.r&&(o.e.r=Gt(t["!ref"]).e.r,i=et(o));for(var s=0;s<a.length;++s){var c=a[s];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+e.SheetNames[r]+"'!"+i;break}}return s==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+e.SheetNames[r]+"'!"+i}),ie("autoFilter",null,{ref:i})}function Bg(n,t,e,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ie("sheetViews",ie("sheetView",null,i),{})}function Rg(n,t,e,r){if(n.c&&e["!comments"].push([t,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",a=n.t,o=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=Qr[n.v];break;case"d":r&&r.cellDates?i=At(n.v,-1).toISOString():(n=jt(n),n.t="n",i=""+(n.v=zt(At(n.v)))),typeof n.z>"u"&&(n.z=qe[14]);break;default:i=n.v;break}var s=wt("v",ze(i)),c={r:t},l=zn(r.cellXfs,n,r);switch(l!==0&&(c.s=l),n.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){s=wt("v",""+to(r.Strings,n.v,r.revStrings)),c.t="s";break}c.t="str";break}if(n.t!=a&&(n.t=a,n.v=o),typeof n.f=="string"&&n.f){var d=n.F&&n.F.slice(0,t.length)==t?{t:"array",ref:n.F}:null;s=ie("f",ze(n.f),d)+(n.v!=null?s:"")}return n.l&&e["!links"].push([t,n.l]),n.D&&(c.cm=1),ie("c",s,c)}function Lg(n,t,e,r){var i=[],a=[],o=Xe(n["!ref"]),s="",c,l="",d=[],m=0,x=0,u=n["!rows"],v=Array.isArray(n),h={r:l},w,T=-1;for(x=o.s.c;x<=o.e.c;++x)d[x]=kt(x);for(m=o.s.r;m<=o.e.r;++m){for(a=[],l=Pt(m),x=o.s.c;x<=o.e.c;++x){c=d[x]+l;var F=v?(n[m]||[])[x]:n[c];F!==void 0&&(s=Rg(F,c,n,t,e,r))!=null&&a.push(s)}(a.length>0||u&&u[m])&&(h={r:l},u&&u[m]&&(w=u[m],w.hidden&&(h.hidden=1),T=-1,w.hpx?T=Ri(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(h.ht=T,h.customHeight=1),w.level&&(h.outlineLevel=w.level)),i[i.length]=ie("row",a.join(""),h))}if(u)for(;m<u.length;++m)u&&u[m]&&(h={r:m+1},w=u[m],w.hidden&&(h.hidden=1),T=-1,w.hpx?T=Ri(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(h.ht=T,h.customHeight=1),w.level&&(h.outlineLevel=w.level),i[i.length]=ie("row","",h));return i.join("")}function t0(n,t,e,r){var i=[tt,ie("worksheet",null,{xmlns:Pr[0],"xmlns:r":pt.r})],a=e.SheetNames[n],o=0,s="",c=e.Sheets[a];c==null&&(c={});var l=c["!ref"]||"A1",d=Xe(l);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),l=et(d)}r||(r={}),c["!comments"]=[];var m=[];Sg(c,e,n,t,i),i[i.length]=ie("dimension",null,{ref:l}),i[i.length]=Bg(c,t,n,e),t.sheetFormat&&(i[i.length]=ie("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=Fg(c,c["!cols"])),i[o=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(s=Lg(c,t,n,e,r),s.length>0&&(i[i.length]=s)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),c["!protect"]&&(i[i.length]=Dg(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=Ig(c["!autofilter"],c,e,n)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=kg(c["!merges"]));var x=-1,u,v=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(h){h[1].Target&&(u={ref:h[0]},h[1].Target.charAt(0)!="#"&&(v=Ne(r,-1,ze(h[1].Target).replace(/#.*$/,""),Fe.HLINK),u["r:id"]="rId"+v),(x=h[1].Target.indexOf("#"))>-1&&(u.location=ze(h[1].Target.slice(x+1))),h[1].Tooltip&&(u.tooltip=ze(h[1].Tooltip)),i[i.length]=ie("hyperlink",null,u))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=Ag(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=wt("ignoredErrors",ie("ignoredError",null,{numberStoredAsText:1,sqref:l}))),m.length>0&&(v=Ne(r,-1,"../drawings/drawing"+(n+1)+".xml",Fe.DRAW),i[i.length]=ie("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=m),c["!comments"].length>0&&(v=Ne(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Fe.VML),i[i.length]=ie("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Ng(n,t){var e={},r=n.l+t;e.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var a=n.read_shift(1);return n.l=r,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=i/20),e}function zg(n,t,e){var r=V(145),i=(e["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var a=320;i.hpx?a=Ri(i.hpx)*20:i.hpt&&(a=i.hpt*20),r.write_shift(2,a),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var s=0,c=r.l;r.l+=4;for(var l={r:n,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,x=-1,u=d<<10;u<d+1<<10;++u){l.c=u;var v=Array.isArray(e)?(e[l.r]||[])[l.c]:e[je(l)];v&&(m<0&&(m=u),x=u)}m<0||(++s,r.write_shift(4,m),r.write_shift(4,x))}var h=r.l;return r.l=c,r.write_shift(4,s),r.l=h,r.length>r.l?r.slice(0,r.l):r}function jg(n,t,e,r){var i=zg(r,e,t);(i.length>17||(t["!rows"]||[])[r])&&Y(n,0,i)}var Wg=rr,Vg=yr;function Ug(){}function Hg(n,t){var e={},r=n[n.l];return++n.l,e.above=!(r&64),e.left=!(r&128),n.l+=18,e.name=Ql(n,t-19),e}function $g(n,t,e){e==null&&(e=V(84+4*n.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),e.write_shift(1,r);for(var i=1;i<3;++i)e.write_shift(1,0);return Ai({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),mc(n,e),e.slice(0,e.l)}function Xg(n){var t=Qt(n);return[t]}function Gg(n,t,e){return e==null&&(e=V(8)),er(t,e)}function Yg(n){var t=tr(n);return[t]}function Kg(n,t,e){return e==null&&(e=V(4)),nr(t,e)}function qg(n){var t=Qt(n),e=n.read_shift(1);return[t,e,"b"]}function Zg(n,t,e){return e==null&&(e=V(9)),er(t,e),e.write_shift(1,n.v?1:0),e}function Jg(n){var t=tr(n),e=n.read_shift(1);return[t,e,"b"]}function Qg(n,t,e){return e==null&&(e=V(5)),nr(t,e),e.write_shift(1,n.v?1:0),e}function eu(n){var t=Qt(n),e=n.read_shift(1);return[t,e,"e"]}function tu(n,t,e){return e==null&&(e=V(9)),er(t,e),e.write_shift(1,n.v),e}function nu(n){var t=tr(n),e=n.read_shift(1);return[t,e,"e"]}function ru(n,t,e){return e==null&&(e=V(8)),nr(t,e),e.write_shift(1,n.v),e.write_shift(2,0),e.write_shift(1,0),e}function iu(n){var t=Qt(n),e=n.read_shift(4);return[t,e,"s"]}function au(n,t,e){return e==null&&(e=V(12)),er(t,e),e.write_shift(4,t.v),e}function ou(n){var t=tr(n),e=n.read_shift(4);return[t,e,"s"]}function su(n,t,e){return e==null&&(e=V(8)),nr(t,e),e.write_shift(4,t.v),e}function cu(n){var t=Qt(n),e=kr(n);return[t,e,"n"]}function lu(n,t,e){return e==null&&(e=V(16)),er(t,e),Zn(n.v,e),e}function du(n){var t=tr(n),e=kr(n);return[t,e,"n"]}function fu(n,t,e){return e==null&&(e=V(12)),nr(t,e),Zn(n.v,e),e}function pu(n){var t=Qt(n),e=xc(n);return[t,e,"n"]}function gu(n,t,e){return e==null&&(e=V(12)),er(t,e),_c(n.v,e),e}function uu(n){var t=tr(n),e=xc(n);return[t,e,"n"]}function hu(n,t,e){return e==null&&(e=V(8)),nr(t,e),_c(n.v,e),e}function mu(n){var t=Qt(n),e=Ga(n);return[t,e,"is"]}function xu(n){var t=Qt(n),e=St(n);return[t,e,"str"]}function _u(n,t,e){return e==null&&(e=V(12+4*n.v.length)),er(t,e),ut(n.v,e),e.length>e.l?e.slice(0,e.l):e}function Cu(n){var t=tr(n),e=St(n);return[t,e,"str"]}function vu(n,t,e){return e==null&&(e=V(8+4*n.v.length)),nr(t,e),ut(n.v,e),e.length>e.l?e.slice(0,e.l):e}function bu(n,t,e){var r=n.l+t,i=Qt(n);i.r=e["!row"];var a=n.read_shift(1),o=[i,a,"b"];if(e.cellFormula){n.l+=2;var s=Xi(n,r-n.l,e);o[3]=wr(s,null,i,e.supbooks,e)}else n.l=r;return o}function wu(n,t,e){var r=n.l+t,i=Qt(n);i.r=e["!row"];var a=n.read_shift(1),o=[i,a,"e"];if(e.cellFormula){n.l+=2;var s=Xi(n,r-n.l,e);o[3]=wr(s,null,i,e.supbooks,e)}else n.l=r;return o}function Pu(n,t,e){var r=n.l+t,i=Qt(n);i.r=e["!row"];var a=kr(n),o=[i,a,"n"];if(e.cellFormula){n.l+=2;var s=Xi(n,r-n.l,e);o[3]=wr(s,null,i,e.supbooks,e)}else n.l=r;return o}function Mu(n,t,e){var r=n.l+t,i=Qt(n);i.r=e["!row"];var a=St(n),o=[i,a,"str"];if(e.cellFormula){n.l+=2;var s=Xi(n,r-n.l,e);o[3]=wr(s,null,i,e.supbooks,e)}else n.l=r;return o}var Ou=rr,yu=yr;function ku(n,t){return t==null&&(t=V(4)),t.write_shift(4,n),t}function Su(n,t){var e=n.l+t,r=rr(n,16),i=Ya(n),a=St(n),o=St(n),s=St(n);n.l=e;var c={rfx:r,relId:i,loc:a,display:s};return o&&(c.Tooltip=o),c}function Eu(n,t){var e=V(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));yr({s:gt(n[0]),e:gt(n[0])},e),Ka("rId"+t,e);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return ut(i||"",e),ut(n[1].Tooltip||"",e),ut("",e),e.slice(0,e.l)}function Tu(){}function Du(n,t,e){var r=n.l+t,i=Cc(n,16),a=n.read_shift(1),o=[i];if(o[2]=a,e.cellFormula){var s=Cg(n,r-n.l,e);o[1]=s}else n.l=r;return o}function Au(n,t,e){var r=n.l+t,i=rr(n,16),a=[i];if(e.cellFormula){var o=bg(n,r-n.l,e);a[1]=o,n.l=r}else n.l=r;return a}function Fu(n,t,e){e==null&&(e=V(18));var r=Gi(n,t);e.write_shift(-4,n),e.write_shift(-4,n),e.write_shift(4,(r.width||10)*256),e.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),e.write_shift(2,i),e}var n0=["left","right","top","bottom","header","footer"];function Iu(n){var t={};return n0.forEach(function(e){t[e]=kr(n,8)}),t}function Bu(n,t){return t==null&&(t=V(48)),e0(n),n0.forEach(function(e){Zn(n[e],t)}),t}function Ru(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function Lu(n,t,e){e==null&&(e=V(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Nu(n){var t=V(24);return t.write_shift(4,4),t.write_shift(4,1),yr(n,t),t}function zu(n,t){return t==null&&(t=V(66)),t.write_shift(2,n.password?Lc(n.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,n[e[0]]!=null&&!n[e[0]]?1:0):t.write_shift(4,n[e[0]]!=null&&n[e[0]]?0:1)}),t}function ju(){}function Wu(){}function Vu(n,t,e,r,i,a,o){if(t.v===void 0)return!1;var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":t=jt(t),t.z=t.z||qe[14],t.v=zt(At(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v;break}var c={r:e,c:r};switch(c.s=zn(i.cellXfs,t,i),t.l&&a["!links"].push([je(c),t.l]),t.c&&a["!comments"].push([je(c),t.c]),t.t){case"s":case"str":return i.bookSST?(s=to(i.Strings,t.v,i.revStrings),c.t="s",c.v=s,o?Y(n,18,su(t,c)):Y(n,7,au(t,c))):(c.t="str",o?Y(n,17,vu(t,c)):Y(n,6,_u(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Y(n,13,hu(t,c)):Y(n,2,gu(t,c)):o?Y(n,16,fu(t,c)):Y(n,5,lu(t,c)),!0;case"b":return c.t="b",o?Y(n,15,Qg(t,c)):Y(n,4,Zg(t,c)),!0;case"e":return c.t="e",o?Y(n,14,ru(t,c)):Y(n,3,tu(t,c)),!0}return o?Y(n,12,Kg(t,c)):Y(n,1,Gg(t,c)),!0}function Uu(n,t,e,r){var i=Xe(t["!ref"]||"A1"),a,o="",s=[];Y(n,145);var c=Array.isArray(t),l=i.e.r;t["!rows"]&&(l=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=l;++d){o=Pt(d),jg(n,t,i,d);var m=!1;if(d<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){d===i.s.r&&(s[x]=kt(x)),a=s[x]+o;var u=c?(t[d]||[])[x]:t[a];if(!u){m=!1;continue}m=Vu(n,u,d,x,r,t,m)}}Y(n,146)}function Hu(n,t){!t||!t["!merges"]||(Y(n,177,ku(t["!merges"].length)),t["!merges"].forEach(function(e){Y(n,176,yu(e))}),Y(n,178))}function $u(n,t){!t||!t["!cols"]||(Y(n,390),t["!cols"].forEach(function(e,r){e&&Y(n,60,Fu(r,e))}),Y(n,391))}function Xu(n,t){!t||!t["!ref"]||(Y(n,648),Y(n,649,Nu(Xe(t["!ref"]))),Y(n,650))}function Gu(n,t,e){t["!links"].forEach(function(r){if(r[1].Target){var i=Ne(e,-1,r[1].Target.replace(/#.*$/,""),Fe.HLINK);Y(n,494,Eu(r,i))}}),delete t["!links"]}function Yu(n,t,e,r){if(t["!comments"].length>0){var i=Ne(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Fe.VML);Y(n,551,Ka("rId"+i)),t["!legacy"]=i}}function Ku(n,t,e,r){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:et(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,s=Gt(a);s.s.r==s.e.r&&(s.e.r=Gt(t["!ref"]).e.r,a=et(s));for(var c=0;c<o.length;++c){var l=o[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+e.SheetNames[r]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+e.SheetNames[r]+"'!"+a}),Y(n,161,yr(Xe(a))),Y(n,162)}}function qu(n,t,e){Y(n,133),Y(n,137,Lu(t,e)),Y(n,138),Y(n,134)}function Zu(n,t){t["!protect"]&&Y(n,535,zu(t["!protect"]))}function Ju(n,t,e,r){var i=Nt(),a=e.SheetNames[n],o=e.Sheets[a]||{},s=a;try{e&&e.Workbook&&(s=e.Workbook.Sheets[n].CodeName||s)}catch{}var c=Xe(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Y(i,129),(e.vbaraw||o["!outline"])&&Y(i,147,$g(s,o["!outline"])),Y(i,148,Vg(c)),qu(i,o,e.Workbook),$u(i,o,n,t,e),Uu(i,o,n,t,e),Zu(i,o),Ku(i,o,e,n),Hu(i,o),Gu(i,o,r),o["!margins"]&&Y(i,476,Bu(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Xu(i,o),Yu(i,o,n,r),Y(i,130),i.end()}function Qu(n,t){n.l+=10;var e=St(n,t-10);return{name:e}}var eh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function th(n){return!n.Workbook||!n.Workbook.WBProps?"false":Tl(n.Workbook.WBProps.date1904)?"true":"false"}var nh="][*?/\\".split("");function r0(n,t){if(n.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return nh.forEach(function(r){if(n.indexOf(r)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function rh(n,t,e){n.forEach(function(r,i){r0(r);for(var a=0;a<i;++a)if(r==n[a])throw new Error("Duplicate Sheet Name: "+r);if(e){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function ih(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var t=n.Workbook&&n.Workbook.Sheets||[];rh(n.SheetNames,t,!!n.vbaraw);for(var e=0;e<n.SheetNames.length;++e)yg(n.Sheets[n.SheetNames[e]],n.SheetNames[e],e)}function i0(n){var t=[tt];t[t.length]=ie("workbook",null,{xmlns:Pr[0],"xmlns:r":pt.r});var e=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(eh.forEach(function(s){n.Workbook.WBProps[s[0]]!=null&&n.Workbook.WBProps[s[0]]!=s[1]&&(r[s[0]]=n.Workbook.WBProps[s[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=ie("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=n.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==n.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=n.SheetNames.length;++a){var o={name:ze(n.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ie("sheet",null,o)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(s){var c={name:s.Name};s.Comment&&(c.comment=s.Comment),s.Sheet!=null&&(c.localSheetId=""+s.Sheet),s.Hidden&&(c.hidden="1"),s.Ref&&(t[t.length]=ie("definedName",ze(s.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function ah(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=Da(n,t-8),e.name=St(n),e}function oh(n,t){return t||(t=V(127)),t.write_shift(4,n.Hidden),t.write_shift(4,n.iTabID),Ka(n.strRelID,t),ut(n.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function sh(n,t){var e={},r=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var i=t>8?St(n):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(r&65536),e.backupFile=!!(r&64),e.checkCompatibility=!!(r&4096),e.date1904=!!(r&1),e.filterPrivacy=!!(r&8),e.hidePivotFieldList=!!(r&1024),e.promptedSolutions=!!(r&16),e.publishItems=!!(r&2048),e.refreshAllConnections=!!(r&262144),e.saveExternalLinkValues=!!(r&128),e.showBorderUnselectedTables=!!(r&4),e.showInkAnnotation=!!(r&32),e.showObjects=["all","placeholders","none"][r>>13&3],e.showPivotChartFilter=!!(r&32768),e.updateLinks=["userSet","never","always"][r>>8&3],e}function ch(n,t){t||(t=V(72));var e=0;return n&&n.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),mc(n&&n.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function lh(n,t,e){var r=n.l+t;n.l+=4,n.l+=1;var i=n.read_shift(4),a=ed(n),o=vg(n,0,e),s=Ya(n);n.l=r;var c={Name:a,Ptg:o};return i<268435455&&(c.Sheet=i),s&&(c.Comment=s),c}function dh(n,t){Y(n,143);for(var e=0;e!=t.SheetNames.length;++e){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,i={Hidden:r,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};Y(n,156,oh(i))}Y(n,144)}function fh(n,t){t||(t=V(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return ut("SheetJS",t),ut(Hr.version,t),ut(Hr.version,t),ut("7262",t),t.length>t.l?t.slice(0,t.l):t}function ph(n,t){t||(t=V(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,n),t.write_shift(4,n);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function gh(n,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,r=0,i=-1,a=-1;r<e.length;++r)!e[r]||!e[r].Hidden&&i==-1?i=r:e[r].Hidden==1&&a==-1&&(a=r);a>i||(Y(n,135),Y(n,158,ph(i)),Y(n,136))}}function uh(n,t){var e=Nt();return Y(e,131),Y(e,128,fh()),Y(e,153,ch(n.Workbook&&n.Workbook.WBProps||null)),gh(e,n,t),dh(e,n,t),Y(e,132),e.end()}function hh(n,t,e){return(t.slice(-4)===".bin"?uh:i0)(n,e)}function mh(n,t,e,r,i){return(t.slice(-4)===".bin"?Ju:t0)(n,e,r,i)}function xh(n,t,e){return(t.slice(-4)===".bin"?Bf:jc)(n,e)}function _h(n,t,e){return(t.slice(-4)===".bin"?cf:Rc)(n,e)}function Ch(n,t,e){return(t.slice(-4)===".bin"?Zf:$c)(n,e)}function vh(n){return(n.slice(-4)===".bin"?Uf:Uc)()}function bh(n,t){var e=[];return n.Props&&e.push(md(n.Props,t)),n.Custprops&&e.push(xd(n.Props,n.Custprops,t)),e.join("")}function wh(){return""}function Ph(n,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var a=[];a.push(ie("NumberFormat",null,{"ss:Format":ze(qe[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};e.push(ie("Style",a.join(""),o))}),ie("Styles",e.join(""))}function a0(n){return ie("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Qa(n.Ref,{r:0,c:0})})}function Mh(n){if(!((n||{}).Workbook||{}).Names)return"";for(var t=n.Workbook.Names,e=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||e.push(a0(i)))}return ie("Names",e.join(""))}function Oh(n,t,e,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,a=[],o=0;o<i.length;++o){var s=i[o];s.Sheet==e&&(s.Name.match(/^_xlfn\./)||a.push(a0(s)))}return a.join("")}function yh(n,t,e,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(ie("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(ie("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(ie("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e])if(r.Workbook.Sheets[e].Hidden)i.push(ie("Visible",r.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<e&&!(r.Workbook.Sheets[a]&&!r.Workbook.Sheets[a].Hidden);++a);a==e&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(wt("ProtectContents","True")),n["!protect"].objects&&i.push(wt("ProtectObjects","True")),n["!protect"].scenarios&&i.push(wt("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(wt("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(wt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){n["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ie("WorksheetOptions",i.join(""),{xmlns:Xt.x})}function kh(n){return n.map(function(t){var e=El(t.t||""),r=ie("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ie("Comment",r,{"ss:Author":t.a})}).join("")}function Sh(n,t,e,r,i,a,o){if(!n||n.v==null&&n.f==null)return"";var s={};if(n.f&&(s["ss:Formula"]="="+ze(Qa(n.f,o))),n.F&&n.F.slice(0,t.length)==t){var c=gt(n.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(n.l&&n.l.Target&&(s["ss:HRef"]=ze(n.l.Target),n.l.Tooltip&&(s["x:HRefScreenTip"]=ze(n.l.Tooltip))),e["!merges"])for(var l=e["!merges"],d=0;d!=l.length;++d)l[d].s.c!=o.c||l[d].s.r!=o.r||(l[d].e.c>l[d].s.c&&(s["ss:MergeAcross"]=l[d].e.c-l[d].s.c),l[d].e.r>l[d].s.r&&(s["ss:MergeDown"]=l[d].e.r-l[d].s.r));var m="",x="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":m="Number",x=String(n.v);break;case"b":m="Boolean",x=n.v?"1":"0";break;case"e":m="Error",x=Qr[n.v];break;case"d":m="DateTime",x=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||qe[14]);break;case"s":m="String",x=Sl(n.v||"");break}var u=zn(r.cellXfs,n,r);s["ss:StyleID"]="s"+(21+u),s["ss:Index"]=o.c+1;var v=n.v!=null?x:"",h=n.t=="z"?"":'<Data ss:Type="'+m+'">'+v+"</Data>";return(n.c||[]).length>0&&(h+=kh(n.c)),ie("Cell",h,s)}function Eh(n,t){var e='<Row ss:Index="'+(n+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=zc(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Th(n,t,e,r){if(!n["!ref"])return"";var i=Xe(n["!ref"]),a=n["!merges"]||[],o=0,s=[];n["!cols"]&&n["!cols"].forEach(function(w,T){Za(w);var F=!!w.width,I=Gi(T,w),j={"ss:Index":T+1};F&&(j["ss:Width"]=Ii(I.width)),w.hidden&&(j["ss:Hidden"]="1"),s.push(ie("Column",null,j))});for(var c=Array.isArray(n),l=i.s.r;l<=i.e.r;++l){for(var d=[Eh(l,(n["!rows"]||[])[l])],m=i.s.c;m<=i.e.c;++m){var x=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>m)&&!(a[o].s.r>l)&&!(a[o].e.c<m)&&!(a[o].e.r<l)){(a[o].s.c!=m||a[o].s.r!=l)&&(x=!0);break}if(!x){var u={r:l,c:m},v=je(u),h=c?(n[l]||[])[m]:n[v];d.push(Sh(h,v,n,t,e,r,u))}}d.push("</Row>"),d.length>2&&s.push(d.join(""))}return s.join("")}function Dh(n,t,e){var r=[],i=e.SheetNames[n],a=e.Sheets[i],o=a?Oh(a,t,n,e):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=a?Th(a,t,n,e):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(yh(a,t,n,e)),r.join("")}function Ah(n,t){t||(t={}),n.SSF||(n.SSF=jt(qe)),n.SSF&&(Wi(),ji(n.SSF),t.revssf=Vi(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF,t.cellXfs=[],zn(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(bh(n,t)),e.push(wh(n,t)),e.push(""),e.push("");for(var r=0;r<n.SheetNames.length;++r)e.push(ie("Worksheet",Dh(r,t,n),{"ss:Name":ze(n.SheetNames[r])}));return e[2]=Ph(n,t),e[3]=Mh(n,t),tt+ie("Workbook",e.join(""),{xmlns:Xt.ss,"xmlns:o":Xt.o,"xmlns:x":Xt.x,"xmlns:ss":Xt.ss,"xmlns:dt":Xt.dt,"xmlns:html":Xt.html})}var ya={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Fh(n,t){var e=[],r=[],i=[],a=0,o,s=fs(Ms,"n"),c=fs(Os,"n");if(n.Props)for(o=Mt(n.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(s,o[a])?e:Object.prototype.hasOwnProperty.call(c,o[a])?r:i).push([o[a],n.Props[o[a]]]);if(n.Custprops)for(o=Mt(n.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(n.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(s,o[a])?e:Object.prototype.hasOwnProperty.call(c,o[a])?r:i).push([o[a],n.Custprops[o[a]]]);var l=[];for(a=0;a<i.length;++a)Ec.indexOf(i[a][0])>-1||yc.indexOf(i[a][0])>-1||i[a][1]!=null&&l.push(i[a]);r.length&&Ve.utils.cfb_add(t,"/SummaryInformation",Ts(r,ya.SI,c,Os)),(e.length||l.length)&&Ve.utils.cfb_add(t,"/DocumentSummaryInformation",Ts(e,ya.DSI,s,Ms,l.length?l:null,ya.UDI))}function Ih(n,t){var e=t||{},r=Ve.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Ve.utils.cfb_add(r,i,o0(n,e)),e.biff==8&&(n.Props||n.Custprops)&&Fh(n,r),e.biff==8&&n.vbaraw&&Jf(r,Ve.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var Bh={0:{f:Ng},1:{f:Xg},2:{f:pu},3:{f:eu},4:{f:qg},5:{f:cu},6:{f:xu},7:{f:iu},8:{f:Mu},9:{f:Pu},10:{f:bu},11:{f:wu},12:{f:Yg},13:{f:uu},14:{f:nu},15:{f:Jg},16:{f:du},17:{f:Cu},18:{f:ou},19:{f:Ga},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:lh},40:{},42:{},43:{f:xf},44:{f:hf},45:{f:vf},46:{f:wf},47:{f:bf},48:{},49:{f:Gl},50:{},51:{f:Nf},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Yd},62:{f:mu},63:{f:Hf},64:{f:ju},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_n,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ru},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Hg},148:{f:Wg,p:16},151:{f:Tu},152:{},153:{f:sh},154:{},155:{},156:{f:ah},157:{},158:{},159:{T:1,f:af},160:{T:-1},161:{T:1,f:rr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ou},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Rf},336:{T:-1},337:{f:Wf,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Da},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Vd},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Du},427:{f:Au},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Iu},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Ug},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Su},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Da},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Kf},633:{T:1},634:{T:-1},635:{T:1,f:Gf},636:{T:-1},637:{f:Zl},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Qu},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Wu},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function se(n,t,e,r){var i=t;if(!isNaN(i)){var a=r||(e||[]).length||0,o=n.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Ha(e)&&n.push(e)}}function Rh(n,t,e,r){var i=r||(e||[]).length||0;if(i<=8224)return se(n,t,e,i);var a=t;if(!isNaN(a)){for(var o=e.parts||[],s=0,c=0,l=0;l+(o[s]||8224)<=8224;)l+=o[s]||8224,s++;var d=n.next(4);for(d.write_shift(2,a),d.write_shift(2,l),n.push(e.slice(c,c+l)),c+=l;c<i;){for(d=n.next(4),d.write_shift(2,60),l=0;l+(o[s]||8224)<=8224;)l+=o[s]||8224,s++;d.write_shift(2,l),n.push(e.slice(c,c+l)),c+=l}}}function ti(n,t,e){return n||(n=V(7)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,0),n.write_shift(1,0),n}function Lh(n,t,e,r){var i=V(9);return ti(i,n,t),Dc(e,r||"b",i),i}function Nh(n,t,e){var r=V(8+2*e.length);return ti(r,n,t),r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function zh(n,t,e,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?zt(At(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?se(n,2,Jd(e,r,i)):se(n,3,Zd(e,r,i));return;case"b":case"e":se(n,5,Lh(e,r,t.v,t.t));return;case"s":case"str":se(n,4,Nh(e,r,(t.v||"").slice(0,255)));return}se(n,1,ti(null,e,r))}function jh(n,t,e,r){var i=Array.isArray(t),a=Xe(t["!ref"]||"A1"),o,s="",c=[];if(a.e.c>255||a.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=et(a)}for(var l=a.s.r;l<=a.e.r;++l){s=Pt(l);for(var d=a.s.c;d<=a.e.c;++d){l===a.s.r&&(c[d]=kt(d)),o=c[d]+s;var m=i?(t[l]||[])[d]:t[o];m&&zh(n,m,l,d,r)}}}function Wh(n,t){var e=t||{};xn!=null&&e.dense==null&&(e.dense=xn);for(var r=Nt(),i=0,a=0;a<n.SheetNames.length;++a)n.SheetNames[a]==e.sheet&&(i=a);if(i==0&&e.sheet&&n.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return se(r,e.biff==4?1033:e.biff==3?521:9,qa(n,16,e)),jh(r,n.Sheets[n.SheetNames[i]],i,e,n),se(r,10),r.end()}function Vh(n,t,e){se(n,49,Id({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function Uh(n,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&se(n,1054,Ld(i,t[i],e))})}function Hh(n,t){var e=V(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),se(n,2151,e),e=V(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Ic(Xe(t["!ref"]||"A1"),e),e.write_shift(4,4),se(n,2152,e)}function $h(n,t){for(var e=0;e<16;++e)se(n,224,As({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){se(n,224,As(r,0,t))})}function Xh(n,t){for(var e=0;e<t["!links"].length;++e){var r=t["!links"][e];se(n,440,$d(r)),r[1].Tooltip&&se(n,2048,Xd(r))}delete t["!links"]}function Gh(n,t){if(t){var e=0;t.forEach(function(r,i){++e<=256&&r&&se(n,125,Kd(Gi(i,r),i))})}}function Yh(n,t,e,r,i){var a=16+zn(i.cellXfs,t,i);if(t.v==null&&!t.bf){se(n,513,Jn(e,r,a));return}if(t.bf)se(n,6,_g(t,e,r,i,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?zt(At(t.v)):t.v;se(n,515,Wd(e,r,o,a,i));break;case"b":case"e":se(n,517,jd(e,r,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var s=to(i.Strings,t.v,i.revStrings);se(n,253,Bd(e,r,s,a,i))}else se(n,516,Rd(e,r,(t.v||"").slice(0,255),a,i));break;default:se(n,513,Jn(e,r,a))}}function Kh(n,t,e){var r=Nt(),i=e.SheetNames[n],a=e.Sheets[i]||{},o=(e||{}).Workbook||{},s=(o.Sheets||[])[n]||{},c=Array.isArray(a),l=t.biff==8,d,m="",x=[],u=Xe(a["!ref"]||"A1"),v=l?65536:16384;if(u.e.c>255||u.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,v-1)}se(r,2057,qa(e,16,t)),se(r,13,Jt(1)),se(r,12,Jt(100)),se(r,15,Dt(!0)),se(r,17,Dt(!1)),se(r,16,Zn(.001)),se(r,95,Dt(!0)),se(r,42,Dt(!1)),se(r,43,Dt(!1)),se(r,130,Jt(1)),se(r,128,zd([0,0])),se(r,131,Dt(!1)),se(r,132,Dt(!1)),l&&Gh(r,a["!cols"]),se(r,512,Nd(u,t)),l&&(a["!links"]=[]);for(var h=u.s.r;h<=u.e.r;++h){m=Pt(h);for(var w=u.s.c;w<=u.e.c;++w){h===u.s.r&&(x[w]=kt(w)),d=x[w]+m;var T=c?(a[h]||[])[w]:a[d];T&&(Yh(r,T,h,w,t),l&&T.l&&a["!links"].push([d,T.l]))}}var F=s.CodeName||s.name||i;return l&&se(r,574,Fd((o.Views||[])[0])),l&&(a["!merges"]||[]).length&&se(r,229,Hd(a["!merges"])),l&&Xh(r,a),se(r,442,Fc(F,t)),l&&Hh(r,a),se(r,10),r.end()}function qh(n,t,e){var r=Nt(),i=(n||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},s=e.biff==8,c=e.biff==5;if(se(r,2057,qa(n,5,e)),e.bookType=="xla"&&se(r,135),se(r,225,s?Jt(1200):null),se(r,193,vd(2)),c&&se(r,191),c&&se(r,192),se(r,226),se(r,92,Ed("SheetJS",e)),se(r,66,Jt(s?1200:1252)),s&&se(r,353,Jt(0)),s&&se(r,448),se(r,317,qd(n.SheetNames.length)),s&&n.vbaraw&&se(r,211),s&&n.vbaraw){var l=o.CodeName||"ThisWorkbook";se(r,442,Fc(l,e))}se(r,156,Jt(17)),se(r,25,Dt(!1)),se(r,18,Dt(!1)),se(r,19,Jt(0)),s&&se(r,431,Dt(!1)),s&&se(r,444,Jt(0)),se(r,61,Ad(e)),se(r,64,Dt(!1)),se(r,141,Jt(0)),se(r,34,Dt(th(n)=="true")),se(r,14,Dt(!0)),s&&se(r,439,Dt(!1)),se(r,218,Jt(0)),Vh(r,n,e),Uh(r,n.SSF,e),$h(r,e),s&&se(r,352,Dt(!1));var d=r.end(),m=Nt();s&&se(m,140,Gd()),s&&e.Strings&&Rh(m,252,Dd(e.Strings,e)),se(m,10);var x=m.end(),u=Nt(),v=0,h=0;for(h=0;h<n.SheetNames.length;++h)v+=(s?12:11)+(s?2:1)*n.SheetNames[h].length;var w=d.length+v+x.length;for(h=0;h<n.SheetNames.length;++h){var T=a[h]||{};se(u,133,Td({pos:w,hs:T.Hidden||0,dt:0,name:n.SheetNames[h]},e)),w+=t[h].length}var F=u.end();if(v!=F.length)throw new Error("BS8 "+v+" != "+F.length);var I=[];return d.length&&I.push(d),F.length&&I.push(F),x.length&&I.push(x),bt(I)}function Zh(n,t){var e=t||{},r=[];n&&!n.SSF&&(n.SSF=jt(qe)),n&&n.SSF&&(Wi(),ji(n.SSF),e.revssf=Vi(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,no(e),e.cellXfs=[],zn(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=Kh(i,e,n);return r.unshift(qh(n,r,e)),bt(r)}function o0(n,t){for(var e=0;e<=n.SheetNames.length;++e){var r=n.Sheets[n.SheetNames[e]];if(!(!r||!r["!ref"])){var i=Gt(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Zh(n,t);case 4:case 3:case 2:return Wh(n,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Jh(n,t,e,r){for(var i=n["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>e||i[l].s.c>o)&&!(i[l].e.r<e||i[l].e.c<o)){if(i[l].s.r<e||i[l].s.c<o){s=-1;break}s=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(s<0)){var d=je({r:e,c:o}),m=r.dense?(n[e]||[])[o]:n[d],x=m&&m.v!=null&&(m.h||kl(m.w||(kn(m),m.w)||""))||"",u={};s>1&&(u.rowspan=s),c>1&&(u.colspan=c),r.editable?x='<span contenteditable="true">'+x+"</span>":m&&(u["data-t"]=m&&m.t||"z",m.v!=null&&(u["data-v"]=m.v),m.z!=null&&(u["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+m.l.Target+'">'+x+"</a>")),u.id=(r.id||"sjs")+"-"+d,a.push(ie("td",x,u))}}var v="<tr>";return v+a.join("")+"</tr>"}var Qh='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',e1="</body></html>";function t1(n,t,e){var r=[];return r.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function s0(n,t){var e=t||{},r=e.header!=null?e.header:Qh,i=e.footer!=null?e.footer:e1,a=[r],o=Gt(n["!ref"]);e.dense=Array.isArray(n),a.push(t1(n,o,e));for(var s=o.s.r;s<=o.e.r;++s)a.push(Jh(n,o,s,e));return a.push("</table>"+i),a.join("")}function c0(n,t,e){var r=e||{};xn!=null&&(r.dense=xn);var i=0,a=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?gt(r.origin):r.origin;i=o.r,a=o.c}var s=t.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,s.length),l={s:{r:0,c:0},e:{r:i,c:a}};if(n["!ref"]){var d=Gt(n["!ref"]);l.s.r=Math.min(l.s.r,d.s.r),l.s.c=Math.min(l.s.c,d.s.c),l.e.r=Math.max(l.e.r,d.e.r),l.e.c=Math.max(l.e.c,d.e.c),i==-1&&(l.e.r=i=d.e.r+1)}var m=[],x=0,u=n["!rows"]||(n["!rows"]=[]),v=0,h=0,w=0,T=0,F=0,I=0;for(n["!cols"]||(n["!cols"]=[]);v<s.length&&h<c;++v){var j=s[v];if(zs(j)){if(r.display)continue;u[h]={hidden:!0}}var W=j.children;for(w=T=0;w<W.length;++w){var pe=W[w];if(!(r.display&&zs(pe))){var A=pe.hasAttribute("data-v")?pe.getAttribute("data-v"):pe.hasAttribute("v")?pe.getAttribute("v"):Dl(pe.innerHTML),X=pe.getAttribute("data-z")||pe.getAttribute("z");for(x=0;x<m.length;++x){var z=m[x];z.s.c==T+a&&z.s.r<h+i&&h+i<=z.e.r&&(T=z.e.c+1-a,x=-1)}I=+pe.getAttribute("colspan")||1,((F=+pe.getAttribute("rowspan")||1)>1||I>1)&&m.push({s:{r:h+i,c:T+a},e:{r:h+i+(F||1)-1,c:T+a+(I||1)-1}});var H={t:"s",v:A},K=pe.getAttribute("data-t")||pe.getAttribute("t")||"";A!=null&&(A.length==0?H.t=K||"z":r.raw||A.trim().length==0||K=="s"||(A==="TRUE"?H={t:"b",v:!0}:A==="FALSE"?H={t:"b",v:!1}:isNaN(Mn(A))?isNaN(Gr(A).getDate())||(H={t:"d",v:At(A)},r.cellDates||(H={t:"n",v:zt(H.v)}),H.z=r.dateNF||qe[14]):H={t:"n",v:Mn(A)})),H.z===void 0&&X!=null&&(H.z=X);var Z="",_e=pe.getElementsByTagName("A");if(_e&&_e.length)for(var Be=0;Be<_e.length&&!(_e[Be].hasAttribute("href")&&(Z=_e[Be].getAttribute("href"),Z.charAt(0)!="#"));++Be);Z&&Z.charAt(0)!="#"&&(H.l={Target:Z}),r.dense?(n[h+i]||(n[h+i]=[]),n[h+i][T+a]=H):n[je({c:T+a,r:h+i})]=H,l.e.c<T+a&&(l.e.c=T+a),T+=I}}++h}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),l.e.r=Math.max(l.e.r,h-1+i),n["!ref"]=et(l),h>=c&&(n["!fullref"]=et((l.e.r=s.length-v+h-1+i,l))),n}function l0(n,t){var e=t||{},r=e.dense?[]:{};return c0(r,n,t)}function n1(n,t){return Qn(l0(n,t),t)}function zs(n){var t="",e=r1(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function r1(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var i1=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Yr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return tt+t}})(),js=(function(){var n=function(a){return ze(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,r=function(a,o,s){var c=[];c.push('      <table:table table:name="'+ze(o.SheetNames[s])+`" table:style-name="ta1">
`);var l=0,d=0,m=Gt(a["!ref"]||"A1"),x=a["!merges"]||[],u=0,v=Array.isArray(a);if(a["!cols"])for(d=0;d<=m.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var h="",w=a["!rows"]||[];for(l=0;l<m.s.r;++l)h=w[l]?' table:style-name="ro'+w[l].ods+'"':"",c.push("        <table:table-row"+h+`></table:table-row>
`);for(;l<=m.e.r;++l){for(h=w[l]?' table:style-name="ro'+w[l].ods+'"':"",c.push("        <table:table-row"+h+`>
`),d=0;d<m.s.c;++d)c.push(t);for(;d<=m.e.c;++d){var T=!1,F={},I="";for(u=0;u!=x.length;++u)if(!(x[u].s.c>d)&&!(x[u].s.r>l)&&!(x[u].e.c<d)&&!(x[u].e.r<l)){(x[u].s.c!=d||x[u].s.r!=l)&&(T=!0),F["table:number-columns-spanned"]=x[u].e.c-x[u].s.c+1,F["table:number-rows-spanned"]=x[u].e.r-x[u].s.r+1;break}if(T){c.push(e);continue}var j=je({r:l,c:d}),W=v?(a[l]||[])[d]:a[j];if(W&&W.f&&(F["table:formula"]=ze(Mg(W.f)),W.F&&W.F.slice(0,j.length)==j)){var pe=Gt(W.F);F["table:number-matrix-columns-spanned"]=pe.e.c-pe.s.c+1,F["table:number-matrix-rows-spanned"]=pe.e.r-pe.s.r+1}if(!W){c.push(t);continue}switch(W.t){case"b":I=W.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=W.v?"true":"false";break;case"n":I=W.w||String(W.v||0),F["office:value-type"]="float",F["office:value"]=W.v||0;break;case"s":case"str":I=W.v==null?"":W.v,F["office:value-type"]="string";break;case"d":I=W.w||At(W.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=At(W.v).toISOString(),F["table:style-name"]="ce1";break;default:c.push(t);continue}var A=n(I);if(W.l&&W.l.Target){var X=W.l.Target;X=X.charAt(0)=="#"?"#"+Og(X.slice(1)):X,X.charAt(0)!="#"&&!X.match(/^\w+:/)&&(X="../"+X),A=ie("text:a",A,{"xlink:href":X.replace(/&/g,"&amp;")})}c.push("          "+ie("table:table-cell",ie("text:p",A,{}),F)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var s=0;o.SheetNames.map(function(l){return o.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var d=0;d<l["!cols"].length;++d)if(l["!cols"][d]){var m=l["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Za(m),m.ods=s;var x=l["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),a.push(`  </style:style>
`),++s}}});var c=0;o.SheetNames.map(function(l){return o.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var d=0;d<l["!rows"].length;++d)if(l["!rows"][d]){l["!rows"][d].ods=c;var m=l["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,s){var c=[tt],l=Yr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Yr({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(c.push("<office:document"+l+d+`>
`),c.push(Mc().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)c.push(r(o.Sheets[o.SheetNames[m]],o,m,s));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),s.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function d0(n,t){if(t.bookType=="fods")return js(n,t);var e=Ra(),r="",i=[],a=[];return r="mimetype",Se(e,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Se(e,r,js(n,t)),i.push([r,"text/xml"]),a.push([r,"ContentFile"]),r="styles.xml",Se(e,r,i1(n,t)),i.push([r,"text/xml"]),a.push([r,"StylesFile"]),r="meta.xml",Se(e,r,tt+Mc()),i.push([r,"text/xml"]),a.push([r,"MetadataFile"]),r="manifest.rdf",Se(e,r,hd(a)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Se(e,r,gd(i)),e}function Li(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function a1(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):cn(wn(n))}function o1(n,t){e:for(var e=0;e<=n.length-t.length;++e){for(var r=0;r<t.length;++r)if(n[e+r]!=t[r])continue e;return!0}return!1}function Nn(n){var t=n.reduce(function(i,a){return i+a.length},0),e=new Uint8Array(t),r=0;return n.forEach(function(i){e.set(i,r),r+=i.length}),e}function s1(n,t,e){var r=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,i=e/Math.pow(10,r-6176);n[t+15]|=r>>7,n[t+14]|=(r&127)<<1;for(var a=0;i>=1;++a,i/=256)n[t+a]=i&255;n[t+15]|=e>=0?0:128}function Kr(n,t){var e=t?t[0]:0,r=n[e]&127;e:if(n[e++]>=128&&(r|=(n[e]&127)<<7,n[e++]<128||(r|=(n[e]&127)<<14,n[e++]<128)||(r|=(n[e]&127)<<21,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break e;return t&&(t[0]=e),r}function Le(n){var t=new Uint8Array(7);t[0]=n&127;var e=1;e:if(n>127){if(t[e-1]|=128,t[e]=n>>7&127,++e,n<=16383||(t[e-1]|=128,t[e]=n>>14&127,++e,n<=2097151)||(t[e-1]|=128,t[e]=n>>21&127,++e,n<=268435455)||(t[e-1]|=128,t[e]=n/256>>>21&127,++e,n<=34359738367)||(t[e-1]|=128,t[e]=n/65536>>>21&127,++e,n<=4398046511103))break e;t[e-1]|=128,t[e]=n/16777216>>>21&127,++e}return t.slice(0,e)}function vr(n){var t=0,e=n[t]&127;e:if(n[t++]>=128){if(e|=(n[t]&127)<<7,n[t++]<128||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128))break e;e|=(n[t]&127)<<28}return e}function rt(n){for(var t=[],e=[0];e[0]<n.length;){var r=e[0],i=Kr(n,e),a=i&7;i=Math.floor(i/8);var o=0,s;if(i==0)break;switch(a){case 0:{for(var c=e[0];n[e[0]++]>=128;);s=n.slice(c,e[0])}break;case 5:o=4,s=n.slice(e[0],e[0]+o),e[0]+=o;break;case 1:o=8,s=n.slice(e[0],e[0]+o),e[0]+=o;break;case 2:o=Kr(n,e),s=n.slice(e[0],e[0]+o),e[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(r))}var l={data:s,type:a};t[i]==null?t[i]=[l]:t[i].push(l)}return t}function Ct(n){var t=[];return n.forEach(function(e,r){e.forEach(function(i){i.data&&(t.push(Le(r*8+i.type)),i.type==2&&t.push(Le(i.data.length)),t.push(i.data))})}),Nn(t)}function on(n){for(var t,e=[],r=[0];r[0]<n.length;){var i=Kr(n,r),a=rt(n.slice(r[0],r[0]+i));r[0]+=i;var o={id:vr(a[1][0].data),messages:[]};a[2].forEach(function(s){var c=rt(s.data),l=vr(c[3][0].data);o.messages.push({meta:c,data:n.slice(r[0],r[0]+l)}),r[0]+=l}),(t=a[3])!=null&&t[0]&&(o.merge=vr(a[3][0].data)>>>0>0),e.push(o)}return e}function pr(n){var t=[];return n.forEach(function(e){var r=[];r[1]=[{data:Le(e.id),type:0}],r[2]=[],e.merge!=null&&(r[3]=[{data:Le(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Le(o.data.length)}],r[2].push({data:Ct(o.meta),type:2})});var a=Ct(r);t.push(Le(a.length)),t.push(a),i.forEach(function(o){return t.push(o)})}),Nn(t)}function c1(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e=[0],r=Kr(t,e),i=[];e[0]<t.length;){var a=t[e[0]]&3;if(a==0){var o=t[e[0]++]>>2;if(o<60)++o;else{var s=o-59;o=t[e[0]],s>1&&(o|=t[e[0]+1]<<8),s>2&&(o|=t[e[0]+2]<<16),s>3&&(o|=t[e[0]+3]<<24),o>>>=0,o++,e[0]+=s}i.push(t.slice(e[0],e[0]+o)),e[0]+=o;continue}else{var c=0,l=0;if(a==1?(l=(t[e[0]]>>2&7)+4,c=(t[e[0]++]&224)<<3,c|=t[e[0]++]):(l=(t[e[0]++]>>2)+1,a==2?(c=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(c=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),i=[Nn(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var d=Nn(i);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function sn(n){for(var t=[],e=0;e<n.length;){var r=n[e++],i=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push(c1(r,n.slice(e,e+i))),e+=i}if(e!==n.length)throw new Error("data is not a valid framed stream!");return Nn(t)}function gr(n){for(var t=[],e=0;e<n.length;){var r=Math.min(n.length-e,268435455),i=new Uint8Array(4);t.push(i);var a=Le(r),o=a.length;t.push(a),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(n.slice(e,e+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,e+=r}return Nn(t)}function ka(n,t){var e=new Uint8Array(32),r=Li(e),i=12,a=0;switch(e[0]=5,n.t){case"n":e[1]=2,s1(e,i,n.v),a|=1,i+=16;break;case"b":e[1]=6,r.setFloat64(i,n.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));e[1]=3,r.setUint32(i,t.indexOf(n.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,a,!0),e.slice(0,i)}function Sa(n,t){var e=new Uint8Array(32),r=Li(e),i=12,a=0;switch(e[0]=3,n.t){case"n":e[2]=2,r.setFloat64(i,n.v,!0),a|=32,i+=8;break;case"b":e[2]=6,r.setFloat64(i,n.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));e[2]=3,r.setUint32(i,t.indexOf(n.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,a,!0),e.slice(0,i)}function Fn(n){var t=rt(n);return Kr(t[1][0].data)}function l1(n,t,e){var r,i,a,o;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var s=((o=(a=n[8])==null?void 0:a[0])==null?void 0:o.data)&&vr(n[8][0].data)>0||!1;if(s)throw"Math only works with normal offsets";for(var c=0,l=Li(n[7][0].data),d=0,m=[],x=Li(n[4][0].data),u=0,v=[],h=0;h<t.length;++h){if(t[h]==null){l.setUint16(h*2,65535,!0),x.setUint16(h*2,65535);continue}l.setUint16(h*2,d,!0),x.setUint16(h*2,u,!0);var w,T;switch(typeof t[h]){case"string":w=ka({t:"s",v:t[h]},e),T=Sa({t:"s",v:t[h]},e);break;case"number":w=ka({t:"n",v:t[h]},e),T=Sa({t:"n",v:t[h]},e);break;case"boolean":w=ka({t:"b",v:t[h]},e),T=Sa({t:"b",v:t[h]},e);break;default:throw new Error("Unsupported value "+t[h])}m.push(w),d+=w.length,v.push(T),u+=T.length,++c}for(n[2][0].data=Le(c);h<n[7][0].data.length/2;++h)l.setUint16(h*2,65535,!0),x.setUint16(h*2,65535,!0);return n[6][0].data=Nn(m),n[3][0].data=Nn(v),c}function d1(n,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Gt(e["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(et(r)));var a=Ni(e,{range:r,header:1}),o=["~Sh33tJ5~"];a.forEach(function(D){return D.forEach(function(E){typeof E=="string"&&o.push(E)})});var s={},c=[],l=Ve.read(t.numbers,{type:"base64"});l.FileIndex.map(function(D,E){return[D,l.FullPaths[E]]}).forEach(function(D){var E=D[0],q=D[1];if(E.type==2&&E.name.match(/\.iwa/)){var xe=E.content,be=sn(xe),ue=on(be);ue.forEach(function(de){c.push(de.id),s[de.id]={deps:[],location:q,type:vr(de.messages[0].meta[1][0].data)}})}}),c.sort(function(D,E){return D-E});var d=c.filter(function(D){return D>1}).map(function(D){return[D,Le(D)]});l.FileIndex.map(function(D,E){return[D,l.FullPaths[E]]}).forEach(function(D){var E=D[0],q=D[1];if(E.name.match(/\.iwa/)){var xe=on(sn(E.content));xe.forEach(function(be){be.messages.forEach(function(ue){d.forEach(function(de){be.messages.some(function(We){return vr(We.meta[1][0].data)!=11006&&o1(We.data,de[1])})&&s[de[0]].deps.push(be.id)})})})}});function m(){for(var D=927262;D<2e6;++D)if(!s[D])return D;throw new Error("Too many messages")}for(var x=Ve.find(l,s[1].location),u=on(sn(x.content)),v,h=0;h<u.length;++h){var w=u[h];w.id==1&&(v=w)}var T=Fn(rt(v.messages[0].data)[1][0].data);for(x=Ve.find(l,s[T].location),u=on(sn(x.content)),h=0;h<u.length;++h)w=u[h],w.id==T&&(v=w);for(T=Fn(rt(v.messages[0].data)[2][0].data),x=Ve.find(l,s[T].location),u=on(sn(x.content)),h=0;h<u.length;++h)w=u[h],w.id==T&&(v=w);for(T=Fn(rt(v.messages[0].data)[2][0].data),x=Ve.find(l,s[T].location),u=on(sn(x.content)),h=0;h<u.length;++h)w=u[h],w.id==T&&(v=w);var F=rt(v.messages[0].data);{F[6][0].data=Le(r.e.r+1),F[7][0].data=Le(r.e.c+1);var I=Fn(F[46][0].data),j=Ve.find(l,s[I].location),W=on(sn(j.content));{for(var pe=0;pe<W.length&&W[pe].id!=I;++pe);if(W[pe].id!=I)throw"Bad ColumnRowUIDMapArchive";var A=rt(W[pe].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var X=0;X<=r.e.c;++X){var z=[];z[1]=z[2]=[{type:0,data:Le(X+420690)}],A[1].push({type:2,data:Ct(z)}),A[2].push({type:0,data:Le(X)}),A[3].push({type:0,data:Le(X)})}A[4]=[],A[5]=[],A[6]=[];for(var H=0;H<=r.e.r;++H)z=[],z[1]=z[2]=[{type:0,data:Le(H+726270)}],A[4].push({type:2,data:Ct(z)}),A[5].push({type:0,data:Le(H)}),A[6].push({type:0,data:Le(H)});W[pe].messages[0].data=Ct(A)}j.content=gr(pr(W)),j.size=j.content.length,delete F[46];var K=rt(F[4][0].data);{K[7][0].data=Le(r.e.r+1);var Z=rt(K[1][0].data),_e=Fn(Z[2][0].data);j=Ve.find(l,s[_e].location),W=on(sn(j.content));{if(W[0].id!=_e)throw"Bad HeaderStorageBucket";var Be=rt(W[0].messages[0].data);for(H=0;H<a.length;++H){var Ce=rt(Be[2][0].data);Ce[1][0].data=Le(H),Ce[4][0].data=Le(a[H].length),Be[2][H]={type:Be[2][0].type,data:Ct(Ce)}}W[0].messages[0].data=Ct(Be)}j.content=gr(pr(W)),j.size=j.content.length;var it=Fn(K[2][0].data);j=Ve.find(l,s[it].location),W=on(sn(j.content));{if(W[0].id!=it)throw"Bad HeaderStorageBucket";for(Be=rt(W[0].messages[0].data),X=0;X<=r.e.c;++X)Ce=rt(Be[2][0].data),Ce[1][0].data=Le(X),Ce[4][0].data=Le(r.e.r+1),Be[2][X]={type:Be[2][0].type,data:Ct(Ce)};W[0].messages[0].data=Ct(Be)}j.content=gr(pr(W)),j.size=j.content.length;var at=Fn(K[4][0].data);(function(){for(var D=Ve.find(l,s[at].location),E=on(sn(D.content)),q,xe=0;xe<E.length;++xe){var be=E[xe];be.id==at&&(q=be)}var ue=rt(q.messages[0].data);{ue[3]=[];var de=[];o.forEach(function(xt,Ae){de[1]=[{type:0,data:Le(Ae)}],de[2]=[{type:0,data:Le(1)}],de[3]=[{type:2,data:a1(xt)}],ue[3].push({type:2,data:Ct(de)})})}q.messages[0].data=Ct(ue);var We=pr(E),Ee=gr(We);D.content=Ee,D.size=D.content.length})();var Ft=rt(K[3][0].data);{var Et=Ft[1][0];delete Ft[2];var mt=rt(Et.data);{var It=Fn(mt[2][0].data);(function(){for(var D=Ve.find(l,s[It].location),E=on(sn(D.content)),q,xe=0;xe<E.length;++xe){var be=E[xe];be.id==It&&(q=be)}var ue=rt(q.messages[0].data);{delete ue[6],delete Ft[7];var de=new Uint8Array(ue[5][0].data);ue[5]=[];for(var We=0,Ee=0;Ee<=r.e.r;++Ee){var xt=rt(de);We+=l1(xt,a[Ee],o),xt[1][0].data=Le(Ee),ue[5].push({data:Ct(xt),type:2})}ue[1]=[{type:0,data:Le(r.e.c+1)}],ue[2]=[{type:0,data:Le(r.e.r+1)}],ue[3]=[{type:0,data:Le(We)}],ue[4]=[{type:0,data:Le(r.e.r+1)}]}q.messages[0].data=Ct(ue);var Ae=pr(E),en=gr(Ae);D.content=en,D.size=D.content.length})()}Et.data=Ct(mt)}K[3][0].data=Ct(Ft)}F[4][0].data=Ct(K)}v.messages[0].data=Ct(F);var S=pr(u),G=gr(S);return x.content=G,x.size=x.content.length,l}function f1(n){return function(e){for(var r=0;r!=n.length;++r){var i=n[r];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function no(n){f1([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function p1(n,t){return t.bookType=="ods"?d0(n,t):t.bookType=="numbers"?d1(n,t):t.bookType=="xlsb"?g1(n,t):u1(n,t)}function g1(n,t){hr=1024,n&&!n.SSF&&(n.SSF=jt(qe)),n&&n.SSF&&(Wi(),ji(n.SSF),t.revssf=Vi(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ur?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",r=Xc.indexOf(t.bookType)>-1,i=bc();no(t=t||{});var a=Ra(),o="",s=0;if(t.cellXfs=[],zn(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",Se(a,o,Oc(n.Props,t)),i.coreprops.push(o),Ne(t.rels,2,o,Fe.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var c=[],l=0;l<n.SheetNames.length;++l)(n.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(n.SheetNames[l]);n.Props.SheetNames=c}for(n.Props.Worksheets=n.Props.SheetNames.length,Se(a,o,kc(n.Props,t)),i.extprops.push(o),Ne(t.rels,3,o,Fe.EXT_PROPS),n.Custprops!==n.Props&&Mt(n.Custprops||{}).length>0&&(o="docProps/custom.xml",Se(a,o,Sc(n.Custprops,t)),i.custprops.push(o),Ne(t.rels,4,o,Fe.CUST_PROPS)),s=1;s<=n.SheetNames.length;++s){var d={"!id":{}},m=n.Sheets[n.SheetNames[s-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+s+"."+e,Se(a,o,mh(s-1,o,t,n,d)),i.sheets.push(o),Ne(t.wbrels,-1,"worksheets/sheet"+s+"."+e,Fe.WS[0])}if(m){var u=m["!comments"],v=!1,h="";u&&u.length>0&&(h="xl/comments"+s+"."+e,Se(a,h,Ch(u,h,t)),i.comments.push(h),Ne(d,-1,"../comments"+s+"."+e,Fe.CMNT),v=!0),m["!legacy"]&&v&&Se(a,"xl/drawings/vmlDrawing"+s+".vml",Hc(s,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&Se(a,Pc(o),_r(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+e,Se(a,o,_h(t.Strings,o,t)),i.strs.push(o),Ne(t.wbrels,-1,"sharedStrings."+e,Fe.SST)),o="xl/workbook."+e,Se(a,o,hh(n,o,t)),i.workbooks.push(o),Ne(t.rels,1,o,Fe.WB),o="xl/theme/theme1.xml",Se(a,o,Vc(n.Themes,t)),i.themes.push(o),Ne(t.wbrels,-1,"theme/theme1.xml",Fe.THEME),o="xl/styles."+e,Se(a,o,xh(n,o,t)),i.styles.push(o),Ne(t.wbrels,-1,"styles."+e,Fe.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",Se(a,o,n.vbaraw),i.vba.push(o),Ne(t.wbrels,-1,"vbaProject.bin",Fe.VBA)),o="xl/metadata."+e,Se(a,o,vh(o)),i.metadata.push(o),Ne(t.wbrels,-1,"metadata."+e,Fe.XLMETA),Se(a,"[Content_Types].xml",wc(i,t)),Se(a,"_rels/.rels",_r(t.rels)),Se(a,"xl/_rels/workbook."+e+".rels",_r(t.wbrels)),delete t.revssf,delete t.ssf,a}function u1(n,t){hr=1024,n&&!n.SSF&&(n.SSF=jt(qe)),n&&n.SSF&&(Wi(),ji(n.SSF),t.revssf=Vi(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ur?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",r=Xc.indexOf(t.bookType)>-1,i=bc();no(t=t||{});var a=Ra(),o="",s=0;if(t.cellXfs=[],zn(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",Se(a,o,Oc(n.Props,t)),i.coreprops.push(o),Ne(t.rels,2,o,Fe.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var c=[],l=0;l<n.SheetNames.length;++l)(n.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(n.SheetNames[l]);n.Props.SheetNames=c}n.Props.Worksheets=n.Props.SheetNames.length,Se(a,o,kc(n.Props,t)),i.extprops.push(o),Ne(t.rels,3,o,Fe.EXT_PROPS),n.Custprops!==n.Props&&Mt(n.Custprops||{}).length>0&&(o="docProps/custom.xml",Se(a,o,Sc(n.Custprops,t)),i.custprops.push(o),Ne(t.rels,4,o,Fe.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,s=1;s<=n.SheetNames.length;++s){var m={"!id":{}},x=n.Sheets[n.SheetNames[s-1]],u=(x||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+s+"."+e,Se(a,o,t0(s-1,t,n,m)),i.sheets.push(o),Ne(t.wbrels,-1,"worksheets/sheet"+s+"."+e,Fe.WS[0])}if(x){var v=x["!comments"],h=!1,w="";if(v&&v.length>0){var T=!1;v.forEach(function(F){F[1].forEach(function(I){I.T==!0&&(T=!0)})}),T&&(w="xl/threadedComments/threadedComment"+s+"."+e,Se(a,w,$f(v,d,t)),i.threadedcomments.push(w),Ne(m,-1,"../threadedComments/threadedComment"+s+"."+e,Fe.TCMNT)),w="xl/comments"+s+"."+e,Se(a,w,$c(v,t)),i.comments.push(w),Ne(m,-1,"../comments"+s+"."+e,Fe.CMNT),h=!0}x["!legacy"]&&h&&Se(a,"xl/drawings/vmlDrawing"+s+".vml",Hc(s,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&Se(a,Pc(o),_r(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+e,Se(a,o,Rc(t.Strings,t)),i.strs.push(o),Ne(t.wbrels,-1,"sharedStrings."+e,Fe.SST)),o="xl/workbook."+e,Se(a,o,i0(n,t)),i.workbooks.push(o),Ne(t.rels,1,o,Fe.WB),o="xl/theme/theme1.xml",Se(a,o,Vc(n.Themes,t)),i.themes.push(o),Ne(t.wbrels,-1,"theme/theme1.xml",Fe.THEME),o="xl/styles."+e,Se(a,o,jc(n,t)),i.styles.push(o),Ne(t.wbrels,-1,"styles."+e,Fe.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",Se(a,o,n.vbaraw),i.vba.push(o),Ne(t.wbrels,-1,"vbaProject.bin",Fe.VBA)),o="xl/metadata."+e,Se(a,o,Uc()),i.metadata.push(o),Ne(t.wbrels,-1,"metadata."+e,Fe.XLMETA),d.length>1&&(o="xl/persons/person.xml",Se(a,o,Xf(d,t)),i.people.push(o),Ne(t.wbrels,-1,"persons/person.xml",Fe.PEOPLE)),Se(a,"[Content_Types].xml",wc(i,t)),Se(a,"_rels/.rels",_r(t.rels)),Se(a,"xl/_rels/workbook."+e+".rels",_r(t.wbrels)),delete t.revssf,delete t.ssf,a}function h1(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=yn(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function f0(n,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Jr(t.file,Ve.write(n,{type:Ie?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ve.write(n,t)}function m1(n,t){var e=jt(t||{}),r=p1(n,e);return x1(r,e)}function x1(n,t){var e={},r=Ie?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=r;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=n.FullPaths?Ve.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):n.generate(e);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(zi(i))}return t.password&&typeof encrypt_agile<"u"?f0(encrypt_agile(i,t.password),t):t.type==="file"?Jr(t.file,i):t.type=="string"?zr(i):i}function _1(n,t){var e=t||{},r=Ih(n,e);return f0(r,e)}function mn(n,t,e){e||(e="");var r=e+n;switch(t.type){case"base64":return Xr(wn(r));case"binary":return wn(r);case"string":return n;case"file":return Jr(t.file,r,"utf8");case"buffer":return Ie?Sn(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):mn(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function C1(n,t){switch(t.type){case"base64":return Xr(n);case"binary":return n;case"string":return n;case"file":return Jr(t.file,n,"binary");case"buffer":return Ie?Sn(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Oi(n,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",r=0;r<n.length;++r)e+=String.fromCharCode(n[r]);return t.type=="base64"?Xr(e):t.type=="string"?zr(e):e;case"file":return Jr(t.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+t.type)}}function p0(n,t){H0(),ih(n);var e=jt(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var r=p0(n,e);return e.type="array",zi(r)}var i=0;if(e.sheet&&(typeof e.sheet=="number"?i=e.sheet:i=n.SheetNames.indexOf(e.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return mn(Ah(n,e),e);case"slk":case"sylk":return mn(ef.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"htm":case"html":return mn(s0(n.Sheets[n.SheetNames[i]],e),e);case"txt":return C1(g0(n.Sheets[n.SheetNames[i]],e),e);case"csv":return mn(ro(n.Sheets[n.SheetNames[i]],e),e,"\uFEFF");case"dif":return mn(tf.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"dbf":return Oi(Qd.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"prn":return mn(nf.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"rtf":return mn(df.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"eth":return mn(Bc.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"fods":return mn(d0(n,e),e);case"wk1":return Oi(Fs.sheet_to_wk1(n.Sheets[n.SheetNames[i]],e),e);case"wk3":return Oi(Fs.book_to_wk3(n,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Oi(o0(n,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),_1(n,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return m1(n,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function v1(n){if(!n.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(n.bookType=e.slice(1)),n.bookType=t[n.bookType]||n.bookType}}function En(n,t,e){var r=e||{};return r.type="file",r.file=t,v1(r),p0(n,r)}function b1(n,t,e,r,i,a,o,s){var c=Pt(e),l=s.defval,d=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),m=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:e,enumerable:!1})}catch{x.__rowNum__=e}else x.__rowNum__=e;if(!o||n[e])for(var u=t.s.c;u<=t.e.c;++u){var v=o?n[e][u]:n[r[u]+c];if(v===void 0||v.t===void 0){if(l===void 0)continue;a[u]!=null&&(x[a[u]]=l);continue}var h=v.v;switch(v.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[u]!=null){if(h==null)if(v.t=="e"&&h===null)x[a[u]]=null;else if(l!==void 0)x[a[u]]=l;else if(d&&h===null)x[a[u]]=null;else continue;else x[a[u]]=d&&(v.t!=="n"||v.t==="n"&&s.rawNumbers!==!1)?h:kn(v,h,s);h!=null&&(m=!1)}}return{row:x,isempty:m}}function Ni(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},r=0,i=1,a=[],o=0,s="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},d=l.range!=null?l.range:n["!ref"];switch(l.header===1?r=1:l.header==="A"?r=2:Array.isArray(l.header)?r=3:l.header==null&&(r=0),typeof d){case"string":c=Xe(d);break;case"number":c=Xe(n["!ref"]),c.s.r=d;break;default:c=d}r>0&&(i=0);var m=Pt(c.s.r),x=[],u=[],v=0,h=0,w=Array.isArray(n),T=c.s.r,F=0,I={};w&&!n[T]&&(n[T]=[]);var j=l.skipHidden&&n["!cols"]||[],W=l.skipHidden&&n["!rows"]||[];for(F=c.s.c;F<=c.e.c;++F)if(!(j[F]||{}).hidden)switch(x[F]=kt(F),e=w?n[T][F]:n[x[F]+m],r){case 1:a[F]=F-c.s.c;break;case 2:a[F]=x[F];break;case 3:a[F]=l.header[F-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),s=o=kn(e,null,l),h=I[o]||0,!h)I[o]=1;else{do s=o+"_"+h++;while(I[s]);I[o]=h,I[s]=1}a[F]=s}for(T=c.s.r+i;T<=c.e.r;++T)if(!(W[T]||{}).hidden){var pe=b1(n,c,T,x,r,a,w,l);(pe.isempty===!1||(r===1?l.blankrows!==!1:l.blankrows))&&(u[v++]=pe.row)}return u.length=v,u}var Ws=/"/g;function w1(n,t,e,r,i,a,o,s){for(var c=!0,l=[],d="",m=Pt(e),x=t.s.c;x<=t.e.c;++x)if(r[x]){var u=s.dense?(n[e]||[])[x]:n[r[x]+m];if(u==null)d="";else if(u.v!=null){c=!1,d=""+(s.rawNumbers&&u.t=="n"?u.v:kn(u,null,s));for(var v=0,h=0;v!==d.length;++v)if((h=d.charCodeAt(v))===i||h===a||h===34||s.forceQuotes){d='"'+d.replace(Ws,'""')+'"';break}d=="ID"&&(d='"ID"')}else u.f!=null&&!u.F?(c=!1,d="="+u.f,d.indexOf(",")>=0&&(d='"'+d.replace(Ws,'""')+'"')):d="";l.push(d)}return s.blankrows===!1&&c?null:l.join(o)}function ro(n,t){var e=[],r=t??{};if(n==null||n["!ref"]==null)return"";var i=Xe(n["!ref"]),a=r.FS!==void 0?r.FS:",",o=a.charCodeAt(0),s=r.RS!==void 0?r.RS:`
`,c=s.charCodeAt(0),l=new RegExp((a=="|"?"\\|":a)+"+$"),d="",m=[];r.dense=Array.isArray(n);for(var x=r.skipHidden&&n["!cols"]||[],u=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(x[v]||{}).hidden||(m[v]=kt(v));for(var h=0,w=i.s.r;w<=i.e.r;++w)(u[w]||{}).hidden||(d=w1(n,i,w,m,o,c,a,r),d!=null&&(r.strip&&(d=d.replace(l,"")),(d||r.blankrows!==!1)&&e.push((h++?s:"")+d)));return delete r.dense,e.join("")}function g0(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=ro(n,t);if(typeof Ue>"u"||t.type=="string")return e;var r=Ue.utils.encode(1200,e,"str");return"\xFF\xFE"+r}function P1(n){var t="",e,r="";if(n==null||n["!ref"]==null)return[];var i=Xe(n["!ref"]),a="",o=[],s,c=[],l=Array.isArray(n);for(s=i.s.c;s<=i.e.c;++s)o[s]=kt(s);for(var d=i.s.r;d<=i.e.r;++d)for(a=Pt(d),s=i.s.c;s<=i.e.c;++s)if(t=o[s]+a,e=l?(n[d]||[])[s]:n[t],r="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;r=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)r=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)r=""+e.v;else if(e.t=="b")r=e.v?"TRUE":"FALSE";else if(e.w!==void 0)r="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?r="'"+e.v:r=""+e.v}}c[c.length]=t+"="+r}return c}function u0(n,t,e){var r=e||{},i=+!r.skipHeader,a=n||{},o=0,s=0;if(a&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var c=typeof r.origin=="string"?gt(r.origin):r.origin;o=c.r,s=c.c}var l,d={s:{c:0,r:0},e:{c:s,r:o+t.length-1+i}};if(a["!ref"]){var m=Xe(a["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var x=r.header||[],u=0;t.forEach(function(h,w){Mt(h).forEach(function(T){(u=x.indexOf(T))==-1&&(x[u=x.length]=T);var F=h[T],I="z",j="",W=je({c:s+u,r:o+w+i});l=qr(a,W),F&&typeof F=="object"&&!(F instanceof Date)?a[W]=F:(typeof F=="number"?I="n":typeof F=="boolean"?I="b":typeof F=="string"?I="s":F instanceof Date?(I="d",r.cellDates||(I="n",F=zt(F)),j=r.dateNF||qe[14]):F===null&&r.nullError&&(I="e",F=0),l?(l.t=I,l.v=F,delete l.w,delete l.R,j&&(l.z=j)):a[W]=l={t:I,v:F},j&&(l.z=j))})}),d.e.c=Math.max(d.e.c,s+x.length-1);var v=Pt(o);if(i)for(u=0;u<x.length;++u)a[kt(u+s)+v]={t:"s",v:x[u]};return a["!ref"]=et(d),a}function M1(n,t){return u0(null,n,t)}function qr(n,t,e){if(typeof t=="string"){if(Array.isArray(n)){var r=gt(t);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?qr(n,je(t)):qr(n,je({r:t,c:e||0}))}function O1(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function y1(){return{SheetNames:[],Sheets:{}}}function k1(n,t,e,r){var i=1;if(!e)for(;i<=65535&&n.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||e;for(++i;i<=65535&&n.SheetNames.indexOf(e=o+i)!=-1;++i);}if(r0(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function S1(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=O1(n,t);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[r].Hidden=e}function E1(n,t){return n.z=t,n}function h0(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function T1(n,t,e){return h0(n,"#"+t,e)}function D1(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function A1(n,t,e,r){for(var i=typeof t!="string"?t:Xe(t),a=typeof t=="string"?t:et(t),o=i.s.r;o<=i.e.r;++o)for(var s=i.s.c;s<=i.e.c;++s){var c=qr(n,o,s);c.t="n",c.F=a,delete c.v,o==i.s.r&&s==i.s.c&&(c.f=e,r&&(c.D=!0))}return n}var Te={encode_col:kt,encode_row:Pt,encode_cell:je,encode_range:et,decode_col:Xa,decode_row:$a,split_cell:Xl,decode_cell:gt,decode_range:Gt,format_cell:kn,sheet_add_aoa:hc,sheet_add_json:u0,sheet_add_dom:c0,aoa_to_sheet:Or,json_to_sheet:M1,table_to_sheet:l0,table_to_book:n1,sheet_to_csv:ro,sheet_to_txt:g0,sheet_to_json:Ni,sheet_to_html:s0,sheet_to_formulae:P1,sheet_to_row_object_array:Ni,sheet_get_cell:qr,book_new:y1,book_append_sheet:k1,book_set_sheet_visibility:S1,cell_set_number_format:E1,cell_set_hyperlink:h0,cell_set_internal_link:T1,cell_add_comment:D1,sheet_set_array_formula:A1,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var L_=Hr.version;var Wt=class n{constructor(t){this.http=t;this.loadSpecs()}specsSubject=new st(null);specs$=this.specsSubject.asObservable();loadingSubject=new st(!1);loading$=this.loadingSubject.asObservable();errorSubject=new st(null);error$=this.errorSubject.asObservable();specsData$=null;CALENDAR_DATA_PATH="/data/calendar.json";NOTE_DATA_PATH="/data/note.json";loadSpecs(){if(this.specsData$){this.specsData$.subscribe(t=>this.specsSubject.next(t));return}this.loadingSubject.next(!0),this.errorSubject.next(null),console.log(`[ProjectSpecsService] Loading project specs from separate files:
      - Calendar: ${this.CALENDAR_DATA_PATH}
      - Note: ${this.NOTE_DATA_PATH}`),this.specsData$=_o({calendar:this.http.get(this.CALENDAR_DATA_PATH),note:this.http.get(this.NOTE_DATA_PATH)}).pipe(Kt(({calendar:t,note:e})=>{console.log("[ProjectSpecsService] All project specs loaded successfully"),console.log("[ProjectSpecsService] Available projects: calendar, note"),Object.entries({calendar:t,note:e}).forEach(([i,a])=>{(!a.name||!a.specifications||!a.wbs||!a.ia)&&console.warn(`[ProjectSpecsService] Project '${i}' may have incomplete data`)})}),Kt(({calendar:t,note:e})=>{let r={calendar:t,note:e};this.specsSubject.next(r),this.loadingSubject.next(!1)}),Fr(t=>{let e="Failed to load project specifications";return t instanceof Error?e=t.message:t.status&&(e=`HTTP ${t.status}: ${t.statusText}`),console.error(`[ProjectSpecsService] Error loading specs: ${e}`,t),this.errorSubject.next(e),this.loadingSubject.next(!1),ii(()=>new Error(e))}),vo(1)),this.specsData$.subscribe({next:t=>{console.log("[ProjectSpecsService] Initial subscription successful")},error:t=>{console.error("[ProjectSpecsService] Initial subscription error:",t)}})}getProjectSpec(t){return new gn(e=>{this.specsSubject.subscribe(r=>{r&&r[t]?e.next(r[t]):e.next(void 0),e.complete()})})}getSpecifications(t){return new gn(e=>{this.specsSubject.subscribe(r=>{if(r&&r[t]){let i=r[t].specifications||[];console.log(`[ProjectSpecsService] Loaded ${i.length} specifications for project '${t}'`),e.next(i)}else console.warn(`[ProjectSpecsService] Project '${t}' not found`),e.next([]);e.complete()})})}getWBS(t){return new gn(e=>{this.specsSubject.subscribe(r=>{if(r&&r[t]){let i=r[t].wbs?.tasks||[];console.log(`[ProjectSpecsService] Loaded WBS with ${i.length} tasks for project '${t}'`),e.next(i)}else console.warn(`[ProjectSpecsService] Project '${t}' not found`),e.next([]);e.complete()})})}getIA(t){return new gn(e=>{this.specsSubject.subscribe(r=>{if(r&&r[t]){let i=r[t].ia||{pages:[],userFlows:[]};console.log(`[ProjectSpecsService] Loaded ${i.pages.length} pages and ${i.userFlows.length} user flows for project '${t}'`),e.next(i)}else console.warn(`[ProjectSpecsService] Project '${t}' not found`),e.next({pages:[],userFlows:[]});e.complete()})})}getArchitecture(t){return new gn(e=>{this.specsSubject.subscribe(r=>{if(r&&r[t]){let i=r[t].systemArchitecture;console.log(`[ProjectSpecsService] Loaded architecture for project '${t}'`),e.next(i)}else console.warn(`[ProjectSpecsService] Project '${t}' not found`),e.next(void 0);e.complete()})})}getProjectKeys(){return new gn(t=>{this.specsSubject.subscribe(e=>{e?t.next(Object.keys(e)):t.next([]),t.complete()})})}hasProject(t){return new gn(e=>{this.specsSubject.subscribe(r=>{e.next(!!r&&t in r),e.complete()})})}reloadSpecs(){this.specsData$=null,this.loadSpecs()}getSpecsSync(){let t=this.specsSubject.value;return console.log("[ProjectSpecsService] getSpecsSync called",t?`${Object.keys(t).length} projects available`:"No data"),t}getProjectSpecSync(t){let e=this.specsSubject.value,r=e?e[t]:void 0;return console.log(`[ProjectSpecsService] getProjectSpecSync('${t}') called`,r?"Found":"Not found"),r}debugStatus(){let t=this.specsSubject.value,e=this.loadingSubject.value,r=this.errorSubject.value;console.log("%c[ProjectSpecsService] Debug Status","color: blue; font-weight: bold;"),console.log("  Loading:",e),console.log("  Error:",r),console.log("  Projects loaded:",t?Object.keys(t).join(", "):"None"),console.log("  Full data:",t)}debugProject(t){let e=this.getProjectSpecSync(t);console.log(`%c[ProjectSpecsService] Project: ${t}`,"color: green; font-weight: bold;"),e?(console.log("  Name:",e.displayName),console.log("  Status:",e.overview?.status),console.log("  Specifications:",e.specifications?.length||0),console.log("  WBS Tasks:",e.wbs?.tasks?.length||0),console.log("  IA Pages:",e.ia?.pages?.length||0),console.log("  Architecture:",Object.keys(e.systemArchitecture||{}).length,"fields"),console.log("  Full project:",e)):console.warn(`  Project '${t}' not found`)}static \u0275fac=function(e){return new(e||n)(si(Dn))};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var qi=class n{mergedDataSubject=new st(null);mergedData$=this.mergedDataSubject.asObservable();constructor(){}convertTableToSpecifications(t,e="SPEC"){return t.map((r,i)=>({id:`${e}-${String(i+1).padStart(3,"0")}`,category:`${r.mainCategory} > ${r.midCategory}`,title:r.subCategory||r.midCategory,description:r.request.split(`
`)[0],fullDescription:r.request,mainCategory:r.mainCategory,midCategory:r.midCategory,subCategory:r.subCategory,priority:this.convertScoreToPriority(r.priority),feasibility:this.convertScoreToPriority(r.feasibility),isHighPriority:r.isRed||!1,note:r.note,status:parseFloat(r.feasibility)>=1.5?"\uACC4\uD68D":"\uC9C4\uD589\uC911",version:"v1.0"}))}extractRequirements(t){let e=new Map;return t.forEach(r=>{let i=r.mainCategory;e.has(i)||e.set(i,new Set),r.request.split(`
`).filter(o=>o.trim().length>0).forEach(o=>{e.get(i).add(o.trim())})}),Array.from(e.entries()).map(([r,i])=>({category:r,items:Array.from(i)}))}mergeSpecPlanWithProjectSpec(t,e,r="SPEC"){let i=this.convertTableToSpecifications(e,r),a=this.extractRequirements(e),o=ot($e({},t),{specifications:[...t.specifications||[],...i],requirements:[...t.requirements||[],...a]});return this.mergedDataSubject.next(o),o}mergeAndSave(t,e,r){let i=r[t]||{},a=this.getProjectCode(t),o=this.mergeSpecPlanWithProjectSpec(i,e,a);return ot($e({},r),{[t]:o})}getProjectCode(t){return{calendar:"EZCAL",note:"EZNOTE","calendar-plus":"EZCAL-PLUS"}[t]||t.toUpperCase().substring(0,4)}convertScoreToPriority(t){let e=parseFloat(t);return e>=2?"\uB192\uC74C":e>=1.5?"\uC911\uAC04":"\uB0AE\uC74C"}getHighPriorityItems(t){return t.filter(e=>e.isRed===!0)}getCategoryStatistics(t){let e=new Map;return t.forEach(r=>{let i=r.mainCategory;e.set(i,(e.get(i)||0)+1)}),e}getPriorityStatistics(t){return{high:t.filter(e=>parseFloat(e.priority)>=2).length,medium:t.filter(e=>1.5<=parseFloat(e.priority)&&parseFloat(e.priority)<2).length,low:t.filter(e=>parseFloat(e.priority)<1.5).length,total:t.length}}getFeasibilityStatistics(t){return{high:t.filter(e=>parseFloat(e.feasibility)>=2).length,medium:t.filter(e=>1.5<=parseFloat(e.feasibility)&&parseFloat(e.feasibility)<2).length,low:t.filter(e=>parseFloat(e.feasibility)<1.5).length,total:t.length}}convertToJSON(t){return JSON.stringify(t,null,2)}convertToCSV(t){let e=["ID","\uB300\uBD84\uB958","\uC911\uBD84\uB958","\uC18C\uBD84\uB958","\uC758\uB8B0 \uB0B4\uC6A9","\uBC18\uC601\uC694\uCCAD","\uBC18\uC601\uAC00\uB2A5","\uBE44\uACE0"],r=t.map(a=>[a.id.toString(),a.mainCategory,a.midCategory,a.subCategory,a.request.replace(/\n/g," | "),a.priority,a.feasibility,a.note.replace(/\n/g," | ")]);return[e.join(","),...r.map(a=>a.map(o=>`"${o}"`).join(","))].join(`
`)}getMergedData$(){return this.mergedData$}getMergedDataSync(){return this.mergedDataSubject.value}reset(){this.mergedDataSubject.next(null)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var Zi=class n{http=ct(Dn);apiBase="/api/desk/projects";syncStatusSubject=new st("idle");syncStatus$=this.syncStatusSubject.asObservable();syncErrorSubject=new st(null);syncError$=this.syncErrorSubject.asObservable();saveCalendar(t,e,r){this.syncStatusSubject.next("syncing"),this.syncErrorSubject.next(null);let i={projectId:t,specData:e,version:r};return this.http.post(`${this.apiBase}/calendar`,i).pipe(Kt(()=>{this.syncStatusSubject.next("idle"),console.log("[DeskSync] Calendar saved successfully")}),Fr(a=>this.handleError(a)))}saveNote(t,e,r){this.syncStatusSubject.next("syncing"),this.syncErrorSubject.next(null);let i={projectId:t,specData:e,version:r};return this.http.post(`${this.apiBase}/note`,i).pipe(Kt(()=>{this.syncStatusSubject.next("idle"),console.log("[DeskSync] Note saved successfully")}),Fr(a=>this.handleError(a)))}getCalendar(t){return this.http.get(`${this.apiBase}/calendar/${t}`)}getNote(t){return this.http.get(`${this.apiBase}/note/${t}`)}getSyncHistory(t,e=50){return this.http.get(`${this.apiBase}/${t}/sync-history?limit=${e}`)}handleError(t){let e="Unknown error occurred";return t.error instanceof ErrorEvent?e=`Error: ${t.error.message}`:t.status===409?e=`Conflict: ${t.error?.error?.message||"Version mismatch"}`:e=`Server Error: ${t.status}`,this.syncStatusSubject.next("error"),this.syncErrorSubject.next(e),console.error("[DeskSync] Error:",e),ii(()=>new Error(e))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var Sr=class n{deskSync=ct(Zi);CALENDAR_PROJECT_ID="EZCAL-001";NOTE_PROJECT_ID="EZNOTE-001";LOCAL_STORAGE_KEY_CALENDAR="desk_calendar_meta";LOCAL_STORAGE_KEY_NOTE="desk_note_meta";localVersionsSubject=new st(new Map);localVersions$=this.localVersionsSubject.asObservable();localChecksumsSubject=new st(new Map);localChecksums$=this.localChecksumsSubject.asObservable();constructor(){this.loadLocalMetadata()}loadLocalMetadata(){let t=JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_KEY_CALENDAR)||"{}"),e=JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_KEY_NOTE)||"{}"),r=new Map([["calendar",t.version||0],["note",e.version||0]]),i=new Map([["calendar",t.checksum||""],["note",e.checksum||""]]);this.localVersionsSubject.next(r),this.localChecksumsSubject.next(i),console.log("[ProjectSpecsSync] Local metadata loaded","Calendar v"+(t.version||0),"Note v"+(e.version||0))}saveLocalMetadata(t,e,r){let i=t==="calendar"?this.LOCAL_STORAGE_KEY_CALENDAR:this.LOCAL_STORAGE_KEY_NOTE;localStorage.setItem(i,JSON.stringify({version:e,checksum:r,lastUpdated:new Date().toISOString()}));let a=this.localVersionsSubject.value,o=this.localChecksumsSubject.value;a.set(t,e),o.set(t,r),this.localVersionsSubject.next(a),this.localChecksumsSubject.next(o),console.log(`[ProjectSpecsSync] ${t} metadata saved - v${e}`)}generateChecksum(t){let e=JSON.stringify(t),r=0;for(let i=0;i<e.length;i++){let a=e.charCodeAt(i);r=(r<<5)-r+a,r=r&r}return Math.abs(r).toString(16)}saveCalendarToDb(t){return bn(this,null,function*(){let e=this.localVersionsSubject.value.get("calendar")||0,r=this.generateChecksum(t);try{let i=yield this.deskSync.saveCalendar(this.CALENDAR_PROJECT_ID,t,e).toPromise();i&&(this.saveLocalMetadata("calendar",i.version,i.checksum),console.log("[ProjectSpecsSync] Calendar synced to DB",i))}catch(i){throw console.error("[ProjectSpecsSync] Calendar sync failed",i),i}})}saveNoteToDb(t){return bn(this,null,function*(){let e=this.localVersionsSubject.value.get("note")||0,r=this.generateChecksum(t);try{let i=yield this.deskSync.saveNote(this.NOTE_PROJECT_ID,t,e).toPromise();i&&(this.saveLocalMetadata("note",i.version,i.checksum),console.log("[ProjectSpecsSync] Note synced to DB",i))}catch(i){throw console.error("[ProjectSpecsSync] Note sync failed",i),i}})}loadFromDb(t){return bn(this,null,function*(){try{let e=t==="calendar"?this.CALENDAR_PROJECT_ID:this.NOTE_PROJECT_ID,r;t==="calendar"?r=yield this.deskSync.getCalendar(e).toPromise():r=yield this.deskSync.getNote(e).toPromise();let i=r.specData,a=this.generateChecksum(i);return this.saveLocalMetadata(t,r.version,a),console.log(`[ProjectSpecsSync] ${t} loaded from DB`,r),i}catch(e){throw console.error(`[ProjectSpecsSync] Load ${t} from DB failed`,e),e}})}hasLocalChanges(t,e){let r=this.localChecksumsSubject.value.get(t)||"",i=this.generateChecksum(e),a=r!==i;return a&&console.log(`[ProjectSpecsSync] ${t} has local changes`,"stored:",r.substring(0,8),"current:",i.substring(0,8)),a}getSyncHistory(t,e=50){return bn(this,null,function*(){try{let r=t==="calendar"?this.CALENDAR_PROJECT_ID:this.NOTE_PROJECT_ID,i=yield this.deskSync.getSyncHistory(r,e).toPromise();return console.log(`[ProjectSpecsSync] Sync history loaded for ${t}`,i),i}catch(r){throw console.error("[ProjectSpecsSync] Failed to get sync history",r),r}})}getLocalVersion(t){return this.localVersionsSubject.value.get(t)||0}getLocalChecksum(t){return this.localChecksumsSubject.value.get(t)||""}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};function m0(n){let t=new Map;return n.forEach(e=>{let r=e.mainCategory;t.has(r)||t.set(r,[]),t.get(r).push(e)}),t}function x0(n){return{id:`REQ-${n.id}`,title:n.subCategory||n.request.split(`
`)[0],description:n.request,category:n.mainCategory,subcategory:n.midCategory,priority:n.priority,feasibility:n.feasibility,status:parseFloat(n.feasibility)>=1.5?"\uAC00\uB2A5":"\uAC80\uD1A0 \uD544\uC694",note:n.note,isRed:n.isRed||!1}}var F1=(n,t)=>t.id;function I1(n,t){if(n&1&&(Ze(0,"td",16),g(1),Ye()),n&2){let e=k(),r=e.$implicit,i=e.$index,a=k();Lt("rowspan",a.getMainCategorySpan(i)),_(),ge(" ",r.mainCategory," ")}}function B1(n,t){if(n&1&&(Ze(0,"td",17),g(1),Ye()),n&2){let e=k(),r=e.$implicit,i=e.$index,a=k();Lt("rowspan",a.getMidCategorySpan(i)),_(),ge(" ",r.midCategory," ")}}function R1(n,t){if(n&1&&(Ze(0,"div",21),g(1),Ye()),n&2){let e=k().$implicit;_(),ge(" Added: ",e.addedDate," ")}}function L1(n,t){if(n&1&&(Ze(0,"tr",12)(1,"td",14)(2,"span",15),g(3),Ye()(),ae(4,I1,2,2,"td",16),ae(5,B1,2,2,"td",17),Ze(6,"td",18),g(7),Ye(),Ze(8,"td",19)(9,"div",20)(10,"div"),g(11),Ye(),ae(12,R1,2,1,"div",21),Ye()(),Ze(13,"td",22)(14,"span"),g(15),Ye()(),Ze(16,"td",22)(17,"span"),g(18),Ye()(),Ze(19,"td",23),g(20),Ye()()),n&2){let e=t.$implicit,r=t.$index,i=k();_(3),ge(" ",e.id," "),_(),oe(i.shouldShowMainCategory(r)?4:-1),_(),oe(i.shouldShowMidCategory(r)?5:-1),_(2),ge(" ",e.subCategory," "),_(3),ve("text-red-600",e.isRed)("font-semibold",e.isRed),_(),ge(" ",e.request," "),_(),oe(e.addedDate?12:-1),_(2),dt(i.getScoreClass(e.priority)),_(),ge(" ",e.priority," "),_(2),dt(i.getScoreClass(e.feasibility)),_(),ge(" ",e.feasibility," "),_(2),ge(" ",e.note," ")}}var Er=class n{set folderType(t){this.currentFolderType=t,this.loadTableData(t)}http=ct(Dn);specPlanMergeService=ct(qi);specsSyncService=ct(Sr);destroy$=new tn;dataChange$=new tn;currentFolderType="calendar";CALENDAR_DATA_PATH="./data/calendar.json";NOTE_DATA_PATH="./data/note.json";calendarData=[];noteData=[];tableData=$n([]);syncStatus=$n("idle");lastSyncTime=$n("");syncError=$n("");ngOnInit(){this.loadTableData(this.currentFolderType),this.setupAutoSaveListener()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupAutoSaveListener(){this.dataChange$.pipe(ai(1e4),wo(()=>{this.syncStatus.set("syncing");let t=this.mergeToProjectSpec();return this.currentFolderType==="calendar"?new Promise((e,r)=>{this.specsSyncService.saveCalendarToDb(t).then(()=>{this.syncStatus.set("success"),this.lastSyncTime.set(new Date().toLocaleTimeString("ko-KR")),this.syncError.set(""),setTimeout(()=>this.syncStatus.set("idle"),2e3),e()}).catch(i=>{this.syncStatus.set("error"),this.syncError.set(i.message||"Calendar sync failed"),r(i)})}):new Promise((e,r)=>{this.specsSyncService.saveNoteToDb(t).then(()=>{this.syncStatus.set("success"),this.lastSyncTime.set(new Date().toLocaleTimeString("ko-KR")),this.syncError.set(""),setTimeout(()=>this.syncStatus.set("idle"),2e3),e()}).catch(i=>{this.syncStatus.set("error"),this.syncError.set(i.message||"Note sync failed"),r(i)})})}),nt(this.destroy$)).subscribe({next:()=>{console.log("[SpecPlan] Auto-save completed for",this.currentFolderType)},error:t=>{console.error("[SpecPlan] Auto-save failed:",t)}})}notifyDataChange(){this.dataChange$.next()}loadTableData(t){let e=t==="note"?this.NOTE_DATA_PATH:this.CALENDAR_DATA_PATH;this.http.get(e).pipe(nt(this.destroy$)).subscribe({next:r=>{t==="note"?(this.noteData=r.specifications||[],this.tableData.set(this.noteData)):(this.calendarData=r.specifications||[],this.tableData.set(this.calendarData))},error:r=>{console.error(`[SpecPlan] ${t} \uB370\uC774\uD130 \uB85C\uB4DC \uC2E4\uD328:`,r),this.tableData.set([])}})}shouldShowMainCategory(t){return t===0?!0:this.tableData()[t].mainCategory!==this.tableData()[t-1].mainCategory}getMainCategorySpan(t){let e=this.tableData()[t].mainCategory,r=0;for(let i=t;i<this.tableData().length&&this.tableData()[i].mainCategory===e;i++)r++;return r}shouldShowMidCategory(t){if(t===0)return!0;let e=this.tableData()[t],r=this.tableData()[t-1];return e.midCategory!==r.midCategory||e.mainCategory!==r.mainCategory}getMidCategorySpan(t){let e=this.tableData()[t],r=0;for(let i=t;i<this.tableData().length&&(this.tableData()[i].midCategory===e.midCategory&&this.tableData()[i].mainCategory===e.mainCategory);i++)r++;return r}getScoreClass(t){let e="inline-block px-2 py-0.5 rounded-full font-bold text-xs ",r=parseFloat(t);return r>=2?e+"bg-red-100 text-red-700 border border-red-200":r>=1.5?e+"bg-blue-100 text-blue-700 border border-blue-200":e+"bg-green-100 text-green-700 border border-green-200"}convertToSpecifications(t="SPEC"){return this.specPlanMergeService.convertTableToSpecifications(this.tableData(),t)}getCategories(){return m0(this.tableData())}getRequirements(){return this.specPlanMergeService.extractRequirements(this.tableData())}mergeToProjectSpec(t){return this.specPlanMergeService.mergeSpecPlanWithProjectSpec(t||{},this.tableData(),"SPEC")}getHighPriorityItems(){return this.specPlanMergeService.getHighPriorityItems(this.tableData())}getPriorityStats(){return this.specPlanMergeService.getPriorityStatistics(this.tableData())}getFeasibilityStats(){return this.specPlanMergeService.getFeasibilityStatistics(this.tableData())}convertRowToRequirement(t){return x0(t)}exportAsJSON(){let t=this.mergeToProjectSpec();return this.specPlanMergeService.convertToJSON(t)}exportAsCSV(){return this.specPlanMergeService.convertToCSV(this.tableData())}getStatistics(){return{total:this.tableData().length,categories:new Set(this.tableData().map(t=>t.mainCategory)).size,highPriority:this.getHighPriorityItems().length,priorityStats:this.getPriorityStats(),feasibilityStats:this.getFeasibilityStats()}}getCategoryStats(){return this.specPlanMergeService.getCategoryStatistics(this.tableData())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=yt({type:n,selectors:[["app-spec-plan"]],inputs:{folderType:"folderType"},decls:31,vars:0,consts:[[1,"spec-plan-container"],[1,"spec-plan-wrapper"],[1,"spec-plan-header"],[1,"spec-plan-table-wrapper"],[1,"w-full","border-collapse","text-xs","sm:text-sm"],[1,"bg-black","text-white"],[1,"border","border-gray-600","p-2","w-12","text-center"],[1,"border","border-gray-600","p-2","w-24"],[1,"border","border-gray-600","p-2","w-32"],[1,"border","border-gray-600","p-2","min-w-[300px]"],[1,"border","border-gray-600","p-2","w-20","text-center"],[1,"border","border-gray-600","p-2","w-40"],[1,"hover:bg-gray-50","transition-colors"],[1,"spec-plan-footer"],[1,"border","border-gray-300","p-2","text-center","text-gray-500"],[1,"flex","items-center","justify-center","gap-1"],[1,"border","border-gray-300","p-2","font-bold","bg-[#d9ead3]","text-center","align-middle"],[1,"border","border-gray-300","p-2","font-medium","align-middle"],[1,"border","border-gray-300","p-2","align-top","text-gray-700"],[1,"border","border-gray-300","p-2","align-top","whitespace-pre-line","leading-relaxed"],[1,"flex","flex-col","gap-1"],[1,"text-[10px]","text-gray-400","mt-1"],[1,"border","border-gray-300","p-2","text-center"],[1,"border","border-gray-300","p-2","align-top","text-xs","text-gray-600","italic"]],template:function(e,r){e&1&&(Ze(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),g(4,"\uAE30\uB2A5 \uC694\uAD6C\uC0AC\uD56D \uBA85\uC138\uC11C (\uAE30\uD68D\uC548)"),Ye()(),Ze(5,"div",3)(6,"table",4)(7,"thead")(8,"tr",5)(9,"th",6),g(10,"no."),Ye(),Ze(11,"th",7),g(12,"\uB300\uBD84\uB958"),Ye(),Ze(13,"th",8),g(14,"\uC911\uBD84\uB958"),Ye(),Ze(15,"th",8),g(16,"\uC18C\uBD84\uB958"),Ye(),Ze(17,"th",9),g(18,"\uC758\uB8B0 \uB0B4\uC6A9"),Ye(),Ze(19,"th",10),g(20,"\uBC18\uC601\uC694\uCCAD"),Ye(),Ze(21,"th",10),g(22,"\uBC18\uC601\uAC00\uB2A5"),Ye(),Ze(23,"th",11),g(24,"\uBE44\uACE0"),Ye()()(),Ze(25,"tbody"),ye(26,L1,21,17,"tr",12,F1),Ye()()(),Ze(28,"div",13)(29,"p"),g(30,"\xA9 2024 UI/UX Planning Document"),Ye()()()()),e&2&&(_(26),ke(r.tableData()))},dependencies:[hi],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.spec-plan-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;background:#f9fafb;padding:16px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.spec-plan-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#fff;border-radius:8px;border:1px solid #e5e7eb;box-shadow:0 10px 15px -3px #0000001a;overflow:hidden;flex:1;min-height:0}.spec-plan-header[_ngcontent-%COMP%]{flex-shrink:0;background:#1e293b;padding:16px;border-bottom:1px solid #e5e7eb}.spec-plan-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:700;color:#fff;text-align:center}.spec-plan-table-wrapper[_ngcontent-%COMP%]{flex:1;overflow:auto;min-height:0}.spec-plan-footer[_ngcontent-%COMP%]{flex-shrink:0;padding:16px;background:#f3f4f6;border-top:1px solid #e5e7eb}.spec-plan-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px;color:#9ca3af;text-align:right;font-style:italic}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{word-break:keep-all}"],changeDetection:0})};var z1=(n,t)=>t.id+"_"+n,j1=(n,t)=>t.category+"_"+n,W1=(n,t)=>t+"_"+n;function V1(n,t){if(n&1&&ee(0,"app-spec-plan",15),n&2){let e=k(2);we("folderType",e.folderType)}}function U1(n,t){if(n&1&&(f(0,"div",39)(1,"h3"),g(2,"PC Environment"),p(),f(3,"div",40)(4,"span",41),g(5,"Structure"),p(),f(6,"span",42),g(7),p()(),f(8,"div",40)(9,"span",41),g(10,"Sidebar"),p(),f(11,"span",42),g(12),p()(),f(13,"div",40)(14,"span",41),g(15,"Scroll"),p(),f(16,"span",42),g(17),p()()(),f(18,"div",43)(19,"h3"),g(20,"Mobile Environment"),p(),f(21,"div",40)(22,"span",41),g(23,"Structure"),p(),f(24,"span",42),g(25),p()(),f(26,"div",40)(27,"span",41),g(28,"Navigation"),p(),f(29,"span",42),g(30),p()(),f(31,"div",40)(32,"span",41),g(33,"Experience"),p(),f(34,"span",42),g(35),p()()()),n&2){let e=k(3);_(7),ne(e.currentProjectSpec.layoutStrategy.desktop.structure),_(5),ne(e.currentProjectSpec.layoutStrategy.desktop.sidebar),_(5),ne(e.currentProjectSpec.layoutStrategy.desktop.scroll),_(8),ne(e.currentProjectSpec.layoutStrategy.mobile.structure),_(5),ne(e.currentProjectSpec.layoutStrategy.mobile.sidebar),_(5),ne(e.currentProjectSpec.layoutStrategy.mobile.scroll)}}function H1(n,t){if(n&1&&(f(0,"span",52),g(1),p()),n&2){let e=k().$implicit;_(),ne(e.addedDate)}}function $1(n,t){if(n&1&&(f(0,"tr")(1,"td",44),g(2),p(),f(3,"td",45),g(4),p(),f(5,"td",45),g(6),p(),f(7,"td",45),g(8),p(),f(9,"td",46)(10,"span",47),g(11),p()(),f(12,"td",48),g(13),p(),f(14,"td",48),g(15),p(),f(16,"td",49)(17,"span",50),g(18),p()(),f(19,"td",51),ae(20,H1,2,1,"span",52),p()()),n&2){let e=t.$implicit,r=k(3);_(2),ne(e.id),_(2),ne(e.mainCategory),_(2),ne(e.subCategory),_(2),ne(e.subSubCategory),_(3),ne(e.title),_(2),ne(e.pcSpec),_(2),ne(e.mobileSpec),_(2),dt(r.getStatusClass(e.status)),_(),ne(e.status),_(2),oe(e.addedDate?20:-1)}}function X1(n,t){if(n&1&&(f(0,"li"),g(1),p()),n&2){let e=t.$implicit;_(),ne(e)}}function G1(n,t){if(n&1&&(f(0,"div",38)(1,"h4"),g(2),p(),f(3,"ul"),ye(4,X1,2,1,"li",null,W1),p()()),n&2){let e=t.$implicit;_(2),ne(e.category),_(2),ke(e.items)}}function Y1(n,t){if(n&1&&(f(0,"section",16)(1,"div",17)(2,"span",18),g(3,"\u{1F4CA}"),p(),f(4,"h2"),g(5,"Project Overview"),p()(),f(6,"div",19)(7,"div",20)(8,"span",12),g(9,"Project Title"),p(),f(10,"span",21),g(11),p()(),f(12,"div",22)(13,"span",12),g(14,"Objective"),p(),f(15,"span",21),g(16),p()(),f(17,"div",20)(18,"span",12),g(19,"Target Users"),p(),f(20,"span",21),g(21),p()(),f(22,"div",20)(23,"span",12),g(24,"Platform"),p(),f(25,"span",21),g(26),p()(),f(27,"div",20)(28,"span",12),g(29,"Status"),p(),f(30,"span",23),g(31),p()(),f(32,"div",20)(33,"span",12),g(34,"Scope"),p(),f(35,"span",21),g(36),p()()()(),f(37,"section",16)(38,"div",17)(39,"span",18),g(40,"\u{1F4F1}"),p(),f(41,"h2"),g(42,"UI/UX Layout Strategy"),p()(),f(43,"div",24),ae(44,U1,36,6),p()(),f(45,"section",16)(46,"div",17)(47,"span",18),g(48,"\u2699\uFE0F"),p(),f(49,"h2"),g(50,"Functional Specifications"),p()(),f(51,"div",25)(52,"table",26)(53,"thead")(54,"tr")(55,"th",27),g(56,"ID"),p(),f(57,"th",28),g(58,"\uB300\uBD84\uB958"),p(),f(59,"th",28),g(60,"\uC911\uBD84\uB958"),p(),f(61,"th",28),g(62,"\uC18C\uBD84\uB958"),p(),f(63,"th",29),g(64,"Feature"),p(),f(65,"th"),g(66,"PC Specification"),p(),f(67,"th"),g(68,"Mobile Specification"),p(),f(69,"th",30),g(70,"Status"),p(),f(71,"th",31),g(72,"Added Date"),p()()(),f(73,"tbody"),ye(74,$1,21,11,"tr",null,z1),p()()()(),f(76,"div",32)(77,"section",16)(78,"div",17)(79,"span",18),g(80,"\u{1F3D7}\uFE0F"),p(),f(81,"h2"),g(82,"Architecture"),p()(),f(83,"div",33)(84,"div",34)(85,"span",35),g(86,"Frontend"),p(),f(87,"span",36),g(88),p()(),f(89,"div",34)(90,"span",35),g(91,"Backend"),p(),f(92,"span",36),g(93),p()(),f(94,"div",34)(95,"span",35),g(96,"DB"),p(),f(97,"span",36),g(98),p()(),f(99,"div",34)(100,"span",35),g(101,"Deploy"),p(),f(102,"span",36),g(103),p()()()(),f(104,"section",16)(105,"div",17)(106,"span",18),g(107,"\u{1F4DD}"),p(),f(108,"h2"),g(109,"Key Requirements"),p()(),f(110,"div",37),ye(111,G1,6,1,"div",38,j1),p()()()),n&2){let e=k(2);_(11),ne(e.currentProjectSpec.overview.projectName),_(5),ne(e.currentProjectSpec.overview.objective),_(5),ne(e.currentProjectSpec.overview.targetUsers),_(5),ne(e.currentProjectSpec.overview.platforms),_(5),ne(e.currentProjectSpec.overview.status),_(5),ne(e.currentProjectSpec.overview.mainScope),_(8),oe(e.currentProjectSpec.layoutStrategy?44:-1),_(30),ke(e.currentProjectSpec.specifications),_(14),ne(e.currentProjectSpec.systemArchitecture.frontend),_(5),ne(e.currentProjectSpec.systemArchitecture.backend),_(5),ne(e.currentProjectSpec.systemArchitecture.database),_(5),ne(e.currentProjectSpec.systemArchitecture.deployment),_(8),ke(e.currentProjectSpec.requirements)}}function K1(n,t){if(n&1){let e=Oe();f(0,"header",2)(1,"div",3)(2,"div",4)(3,"span",5),g(4,"FUNCTIONAL SPECIFICATION"),p(),f(5,"h1"),g(6),f(7,"span",6),g(8),p()(),f(9,"p",7),g(10),p()(),f(11,"div",8)(12,"div",9)(13,"button",10),re("click",function(){J(e);let i=k();return Q(i.toggleViewMode("standard"))}),g(14,"\uD45C\uC900 \uBA85\uC138"),p(),f(15,"button",10),re("click",function(){J(e);let i=k();return Q(i.toggleViewMode("planning"))}),g(16,"\uAE30\uD68D\uC548 \uBCF4\uAE30"),p()(),f(17,"div",11)(18,"span",12),g(19,"Last Updated:"),p(),f(20,"span",13),g(21),p()()()()(),f(22,"div",14),ae(23,V1,1,1,"app-spec-plan",15)(24,Y1,113,11),p()}if(n&2){let e=k();_(6),ge("",e.currentProjectSpec.displayName," "),_(2),ne(e.currentProjectSpec.overview.version),_(2),ne(e.currentProjectSpec.description),_(3),ve("active",e.viewMode==="standard"),_(2),ve("active",e.viewMode==="planning"),_(6),ne(e.currentProjectSpec.overview.todayDate),_(2),oe(e.viewMode==="planning"?23:24)}}function q1(n,t){n&1&&(f(0,"div",1),ee(1,"div",53),f(2,"p"),g(3,"Loading Functional Specifications..."),p()())}var ar=class n{constructor(t){this.projectSpecsService=t}folderType="calendar";currentProjectSpec=null;isLoading=!1;errorMessage=null;viewMode="planning";showDownloadMenu=!1;destroy$=new tn;ngOnInit(){this.subscribeToProjectSpecs()}ngOnChanges(t){t.folderType&&!t.folderType.firstChange&&this.updateCurrentSpec()}ngAfterViewInit(){this.updateCurrentSpec()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}subscribeToProjectSpecs(){this.projectSpecsService.loading$.pipe(nt(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.projectSpecsService.error$.pipe(nt(this.destroy$)).subscribe(t=>{this.errorMessage=t,t&&console.error("Error loading project specs:",t)}),this.projectSpecsService.specs$.pipe(nt(this.destroy$)).subscribe(()=>{this.updateCurrentSpec()})}updateCurrentSpec(){this.currentProjectSpec=this.projectSpecsService.getProjectSpecSync(this.folderType)||null}toggleViewMode(t){this.viewMode=t}getStatusClass(t){if(!t)return"";let e=t.toLowerCase().replace(" ","");return e.includes("\uC644\uB8CC")||e.includes("complete")||e.includes("done")?"complete":e.includes("\uC9C4\uD589")||e.includes("ongoing")||e.includes("progress")?"ongoing":e.includes("\uB300\uAE30")||e.includes("\uACC4\uD68D")||e.includes("\uAE30\uD68D")||e.includes("pending")?"pending":""}getPriorityClass(t){if(!t)return"";let e=t.toLowerCase();return e.includes("p0")||e.includes("\uB192\uC74C")?"high":e.includes("p1")||e.includes("\uC911\uAC04")?"medium":e.includes("p2")||e.includes("\uB0AE\uC74C")?"low":""}toggleDownloadMenu(){this.showDownloadMenu=!this.showDownloadMenu}downloadDB(){if(!this.currentProjectSpec)return;let t=`${this.currentProjectSpec.name}_DB.json`,e=JSON.stringify(this.currentProjectSpec,null,2),r=new Blob([e],{type:"application/json"}),i=window.URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=t,a.click(),window.URL.revokeObjectURL(i),this.showDownloadMenu=!1}downloadExcel(){if(!this.currentProjectSpec)return;let t=`${this.currentProjectSpec.name}_Spec.xlsx`,e=this.currentProjectSpec.specifications.map(c=>({ID:c.id,\uBD84\uB958:c.category||"",\uD654\uBA74\uBA85:c.title,\uCD94\uAC00\uC77C:c.addedDate||"",\uB0B4\uC6A9:c.description,\uC6B0\uC120\uC21C\uC704:c.priority,\uC0C1\uD0DC:c.status,\uC0C1\uC138:c.details||"",PC\uC0AC\uC591:c.pcSpec||"",Mobile\uC0AC\uC591:c.mobileSpec||""})),r=Te.json_to_sheet(e),i={fill:{fgColor:{rgb:"FF1E293B"}},font:{bold:!0,color:{rgb:"FFFFFFFF"},size:11},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},a={alignment:{vertical:"top",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},o=Te.decode_range(r["!ref"]||"A1");for(let c=o.s.c;c<=o.e.c;++c){let l=Te.encode_col(c)+"1";r[l]&&(r[l].s=i)}for(let c=o.s.r+1;c<=o.e.r;++c)for(let l=o.s.c;l<=o.e.c;++l){let d=Te.encode_cell({r:c,c:l});r[d]&&(r[d].s=a)}r["!cols"]=[{wch:12},{wch:14},{wch:16},{wch:30},{wch:12},{wch:10},{wch:30},{wch:20},{wch:20}];let s=Te.book_new();Te.book_append_sheet(s,r,"Specification"),En(s,t),this.showDownloadMenu=!1}static \u0275fac=function(e){return new(e||n)(lt(Wt))};static \u0275cmp=yt({type:n,selectors:[["app-spec-doc"]],inputs:{folderType:"folderType"},standalone:!1,features:[un],decls:3,vars:1,consts:[[1,"spec-doc-container"],[1,"loading-state"],[1,"spec-header"],[1,"header-content"],[1,"title-group"],[1,"category-tag"],[1,"version"],[1,"subtitle"],[1,"header-right-group"],[1,"view-toggle"],[3,"click"],[1,"update-info"],[1,"label"],[1,"date"],[1,"spec-content"],[3,"folderType"],[1,"section"],[1,"section-title"],[1,"icon"],[1,"summary-grid"],[1,"summary-card"],[1,"value"],[1,"summary-card","highlight"],[1,"value","status-badge"],[1,"strategy-grid"],[1,"table-container"],[1,"spec-table"],["width","60"],["width","140"],["width","150"],["width","80"],["width","100"],[1,"footer-grid"],[1,"arch-box"],[1,"arch-item"],[1,"tag"],[1,"tech"],[1,"req-box"],[1,"req-group"],[1,"strategy-card","pc"],[1,"spec-item"],[1,"spec-label"],[1,"spec-value"],[1,"strategy-card","mobile"],[1,"id-cell"],[1,"category-cell"],[1,"title-cell"],[1,"feature-name"],[1,"desc-cell"],[1,"status-cell"],[1,"badge"],[1,"date-cell"],[1,"added-date"],[1,"spinner"]],template:function(e,r){e&1&&(f(0,"div",0),ae(1,K1,25,9)(2,q1,4,0,"div",1),p()),e&2&&(_(),oe(r.currentProjectSpec?1:2))},dependencies:[Er],styles:['@charset "UTF-8";.spec-doc-container[_ngcontent-%COMP%]{--primary-color: #4f46e5;--secondary-color: #6366f1;--bg-color: #f8fafc;--card-bg: #ffffff;--text-main: #1e293b;--text-muted: #64748b;--accent-pc: #0ea5e9;--accent-mobile: #ec4899;--border-color: #e2e8f0;width:100%;height:100%;background-color:var(--bg-color);overflow-y:auto;font-family:Inter,system-ui,-apple-system,sans-serif;color:var(--text-main)}.spec-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e293b,#334155);color:#fff;padding:40px 30px}.spec-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:flex-end}.spec-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-right-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:12px}.spec-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-right-group[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]{display:flex;background:#ffffff1a;padding:4px;border-radius:8px;gap:4px}.spec-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-right-group[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 14px;border:none;background:transparent;font-size:12px;font-weight:600;color:#ffffffb3;cursor:pointer;border-radius:6px;transition:all .2s}.spec-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-right-group[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#fff;color:#1e293b;box-shadow:0 2px 4px #0000001a}.spec-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-right-group[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(.active){background:#ffffff26;color:#fff}.spec-header[_ngcontent-%COMP%]   .category-tag[_ngcontent-%COMP%]{font-size:12px;font-weight:700;letter-spacing:.1em;color:var(--secondary-color);margin-bottom:8px;display:block}.spec-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:32px;font-weight:800;display:flex;align-items:center;gap:12px}.spec-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .version[_ngcontent-%COMP%]{font-size:14px;font-weight:500;background:#ffffff1a;padding:4px 12px;border-radius:20px;color:#94a3b8}.spec-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:8px 0 0;font-size:16px;color:#94a3b8}.spec-header[_ngcontent-%COMP%]   .update-info[_ngcontent-%COMP%]{text-align:right;font-size:13px;color:#94a3b8}.spec-header[_ngcontent-%COMP%]   .update-info[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#fff;font-weight:600;margin-left:6px}.spec-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:40px 30px}.section[_ngcontent-%COMP%]{margin-bottom:50px}.section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:20px}.section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:700}.section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:24px}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{background:var(--card-bg);padding:20px;border-radius:12px;border:1px solid var(--border-color);display:flex;flex-direction:column;gap:8px}.summary-grid[_ngcontent-%COMP%]   .summary-card.highlight[_ngcontent-%COMP%]{border-left:4px solid var(--primary-color)}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:var(--text-muted);text-transform:uppercase}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:15px;font-weight:500}.strategy-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:25px}.strategy-grid[_ngcontent-%COMP%]   .strategy-card[_ngcontent-%COMP%]{background:var(--card-bg);padding:24px;border-radius:16px;border:1px solid var(--border-color);box-shadow:0 4px 6px -1px #0000000d}.strategy-grid[_ngcontent-%COMP%]   .strategy-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:18px;font-weight:700}.strategy-grid[_ngcontent-%COMP%]   .strategy-card.pc[_ngcontent-%COMP%]{border-top:4px solid var(--accent-pc)}.strategy-grid[_ngcontent-%COMP%]   .strategy-card.pc[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--accent-pc)}.strategy-grid[_ngcontent-%COMP%]   .strategy-card.mobile[_ngcontent-%COMP%]{border-top:4px solid var(--accent-mobile)}.strategy-grid[_ngcontent-%COMP%]   .strategy-card.mobile[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--accent-mobile)}.strategy-grid[_ngcontent-%COMP%]   .strategy-card[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px dashed var(--border-color)}.strategy-grid[_ngcontent-%COMP%]   .strategy-card[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]:last-child{border:none}.strategy-grid[_ngcontent-%COMP%]   .strategy-card[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]   .spec-label[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:var(--text-muted)}.strategy-grid[_ngcontent-%COMP%]   .strategy-card[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]   .spec-value[_ngcontent-%COMP%]{font-size:14px;text-align:right}.table-container[_ngcontent-%COMP%]{background:var(--card-bg);border-radius:16px;border:1px solid var(--border-color);overflow:hidden;box-shadow:0 10px 15px -3px #0000000d}.spec-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;table-layout:auto}.spec-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f1f5f9;padding:12px 10px;text-align:left;font-size:12px;font-weight:700;color:var(--text-muted);border-bottom:1px solid var(--border-color);white-space:nowrap}.spec-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 10px;font-size:13px;border-bottom:1px solid var(--border-color);vertical-align:top;word-break:keep-all}.spec-table[_ngcontent-%COMP%]   .id-cell[_ngcontent-%COMP%]{font-family:monospace;font-weight:600;color:var(--primary-color);font-size:12px}.spec-table[_ngcontent-%COMP%]   .category-cell[_ngcontent-%COMP%]{font-size:11px;color:var(--text-muted);background-color:#f8fafc}.spec-table[_ngcontent-%COMP%]   .title-cell[_ngcontent-%COMP%]{font-weight:600;max-width:250px}.spec-table[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:6px;font-size:11px;font-weight:700}.spec-table[_ngcontent-%COMP%]   .badge.complete[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.spec-table[_ngcontent-%COMP%]   .badge.ongoing[_ngcontent-%COMP%]{background:#fef9c3;color:#854d0e}.spec-table[_ngcontent-%COMP%]   .badge.pending[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569}.spec-table[_ngcontent-%COMP%]   tr.is-new[_ngcontent-%COMP%]{background-color:transparent}.date-cell[_ngcontent-%COMP%]{font-size:11px;color:#64748b;font-family:monospace}.footer-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:30px}.arch-box[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.arch-box[_ngcontent-%COMP%]   .arch-item[_ngcontent-%COMP%]{background:#fff;padding:15px;border-radius:10px;border:1px solid var(--border-color);display:flex;flex-direction:column;gap:4px}.arch-box[_ngcontent-%COMP%]   .arch-item[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:var(--secondary-color);text-transform:uppercase}.arch-box[_ngcontent-%COMP%]   .arch-item[_ngcontent-%COMP%]   .tech[_ngcontent-%COMP%]{font-size:14px;font-weight:600}.req-box[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;border:1px solid var(--border-color)}.req-box[_ngcontent-%COMP%]   .req-group[_ngcontent-%COMP%]{margin-bottom:20px}.req-box[_ngcontent-%COMP%]   .req-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.req-box[_ngcontent-%COMP%]   .req-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:15px;color:var(--primary-color)}.req-box[_ngcontent-%COMP%]   .req-group[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:18px;color:var(--text-muted);font-size:14px}.req-box[_ngcontent-%COMP%]   .req-group[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:5px}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:400px;gap:20px;color:var(--text-muted)}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid var(--border-color);border-top:4px solid var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.spec-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:20px}.summary-grid[_ngcontent-%COMP%], .strategy-grid[_ngcontent-%COMP%], .footer-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.spec-table[_ngcontent-%COMP%]{display:block;overflow-x:auto}}.spec-table[_ngcontent-%COMP%]{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #00000014;border:1px solid #e0e0e0}.table-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 3fr 1.5fr 1.5fr;background:#f8f9fa;border-bottom:1px solid #e0e0e0;font-weight:600;font-size:13px;color:#333}.table-header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:15px 12px;text-align:left}.table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 3fr 1.5fr 1.5fr;border-bottom:1px solid #e0e0e0;font-size:13px;color:#666}.table-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.table-row[_ngcontent-%COMP%]:hover{background:#fafbfc}.table-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:12px;display:flex;align-items:center}.col-id[_ngcontent-%COMP%]{font-weight:600;color:#667eea;flex:0 0 80px}.col-title[_ngcontent-%COMP%]{font-weight:500;color:#333;flex:0 0 150px}.col-description[_ngcontent-%COMP%]{color:#777;flex:1}.col-details[_ngcontent-%COMP%]{color:#999;flex:0 0 120px;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.col-priority[_ngcontent-%COMP%], .col-status[_ngcontent-%COMP%]{justify-content:center;flex:0 0 100px}.badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:12px;font-size:12px;font-weight:600;text-align:center}.badge.priority.high[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.badge.priority.medium[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.badge.priority.low[_ngcontent-%COMP%], .badge.status.in-progress[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.badge.status.completed[_ngcontent-%COMP%]{background:#dcfce7;color:#16a34a}.badge.status.planned[_ngcontent-%COMP%]{background:#e9d5ff;color:#7c3aed}.ui-requirements[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #00000014}.ui-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px}.ui-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:8px 0;color:#555;font-size:14px;line-height:1.6}.ui-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:"\\2713";margin-right:8px;color:#667eea;font-weight:700}.added-date[_ngcontent-%COMP%]{display:inline-block;font-size:10px;color:#64748b;padding:2px 6px;border-radius:4px;background-color:#64748b1a}.feature-name[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;font-weight:500}']})};var Z1=["ganttScrollContainer"],J1=["taskListBody"],_0=(n,t)=>t.id+"_"+n,Q1=(n,t)=>t.name,io=(n,t)=>t.toMillis();function em(n,t){if(n&1){let e=Oe();f(0,"button",60),re("click",function(){J(e);let i=k().$implicit,a=k(2);return Q(a.toggleExpand(i.id))}),Me(),f(1,"svg",61),ee(2,"polyline",62),p()()}if(n&2){let e=k().$implicit,r=k(2);ve("expanded",r.isExpanded(e.id))}}function tm(n,t){n&1&&(f(0,"div",51),Me(),f(1,"svg",63),ee(2,"circle",64),p()())}function nm(n,t){if(n&1){let e=Oe();f(0,"div",65),re("click",function(){J(e);let i=k().$implicit,a=k(2);return Q(a.startEditDate(i.id,"startDate",i.startDate))})("mousedown",function(i){J(e);let a=k().$implicit,o=k(2);return Q(o.onDateTextMouseDown(i,a.id,"startDate"))}),g(1),qt(2,"date"),p()}if(n&2){let e=k().$implicit;_(),ge(" ",Xn(2,1,e.startDate,"MM/dd")," ")}}function rm(n,t){if(n&1){let e=Oe();f(0,"div",66)(1,"input",67),ua("ngModelChange",function(i){J(e);let a=k(3);return ga(a.editingValue,i)||(a.editingValue=i),Q(i)}),re("keyup.enter",function(){J(e);let i=k().$implicit,a=k(2);return Q(a.saveEditDate(i.id,"startDate"))})("keyup.escape",function(){J(e);let i=k(3);return Q(i.cancelEditDate())}),p(),f(2,"button",68),re("click",function(){J(e);let i=k().$implicit,a=k(2);return Q(a.saveEditDate(i.id,"startDate"))}),g(3,"\u2713"),p(),f(4,"button",69),re("click",function(){J(e);let i=k(3);return Q(i.cancelEditDate())}),g(5,"\u2715"),p()()}if(n&2){let e=k(3);_(),pa("ngModel",e.editingValue)}}function im(n,t){if(n&1){let e=Oe();f(0,"div",65),re("click",function(){J(e);let i=k().$implicit,a=k(2);return Q(a.startEditDate(i.id,"endDate",i.endDate))})("mousedown",function(i){J(e);let a=k().$implicit,o=k(2);return Q(o.onDateTextMouseDown(i,a.id,"endDate"))}),g(1),qt(2,"date"),p()}if(n&2){let e=k().$implicit;_(),ge(" ",Xn(2,1,e.endDate,"MM/dd")," ")}}function am(n,t){if(n&1){let e=Oe();f(0,"div",66)(1,"input",67),ua("ngModelChange",function(i){J(e);let a=k(3);return ga(a.editingValue,i)||(a.editingValue=i),Q(i)}),re("keyup.enter",function(){J(e);let i=k().$implicit,a=k(2);return Q(a.saveEditDate(i.id,"endDate"))})("keyup.escape",function(){J(e);let i=k(3);return Q(i.cancelEditDate())}),p(),f(2,"button",68),re("click",function(){J(e);let i=k().$implicit,a=k(2);return Q(a.saveEditDate(i.id,"endDate"))}),g(3,"\u2713"),p(),f(4,"button",69),re("click",function(){J(e);let i=k(3);return Q(i.cancelEditDate())}),g(5,"\u2715"),p()()}if(n&2){let e=k(3);_(),pa("ngModel",e.editingValue)}}function om(n,t){if(n&1&&(f(0,"div",46)(1,"div",19)(2,"div",47),ee(3,"div",48),f(4,"div",49),ae(5,em,3,2,"button",50)(6,tm,3,0,"div",51),p(),f(7,"span",52),g(8),p()()(),f(9,"div",20)(10,"span",53),g(11),p()(),f(12,"div",21)(13,"div",54)(14,"span",55),g(15),p()()(),f(16,"div",56),Ut(17,nm,3,4,"div",57)(18,rm,6,1,"div",58),p(),f(19,"div",59),Ut(20,im,3,4,"div",57)(21,am,6,1,"div",58),p()()),n&2){let e=t.$implicit,r=k(2);ve("level-0",r.getItemLevel(e)===0)("level-1",r.getItemLevel(e)===1)("level-2",r.getItemLevel(e)===2)("group-task",r.hasChildren(e))("progress-high",e.progress>=75)("progress-medium",e.progress>=50&&e.progress<75)("progress-low",e.progress<50),_(3),ve("high",e.progress>=75)("medium",e.progress>=50&&e.progress<75)("low",e.progress<50),_(2),oe(r.hasChildren(e)?5:6),_(2),we("title",e.name),_(),ne(e.name),_(3),ne(e.responsible),_(4),ge("",e.progress,"%"),_(2),we("ngIf",r.editingTaskId!==e.id||r.editingField!=="startDate"),_(),we("ngIf",r.editingTaskId===e.id&&r.editingField==="startDate"),_(2),we("ngIf",r.editingTaskId!==e.id||r.editingField!=="endDate"),_(),we("ngIf",r.editingTaskId===e.id&&r.editingField==="endDate")}}function sm(n,t){if(n&1&&(f(0,"div",70),g(1),p()),n&2){let e=t.$implicit,r=k(2);De("width",e.colSpan*r.columnWidth,"px"),_(),ge(" ",e.name," ")}}function cm(n,t){if(n&1&&(f(0,"div",71),g(1),p()),n&2){let e=t.$implicit,r=k(2);De("width",r.columnWidth,"px"),ve("today",r.isToday(e))("weekend",e.weekday>5),_(),ge(" ",e.day," ")}}function lm(n,t){if(n&1&&(f(0,"div",72),g(1),p()),n&2){let e=t.$implicit,r=k(2);De("width",r.columnWidth,"px"),ve("today",r.isToday(e))("weekend",e.weekday>5),_(),ge(" ",r.getDayName(e)," ")}}function dm(n,t){if(n&1&&ee(0,"div",73),n&2){let e=t.$implicit,r=k(2);De("width",r.columnWidth,"px"),ve("weekend",e.weekday>5)("today",r.isToday(e))}}function fm(n,t){n&1&&ee(0,"div",74),n&2&&De("left",t,"px")}function pm(n,t){if(n&1&&(f(0,"span",82),g(1),p()),n&2){let e=k().$implicit;_(),ge("",e.progress,"%")}}function gm(n,t){if(n&1&&(f(0,"span",82),g(1),p()),n&2){let e=k(2).$implicit;_(),ge("",e.progress,"%")}}function um(n,t){if(n&1&&(f(0,"div",83)(1,"div",84),Ut(2,gm,2,1,"span",79),p()()),n&2){let e=k().$implicit,r=k(2),i=r.getDragPreviewPosition(e.id);De("left",i.left,"px")("width",i.width,"px"),_(),De("background",r.getProgressColor(e.progress)),_(),we("ngIf",i.width>60)}}function hm(n,t){if(n&1){let e=Oe();f(0,"div",75)(1,"div",76)(2,"div",77),re("mousedown",function(i){let a=J(e).$implicit,o=k(2);return Q(o.onGanttBarMouseDown(i,a.id,"start"))}),p(),f(3,"div",78),re("mousedown",function(i){let a=J(e).$implicit,o=k(2);return Q(o.onGanttBarMouseDown(i,a.id,"middle"))}),Ut(4,pm,2,1,"span",79),p(),f(5,"div",80),re("mousedown",function(i){let a=J(e).$implicit,o=k(2);return Q(o.onGanttBarMouseDown(i,a.id,"end"))}),p()(),ae(6,um,3,7,"div",81),p()}if(n&2){let e=t.$implicit,r=k(2);ve("group-row",r.hasChildren(e));let i=r.getTaskPosition(e);_(),De("left",i.left,"px")("width",i.width,"px"),ve("dragging",r.draggingTask===e.id),_(),we("title","\uC2DC\uC791\uC77C \uC870\uC815"),_(),De("background",r.getProgressColor(e.progress)),we("title",e.name+" ("+e.progress+"%) - \uB4DC\uB798\uADF8\uB85C \uC870\uC815"),_(),we("ngIf",i.width>60),_(),we("title","\uC885\uB8CC\uC77C \uC870\uC815"),_(),oe((r.dragPreview==null?null:r.dragPreview.taskId)===e.id?6:-1)}}function mm(n,t){if(n&1){let e=Oe();f(0,"div",3)(1,"div",4)(2,"h2"),g(3),p(),f(4,"div",5)(5,"div",6),ee(6,"div",7),f(7,"span"),g(8,"75% \uC774\uC0C1"),p()(),f(9,"div",6),ee(10,"div",8),f(11,"span"),g(12,"50-75%"),p()(),f(13,"div",6),ee(14,"div",9),f(15,"span"),g(16,"25% \uBBF8\uB9CC"),p()()()(),f(17,"div",10)(18,"div",11)(19,"button",12),re("click",function(){J(e);let i=k();return Q(i.scrollToToday())}),g(20,"\uC624\uB298\uB85C \uC774\uB3D9"),p(),ee(21,"div",13),f(22,"button",14),re("click",function(){J(e);let i=k();return Q(i.updateZoom("day"))}),g(23,"\uC77C"),p(),f(24,"button",14),re("click",function(){J(e);let i=k();return Q(i.updateZoom("week"))}),g(25,"\uC8FC"),p(),f(26,"button",14),re("click",function(){J(e);let i=k();return Q(i.updateZoom("month"))}),g(27,"\uC6D4"),p()()()(),f(28,"div",15)(29,"div",16)(30,"div",17)(31,"div",18)(32,"div",19),g(33,"\uC791\uC5C5\uBA85"),p(),f(34,"div",20),g(35,"\uB2F4\uB2F9"),p(),f(36,"div",21),g(37,"\uC9C4\uCC99"),p(),f(38,"div",22),g(39,"\uC2DC\uC791\uC77C"),p(),f(40,"div",22),g(41,"\uC885\uB8CC\uC77C"),p()()(),f(42,"div",23,0),re("scroll",function(i){J(e);let a=k();return Q(a.onTaskListScroll(i))}),ye(44,om,22,29,"div",24,_0),p()(),f(46,"div",25,1),re("scroll",function(i){J(e);let a=k();return Q(a.onGanttScroll(i))}),f(48,"div",26)(49,"div",27)(50,"div",28),ye(51,sm,2,3,"div",29,Q1),p(),f(53,"div",30),ye(54,cm,2,7,"div",31,io),p(),f(56,"div",32),ye(57,lm,2,7,"div",33,io),p()(),ee(59,"div",34),f(60,"div",35)(61,"div",36),ye(62,dm,1,6,"div",37,io),p(),ae(64,fm,1,2,"div",38),f(65,"div",39),ye(66,hm,7,15,"div",40,_0),p()()()()(),f(68,"div",41)(69,"div",42)(70,"div",43)(71,"div",44),g(72,"\uC804\uCCB4 \uC791\uC5C5 \uC218"),p(),f(73,"div",45),g(74),p()(),f(75,"div",43)(76,"div",44),g(77,"\uC2DC\uC791\uC77C"),p(),f(78,"div",45),g(79),p()(),f(80,"div",43)(81,"div",44),g(82,"\uC885\uB8CC\uC77C"),p(),f(83,"div",45),g(84),p()(),f(85,"div",43)(86,"div",44),g(87,"\uD604\uC7AC \uC2A4\uCF00\uC904"),p(),f(88,"div",45),g(89),p()()()()}if(n&2){let e,r=k();_(3),ge("",r.currentProjectData.name," WBS & Gantt"),_(19),ve("active",r.zoomLevel==="day"),_(2),ve("active",r.zoomLevel==="week"),_(2),ve("active",r.zoomLevel==="month"),_(18),ke(r.renderItems(r.currentProjectData.wbs.tasks)),_(5),De("width",r.timeline.days.length*r.columnWidth,"px"),_(2),ke(r.timeline.months),_(3),ke(r.timeline.days),_(3),ke(r.timeline.days),_(3),De("width",r.timeline.days.length*r.columnWidth,"px"),_(2),ke(r.timeline.days),_(2),oe((e=r.getTodayPosition())?64:-1,e),_(2),ke(r.renderItems(r.currentProjectData.wbs.tasks)),_(8),ge("",r.getAllTasks(r.currentProjectData.wbs.tasks).length,"\uAC1C"),_(5),ne(r.projectStartDate==null?null:r.projectStartDate.toFormat("yyyy-MM-dd")),_(5),ne(r.projectEndDate==null?null:r.projectEndDate.toFormat("yyyy-MM-dd")),_(5),ge("",r.zoomLevel==="day"?"\uC77C\uBCC4":r.zoomLevel==="week"?"\uC8FC\uBCC4":"\uC6D4\uBCC4"," \uBCF4\uAE30")}}var Tn=class n{constructor(t){this.projectSpecsService=t}folderType="calendar";ganttScrollContainer;taskListBody;currentProjectData=null;isLoading=!1;errorMessage=null;expandedItems=new Set;editingTaskId=null;editingField=null;editingValue="";timeline={days:[],months:[]};projectStartDate=null;projectEndDate=null;columnWidth=40;zoomLevel="day";draggingTask=null;dragMode=null;dragStartX=0;dragPreview=null;dateTextDragging=!1;dateTextField=null;dateTextDragStartX=0;dateTextDragStartDate="";destroy$=new tn;ngOnInit(){this.loadExpandedState(),this.subscribeToProjectSpecs()}ngOnChanges(t){t.folderType&&!t.folderType.firstChange&&(this.loadExpandedState(),this.updateCurrentData())}ngAfterViewInit(){this.updateCurrentData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}saveExpandedState(){let t=Array.from(this.expandedItems);localStorage.setItem(`wbs-expanded-${this.folderType}`,JSON.stringify(t))}loadExpandedState(){let t=localStorage.getItem(`wbs-expanded-${this.folderType}`);if(t)try{let e=JSON.parse(t);this.expandedItems=new Set(e)}catch(e){console.error("Failed to load expanded state:",e)}}subscribeToProjectSpecs(){this.projectSpecsService.loading$.pipe(nt(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.projectSpecsService.error$.pipe(nt(this.destroy$)).subscribe(t=>{this.errorMessage=t}),this.projectSpecsService.specs$.pipe(nt(this.destroy$)).subscribe(()=>{this.updateCurrentData()})}updateCurrentData(){let t=this.projectSpecsService.getProjectSpecSync(this.folderType);t&&(this.currentProjectData={name:t.name,wbs:t.wbs},this.currentProjectData.wbs.tasks.length>0&&this.expandedItems.add(this.currentProjectData.wbs.tasks[0].id),this.calculateTimeline())}calculateTimeline(){if(!this.currentProjectData||!this.currentProjectData.wbs.tasks.length)return;let t=this.getAllTasks(this.currentProjectData.wbs.tasks);if(t.length===0)return;let e=t.map(l=>_t.fromISO(l.startDate)).filter(l=>l.isValid),r=t.map(l=>_t.fromISO(l.endDate)).filter(l=>l.isValid);if(e.length===0||r.length===0){console.warn("\uC720\uD6A8\uD55C \uB0A0\uC9DC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let i=_t.min(...e),a=_t.max(...r);if(!i||!a||!i.isValid||!a.isValid)return;this.projectStartDate=i,this.projectEndDate=a,this.projectEndDate.diff(this.projectStartDate,"years").years>5&&(this.projectEndDate=this.projectStartDate.plus({years:1}));let o=[],s=[],c=this.projectStartDate;for(;c<=this.projectEndDate;){o.push(c);let l=c.toFormat("yyyy\uB144 L\uC6D4"),d=s[s.length-1];d&&d.name===l?d.colSpan++:s.push({name:l,colSpan:1}),c=c.plus({days:1})}this.timeline={days:o,months:s}}getAllTasks(t){let e=[];return t.forEach(r=>{e.push(r),r.subtasks&&e.push(...this.getAllTasks(r.subtasks))}),e}getTaskPosition(t){if(!this.projectStartDate)return{left:0,width:0};if(!t.startDate||!t.endDate)return{left:0,width:0};let e=_t.fromISO(t.startDate),r=_t.fromISO(t.endDate);if(!e.isValid||!r.isValid)return{left:0,width:0};let i=e.diff(this.projectStartDate,"days").days,a=r.diff(e,"days").days+1;return{left:i*this.columnWidth,width:a*this.columnWidth}}getTodayPosition(){if(!this.projectStartDate||!this.projectEndDate)return null;let t=_t.now().startOf("day");return t<this.projectStartDate||t>this.projectEndDate?null:t.diff(this.projectStartDate,"days").days*this.columnWidth}scrollingSide=null;onGanttScroll(t){if(this.scrollingSide==="list")return;this.scrollingSide="gantt";let e=t.target;this.taskListBody&&(this.taskListBody.nativeElement.scrollTop=e.scrollTop),this.scrollingSide=null}onTaskListScroll(t){if(this.scrollingSide==="gantt")return;this.scrollingSide="list";let e=t.target;this.ganttScrollContainer&&(this.ganttScrollContainer.nativeElement.scrollTop=e.scrollTop),this.scrollingSide=null}isToday(t){return t.hasSame(_t.now(),"day")}getDayName(t){return["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"][t.weekday%7]}updateZoom(t){switch(this.zoomLevel=t,t){case"day":this.columnWidth=40;break;case"week":this.columnWidth=15;break;case"month":this.columnWidth=5;break}}scrollToToday(){let t=this.getTodayPosition();t!==null&&this.ganttScrollContainer&&this.ganttScrollContainer.nativeElement.scrollTo({left:t-200,behavior:"smooth"})}toggleExpand(t){this.expandedItems.has(t)?this.expandedItems.delete(t):this.expandedItems.add(t),this.saveExpandedState()}isExpanded(t){return this.expandedItems.has(t)}getProgressColor(t){return t===100?"#22c55e":t>0?"#3b82f6":"#94a3b8"}renderItems(t){let e=[];return t.forEach(r=>{e.push(r),r.subtasks&&this.isExpanded(r.id)&&e.push(...this.renderItems(r.subtasks))}),e}getLevel(t,e,r=0){for(let i of t){if(i.id===e)return r;if(i.subtasks){let a=this.getLevel(i.subtasks,e,r+1);if(a>=0)return a}}return 0}hasChildren(t){return!!(t.subtasks&&t.subtasks.length>0)}startEditDate(t,e,r){this.editingTaskId=t,this.editingField=e,this.editingValue=r.toFormat("yyyy-MM-dd")}cancelEditDate(){this.editingTaskId=null,this.editingField=null,this.editingValue=""}saveEditDate(t,e){try{let r=_t.fromISO(this.editingValue);if(!r.isValid){alert("\uC720\uD6A8\uD558\uC9C0 \uC54A\uC740 \uB0A0\uC9DC\uC785\uB2C8\uB2E4.");return}let i=this.findTaskById(this.currentProjectData?.wbs.tasks||[],t);if(i){if(e==="startDate"){if(i.endDate){let a=_t.fromISO(i.endDate);if(r>a){alert("\uC2DC\uC791\uC77C\uC740 \uC885\uB8CC\uC77C\uBCF4\uB2E4 \uD074 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}}i.startDate=this.editingValue}else{if(i.startDate){let a=_t.fromISO(i.startDate);if(r<a){alert("\uC885\uB8CC\uC77C\uC740 \uC2DC\uC791\uC77C\uBCF4\uB2E4 \uC791\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}}i.endDate=this.editingValue}this.calculateTimeline(),this.cancelEditDate()}}catch(r){console.error("\uB0A0\uC9DC \uC800\uC7A5 \uC624\uB958:",r),alert("\uB0A0\uC9DC \uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}}findTaskById(t,e){for(let r of t){if(r.id===e)return r;if(r.subtasks){let i=this.findTaskById(r.subtasks,e);if(i)return i}}return null}onGanttBarMouseDown(t,e,r){t.preventDefault(),t.stopPropagation(),this.draggingTask=e,this.dragMode=r,this.dragStartX=t.clientX;let i=this.findTaskById(this.currentProjectData?.wbs.tasks||[],e);i&&(this.dragPreview={taskId:e,startDate:i.startDate,endDate:i.endDate}),document.addEventListener("mousemove",this.onGanttDrag),document.addEventListener("mouseup",this.onGanttDragEnd)}onGanttDrag=t=>{if(!this.draggingTask||!this.dragMode||!this.dragPreview)return;let e=t.clientX-this.dragStartX,r=Math.round(e/this.columnWidth),i=this.findTaskById(this.currentProjectData?.wbs.tasks||[],this.draggingTask);if(i)try{let a=_t.fromISO(i.startDate),o=_t.fromISO(i.endDate),s=o.diff(a,"days").days;if(this.dragMode==="start"){let c=a.plus({days:r});c<=o&&(this.dragPreview.startDate=c.toISODate())}else if(this.dragMode==="end"){let c=o.plus({days:r});c>=a&&(this.dragPreview.endDate=c.toISODate())}else if(this.dragMode==="middle"){let c=a.plus({days:r}),l=c.plus({days:s});this.dragPreview.startDate=c.toISODate(),this.dragPreview.endDate=l.toISODate()}}catch(a){console.error("\uB4DC\uB798\uADF8 \uBBF8\uB9AC\uBCF4\uAE30 \uC624\uB958:",a)}};onGanttDragEnd=t=>{if(this.draggingTask&&this.dragMode&&this.dragPreview){let e=this.findTaskById(this.currentProjectData?.wbs.tasks||[],this.draggingTask);e&&(e.startDate=this.dragPreview.startDate,e.endDate=this.dragPreview.endDate,this.calculateTimeline())}document.removeEventListener("mousemove",this.onGanttDrag),document.removeEventListener("mouseup",this.onGanttDragEnd),this.draggingTask=null,this.dragMode=null,this.dragPreview=null};getDragPreviewPosition(t){if(!this.dragPreview||this.dragPreview.taskId!==t||!this.projectStartDate)return{left:0,width:0};try{let e=_t.fromISO(this.dragPreview.startDate),r=_t.fromISO(this.dragPreview.endDate);if(!e.isValid||!r.isValid)return{left:0,width:0};let i=e.diff(this.projectStartDate,"days").days,a=r.diff(e,"days").days+1;return{left:i*this.columnWidth,width:Math.max(a*this.columnWidth,30)}}catch{return{left:0,width:0}}}onDateTextMouseDown(t,e,r){t.preventDefault(),t.stopPropagation();let i=this.findTaskById(this.currentProjectData?.wbs.tasks||[],e);i&&(this.dateTextDragging=!0,this.dateTextField=r,this.dateTextDragStartX=t.clientX,this.dateTextDragStartDate=r==="startDate"?i.startDate:i.endDate,document.addEventListener("mousemove",this.onDateTextDrag),document.addEventListener("mouseup",this.onDateTextDragEnd))}onDateTextDrag=t=>{if(!this.dateTextDragging||!this.dateTextField||!this.editingTaskId)return;let e=t.clientX-this.dateTextDragStartX,r=Math.round(e/this.columnWidth);try{let a=_t.fromISO(this.dateTextDragStartDate).plus({days:r});if(!a.isValid)return;this.editingValue=a.toFormat("yyyy-MM-dd")}catch(i){console.error("\uB0A0\uC9DC \uD14D\uC2A4\uD2B8 \uB4DC\uB798\uADF8 \uC624\uB958:",i)}};onDateTextDragEnd=t=>{this.dateTextDragging&&this.editingTaskId&&this.dateTextField&&this.saveEditDate(this.editingTaskId,this.dateTextField),document.removeEventListener("mousemove",this.onDateTextDrag),document.removeEventListener("mouseup",this.onDateTextDragEnd),this.dateTextDragging=!1,this.dateTextField=null,this.dateTextDragStartDate=""};getItemLevel(t){return this.currentProjectData?.wbs.tasks?this.getLevel(this.currentProjectData.wbs.tasks,t.id):0}toggleDownloadMenu(){}downloadDB(){if(!this.currentProjectData)return;let t=`${this.currentProjectData.name}_WBS_DB.json`,e=JSON.stringify(this.currentProjectData,null,2),r=new Blob([e],{type:"application/json"}),i=window.URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=t,a.click(),window.URL.revokeObjectURL(i)}downloadExcel(){if(!this.currentProjectData||!this.currentProjectData.wbs.tasks.length)return;let t=`${this.currentProjectData.name}_WBS.xlsx`,e=[],r=(l,d=0)=>{l.forEach(m=>{e.push({\uB808\uBCA8:d,ID:m.id,\uC791\uC5C5\uBA85:m.name,\uC2DC\uC791\uC77C:m.startDate,\uC885\uB8CC\uC77C:m.endDate,\uC9C4\uD589\uC728:m.progress+"%",\uB2F4\uB2F9\uC790:m.responsible||"",\uC0C1\uD0DC:m.type==="group"?"\uADF8\uB8F9":"\uC791\uC5C5"}),m.subtasks&&m.subtasks.length>0&&r(m.subtasks,d+1)})};r(this.currentProjectData.wbs.tasks);let i=Te.json_to_sheet(e),a={fill:{fgColor:{rgb:"FF2E5090"}},font:{bold:!0,color:{rgb:"FFFFFFFF"},size:11},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},o={alignment:{vertical:"center",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},s=Te.decode_range(i["!ref"]||"A1");for(let l=s.s.c;l<=s.e.c;++l){let d=Te.encode_col(l)+"1";i[d]&&(i[d].s=a)}for(let l=s.s.r+1;l<=s.e.r;++l)for(let d=s.s.c;d<=s.e.c;++d){let m=Te.encode_cell({r:l,c:d});i[m]&&(i[m].s=o)}i["!cols"]=[{wch:8},{wch:12},{wch:25},{wch:15},{wch:15},{wch:10},{wch:15},{wch:12}];let c=Te.book_new();Te.book_append_sheet(c,i,"WBS"),En(c,t)}static \u0275fac=function(e){return new(e||n)(lt(Wt))};static \u0275cmp=yt({type:n,selectors:[["app-wbs-doc"]],viewQuery:function(e,r){if(e&1&&(nn(Z1,5),nn(J1,5)),e&2){let i;rn(i=an())&&(r.ganttScrollContainer=i.first),rn(i=an())&&(r.taskListBody=i.first)}},inputs:{folderType:"folderType"},standalone:!1,features:[un],decls:2,vars:1,consts:[["taskListBody",""],["ganttScrollContainer",""],[1,"wbs-doc-container"],[1,"wbs-header"],[1,"header-left"],[1,"wbs-legend"],[1,"legend-item"],[1,"legend-color",2,"background","#10b981"],[1,"legend-color",2,"background","#f59e0b"],[1,"legend-color",2,"background","#ef4444"],[1,"header-right"],[1,"zoom-controls"],[1,"today-btn",3,"click"],[1,"separator"],[3,"click"],[1,"gantt-wrapper"],[1,"task-list-side"],[1,"side-header"],[1,"header-row"],[1,"col-tree-name"],[1,"col-responsible"],[1,"col-progress"],[1,"col-date"],[1,"side-body",3,"scroll"],[1,"task-row",3,"level-0","level-1","level-2","group-task","progress-high","progress-medium","progress-low"],[1,"gantt-chart-side",3,"scroll"],[1,"gantt-container"],[1,"gantt-header"],[1,"month-row"],[1,"month-cell",3,"width"],[1,"day-row"],[1,"day-cell","num-cell",3,"today","weekend","width"],[1,"day-row","weekday-row"],[1,"day-cell","name-cell",3,"today","weekend","width"],[1,"gantt-body-spacer",2,"height","1px"],[1,"gantt-body"],[1,"gantt-grid"],[1,"grid-column",3,"weekend","today","width"],[1,"today-line-overlay",2,"display","block",3,"left"],[1,"tasks-container"],[1,"gantt-task-row",3,"group-row"],[1,"wbs-summary"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"task-row"],[1,"tree-content"],[1,"progress-indicator"],[1,"tree-icon-wrapper"],[1,"expand-btn",3,"expanded"],[1,"no-expand"],[1,"item-name",3,"title"],[1,"responsible-badge"],[1,"progress-display"],[1,"progress-text"],[1,"date-cell"],["class","date-display date-draggable",3,"click","mousedown",4,"ngIf"],["class","date-edit",4,"ngIf"],[1,"col-date","date-cell"],[1,"expand-btn",3,"click"],["viewBox","0 0 16 16","width","16","height","16",1,"expand-icon"],["points","6 2 12 8 6 14"],["viewBox","0 0 16 16","width","16","height","16",1,"task-icon"],["cx","8","cy","8","r","3"],[1,"date-display","date-draggable",3,"click","mousedown"],[1,"date-edit"],["type","date","autofocus","",1,"date-input",3,"ngModelChange","keyup.enter","keyup.escape","ngModel"],[1,"btn-save",3,"click"],[1,"btn-cancel",3,"click"],[1,"month-cell"],[1,"day-cell","num-cell"],[1,"day-cell","name-cell"],[1,"grid-column"],[1,"today-line-overlay",2,"display","block"],[1,"gantt-task-row"],[1,"task-bar-wrapper"],[1,"gantt-bar-resize","gantt-bar-start",3,"mousedown","title"],[1,"task-bar",3,"mousedown","title"],["class","task-label",4,"ngIf"],[1,"gantt-bar-resize","gantt-bar-end",3,"mousedown","title"],[1,"task-bar-wrapper","task-bar-preview",3,"left","width"],[1,"task-label"],[1,"task-bar-wrapper","task-bar-preview"],[1,"task-bar","task-bar-preview-inner"]],template:function(e,r){e&1&&(f(0,"div",2),ae(1,mm,90,16),p()),e&2&&(_(),oe(r.currentProjectData?1:-1))},dependencies:[lr,zo,jo,Wo,Io],styles:[".wbs-doc-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;background:#fff;padding:0;overflow:hidden;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif}.wbs-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;background:#f8fafc;border-bottom:1px solid #e2e8f0}.wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.25rem;color:#1e293b}.wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .wbs-legend[_ngcontent-%COMP%]{display:flex;gap:16px}.wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .wbs-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:12px;color:#64748b}.wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .wbs-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:2px}.wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]{display:flex;gap:4px;background:#f1f5f9;padding:4px;border-radius:6px}.wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 12px;border:none;background:transparent;font-size:12px;cursor:pointer;border-radius:4px;color:#64748b}.wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#fff;color:#3b82f6;box-shadow:0 1px 3px #0000001a}.wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button.today-btn[_ngcontent-%COMP%]{color:#3b82f6;font-weight:600}.wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button.today-btn[_ngcontent-%COMP%]:hover{background:#3b82f60d}.wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{width:1px;height:16px;background:#e2e8f0;margin:0 4px}.gantt-wrapper[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden;position:relative}.task-list-side[_ngcontent-%COMP%]{width:600px;flex-shrink:0;display:flex;flex-direction:column;border-right:1px solid #e2e8f0;background:#fff;z-index:10;overflow:hidden}.task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]{height:90px;background:#f8fafc;border-bottom:1px solid #e2e8f0;font-weight:600;font-size:11px;color:#475569;padding:0;display:flex;flex-direction:column;justify-content:center}.task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 80px 60px 70px 70px;height:100%;align-items:center;padding:0}.task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center;border-right:1px solid #e2e8f0;padding:0 8px}.task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]{justify-content:flex-start;padding-left:20px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:2px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 80px 60px 70px 70px;min-height:32px;align-items:center;border-bottom:1px solid #f1f5f9;transition:background-color .15s ease}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;border-right:1px solid #f1f5f9;padding:0 4px;font-size:11px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-0[_ngcontent-%COMP%]{background-color:#eff6ff;font-weight:700}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-0[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{color:#1e40af;font-size:12px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-1[_ngcontent-%COMP%]{background-color:#fff;font-weight:500}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-1[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]{padding-left:16px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-2[_ngcontent-%COMP%]{background-color:#fff;font-weight:400}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-2[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]{padding-left:32px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]{padding:0}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;height:100%;width:100%;padding-left:8px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .progress-indicator[_ngcontent-%COMP%]{width:3px;height:20px;flex-shrink:0;border-radius:1.5px}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .progress-indicator.high[_ngcontent-%COMP%]{background:#10b981}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .progress-indicator.medium[_ngcontent-%COMP%]{background:#f59e0b}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .progress-indicator.low[_ngcontent-%COMP%]{background:#ef4444}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .tree-icon-wrapper[_ngcontent-%COMP%]{width:16px;display:flex;align-items:center;justify-content:center}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{background:none;border:none;padding:0;cursor:pointer;color:#64748b;display:flex;transition:transform .15s ease}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .expand-btn.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:currentColor;fill:none;stroke-width:2}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .task-icon[_ngcontent-%COMP%]{color:#cbd5e1;fill:currentColor}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .responsible-badge[_ngcontent-%COMP%]{background:#f1f5f9;padding:2px 6px;border-radius:4px;font-size:10px;color:#475569}.task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-responsible[_ngcontent-%COMP%], .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-progress[_ngcontent-%COMP%], .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-date[_ngcontent-%COMP%]{justify-content:center}.gantt-chart-side[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-container[_ngcontent-%COMP%]{position:relative}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid #e2e8f0}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]{height:30px;display:flex;border-bottom:1px solid #cbd5e1;background:#334155}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]   .month-cell[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:#fff;border-right:1px solid #475569}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]{height:30px;display:flex;border-bottom:1px solid #cbd5e1}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:10px;color:#475569;border-right:1px solid #e2e8f0;background:#f8fafc;box-sizing:border-box}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.num-cell[_ngcontent-%COMP%]{font-weight:600}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.name-cell[_ngcontent-%COMP%]{font-size:9px;color:#64748b;background:#fff}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.weekend[_ngcontent-%COMP%]{background:#fef2f2;color:#ef4444}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.today[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8;font-weight:700;border-right:1px solid #3b82f6}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]{position:relative;background:#fff}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-grid[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;pointer-events:none}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-grid[_ngcontent-%COMP%]   .grid-column[_ngcontent-%COMP%]{height:100%;border-right:1px solid #f1f5f9}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-grid[_ngcontent-%COMP%]   .grid-column.weekend[_ngcontent-%COMP%]{background:#f1f5f980}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-grid[_ngcontent-%COMP%]   .grid-column.today[_ngcontent-%COMP%]{background:#3b82f608;border-right:1px solid rgba(59,130,246,.4)}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .today-line-overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:2px;background:#ef4444;z-index:5;pointer-events:none;box-shadow:0 0 4px #ef444466}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]{position:relative}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row[_ngcontent-%COMP%]{height:32px;border-bottom:1px solid transparent;position:relative;display:flex;align-items:center}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row[_ngcontent-%COMP%]   .task-bar-wrapper[_ngcontent-%COMP%]{position:absolute;height:18px;display:flex;align-items:center;transition:all .3s cubic-bezier(.4,0,.2,1)}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]{height:100%;width:100%;border-radius:2px;position:relative;overflow:hidden;background:#e2e8f0;border:1px solid #cbd5e1;color:#fff;font-size:9px;display:flex;align-items:center;justify-content:center;cursor:pointer}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background:#8b5cf6;opacity:.8}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]   .task-label[_ngcontent-%COMP%]{position:relative;z-index:1;font-weight:600;color:#fff;text-shadow:0 1px 1px rgba(0,0,0,.3)}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row.group-row[_ngcontent-%COMP%]{background:#f8fafc80}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row.group-row[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]{background:#94a3b8;border:none;height:8px;top:4px}.gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .tasks-container[_ngcontent-%COMP%]   .gantt-task-row.group-row[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{background:#334155}.expand-btn[_ngcontent-%COMP%]{width:20px;height:20px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:none;cursor:pointer;color:#64748b;font-size:10px;transition:transform .2s}.expand-btn.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.no-expand[_ngcontent-%COMP%]{width:20px}.wbs-summary[_ngcontent-%COMP%]{padding:16px 24px;background:#f8fafc;border-top:1px solid #e2e8f0}.wbs-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:flex;gap:32px}.wbs-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:11px;color:#64748b;margin-bottom:4px}.wbs-summary[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1e293b}.date-cell[_ngcontent-%COMP%]{cursor:pointer;position:relative}.date-cell[_ngcontent-%COMP%]   .date-display[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;transition:all .2s;font-size:12px;color:#475569}.date-cell[_ngcontent-%COMP%]   .date-display[_ngcontent-%COMP%]:hover{background:#3b82f61a;color:#3b82f6;font-weight:500}.date-cell[_ngcontent-%COMP%]   .date-draggable[_ngcontent-%COMP%]{cursor:ew-resize;-webkit-user-select:none;user-select:none}.date-cell[_ngcontent-%COMP%]   .date-draggable[_ngcontent-%COMP%]:active{background:#3b82f626;font-weight:600}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]{display:flex;gap:4px;align-items:center}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]{padding:4px 6px;border:1px solid #3b82f6;border-radius:3px;font-size:11px;font-family:inherit;min-width:80px}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #3b82f633}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%], .date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{padding:2px 6px;border:none;border-radius:3px;font-size:11px;cursor:pointer;transition:all .2s;font-weight:600;min-width:24px}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover, .date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]{background:#22c55e;color:#fff}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-save[_ngcontent-%COMP%]:hover{background:#16a34a}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.date-cell[_ngcontent-%COMP%]   .date-edit[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background:#dc2626}.task-bar-wrapper[_ngcontent-%COMP%]{position:absolute;height:24px;display:flex;border-radius:3px;overflow:hidden;-webkit-user-select:none;user-select:none;transition:box-shadow .2s}.task-bar-wrapper[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #00000026}.task-bar-wrapper.dragging[_ngcontent-%COMP%]{opacity:.7}.task-bar-wrapper[_ngcontent-%COMP%]   .gantt-bar-resize[_ngcontent-%COMP%]{width:8px;background:#fff6;cursor:col-resize;transition:background .2s;flex-shrink:0}.task-bar-wrapper[_ngcontent-%COMP%]   .gantt-bar-resize[_ngcontent-%COMP%]:hover{background:#fffc}.task-bar-wrapper[_ngcontent-%COMP%]   .gantt-bar-start[_ngcontent-%COMP%]{border-radius:3px 0 0 3px}.task-bar-wrapper[_ngcontent-%COMP%]   .gantt-bar-end[_ngcontent-%COMP%]{border-radius:0 3px 3px 0}.task-bar-wrapper[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600;color:#fff;cursor:move;transition:all .2s;position:relative}.task-bar-wrapper[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]:active{opacity:.85}.task-bar-wrapper[_ngcontent-%COMP%]   .task-bar[_ngcontent-%COMP%]   .task-label[_ngcontent-%COMP%]{text-shadow:0 1px 2px rgba(0,0,0,.3);z-index:2}.task-bar-preview[_ngcontent-%COMP%]{position:absolute;height:24px;display:flex;border-radius:3px;overflow:hidden;opacity:.5;border:2px dashed #3b82f6;background:#3b82f61a;box-shadow:inset 0 0 4px #3b82f64d;z-index:5;pointer-events:none}.task-bar-preview[_ngcontent-%COMP%]   .task-bar-preview-inner[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600;color:#ffffffb3}.task-bar-preview[_ngcontent-%COMP%]   .task-bar-preview-inner[_ngcontent-%COMP%]   .task-label[_ngcontent-%COMP%]{opacity:.7}"]})};var Ji=class n{STATUS_COLORS={open:"#94a3b8",inProgress:"#3b82f6",completed:"#22c55e",urgent:"#ef4444"};SCREEN_TYPE_COLORS={screen:{bg:"#DBEAFE",border:"#3b82f6",text:"#1E40AF"},modal:{bg:"#F3E8FF",border:"#a855f7",text:"#6B21A8"},panel:{bg:"#D1FAE5",border:"#22c55e",text:"#065F46"},sheet:{bg:"#FFEDD5",border:"#f97316",text:"#9A3412"}};generateScreensFromMapping(t,e,r){let i=[];if(!t||Object.keys(t).length===0)return console.warn("[FlowchartDataService] screenMapping is empty or undefined"),i;let a=Object.keys(t),o=new Map;for(let[c,l]of Object.entries(t)){let d=l.depth;o.has(d)||o.set(d,[]),o.get(d).push(c)}let s=1;for(let c of a){let l=t[c];if(!l||!l.specIds){console.warn(`[FlowchartDataService] Invalid mapping for screen: ${c}`,l);continue}let d=l.specIds.map(w=>String(w)),m=e.filter(w=>d.some(T=>w.id.includes(T))),x=r?.[c]?$e({},r[c]):this.calculateHierarchicalPosition(c,l.depth,o),u=this.calculateItemsProgress(m),v=this.getColorByProgress(u,m),h={id:`SCR-${String(s).padStart(3,"0")}`,name:c,icon:l.icon,description:l.description,color:v,position:x,features:this.extractFeatures(m),events:this.generateEvents(c,m),connections:[],screenType:l.type,path:l.path,depth:l.depth,parent:l.parent};i.push(h),s++}return this.setConnectionsByParent(i,t),i}generateScreensFromSpecPlan(t,e,r){let i=this.groupByMainCategory(t),a=this.sortByDepth(Object.keys(i),e),o=[],s=e==="calendar"?"EZCAL":"EZNOTE",c=this.groupScreensByDepth(a),l=1;for(let d of a){let m=i[d];if(!m)continue;let u=this.SCREEN_HIERARCHY[d]?.depth??0,v=r?.[d]?$e({},r[d]):this.calculateHierarchicalPosition(d,u,c),h=this.calculateItemsProgress(m),w=this.getColorByProgress(h,m),T={id:`${s}-SCR-${String(l).padStart(3,"0")}`,name:d,icon:this.SCREEN_ICONS[d]||"\u{1F4C4}",description:`${d} \uAD00\uB828 \uAE30\uB2A5 (Depth ${u})`,color:w,position:v,features:this.extractFeatures(m),events:this.generateEvents(d,m),connections:[]};o.push(T),l++}return this.setHierarchicalConnections(o),o}SCREEN_ICONS={"\uCE98\uB9B0\uB354 \uAD00\uB9AC":"\u{1F4C5}","\uCE98\uB9B0\uB354 \uBAA9\uB85D":"\u{1F4CB}","\uC77C\uC815 \uB4F1\uB85D":"\u2795","\uC77C\uC815 \uC218\uC815":"\u270F\uFE0F","\uCE98\uB9B0\uB354 \uC218\uC815":"\u2699\uFE0F","\uBCF4\uC644 \uAE30\uB2A5":"\u{1F527}",\uC124\uC815:"\u2699\uFE0F","\uB178\uD2B8 \uAD00\uB9AC":"\u{1F4DD}","\uB178\uD2B8 \uBAA9\uB85D":"\u{1F4CB}","\uB178\uD2B8 \uB4F1\uB85D":"\u2795","\uB178\uD2B8 \uB4F1\uB85D/\uC218\uC815":"\u270F\uFE0F","\uD3F4\uB354 \uB4F1\uB85D/\uC218\uC815":"\u{1F4C1}"};ENTRY_SCREENS={calendar:"\uCE98\uB9B0\uB354 \uAD00\uB9AC",note:"\uB178\uD2B8 \uAD00\uB9AC"};SCREEN_HIERARCHY={"\uCE98\uB9B0\uB354 \uAD00\uB9AC":{children:["\uCE98\uB9B0\uB354 \uBAA9\uB85D","\uC77C\uC815 \uB4F1\uB85D"],depth:0},"\uCE98\uB9B0\uB354 \uBAA9\uB85D":{children:["\uCE98\uB9B0\uB354 \uC218\uC815"],depth:1},"\uC77C\uC815 \uB4F1\uB85D":{children:["\uC77C\uC815 \uC218\uC815","\uC124\uC815"],depth:1},"\uCE98\uB9B0\uB354 \uC218\uC815":{children:[],depth:2},"\uC77C\uC815 \uC218\uC815":{children:["\uBCF4\uC644 \uAE30\uB2A5"],depth:2},\uC124\uC815:{children:[],depth:2},"\uBCF4\uC644 \uAE30\uB2A5":{children:[],depth:3},"\uB178\uD2B8 \uAD00\uB9AC":{children:["\uB178\uD2B8 \uBAA9\uB85D","\uB178\uD2B8 \uB4F1\uB85D"],depth:0},"\uB178\uD2B8 \uBAA9\uB85D":{children:["\uD3F4\uB354 \uB4F1\uB85D/\uC218\uC815"],depth:1},"\uB178\uD2B8 \uB4F1\uB85D":{children:["\uB178\uD2B8 \uB4F1\uB85D/\uC218\uC815","\uC124\uC815"],depth:1},"\uD3F4\uB354 \uB4F1\uB85D/\uC218\uC815":{children:[],depth:2},"\uB178\uD2B8 \uB4F1\uB85D/\uC218\uC815":{children:["\uBCF4\uC644 \uAE30\uB2A5"],depth:2}};setConnectionsByParent(t,e){let r=new Map(t.map(i=>[i.name,i]));for(let i of t){let a=e[i.name];if(a){if(a.connections&&Array.isArray(a.connections))for(let o of a.connections){let s=r.get(o);s&&i.connections.push({targetScreenId:s.id,type:"navigate",label:o})}if(a.parent){let o=r.get(a.parent);o&&(i.connections.some(c=>c.targetScreenId===o.id)||o.connections.push({targetScreenId:i.id,type:"navigate",label:i.name}))}}}}sortByDepth(t,e){return t.sort((r,i)=>{let a=this.SCREEN_HIERARCHY[r]?.depth??99,o=this.SCREEN_HIERARCHY[i]?.depth??99;return a-o})}groupScreensByDepth(t){let e=new Map;for(let r of t){let i=this.SCREEN_HIERARCHY[r]?.depth??0;e.has(i)||e.set(i,[]),e.get(i).push(r)}return e}calculateHierarchicalPosition(t,e,r){let i=r.get(e)||[],a=i.indexOf(t),o=i.length,s=60,c=280,l=280,d=200,m=320,x=2e3,u=s+e*c,v=(o-1)*m,w=(x-v)/2+a*m;return{x:Math.max(50,w),y:u}}autoLayoutScreens(t){let s={},c=new Map;for(let x of t){let u=x.depth??0;c.has(u)||c.set(u,[]),c.get(u).push(x)}let l=Array.from(c.keys()).sort((x,u)=>x-u),d=new Map;for(let x of t)for(let u of x.connections)d.has(u.targetScreenId)||d.set(u.targetScreenId,[]),d.get(u.targetScreenId).push(x.id);for(let x of l){let u=c.get(x),v=80+x*340;if(x===0){let w=1500-(u.length*380-100)/2;u.forEach(T=>{s[T.name]={x:w,y:v},w+=380})}else{let h=[];u.forEach(W=>{let pe=d.get(W.id)||[],A=t.filter(z=>pe.includes(z.id)),X=1500;A.length>0&&(X=A.reduce((H,K)=>{let Z=s[K.name];return H+(Z?Z.x:1500)},0)/A.length),h.push({screen:W,targetX:X})}),h.sort((W,pe)=>W.targetX-pe.targetX);for(let W=0;W<h.length;W++){let pe=h[W].targetX;if(W>0){let A=h[W-1].screen,z=s[A.name].x+280+100;pe<z&&(pe=z)}s[h[W].screen.name]={x:pe,y:v}}let w=s[h[h.length-1].screen.name].x-s[h[0].screen.name].x+280,T=s[h[0].screen.name].x+w/2,F=u.flatMap(W=>d.get(W.id)||[]),I=Array.from(new Set(F)),j=t.filter(W=>I.includes(W.id));if(j.length>0){let A=j.reduce((X,z)=>X+(s[z.name]?.x||1500),0)/j.length-T;u.forEach(X=>{s[X.name].x+=A})}}}let m=Object.values(s).map(x=>x.x);if(m.length>0){let u=100-Math.min(...m);for(let v in s)s[v].x+=u}return this.resolveAllCollisions(s,t,280,160,100/2,20,10),s}resolveAllCollisions(t,e,r,i,a,o,s){let c=0,l=!0;for(;l&&c<s;){l=!1,c++;for(let d=0;d<e.length;d++)for(let m=d+1;m<e.length;m++){let x=e[d],u=e[m],v=t[x.name],h=t[u.name];if(!v||!h)continue;if(this.detectCollisionWithMargin(v.x,v.y,h.x,h.y,r,i,a,o).colliding)if(l=!0,v.x<=h.x){let T=v.x+r+a-h.x;h.x+=T}else{let T=h.x+r+a-v.x;v.x+=T}}}}detectCollisionWithMargin(t,e,r,i,a,o,s,c){let l={left:t-s,right:t+a+s,top:e-c,bottom:e+o+c},d={left:r-s,right:r+a+s,top:i-c,bottom:i+o+c};return{colliding:l.left<d.right&&l.right>d.left&&l.top<d.bottom&&l.bottom>d.top}}isScreensColliding(t,e){return!(t.x+t.width+10<e.x||e.x+e.width+10<t.x||t.y+t.height+10<e.y||e.y+e.height+10<t.y)}findCollidingScreens(t,e){let a=[];for(let o=0;o<t.length;o++)for(let s=o+1;s<t.length;s++){let c=t[o],l=t[s],d=e[c.name],m=e[l.name];d&&m&&this.isScreensColliding({x:d.x,y:d.y,width:280,height:200},{x:m.x,y:m.y,width:280,height:200})&&(a.includes(c.name)||a.push(c.name),a.includes(l.name)||a.push(l.name))}return a}setHierarchicalConnections(t){let e=new Map(t.map(r=>[r.name,r]));for(let r of t){let i=this.SCREEN_HIERARCHY[r.name];if(i)for(let a of i.children){let o=e.get(a);o&&r.connections.push({targetScreenId:o.id,type:"navigate",label:a})}}}groupByMainCategory(t){return t.reduce((e,r)=>{let i=r.mainCategory;return e[i]||(e[i]=[]),e[i].push(r),e},{})}extractFeatures(t){return t.map(e=>({id:e.id,midCategory:e.midCategory,subCategory:e.subCategory||"",name:e.subCategory||e.midCategory,request:e.request,priority:e.priority,feasibility:e.feasibility,status:e.status||"open",wbsInfo:e.startDate?{startDate:e.startDate,endDate:e.endDate||"",progress:e.progress||0,responsible:e.responsible||""}:void 0}))}generateEvents(t,e){let r=[],i=this.toSnakeCase(t);return r.push({id:`evt-${i}-view`,name:`${i}_viewed`,displayName:`${t} \uD398\uC774\uC9C0 \uC870\uD68C`,type:"pageview",trigger:"\uD398\uC774\uC9C0 \uB85C\uB4DC"}),e.filter(o=>o.status==="completed"||o.isHighPriority||parseFloat(o.priority)>=1.5).slice(0,5).forEach((o,s)=>{let c=this.toSnakeCase(o.subCategory||o.midCategory);r.push({id:`evt-${i}-${s}`,name:`${c}_action`,displayName:`${o.subCategory||o.midCategory} \uB3D9\uC791`,type:this.determineEventType(o),trigger:`${o.subCategory||o.midCategory} \uC2E4\uD589`,relatedFeatureId:o.id})}),r}determineEventType(t){let e=(t.subCategory||t.midCategory).toLowerCase();return e.includes("\uC644\uB8CC")||e.includes("\uC800\uC7A5")||e.includes("\uB4F1\uB85D")?"conversion":e.includes("\uC774\uB3D9")||e.includes("\uC804\uD658")?"navigation":"action"}toSnakeCase(t){return t.replace(/\s+/g,"_").replace(/[\/\\]/g,"_").replace(/[()]/g,"").toLowerCase()}getScreenDepth(t){return this.SCREEN_HIERARCHY[t]?.depth??0}getParentScreen(t,e){for(let[r,i]of Object.entries(this.SCREEN_HIERARCHY))if(i.children.includes(t))return e.find(a=>a.name===r)}getChildScreens(t,e){let r=this.SCREEN_HIERARCHY[t];return r?e.filter(i=>r.children.includes(i.name)):[]}setConnections(t){}groupFeaturesByMidCategory(t){let e={};for(let r of t)e[r.midCategory]||(e[r.midCategory]=[]),e[r.midCategory].push(r);return Object.entries(e).map(([r,i])=>({midCategory:r,features:i}))}calculateScreenProgress(t){let e=t.features;if(e.length===0)return 0;let r=e.reduce((i,a)=>a.status==="completed"?i+100:a.status==="inProgress"?i+(a.wbsInfo?.progress||50):i,0);return Math.round(r/e.length)}getEventColor(t){let e={pageview:{bg:"#FEF3C7",border:"#FCD34D",text:"#92400E"},action:{bg:"#DBEAFE",border:"#60A5FA",text:"#1E40AF"},conversion:{bg:"#D1FAE5",border:"#34D399",text:"#065F46"},navigation:{bg:"#FEE2E2",border:"#F87171",text:"#991B1B"},error:{bg:"#FEE2E2",border:"#EF4444",text:"#B91C1C"}};return e[t]||e.action}calculateEdgePath(t,e){let r={x:t.x+t.width/2,y:t.y+t.height},i={x:e.x+e.width/2,y:e.y},a=(r.y+i.y)/2;return`M ${r.x} ${r.y} 
            C ${r.x} ${a}, 
              ${i.x} ${a}, 
              ${i.x} ${i.y}`}calculateItemsProgress(t){if(t.length===0)return 0;let e=t.reduce((r,i)=>i.status==="completed"?r+100:i.status==="inProgress"?r+(i.progress||50):r,0);return Math.round(e/t.length)}getColorByProgress(t,e){return e.some(i=>i.isHighPriority)?this.STATUS_COLORS.urgent:t===0?this.STATUS_COLORS.open:t===100?this.STATUS_COLORS.completed:this.STATUS_COLORS.inProgress}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var Qi=class n{DB_NAME="loworld-ia-screens";STORE_NAME="screen-images";DB_VERSION=1;STORAGE_KEY_PREFIX="ia-screen-image-";imagesSubject=new st(new Map);images$=this.imagesSubject.asObservable();dbInstance=null;constructor(){this.initializeDatabase()}initializeDatabase(){let t=indexedDB.open(this.DB_NAME,this.DB_VERSION);t.onerror=()=>{console.error("[ScreenImageStorage] IndexedDB \uCD08\uAE30\uD654 \uC2E4\uD328:",t.error)},t.onsuccess=()=>{this.dbInstance=t.result,console.log("[ScreenImageStorage] IndexedDB \uCD08\uAE30\uD654 \uC644\uB8CC")},t.onupgradeneeded=e=>{let r=e.target.result;r.objectStoreNames.contains(this.STORE_NAME)||(r.createObjectStore(this.STORE_NAME,{keyPath:"screenId"}),console.log("[ScreenImageStorage] Object Store \uC0DD\uC131:",this.STORE_NAME))}}getScreenImages(t){let e=`${this.STORAGE_KEY_PREFIX}${t}`,r=localStorage.getItem(e);if(r)try{let i=JSON.parse(r);return Un(i)}catch(i){console.error("[ScreenImageStorage] LocalStorage \uD30C\uC2F1 \uC624\uB958:",i)}return Un([])}saveScreenImage(t,e){return new gn(r=>{let i=`${this.STORAGE_KEY_PREFIX}${t}`,a=this.getLocalImages(t),o=a.findIndex(s=>s.id===e.id);o>=0?a[o]=e:a.push(e),localStorage.setItem(i,JSON.stringify(a)),e.imageSource.type==="base64"?this.saveImageToIndexedDB(t,e).then(()=>{r.next(e),r.complete()}).catch(s=>{console.error("[ScreenImageStorage] IndexedDB \uC800\uC7A5 \uC624\uB958:",s),r.next(e),r.complete()}):(r.next(e),r.complete()),this.updateImagesSubject(t)})}deleteScreenImage(t,e){let r=`${this.STORAGE_KEY_PREFIX}${t}`,a=this.getLocalImages(t).filter(o=>o.id!==e);return localStorage.setItem(r,JSON.stringify(a)),this.dbInstance&&this.dbInstance.transaction([this.STORE_NAME],"readwrite").objectStore(this.STORE_NAME).delete(t),this.updateImagesSubject(t),Un(!0)}setActiveImage(t,e){let r=`${this.STORAGE_KEY_PREFIX}${t}`,i=this.getLocalImages(t);return i.forEach(a=>{a.isActive=a.id===e}),localStorage.setItem(r,JSON.stringify(i)),this.updateImagesSubject(t),Un(void 0)}exportAllMetadata(){let t={};return Object.keys(localStorage).forEach(r=>{if(r.startsWith(this.STORAGE_KEY_PREFIX)){let i=r.replace(this.STORAGE_KEY_PREFIX,"");try{let a=JSON.parse(localStorage.getItem(r)||"[]");t[i]=a}catch(a){console.error(`[ScreenImageStorage] ${i} \uBA54\uD0C0\uB370\uC774\uD130 \uC218\uC9D1 \uC624\uB958:`,a)}}}),Un(t)}clearAllData(){return Object.keys(localStorage).forEach(e=>{e.startsWith(this.STORAGE_KEY_PREFIX)&&localStorage.removeItem(e)}),this.dbInstance&&this.dbInstance.transaction([this.STORE_NAME],"readwrite").objectStore(this.STORE_NAME).clear(),this.imagesSubject.next(new Map),Un(!0)}getLocalImages(t){let e=`${this.STORAGE_KEY_PREFIX}${t}`,r=localStorage.getItem(e);if(!r)return[];try{return JSON.parse(r)}catch{return[]}}saveImageToIndexedDB(t,e){return new Promise((r,i)=>{if(!this.dbInstance){i(new Error("IndexedDB\uAC00 \uCD08\uAE30\uD654\uB418\uC9C0 \uC54A\uC74C"));return}let o=this.dbInstance.transaction([this.STORE_NAME],"readwrite").objectStore(this.STORE_NAME),s={screenId:t,images:[e],lastUpdated:new Date().toISOString()},c=o.put(s);c.onsuccess=()=>r(),c.onerror=()=>i(c.error)})}updateImagesSubject(t){let e=this.imagesSubject.value;e.set(t,this.getLocalImages(t)),this.imagesSubject.next(new Map(e))}getActiveImage(t){return this.getScreenImages(t).pipe(Hn(e=>e.find(i=>i.isActive)||e[e.length-1]||null))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var ea=class n{constructor(t){this.storageService=t}screensWithImagesSubject=new st(new Map);screensWithImages$=this.screensWithImagesSubject.asObservable();addImageToScreen(t,e){return this.storageService.saveScreenImage(t,e).pipe(Kt(()=>{this.loadScreenWithImages(t).subscribe()}))}removeImageFromScreen(t,e){return this.storageService.deleteScreenImage(t,e).pipe(Kt(()=>{this.loadScreenWithImages(t).subscribe()}))}getScreenImages(t){return this.storageService.getScreenImages(t)}getActiveImage(t){return this.storageService.getActiveImage(t)}setActiveImage(t,e){return this.storageService.setActiveImage(t,e).pipe(Kt(()=>{this.loadScreenWithImages(t).subscribe()}))}updateImageMetadata(t,e,r){return this.getScreenImages(t).pipe(Hn(i=>{let a=i.findIndex(c=>c.id===e);if(a<0)throw new Error(`\uC774\uBBF8\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4: ${e}`);let o=$e($e({},i[a]),r);i[a]=o;let s=`ia-screen-image-${t}`;return localStorage.setItem(s,JSON.stringify(i)),o}),Kt(()=>{this.loadScreenWithImages(t).subscribe()}))}loadScreenWithImages(t){return this.getScreenImages(t).pipe(Hn(e=>{let r=e.find(a=>a.isActive);return{id:t,name:"",icon:"",description:"",color:"",position:{x:0,y:0},features:[],events:[],connections:[],images:e,activeImageId:r?.id,imageCount:e.length}}),Kt(e=>{let r=this.screensWithImagesSubject.value;e&&(r.set(t,e),this.screensWithImagesSubject.next(new Map(r)))}))}extractImageData(t){return t.type==="base64"||t.type==="url"?t.value:""}uploadImageFile(t){return new Promise((e,r)=>{let i=new FileReader;i.onload=a=>{let o=a.target?.result;e(o)},i.onerror=()=>{r(new Error("\uD30C\uC77C \uC77D\uAE30 \uC2E4\uD328"))},i.readAsDataURL(t)})}getImageDimensions(t){return new Promise((e,r)=>{let i=new Image;i.onload=()=>{e({width:i.width,height:i.height})},i.onerror=()=>{r(new Error("\uC774\uBBF8\uC9C0 \uD06C\uAE30 \uC870\uD68C \uC2E4\uD328"))},i.src=t})}exportAllImages(){return this.storageService.exportAllMetadata()}clearAllImages(){return this.screensWithImagesSubject.next(new Map),this.storageService.clearAllData()}static \u0275fac=function(e){return new(e||n)(si(Qi))};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var vm=["container"],bm=["intentName"],wm=["fileInput"],Pm=n=>({"height.px":n}),Mm=n=>({"border-top-color":n}),v0=n=>({"background-color":n}),Om=(n,t)=>t.type,fn=(n,t)=>t.id,ym=(n,t)=>t.mainCategory,km=(n,t)=>t.name,b0=(n,t)=>t.targetScreenId,ao=(n,t)=>t.midCategory;function Sm(n,t){n&1&&(f(0,"span",28),g(1,"\u{1F4C5} \uC774\uC9C0\uCE98\uB9B0\uB354"),p())}function Em(n,t){n&1&&(f(0,"span",29),g(1,"\u{1F4DD} \uC774\uC9C0\uB178\uD2B8"),p())}function Tm(n,t){n&1&&ee(0,"span",39)}function Dm(n,t){n&1&&(ee(0,"span",56),g(1," \uC800\uC7A5 \uC911... "))}function Am(n,t){n&1&&g(0," \u{1F4BE} DB \uC800\uC7A5 ")}function Fm(n,t){if(n&1){let e=Oe();f(0,"div",47)(1,"button",57),re("click",function(){J(e);let i=k();return Q(i.downloadAsJson())}),g(2,"DB \uB2E4\uC6B4\uB85C\uB4DC (JSON)"),p(),f(3,"button",57),re("click",function(){J(e);let i=k();return Q(i.downloadAsExcel())}),g(4,"IA \uB2E4\uC6B4\uB85C\uB4DC (Excel)"),p(),f(5,"button",57),re("click",function(){J(e);let i=k();return Q(i.downloadWbs())}),g(6,"WBS \uB2E4\uC6B4\uB85C\uB4DC (Excel)"),p()()}}function Im(n,t){n&1&&(f(0,"div",48),ee(1,"div",58),f(2,"span"),g(3,"\uB370\uC774\uD130 \uB85C\uB4DC \uC911..."),p()())}function Bm(n,t){if(n&1){let e=Oe();f(0,"button",64),re("click",function(){J(e);let i=k(2);return Q(i.groupSelectedNodes())}),Me(),f(1,"svg",5),ee(2,"rect",65)(3,"rect",66)(4,"rect",67)(5,"rect",68),p(),g(6),p()}if(n&2){let e=k(2);_(6),ge(" \uB2E4\uC911\uC120\uD0DD \uC800\uC7A5 (",e.selectedNodeIds.size,") ")}}function Rm(n,t){if(n&1){let e=Oe();f(0,"div",59)(1,"div",60),g(2),p(),Ut(3,Bm,7,1,"button",61),f(4,"button",62),re("click",function(){J(e);let i=k();return Q(i.clearSelection())}),Me(),f(5,"svg",5),ee(6,"path",63),p(),g(7," \uCDE8\uC18C "),p()()}if(n&2){let e=k();_(2),ge(" \uC120\uD0DD\uB41C \uB178\uB4DC: ",e.selectedNodeIds.size,"\uAC1C "),_(),we("ngIf",e.selectedNodeIds.size>=2)}}function Lm(n,t){if(n&1&&(f(0,"span",90),g(1),p()),n&2){let e=k().$implicit;_(),ne(e.subCategory)}}function Nm(n,t){n&1&&(f(0,"span",91),g(1,"\u{1F525}"),p())}function zm(n,t){if(n&1&&(f(0,"div",105)(1,"div",106),g(2,"\u{1F4CC} \uBE44\uACE0"),p(),f(3,"div",112),g(4),p()()),n&2){let e=k(2).$implicit;_(4),ne(e.note)}}function jm(n,t){if(n&1&&(f(0,"div",99)(1,"div",105)(2,"div",106),g(3,"\u{1F4DD} \uC758\uB8B0\uB0B4\uC6A9"),p(),f(4,"div",107),g(5),p()(),ae(6,zm,5,1,"div",105),f(7,"div",108)(8,"div",109)(9,"span",110),g(10,"ID"),p(),f(11,"span",111),g(12),p()()()()),n&2){let e=k().$implicit;_(5),ne(e.request),_(),oe(e.note?6:-1),_(6),ne(e.id)}}function Wm(n,t){if(n&1&&(f(0,"div",100),g(1),p()),n&2){let e=k().$implicit;_(),ge(" \u{1F4CC} ",e.note," ")}}function Vm(n,t){n&1&&ee(0,"div",113)}function Um(n,t){if(n&1){let e=Oe();f(0,"div",77)(1,"div",78),re("click",function(i){return J(e),Q(i.stopPropagation())}),Me(),f(2,"svg",5),ee(3,"circle",79)(4,"circle",80)(5,"circle",81)(6,"circle",82)(7,"circle",83)(8,"circle",84),p()(),Re(),f(9,"div",85),re("click",function(i){let a=J(e).$implicit,o=k(3);return Q(o.toggleCardExpand(a.id,i))}),f(10,"div",86)(11,"div",87)(12,"span",88),g(13),p(),f(14,"span",89),g(15),p(),ae(16,Lm,2,1,"span",90),p(),ae(17,Nm,2,0,"span",91),p(),f(18,"div",92),g(19),p(),f(20,"div",93),g(21),p(),f(22,"div",94),g(23),p(),f(24,"div",95)(25,"div",96)(26,"span",97),g(27,"\uBC18\uC601\uC694\uCCAD"),p(),f(28,"span",98),g(29),p()(),f(30,"div",96)(31,"span",97),g(32,"\uBC18\uC601\uAC00\uB2A5"),p(),f(33,"span",98),g(34),p()()(),ae(35,jm,13,3,"div",99),ae(36,Wm,2,1,"div",100),f(37,"div",101),Me(),f(38,"svg",102),ee(39,"path",103),p()()(),Ut(40,Vm,1,0,"div",104),p()}if(n&2){let e=t.$implicit,r=k(3);ve("high-priority",e.isHighPriority)("expanded",r.isCardExpanded(e.id)),_(12),we("ngStyle",Br(24,v0,r.getMainCategoryColor(e.mainCategory))),_(),ge(" ",e.mainCategory," "),_(2),ne(e.midCategory),_(),oe(e.subCategory?16:-1),_(),oe(e.isHighPriority?17:-1),_(2),ne(e.subCategory||e.request.split(`
`)[0].substring(0,40)),_(2),ne(e.id),_(2),ge(" ",e.request.split(`
`)[0]," "),_(5),dt(r.getPriorityClass(e.priority)),_(),Ir(" ",r.getScoreVisual(e.priority)," ",e.priority," "),_(4),dt(r.getFeasibilityClass(e.feasibility)),_(),Ir(" ",r.getScoreVisual(e.feasibility)," ",e.feasibility," "),_(),oe(r.isCardExpanded(e.id)?35:-1),_(),oe(!r.isCardExpanded(e.id)&&e.note?36:-1),_(2),ve("rotated",r.isCardExpanded(e.id))}}function Hm(n,t){n&1&&(f(0,"div",76)(1,"span"),g(2,"\uD56D\uBAA9\uC744 \uC5EC\uAE30\uB85C \uB4DC\uB798\uADF8\uD558\uC138\uC694"),p()())}function $m(n,t){if(n&1){let e=Oe();f(0,"div",69)(1,"div",70)(2,"div",71),ee(3,"span",72),g(4),p(),f(5,"span",73),g(6),p()(),f(7,"div",74),re("cdkDropListDropped",function(i){let a=J(e).$implicit,o=k(2);return Q(o.onKanbanDrop(i,a.type))}),ye(8,Um,41,26,"div",75,fn),ae(10,Hm,3,0,"div",76),p()()}if(n&2){let e=t.$implicit,r=k(2);_(),we("ngStyle",Br(8,Mm,e.color)),_(2),we("ngStyle",Br(10,v0,e.color)),_(),ge(" ",e.title," "),_(2),ne(e.items.length),_(),we("id","kanban-"+e.type)("cdkDropListData",e.items)("cdkDropListConnectedTo",r.connectedDropLists),_(),ke(e.items),_(2),oe(e.items.length===0?10:-1)}}function Xm(n,t){if(n&1&&(f(0,"div",50),ye(1,$m,11,12,"div",69,Om),p()),n&2){let e=k();_(),ke(e.kanbanColumns)}}function Gm(n,t){n&1&&(f(0,"span",138),g(1,"\u{1F525}"),p())}function Ym(n,t){if(n&1&&(f(0,"div",150)(1,"span",106),g(2,"\uBE44\uACE0"),p(),f(3,"span",151),g(4),p()()),n&2){let e=k(2).$implicit;_(4),ne(e.note)}}function Km(n,t){if(n&1&&(f(0,"div",146)(1,"div",150)(2,"span",106),g(3,"\uC758\uB8B0\uB0B4\uC6A9"),p(),f(4,"span",151),g(5),p()(),ae(6,Ym,5,1,"div",150),f(7,"div",152)(8,"span",153),g(9),p()()()),n&2){let e=k().$implicit;_(5),ne(e.request),_(),oe(e.note?6:-1),_(3),ne(e.id)}}function qm(n,t){if(n&1){let e=Oe();f(0,"div",133),re("click",function(i){let a=J(e).$implicit,o=k(4);return Q(o.toggleCardExpand(a.id,i))}),ee(1,"div",134),f(2,"div",135)(3,"div",136)(4,"span",137),g(5),p(),ae(6,Gm,2,0,"span",138),p(),f(7,"div",139),ee(8,"span",140),g(9),p(),f(10,"div",141)(11,"div",142)(12,"span",143),g(13,"\u{1F4CB}"),p(),f(14,"span",144),g(15),p()(),f(16,"div",145)(17,"span",143),g(18,"\u2705"),p(),f(19,"span",144),g(20),p()()(),ae(21,Km,10,3,"div",146),p(),f(22,"div",147),Me(),f(23,"svg",148),ee(24,"path",149),p()()()}if(n&2){let e=t.$implicit,r=k(4);ve("high-priority",e.isHighPriority)("expanded",r.expandedCardId===e.id),_(),ve("high",+e.feasibility>=4)("medium",+e.feasibility==3)("low",+e.feasibility<3),_(4),ge(" ",e.subCategory||e.request.split("\\n")[0].substring(0,30)," "),_(),oe(e.isHighPriority?6:-1),_(),De("background",r.getKanbanColumnStatus(e).color+"15")("color",r.getKanbanColumnStatus(e).color)("border-color",r.getKanbanColumnStatus(e).color),_(),De("background",r.getKanbanColumnStatus(e).color),_(),ge(" ",r.getKanbanColumnStatus(e).label," "),_(2),ve("high",+e.priority>=4),_(4),ne(e.priority),_(),ve("high",+e.feasibility>=4),_(4),ne(e.feasibility),_(),oe(r.expandedCardId===e.id?21:-1),_(),ve("expanded",r.expandedCardId===e.id)}}function Zm(n,t){if(n&1&&(f(0,"div",127)(1,"div",128)(2,"span",129),g(3),p(),f(4,"span",130),g(5),p()(),f(6,"div",131),ye(7,qm,25,30,"div",132,fn),p()()),n&2){let e=t.$implicit;_(3),ne(e.name),_(2),ne(e.items.length),_(2),ke(e.items)}}function Jm(n,t){if(n&1&&(f(0,"div",118)(1,"div",119)(2,"div",120)(3,"span",121),g(4),p(),f(5,"span",122),g(6),p()(),f(7,"div",123)(8,"span",124),g(9),p(),f(10,"span",125),g(11),p()()(),f(12,"div",126),ye(13,Zm,9,2,"div",127,km),p()()),n&2){let e=t.$implicit,r=k(2);De("border-left-color",e.color),_(),De("background",e.color+"15"),_(2),De("background",e.color),_(),ge(" ",e.mainCategory.charAt(0)," "),_(2),ne(e.mainCategory),_(3),ge("",e.midCategories.length," \uC911\uBD84\uB958"),_(2),ge("",r.getTotalItemsInMainCategory(e)," \uD56D\uBAA9"),_(2),ke(e.midCategories)}}function Qm(n,t){if(n&1&&(f(0,"div",51)(1,"div",114)(2,"div",31)(3,"span",32),g(4,"\uB300\uBD84\uB958"),p(),f(5,"span",33),g(6),p()(),f(7,"div",31)(8,"span",32),g(9,"\uC804\uCCB4 \uD56D\uBAA9"),p(),f(10,"span",33),g(11),p()(),f(12,"div",115)(13,"span",32),g(14,"\u{1F525} \uAE34\uAE09"),p(),f(15,"span",33),g(16),p()()(),f(17,"div",116),ye(18,Jm,15,10,"div",117,ym),p()()),n&2){let e=k();_(6),ne(e.hierarchicalData.length),_(5),ne(e.specPlanData.length),_(5),ne(e.getHighPriorityCount()),_(2),ke(e.hierarchicalData)}}function ex(n,t){if(n&1&&(f(0,"tr")(1,"td",156)(2,"span",166),g(3),p()(),f(4,"td",157)(5,"span",167),g(6),p()(),f(7,"td",158)(8,"span",168),g(9),p()(),f(10,"td",159),g(11),p(),f(12,"td",160),g(13),p(),f(14,"td",161)(15,"div",169),g(16),p()(),f(17,"td",162)(18,"span",170),g(19),p()(),f(20,"td",163)(21,"span",170),g(22),p()(),f(23,"td",164)(24,"div",171),g(25),p()()()),n&2){let e=t.$implicit,r=k(2);ve("high-priority",e.isHighPriority)("completed",e.status==="completed"),_(3),ne(e.id),_(2),De("background",r.getKanbanColumnStatus(e).color+"15")("color",r.getKanbanColumnStatus(e).color)("border-color",r.getKanbanColumnStatus(e).color),_(),ge(" ",r.getKanbanColumnStatus(e).label," "),_(2),De("background",r.getMainCategoryColor(e.mainCategory)),_(),ge(" ",e.mainCategory," "),_(2),ne(e.midCategory),_(2),ne(e.subCategory),_(3),ne(e.request),_(2),dt(r.getPriorityClass(e.priority)),_(),ge(" ",e.priority," "),_(2),dt(r.getFeasibilityClass(e.feasibility)),_(),ge(" ",e.feasibility," "),_(3),ne(e.note)}}function tx(n,t){if(n&1&&(f(0,"div",52)(1,"div",154)(2,"table",155)(3,"thead")(4,"tr")(5,"th",156),g(6,"ID"),p(),f(7,"th",157),g(8,"\uC0C1\uD0DC"),p(),f(9,"th",158),g(10,"\uB300\uBD84\uB958"),p(),f(11,"th",159),g(12,"\uC911\uBD84\uB958"),p(),f(13,"th",160),g(14,"\uC18C\uBD84\uB958"),p(),f(15,"th",161),g(16,"\uC758\uB8B0\uB0B4\uC6A9"),p(),f(17,"th",162),g(18,"\uBC18\uC601\uC694\uCCAD"),p(),f(19,"th",163),g(20,"\uBC18\uC601\uAC00\uB2A5"),p(),f(21,"th",164),g(22,"\uBE44\uACE0"),p()()(),f(23,"tbody"),ye(24,ex,26,25,"tr",165,fn),p()()()()),n&2){let e=k();_(24),ke(e.specPlanData)}}function nx(n,t){n&1&&(f(0,"div",181)(1,"span",177),g(2,"image_not_supported"),p(),f(3,"p"),g(4,"\uD654\uBA74\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),p()())}function rx(n,t){if(n&1){let e=Oe();f(0,"div",185),re("click",function(){let i=J(e).$implicit,a=k(3);return Q(a.selectScreenForImage(i))}),f(1,"span",186),g(2),p(),f(3,"div",187)(4,"div",188)(5,"span",189),g(6),p()(),f(7,"div",190)(8,"span",191),g(9),p()()()()}if(n&2){let e=t.$implicit,r=k(3);ve("selected",r.selectedScreenImageId===e.id),_(2),ne(e.icon),_(4),ne(e.name.replace("PC - ","").replace("\uB178\uD2B8 - ","")),_(3),ge("\u{1F4F7} ",e.imageCount||0)}}function ix(n,t){if(n&1&&ye(0,rx,10,5,"div",184,fn),n&2){let e=k(2);ke(e.screensWithImages)}}function ax(n,t){n&1&&(f(0,"div",183)(1,"span",177),g(2,"image"),p(),f(3,"p"),g(4,"\uD654\uBA74\uC744 \uC120\uD0DD\uD558\uC138\uC694"),p()())}function ox(n,t){n&1&&ee(0,"div",203)}function sx(n,t){if(n&1&&(f(0,"div",200)(1,"div",201),ee(2,"iframe",202),p(),ae(3,ox,1,0,"div",203),p()),n&2){let e=k(3);ve("mobile-frame",e.selectedDeviceTab==="mobile"),_(2),we("src",e.getIframeUrl(),li),_(),oe(e.selectedDeviceTab==="mobile"?3:-1)}}function cx(n,t){if(n&1&&(f(0,"div",209),ee(1,"img",210),f(2,"div",211)(3,"span",212),g(4),p()()()),n&2){let e=t,r=k(5);_(),we("src",r.getImagePreviewUrl(e),fa)("alt",e.title),_(3),Ir("",e.title," (v",e.version,")")}}function lx(n,t){if(n&1&&(f(0,"div",204),ae(1,cx,5,4,"div",209),p()),n&2){let e,r=k(4);_(),oe((e=r.getActiveImage())?1:-1,e)}}function dx(n,t){n&1&&(f(0,"div",207)(1,"p"),g(2,"\uC774\uBBF8\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),p()())}function fx(n,t){n&1&&(f(0,"div",217),g(1,"\u2713"),p())}function px(n,t){if(n&1){let e=Oe();f(0,"div",214),re("click",function(){let i=J(e).$implicit,a=k(5);return Q(a.selectImage(i))}),f(1,"div",215),ee(2,"img",216),ae(3,fx,2,0,"div",217),p(),f(4,"div",218),g(5),p(),f(6,"div",219),g(7),p()()}if(n&2){let e=t.$implicit,r=k(5);ve("active",r.activeImageId===e.id),_(2),we("src",r.getImagePreviewUrl(e),fa)("alt",e.title),_(),oe(r.activeImageId===e.id?3:-1),_(2),ne(e.title),_(2),ge("v",e.version)}}function gx(n,t){if(n&1&&(f(0,"div",208),ye(1,px,8,7,"div",213,fn),p()),n&2){let e=k(4);_(),ke(e.screenImagesList)}}function ux(n,t){if(n&1&&(ae(0,lx,2,1,"div",204),f(1,"div",205)(2,"h3",206),g(3),p(),ae(4,dx,3,0,"div",207)(5,gx,3,0,"div",208),p()),n&2){let e=k(3);oe(e.activeImageId&&e.screenImagesList.length>0?0:-1),_(3),ge("\uC774\uBBF8\uC9C0 (",e.screenImagesList.length,")"),_(),oe(e.screenImagesList.length===0?4:5)}}function hx(n,t){if(n&1){let e=Oe();f(0,"div",192)(1,"div",193)(2,"span",194),g(3),p(),f(4,"div",195)(5,"h2"),g(6),p(),f(7,"p",196),g(8),p()()(),f(9,"div",197)(10,"div",3)(11,"button",198),re("click",function(){J(e);let i=k(2);return Q(i.toggleLiveViewMode())}),f(12,"span",177),g(13,"image"),p(),g(14," \uBAA9\uC5C5 "),p(),f(15,"button",198),re("click",function(){J(e);let i=k(2);return Q(i.toggleLiveViewMode())}),f(16,"span",177),g(17,"web"),p(),g(18," \uB77C\uC774\uBE0C "),p()()()(),ae(19,sx,4,4,"div",199)(20,ux,6,3)}if(n&2){let e=k(2);_(3),ne(e.currentScreenDetail.icon),_(3),ne(e.currentScreenDetail.name.replace("PC - ","").replace("\uB178\uD2B8 - ","")),_(2),ne(e.currentScreenDetail.description),_(3),ve("active",!e.isLiveViewMode),_(4),ve("active",e.isLiveViewMode),_(4),oe(e.isLiveViewMode?19:20)}}function mx(n,t){if(n&1){let e=Oe();f(0,"div",53)(1,"div",172)(2,"div",173)(3,"h3"),g(4,"\uD654\uBA74 \uBAA9\uB85D"),p(),f(5,"span",174),g(6),p()(),f(7,"div",175)(8,"button",176),re("click",function(){J(e);let i=k();return Q(i.selectDeviceTab("pc"))}),f(9,"span",177),g(10,"desktop_windows"),p(),g(11," PC "),p(),f(12,"button",176),re("click",function(){J(e);let i=k();return Q(i.selectDeviceTab("mobile"))}),f(13,"span",177),g(14,"smartphone"),p(),g(15," \uBAA8\uBC14\uC77C "),p()(),f(16,"div",178)(17,"input",179,0),re("keyup",function(){J(e);let i=Eo(18),a=k();return Q(a.filterScreens(i.value))}),p()(),f(19,"div",180),ae(20,nx,5,0,"div",181)(21,ix,2,0),p()(),f(22,"div",182),ae(23,ax,5,0,"div",183)(24,hx,21,8),p()()}if(n&2){let e=k();_(6),ge("",e.screensWithImages.length,"\uAC1C"),_(2),ve("active",e.selectedDeviceTab==="pc"),_(4),ve("active",e.selectedDeviceTab==="mobile"),_(8),oe(e.screensWithImages.length===0?20:21),_(3),oe(e.currentScreenDetail?24:23)}}function xx(n,t){if(n&1&&(f(0,"div",54),ee(1,"app-wbs-doc",220),p()),n&2){let e=k();_(),we("folderType",e.folderType)}}function _x(n,t){if(n&1&&(Me(),ee(0,"path",253)),n&2){let e=k().$implicit,r=k().$implicit,i=k(2);dt("edge-"+e.type),Lt("d",i.calculateEdgePath(r,t))}}function Cx(n,t){if(n&1&&ae(0,_x,1,3,":svg:path",252),n&2){let e,r=t.$implicit,i=k(3);oe((e=i.getTargetScreen(r.targetScreenId))?0:-1,e)}}function vx(n,t){if(n&1&&ye(0,Cx,1,1,null,null,b0),n&2){let e=t.$implicit;ke(e.connections)}}function bx(n,t){if(n&1&&(f(0,"span",258),g(1),p()),n&2){let e=k().$implicit,r=k(2);_(),ne(r.getScreenTypeLabel(e.screenType))}}function wx(n,t){if(n&1&&(f(0,"div",261)(1,"span",262),g(2),p(),f(3,"span",263),g(4),p()()),n&2){let e=t.$implicit;_(2),ne(e.midCategory),_(2),ge("(",e.features.length,")")}}function Px(n,t){if(n&1&&(f(0,"div",260),ye(1,wx,5,2,"div",261,ao),p()),n&2){let e=k().$implicit,r=k(2);_(),ke(r.getGroupedFeatures(e))}}function Mx(n,t){if(n&1&&(f(0,"span",280),g(1),qt(2,"slice"),p()),n&2){let e=k().$implicit;we("title",e.request),_(),Ir("",Do(2,3,e.request,0,30),"",e.request.length>30?"...":"")}}function Ox(n,t){if(n&1&&(f(0,"span",281),g(1),p()),n&2){let e=k().$implicit;_(),ge("",e.wbsInfo==null?null:e.wbsInfo.progress,"%")}}function yx(n,t){if(n&1&&(f(0,"li",278),ee(1,"span",140),f(2,"span",279),g(3),p(),ae(4,Mx,3,7,"span",280),ae(5,Ox,2,1,"span",281),p()),n&2){let e=t.$implicit;dt(e.status),_(),dt(e.status),_(2),ne(e.subCategory||e.midCategory),_(),oe(e.request?4:-1),_(),oe((e.wbsInfo==null?null:e.wbsInfo.progress)!==void 0?5:-1)}}function kx(n,t){if(n&1&&(f(0,"div",265)(1,"div",274)(2,"span",177),g(3,"folder"),p(),g(4),f(5,"span",275),g(6),p()(),f(7,"ul",276),ye(8,yx,6,7,"li",277,fn),p()()),n&2){let e=t.$implicit;_(4),ge(" ",e.midCategory," "),_(2),ge("",e.features.length,"\uAC1C"),_(2),ke(e.features)}}function Sx(n,t){if(n&1&&(f(0,"span",282),g(1),p()),n&2){let e=t.$implicit;dt(e.type),we("title",e.displayName||e.name),_(),ge(" ",e.displayName||e.name," ")}}function Ex(n,t){if(n&1&&(f(0,"div",264),ye(1,kx,10,2,"div",265,ao),f(3,"div",266)(4,"div",267)(5,"span",177),g(6,"bolt"),p(),g(7," \uC774\uBCA4\uD2B8 "),p(),f(8,"div",268),ye(9,Sx,2,4,"span",269,fn),p()()(),f(11,"div",270)(12,"div",271),g(13),qt(14,"number"),p(),f(15,"div",272),ee(16,"div",273),p()()),n&2){let e=k().$implicit,r=k(2);_(),ke(r.getGroupedFeatures(e)),_(8),ke(e.events),_(4),ge("\uC9C4\uD589\uB960: ",Xn(14,3,r.getScreenProgress(e),"1.0-0"),"%"),_(3),De("width",r.getScreenProgress(e),"%")}}function Tx(n,t){if(n&1){let e=Oe();f(0,"div",254),re("cdkDragStarted",function(i){let a=J(e).$implicit,o=k(2);return Q(o.onScreenDragStart(i,a))})("cdkDragMoved",function(i){let a=J(e).$implicit,o=k(2);return Q(o.onScreenDragMove(i,a))})("cdkDragEnded",function(i){let a=J(e).$implicit,o=k(2);return Q(o.onScreenDragEnd(i,a))})("click",function(){let i=J(e).$implicit,a=k(2);return Q(a.selectScreen(i))}),f(1,"div",255)(2,"span",256),g(3),p(),f(4,"span",257),g(5),p(),ae(6,bx,2,1,"span",258),f(7,"button",259),re("click",function(i){let a=J(e).$implicit,o=k(2);return Q(o.toggleScreenExpand(a.id,i))}),f(8,"span",177),g(9),p()()(),ae(10,Px,3,0,"div",260),ae(11,Ex,17,6),p()}if(n&2){let e=t.$implicit,r=k(2);De("left",e.position.x,"px")("top",e.position.y,"px"),ve("selected",r.selectedScreenId===e.id)("expanded",r.isScreenExpanded(e.id))("type-screen",e.screenType==="screen")("type-modal",e.screenType==="modal")("type-panel",e.screenType==="panel")("type-sheet",e.screenType==="sheet"),we("cdkDragData",e),_(),De("background-color",e.color),_(2),ne(e.icon),_(2),ne(e.name),_(),oe(e.screenType?6:-1),_(3),ge(" ",r.isScreenExpanded(e.id)?"expand_less":"expand_more"," "),_(),oe(r.isScreenExpanded(e.id)?-1:10),_(),oe(r.isScreenExpanded(e.id)?11:-1)}}function Dx(n,t){n&1&&(f(0,"div",250)(1,"span",177),g(2,"account_tree"),p(),f(3,"p"),g(4,"\uAE30\uD68D\uC548 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),p(),f(5,"p",283),g(6,"\uAE30\uD68D\uC548 \uBDF0\uC5D0\uC11C \uB370\uC774\uD130\uB97C \uCD94\uAC00\uD558\uBA74 IA \uD50C\uB85C\uC6B0\uCC28\uD2B8\uAC00 \uC790\uB3D9\uC73C\uB85C \uC0DD\uC131\uB429\uB2C8\uB2E4"),p()())}function Ax(n,t){if(n&1&&(f(0,"div",309)(1,"span",314),g(2,"\uC758\uB8B0\uB0B4\uC6A9:"),p(),g(3),p()),n&2){let e=k().$implicit;_(3),ge(" ",e.request," ")}}function Fx(n,t){if(n&1&&(f(0,"span",311)(1,"span",177),g(2,"star"),p(),g(3),p()),n&2){let e=k().$implicit;_(3),ge(" \uC6B0\uC120\uC21C\uC704: ",e.priority," ")}}function Ix(n,t){if(n&1&&(f(0,"span",312)(1,"span",177),g(2,"check_circle"),p(),g(3),p()),n&2){let e=k().$implicit;_(3),ge(" \uBC18\uC601\uAC00\uB2A5: ",e.feasibility," ")}}function Bx(n,t){if(n&1&&(f(0,"span",313)(1,"span",177),g(2,"trending_up"),p(),g(3),p()),n&2){let e=k().$implicit;_(3),ge(" \uC9C4\uD589: ",e.wbsInfo==null?null:e.wbsInfo.progress,"% ")}}function Rx(n,t){if(n&1&&(f(0,"div",305)(1,"div",136),ee(2,"span",306),f(3,"span",307),g(4),p(),f(5,"span",308),g(6),p()(),ae(7,Ax,4,1,"div",309),f(8,"div",310),ae(9,Fx,4,1,"span",311),ae(10,Ix,4,1,"span",312),ae(11,Bx,4,1,"span",313),p()()),n&2){let e=t.$implicit,r=k(4);_(2),dt(e.status),_(2),ne(e.subCategory||e.midCategory),_(),dt(e.status),_(),ge(" ",r.getStatusLabel(e.status)," "),_(),oe(e.request?7:-1),_(2),oe(e.priority?9:-1),_(),oe(e.feasibility?10:-1),_(),oe((e.wbsInfo==null?null:e.wbsInfo.progress)!==void 0?11:-1)}}function Lx(n,t){if(n&1&&(f(0,"div",296)(1,"div",301)(2,"span",177),g(3,"folder_open"),p(),f(4,"span",302),g(5),p(),f(6,"span",303),g(7),p()(),f(8,"div",304),ye(9,Rx,12,10,"div",305,fn),p()()),n&2){let e=t.$implicit;_(5),ne(e.midCategory),_(2),ge("",e.features.length,"\uAC1C"),_(2),ke(e.features)}}function Nx(n,t){if(n&1&&(f(0,"div",315)(1,"span",316),g(2),p(),f(3,"div",317)(4,"span",318),g(5),p(),f(6,"span",319),g(7),p()()()),n&2){let e=t.$implicit;dt(e.type),_(),dt(e.type),_(),ne(e.type),_(3),ne(e.displayName||e.name),_(2),ge("\uD2B8\uB9AC\uAC70: ",e.trigger)}}function zx(n,t){if(n&1){let e=Oe();f(0,"div",322),re("click",function(){let i=J(e),a=k(5);return Q(a.selectScreen(i))}),f(1,"span",323),g(2),p(),f(3,"span",324),g(4),p(),f(5,"span",325),g(6),p(),f(7,"span",326),g(8,"arrow_forward"),p()()}if(n&2){let e=t,r=k().$implicit;_(2),ne(e.icon),_(2),ne(e.name),_(2),ne(r.type)}}function jx(n,t){if(n&1&&ae(0,zx,9,3,"div",321),n&2){let e,r=t.$implicit,i=k(4);oe((e=i.getTargetScreen(r.targetScreenId))?0:-1,e)}}function Wx(n,t){if(n&1&&(f(0,"div",300)(1,"h4",206)(2,"span",177),g(3,"link"),p(),g(4," \uC5F0\uACB0\uB41C \uD654\uBA74 "),p(),f(5,"div",320),ye(6,jx,1,1,null,null,b0),p()()),n&2){let e=k();_(6),ke(e.connections)}}function Vx(n,t){if(n&1){let e=Oe();f(0,"div",284),re("click",function(i){return J(e),Q(i.stopPropagation())})("wheel",function(i){return J(e),Q(i.stopPropagation())}),f(1,"div",192)(2,"span",285),g(3),p(),f(4,"div",286)(5,"h3",287),g(6),p(),f(7,"span",153),g(8),p()(),f(9,"button",288),re("click",function(){J(e);let i=k(2);return Q(i.closeDetailPanel())}),f(10,"span",177),g(11,"close"),p()()(),f(12,"div",289)(13,"div",290)(14,"div",291)(15,"span",292),g(16,"\uC804\uCCB4 \uAE30\uB2A5"),p(),f(17,"span",293),g(18),p()(),f(19,"div",291)(20,"span",292),g(21,"\uC9C4\uD589\uB960"),p(),f(22,"span",293),g(23),qt(24,"number"),p()(),f(25,"div",291)(26,"span",292),g(27,"\uC774\uBCA4\uD2B8"),p(),f(28,"span",293),g(29),p()()(),f(30,"div",294)(31,"div",272),ee(32,"div",273),p()(),f(33,"div",295)(34,"h4",206)(35,"span",177),g(36,"list_alt"),p(),g(37," \uAE30\uD68D\uC548 \uC0C1\uC138 "),p(),ye(38,Lx,11,2,"div",296,ao),p(),f(40,"div",297)(41,"h4",206)(42,"span",177),g(43,"bolt"),p(),g(44," \uC774\uBCA4\uD2B8 \uBAA9\uB85D "),p(),f(45,"div",298),ye(46,Nx,8,7,"div",299,fn),p()(),ae(48,Wx,8,0,"div",300),p()()}if(n&2){let e=t,r=k(2);_(),De("background-color",e.color),_(2),ne(e.icon),_(3),ne(e.name),_(2),ne(e.id),_(10),ge("",e.features.length,"\uAC1C"),_(5),ge("",Xn(24,11,r.getScreenProgress(e),"1.0-0"),"%"),_(6),ge("",e.events.length,"\uAC1C"),_(3),De("width",r.getScreenProgress(e),"%"),_(6),ke(r.getGroupedFeatures(e)),_(8),ke(e.events),_(2),oe(e.connections.length>0?48:-1)}}function Ux(n,t){if(n&1){let e=Oe();f(0,"div",221),re("wheel",function(i){J(e);let a=k();return Q(a.onFlowchartWheel(i))})("mousedown",function(i){J(e);let a=k();return Q(a.startFlowchartPan(i))})("mousemove",function(i){J(e);let a=k();return Q(a.onFlowchartPanMove(i))})("mouseup",function(){J(e);let i=k();return Q(i.endFlowchartPan())})("mouseleave",function(){J(e);let i=k();return Q(i.endFlowchartPan())}),f(1,"div",222)(2,"div",223)(3,"button",224),re("click",function(){J(e);let i=k();return Q(i.flowchartZoomIn())}),f(4,"span",177),g(5,"add"),p()(),f(6,"span",225),g(7),qt(8,"number"),p(),f(9,"button",226),re("click",function(){J(e);let i=k();return Q(i.flowchartZoomOut())}),f(10,"span",177),g(11,"remove"),p()(),f(12,"button",227),re("click",function(){J(e);let i=k();return Q(i.flowchartFitToScreen())}),f(13,"span",177),g(14,"fit_screen"),p()(),f(15,"button",228),re("click",function(){J(e);let i=k();return Q(i.autoLayoutFlowchart())}),f(16,"span",177),g(17,"auto_awesome"),p(),f(18,"span",229),g(19,"\uC790\uB3D9 \uC815\uB82C"),p()()(),f(20,"div",223)(21,"span",230),g(22,"\uB514\uBC14\uC774\uC2A4:"),p(),f(23,"button",231),re("click",function(){J(e);let i=k();return Q(i.selectDeviceTab("pc"))}),f(24,"span",177),g(25,"desktop_windows"),p(),g(26," PC "),p(),f(27,"button",231),re("click",function(){J(e);let i=k();return Q(i.selectDeviceTab("mobile"))}),f(28,"span",177),g(29,"smartphone"),p(),g(30," \uBAA8\uBC14\uC77C "),p(),f(31,"span",232),g(32,"|"),p()(),f(33,"div",223)(34,"span",230),g(35,"\uD654\uBA74 \uD0C0\uC785:"),p(),f(36,"span",233)(37,"span",234),ee(38,"span",235),g(39,"\uD654\uBA74"),p(),f(40,"span",234),ee(41,"span",236),g(42,"\uBAA8\uB2EC"),p(),f(43,"span",234),ee(44,"span",237),g(45,"\uD328\uB110"),p(),f(46,"span",234),ee(47,"span",238),g(48,"\uC2DC\uD2B8"),p()(),f(49,"span",232),g(50,"|"),p(),f(51,"span",230),g(52,"\uC0C1\uD0DC:"),p(),f(53,"span",239)(54,"span",240),ee(55,"span",241),g(56,"\uB300\uAE30"),p(),f(57,"span",240),ee(58,"span",242),g(59,"\uC9C4\uD589"),p(),f(60,"span",240),ee(61,"span",243),g(62,"\uC644\uB8CC"),p()()()(),f(63,"div",244),Me(),f(64,"svg",245)(65,"defs")(66,"marker",246),ee(67,"polygon",247),p()(),ye(68,vx,2,0,null,null,fn),p(),Re(),f(70,"div",248),ye(71,Tx,12,25,"div",249,fn),p()(),ae(73,Dx,7,0,"div",250),ae(74,Vx,49,14,"div",251),p()}if(n&2){let e,r=k();_(7),ge("",Xn(8,9,r.flowchartZoom,"1.0-0"),"%"),_(16),ve("active",r.selectedDeviceTab==="pc"),_(4),ve("active",r.selectedDeviceTab==="mobile"),_(36),De("transform",r.getFlowchartTransform()),_(5),ke(r.flowchartScreens),_(3),ke(r.flowchartScreens),_(2),oe(r.flowchartScreens.length===0?73:-1),_(),oe((e=r.selectedScreenId&&r.getSelectedScreen())?74:-1,e)}}var ta=class n{container;intentNameInput;fileInput;playSimulator=new Rt;zoomLevelChange=new Rt;penModeChange=new Rt;simulatorRequested=new Rt;width=ha(1200);height=ha(0);pages=[];userFlows=[];viewMode="kanban";isMultiSelectMode=!1;folderType="calendar";specPlanData=[];set zoomLevel(t){this._zoomLevel=t}get zoomLevel(){return this._zoomLevel}set isPenMode(t){this._isPenMode=t}get isPenMode(){return this._isPenMode}_zoomLevel=100;_isPenMode=!1;isSpacePressed=!1;subscription=new xo;offsetX=0;offsetY=0;isPanning=!1;panStartX=0;panStartY=0;draggingNodeId=null;draggingGroupId=null;dragStartX=0;dragStartY=0;nodePositions=new Map;selectedNodeIds=new Set;nodeGroups=new Map;autoGroupsByCategory=new Map;virtualGroupPositions=new Map;groupCounter=0;editingGroupId=null;editingGroupTitle="";kanbanColumns=[];expandedCardId=null;isLoading=!1;hierarchicalData=[];connectedDropLists=["kanban-open","kanban-inProgress","kanban-completed"];CALENDAR_DATA_PATH="./data/calendar.json";NOTE_DATA_PATH="./data/note.json";STORAGE_KEY_CALENDAR="ia-spec-plan-calendar";STORAGE_KEY_NOTE="ia-spec-plan-note";originalJsonData=null;hasUnsavedChanges=!1;showDownloadMenu=!1;flowchartScreens=[];selectedScreenId=null;expandedScreenId=null;flowchartZoom=100;flowchartPanX=0;flowchartPanY=0;isFlowchartPanning=!1;flowchartPanStartX=0;flowchartPanStartY=0;screensWithImages=[];selectedScreenImageId=null;selectedDeviceTab="pc";isLiveViewMode=!0;currentScreenDetail=null;screenImagesList=[];activeImageId=null;draggingScreenId=null;dragOffsetX=0;dragOffsetY=0;dragStartPosition={x:0,y:0};wasDragged=!1;STATUS_COLORS={open:"#94a3b8",inProgress:"#3b82f6",completed:"#22c55e",urgent:"#ef4444"};dialog=ct(qo);snackbar=ct(Jo);router=ct(Uo);httpClient=ct(Dn);flowchartService=ct(Ji);projectSpecsService=ct(Wt);specsSyncService=ct(Sr);screenImageService=ct(ea);sanitizer=ct(An);constructor(){}ngOnInit(){this.initializeNodePositions(),this.loadSpecPlanData(this.folderType),this.pages&&this.pages.length>0?this.createGroupsFromPages():this.createSampleRoleGroups()}ngOnDestroy(){this.subscription.unsubscribe()}loadSpecPlanData(t){this.isLoading=!0,this.hasUnsavedChanges=!1;let e=t==="note"?this.NOTE_DATA_PATH:this.CALENDAR_DATA_PATH;this.httpClient.get(e).subscribe({next:r=>{this.originalJsonData=r;let i=t==="note"?this.STORAGE_KEY_NOTE:this.STORAGE_KEY_CALENDAR,a=localStorage.getItem(i);if(a)try{let s=JSON.parse(a);this.specPlanData=s,this.initializeKanbanView(),this.createCanvasFromSpecPlan(),this.generateFlowchartData(),this.initializeScreensFromData(),this.isLoading=!1,this.snackbar.open(`${t==="calendar"?"\uC774\uC9C0\uCE98\uB9B0\uB354":"\uC774\uC9C0\uB178\uD2B8"} \uC800\uC7A5\uB41C \uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC654\uC2B5\uB2C8\uB2E4`,"\uD655\uC778",{duration:2e3});return}catch(s){console.error("LocalStorage \uB370\uC774\uD130 \uD30C\uC2F1 \uC2E4\uD328:",s)}let o=r.specifications||[];this.specPlanData=o.map(s=>({id:`SP-${String(s.id).padStart(3,"0")}`,mainCategory:s.mainCategory,midCategory:s.midCategory,subCategory:s.subCategory||"",request:s.request,priority:s.priority,feasibility:s.feasibility,note:s.note||"",isHighPriority:s.isRed||!1,status:s.status||"open",startDate:s.startDate,endDate:s.endDate,progress:s.progress,responsible:s.responsible})),this.initializeKanbanView(),this.createCanvasFromSpecPlan(),this.generateFlowchartData(),this.initializeScreensFromData(),this.isLoading=!1},error:r=>{console.error(`[IA Canvas] ${t} \uB370\uC774\uD130 \uB85C\uB4DC \uC2E4\uD328:`,r),this.createSampleSpecPlanData(),this.isLoading=!1}})}saveToLocalStorage(){let t=this.folderType==="note"?this.STORAGE_KEY_NOTE:this.STORAGE_KEY_CALENDAR;localStorage.setItem(t,JSON.stringify(this.specPlanData)),this.hasUnsavedChanges=!1,this.snackbar.open("\uBCC0\uACBD\uC0AC\uD56D\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uD655\uC778",{duration:2e3})}saveToDatabase(){return bn(this,null,function*(){try{this.isLoading=!0,this.snackbar.open("\uB370\uC774\uD130\uBCA0\uC774\uC2A4\uC5D0 \uC800\uC7A5 \uC911...","",{duration:1e3});let t={requirements:this.specPlanData,metadata:{title:this.folderType==="calendar"?"Calendar":"Note",updatedAt:new Date().toISOString(),itemCount:this.specPlanData.length}};this.folderType==="calendar"?(yield this.specsSyncService.saveCalendarToDb(t),this.snackbar.open("\u2705 Calendar\uAC00 \uB370\uC774\uD130\uBCA0\uC774\uC2A4\uC5D0 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uD655\uC778",{duration:3e3})):(yield this.specsSyncService.saveNoteToDb(t),this.snackbar.open("\u2705 Note\uAC00 \uB370\uC774\uD130\uBCA0\uC774\uC2A4\uC5D0 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uD655\uC778",{duration:3e3})),this.saveToLocalStorage(),this.hasUnsavedChanges=!1}catch(t){console.error("[IA-Canvas] DB Save Error:",t),this.snackbar.open("\u274C \uC800\uC7A5 \uC2E4\uD328: "+t.message,"\uD655\uC778",{duration:5e3})}finally{this.isLoading=!1}})}downloadAsJson(){let t=this.originalJsonData?$e({},this.originalJsonData):{};t.specifications=this.specPlanData.map((a,o)=>({id:o+1,mainCategory:a.mainCategory,midCategory:a.midCategory,subCategory:a.subCategory,request:a.request,priority:a.priority,feasibility:a.feasibility,note:a.note,isRed:a.isHighPriority,status:a.status,startDate:a.startDate,endDate:a.endDate,progress:a.progress,responsible:a.responsible})),t.screenPositions=this.flowchartScreens.reduce((a,o)=>(a[o.name]={x:o.position.x,y:o.position.y},a),{});let e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(e),i=document.createElement("a");i.href=r,i.download=`${this.folderType}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),this.hasUnsavedChanges=!1,this.showDownloadMenu=!1,this.snackbar.open(`${this.folderType}.json \uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,"\uD655\uC778",{duration:4e3})}downloadAsExcel(){let t=`${this.folderType}_IA.xlsx`,e=this.specPlanData.map((c,l)=>({ID:c.id,no:l+1,\uB300\uBD84\uB958:c.mainCategory,\uC911\uBD84\uB958:c.midCategory,\uC18C\uBD84\uB958:c.subCategory,\uC758\uB8B0\uB0B4\uC6A9:c.request,\uBC18\uC601\uC694\uCCAD:c.priority,\uBC18\uC601\uAC00\uB2A5:c.feasibility,\uBE44\uACE0:c.note,\uC0C1\uD0DC:c.status||"open",\uC2DC\uC791\uC77C:c.startDate||"",\uC885\uB8CC\uC77C:c.endDate||"",\uC9C4\uCC99\uB960:c.progress?`${c.progress}%`:"",\uB2F4\uB2F9\uC790:c.responsible||""})),r=Te.json_to_sheet(e),i={fill:{fgColor:{rgb:"FF667EEA"}},font:{bold:!0,color:{rgb:"FFFFFFFF"},size:11},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},a={alignment:{vertical:"top",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},o=Te.decode_range(r["!ref"]||"A1");for(let c=o.s.c;c<=o.e.c;++c){let l=Te.encode_col(c)+"1";r[l]&&(r[l].s=i)}for(let c=o.s.r+1;c<=o.e.r;++c)for(let l=o.s.c;l<=o.e.c;++l){let d=Te.encode_cell({r:c,c:l});r[d]&&(r[d].s=a)}r["!cols"]=[{wch:12},{wch:8},{wch:12},{wch:14},{wch:14},{wch:30},{wch:12},{wch:12},{wch:20},{wch:12},{wch:12},{wch:12},{wch:10},{wch:12}];let s=Te.book_new();Te.book_append_sheet(s,r,"IA"),En(s,t),this.showDownloadMenu=!1,this.snackbar.open(`${t} \uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,"\uD655\uC778",{duration:3e3})}downloadWbs(){let t=this.projectSpecsService.getProjectSpecSync(this.folderType);if(!t){this.snackbar.open("WBS \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.","\uD655\uC778",{duration:2e3});return}let e=`${this.folderType}_WBS.xlsx`,r=(d,m=0)=>{let x=[];return d.forEach(u=>{x.push({ID:u.id,Level:m,\uC791\uC5C5\uBA85:"  ".repeat(m)+u.name,\uC2DC\uC791\uC77C:u.startDate,\uC885\uB8CC\uC77C:u.endDate,\uC9C4\uCC99\uB960:u.progress+"%",\uB2F4\uB2F9\uC790:u.responsible,\uBD80\uBAA8ID:u.parent||""}),u.subtasks&&u.subtasks.length>0&&(x=x.concat(r(u.subtasks,m+1)))}),x},i=[];if(t.wbs&&t.wbs.tasks&&(i=r(t.wbs.tasks)),i.length===0){this.snackbar.open("\uB2E4\uC6B4\uB85C\uB4DC\uD560 WBS \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.","\uD655\uC778",{duration:2e3}),this.showDownloadMenu=!1;return}let a=Te.json_to_sheet(i),o={fill:{fgColor:{rgb:"FF667EEA"}},font:{bold:!0,color:{rgb:"FFFFFFFF"},size:11},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},s={alignment:{vertical:"top",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},c=Te.decode_range(a["!ref"]||"A1");for(let d=c.s.c;d<=c.e.c;++d){let m=Te.encode_col(d)+"1";a[m]&&(a[m].s=o)}for(let d=c.s.r+1;d<=c.e.r;++d)for(let m=c.s.c;m<=c.e.c;++m){let x=Te.encode_cell({r:d,c:m});a[x]&&(a[x].s=s)}a["!cols"]=[{wch:15},{wch:8},{wch:30},{wch:12},{wch:12},{wch:10},{wch:12},{wch:15}];let l=Te.book_new();Te.book_append_sheet(l,a,"WBS"),En(l,e),this.showDownloadMenu=!1,this.snackbar.open(`${e} \uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,"\uD655\uC778",{duration:3e3})}toggleDownloadMenu(){this.showDownloadMenu=!this.showDownloadMenu}resetToOriginal(){if(confirm("\uC800\uC7A5\uB41C \uBCC0\uACBD\uC0AC\uD56D\uC744 \uC0AD\uC81C\uD558\uACE0 \uC6D0\uBCF8 \uB370\uC774\uD130\uB85C \uBCF5\uC6D0\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){let t=this.folderType==="note"?this.STORAGE_KEY_NOTE:this.STORAGE_KEY_CALENDAR;localStorage.removeItem(t),this.hasUnsavedChanges=!1;let e=this.folderType==="note"?this.NOTE_DATA_PATH:this.CALENDAR_DATA_PATH;this.isLoading=!0,this.httpClient.get(e).subscribe({next:r=>{let i=r.specifications||[];this.specPlanData=i.map(a=>({id:`SP-${String(a.id).padStart(3,"0")}`,mainCategory:a.mainCategory,midCategory:a.midCategory,subCategory:a.subCategory||"",request:a.request,priority:a.priority,feasibility:a.feasibility,note:a.note||"",isHighPriority:a.isRed||!1,status:"open"})),this.initializeKanbanView(),this.createCanvasFromSpecPlan(),this.isLoading=!1,this.snackbar.open("\uC6D0\uBCF8 \uB370\uC774\uD130\uB85C \uBCF5\uC6D0\uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uD655\uC778",{duration:2e3})},error:r=>{console.error("\uC6D0\uBCF8 \uB370\uC774\uD130 \uB85C\uB4DC \uC2E4\uD328:",r),this.isLoading=!1}})}}markAsChanged(){this.hasUnsavedChanges=!0}initializeKanbanView(){this.kanbanColumns=[{type:"open",title:"\uC624\uD508",color:"#94a3b8",items:[]},{type:"inProgress",title:"\uC9C4\uD589\uC911",color:"#3b82f6",items:[]},{type:"completed",title:"\uC644\uB8CC",color:"#22c55e",items:[]}],this.specPlanData&&this.specPlanData.length>0?this.categorizeItemsToKanban(this.specPlanData):this.createSampleSpecPlanData()}createCanvasFromSpecPlan(){if(!this.specPlanData||this.specPlanData.length===0)return;let t=new Map;this.specPlanData.forEach(r=>{let i=r.mainCategory||"\uAE30\uD0C0",a=r.midCategory||"\uAE30\uD0C0";t.has(i)||t.set(i,new Map);let o=t.get(i);o.has(a)||o.set(a,[]),o.get(a).push(r)}),this.hierarchicalData=[],Array.from(t.keys()).sort().forEach(r=>{let i=t.get(r),a=[];Array.from(i.keys()).sort().forEach(s=>{a.push({name:s,items:i.get(s)})}),this.hierarchicalData.push({mainCategory:r,color:this.getMainCategoryColor(r),midCategories:a})}),this.nodeGroups.clear(),this.nodePositions.clear(),this.virtualGroupPositions.clear()}createSampleSpecPlanData(){let t=[{id:"SP-001",mainCategory:"\uB85C\uADF8\uC778/\uD68C\uC6D0\uAC00\uC785",midCategory:"\uB85C\uADF8\uC778",subCategory:"\uC774\uBA54\uC77C \uB85C\uADF8\uC778",request:`\uC774\uBA54\uC77C\uACFC \uBE44\uBC00\uBC88\uD638\uB85C \uB85C\uADF8\uC778 \uAD6C\uD604
- \uBE44\uBC00\uBC88\uD638 \uC554\uD638\uD654
- \uC790\uB3D9 \uB85C\uADF8\uC778 \uC635\uC158`,priority:"3.0",feasibility:"2.5",note:"MVP \uD544\uC218",isHighPriority:!0},{id:"SP-002",mainCategory:"\uB85C\uADF8\uC778/\uD68C\uC6D0\uAC00\uC785",midCategory:"\uB85C\uADF8\uC778",subCategory:"\uC18C\uC15C \uB85C\uADF8\uC778",request:"\uAD6C\uAE00, \uCE74\uCE74\uC624, \uB124\uC774\uBC84 \uC18C\uC15C \uB85C\uADF8\uC778 \uC5F0\uB3D9",priority:"2.0",feasibility:"1.5",note:"2\uCC28 \uAC1C\uBC1C"},{id:"SP-003",mainCategory:"\uB85C\uADF8\uC778/\uD68C\uC6D0\uAC00\uC785",midCategory:"\uD68C\uC6D0\uAC00\uC785",subCategory:"\uC774\uBA54\uC77C \uC778\uC99D",request:`\uD68C\uC6D0\uAC00\uC785 \uC2DC \uC774\uBA54\uC77C \uC778\uC99D \uD544\uC218
- \uC778\uC99D \uBA54\uC77C \uBC1C\uC1A1
- \uC778\uC99D \uCF54\uB4DC \uD655\uC778`,priority:"2.5",feasibility:"2.0",note:""},{id:"SP-004",mainCategory:"\uCE98\uB9B0\uB354",midCategory:"\uC77C\uC815\uAD00\uB9AC",subCategory:"\uC77C\uC815 \uC0DD\uC131",request:`\uC0C8 \uC77C\uC815 \uC0DD\uC131 \uAE30\uB2A5
- \uC81C\uBAA9, \uB0A0\uC9DC, \uC2DC\uAC04 \uC785\uB825
- \uBC18\uBCF5 \uC124\uC815
- \uC54C\uB9BC \uC124\uC815`,priority:"3.0",feasibility:"2.5",note:"MVP \uD544\uC218",isHighPriority:!0},{id:"SP-005",mainCategory:"\uCE98\uB9B0\uB354",midCategory:"\uC77C\uC815\uAD00\uB9AC",subCategory:"\uC77C\uC815 \uC218\uC815/\uC0AD\uC81C",request:"\uAE30\uC874 \uC77C\uC815 \uC218\uC815 \uBC0F \uC0AD\uC81C \uAE30\uB2A5",priority:"2.5",feasibility:"2.0",note:""},{id:"SP-006",mainCategory:"\uCE98\uB9B0\uB354",midCategory:"\uBDF0",subCategory:"\uC6D4\uAC04 \uBDF0",request:`\uC6D4\uAC04 \uCE98\uB9B0\uB354 \uBDF0 \uAD6C\uD604
- \uC6D4\uBCC4 \uC77C\uC815 \uD45C\uC2DC
- \uB0A0\uC9DC \uD074\uB9AD \uC2DC \uC0C1\uC138`,priority:"2.5",feasibility:"2.0",note:""},{id:"SP-007",mainCategory:"\uCE98\uB9B0\uB354",midCategory:"\uBDF0",subCategory:"\uC8FC\uAC04/\uC77C\uAC04 \uBDF0",request:"\uC8FC\uAC04 \uBC0F \uC77C\uAC04 \uCE98\uB9B0\uB354 \uBDF0",priority:"2.0",feasibility:"1.5",note:"2\uCC28 \uAC1C\uBC1C"},{id:"SP-008",mainCategory:"\uB178\uD2B8",midCategory:"\uC5D0\uB514\uD130",subCategory:"\uB9AC\uCE58 \uD14D\uC2A4\uD2B8",request:`\uB9AC\uCE58 \uD14D\uC2A4\uD2B8 \uC5D0\uB514\uD130
- \uBCFC\uB4DC, \uC774\uD0E4\uB9AD, \uC5B8\uB354\uB77C\uC778
- \uD5E4\uB529
- \uB9AC\uC2A4\uD2B8`,priority:"3.0",feasibility:"2.5",note:"MVP \uD544\uC218",isHighPriority:!0},{id:"SP-009",mainCategory:"\uB178\uD2B8",midCategory:"\uC5D0\uB514\uD130",subCategory:"\uC774\uBBF8\uC9C0 \uC0BD\uC785",request:"\uB178\uD2B8\uC5D0 \uC774\uBBF8\uC9C0 \uCCA8\uBD80 \uAE30\uB2A5",priority:"2.0",feasibility:"1.0",note:"\uAE30\uC220 \uAC80\uD1A0 \uD544\uC694"},{id:"SP-010",mainCategory:"\uB178\uD2B8",midCategory:"\uD3F4\uB354",subCategory:"\uD3F4\uB354 \uAD00\uB9AC",request:`\uB178\uD2B8 \uD3F4\uB354 \uC0DD\uC131/\uC218\uC815/\uC0AD\uC81C
- \uB4DC\uB798\uADF8 \uC564 \uB4DC\uB86D\uC73C\uB85C \uC815\uB9AC`,priority:"2.0",feasibility:"1.5",note:""},{id:"SP-011",mainCategory:"\uD611\uC5C5",midCategory:"\uACF5\uC720",subCategory:"\uBB38\uC11C \uACF5\uC720",request:`\uBB38\uC11C \uACF5\uC720 \uB9C1\uD06C \uC0DD\uC131
- \uAD8C\uD55C \uC124\uC815 (\uBCF4\uAE30/\uD3B8\uC9D1)`,priority:"2.5",feasibility:"1.0",note:"\uBCF4\uC548 \uAC80\uD1A0 \uD544\uC694"},{id:"SP-012",mainCategory:"\uD611\uC5C5",midCategory:"\uC2E4\uC2DC\uAC04",subCategory:"\uB3D9\uC2DC \uD3B8\uC9D1",request:"\uC2E4\uC2DC\uAC04 \uB3D9\uC2DC \uD3B8\uC9D1 \uAE30\uB2A5",priority:"1.5",feasibility:"0.5",note:"3\uCC28 \uAC1C\uBC1C, \uBCF5\uC7A1\uB3C4 \uB192\uC74C"}];this.specPlanData=t,this.categorizeItemsToKanban(t)}categorizeItemsToKanban(t){this.kanbanColumns.forEach(e=>e.items=[]),t.forEach(e=>{switch(e.status||(e.status="open"),e.status){case"open":this.kanbanColumns[0].items.push(e);break;case"inProgress":this.kanbanColumns[1].items.push(e);break;case"completed":this.kanbanColumns[2].items.push(e);break;default:this.kanbanColumns[0].items.push(e)}})}getPriorityClass(t){let e=parseFloat(t)||0;return e>=4?"priority-high":e>=2?"priority-medium":"priority-low"}getFeasibilityClass(t){let e=parseFloat(t)||0;return e>=4?"feasibility-high":e>=2?"feasibility-medium":"feasibility-low"}getScoreVisual(t){let e=parseFloat(t)||0,r=Math.round(e),i=3-r;return"\u25CF".repeat(Math.min(r,3))+"\u25CB".repeat(Math.max(i,0))}toggleCardExpand(t,e){e.stopPropagation(),this.expandedCardId===t?this.expandedCardId=null:this.expandedCardId=t}isCardExpanded(t){return this.expandedCardId===t}getItemsByMainCategory(t){let e=new Map;return t.forEach(r=>{e.has(r.mainCategory)||e.set(r.mainCategory,[]),e.get(r.mainCategory).push(r)}),e}getMainCategoryColor(t){return this.STATUS_COLORS.open}getHighPriorityCount(){return this.specPlanData.filter(t=>t.isHighPriority).length}getCompletedCount(){return this.specPlanData.filter(t=>t.status==="completed").length}getInProgressCount(){return this.specPlanData.filter(t=>t.status==="inProgress").length}getTotalItemsInMainCategory(t){return t.midCategories.reduce((e,r)=>e+r.items.length,0)}onKanbanDrop(t,e){if(t.previousContainer===t.container)Ho(t.container.data,t.previousIndex,t.currentIndex);else{let r=t.previousContainer.data[t.previousIndex];r.status=e,$o(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex);let i=this.specPlanData.find(a=>a.id===r.id);i&&(i.status=e,i.progress=this.getProgressFromStatus(e)),this.syncHierarchicalData(),this.markAsChanged(),this.snackbar.open(`"${r.subCategory||r.midCategory}" \uD56D\uBAA9\uC774 "${this.getColumnTitle(e)}"\uC73C\uB85C \uC774\uB3D9\uB418\uC5C8\uC2B5\uB2C8\uB2E4`,"\uD655\uC778",{duration:3e3})}}getColumnTitle(t){switch(t){case"open":return"\uC624\uD508";case"inProgress":return"\uC9C4\uD589\uC911";case"completed":return"\uC644\uB8CC";default:return""}}syncHierarchicalData(){this.hierarchicalData.forEach(t=>{t.midCategories.forEach(e=>{e.items.forEach(r=>{let i=this.specPlanData.find(a=>a.id===r.id);i&&(r.status=i.status)})})})}getKanbanColumnStatus(t){switch(t.status||"open"){case"open":return{type:"open",label:"\uC624\uD508",color:"#3b82f6"};case"inProgress":return{type:"inProgress",label:"\uC9C4\uD589\uC911",color:"#f59e0b"};case"completed":return{type:"completed",label:"\uC644\uB8CC",color:"#10b981"};default:return{type:"open",label:"\uC624\uD508",color:"#3b82f6"}}}initializeNodePositions(){this.pages.forEach((t,e)=>{let r=100+e%3*350,i=100+Math.floor(e/3)*200;this.nodePositions.set(t.id,{x:r,y:i})})}autoGroupNodesByCategory(){let t=new Map;this.pages.forEach(i=>{let a=i.category||"\uAE30\uD0C0";t.has(a)||t.set(a,[]),t.get(a).push(i.id)});let e=100,r=100;t.forEach((i,a)=>{if(i.length===0)return;let o=this.STATUS_COLORS.open;this.autoGroupsByCategory.set(a,{nodeIds:i,color:o});let s=80;i.forEach((l,d)=>{let m=r,x=e+d*s;this.nodePositions.set(l,{x:m,y:x})});let c=i.length*s+50;e+=c+80,e>800&&(e=100,r+=400)})}createGroupsFromPages(){if(!this.pages||this.pages.length===0)return;this.nodeGroups.clear(),this.nodePositions.clear(),this.virtualGroupPositions.clear();let t=new Map;this.pages.forEach(v=>{let h=v.category||"\uAE30\uD0C0";t.has(h)||t.set(h,[]),t.get(h).push(v)});let e=Array.from(t.keys()).sort(),r=400,i=3,a=100,o=100,s=85,c=100,l=110,d=0,m=a,x=o,u=0;e.forEach(v=>{t.get(v).forEach(w=>{let T=u%i,F=Math.floor(u/i);T===0&&u>0&&(x+=d+c,d=0),m=a+T*r;let I=`page-group-${w.id}`,j=[],W=w.components||[];this.nodeGroups.set(I,{nodeIds:j,title:w.name,x:m,y:x,description:w.description,category:v}),this.virtualGroupPositions.set(I,{x:m,y:x});let pe=l+(w.description?60:0);if(W.length>0)W.forEach((X,z)=>{let H=`${w.id}-comp-${z}`;j.push(H),this.nodePositions.set(H,{x:m+20,y:x+pe+z*s})});else{let X=`${w.id}-comp-default`;j.push(X),this.nodePositions.set(X,{x:m+20,y:x+pe})}let A=pe+j.length*s+20;A>d&&(d=A),u++})})}createSampleRoleGroups(){let t=[{id:"group-auth",title:"\uC778\uC99D & \uBCF4\uC548",color:this.STATUS_COLORS.open,nodeCount:3,col:0,row:0},{id:"group-main",title:"\uBA54\uC778 \uD654\uBA74",color:this.STATUS_COLORS.open,nodeCount:3,col:1,row:0},{id:"group-content",title:"\uCF58\uD150\uCE20 \uAD00\uB9AC",color:this.STATUS_COLORS.open,nodeCount:4,col:2,row:0},{id:"group-collab",title:"\uD611\uC5C5 & \uACF5\uC720",color:this.STATUS_COLORS.open,nodeCount:3,col:0,row:1},{id:"group-settings",title:"\uC124\uC815 & \uAD00\uB9AC",color:this.STATUS_COLORS.open,nodeCount:3,col:1,row:1}],e=0,r=85,i=400,a=600,o=100,s=100;t.forEach(c=>{let l=[],d=o+c.col*i,m=s+c.row*a;for(let x=0;x<c.nodeCount;x++){let u=`sample-${e}`;l.push(u);let v=d+20,h=m+110+x*r;this.nodePositions.set(u,{x:v,y:h}),e++}this.nodeGroups.set(c.id,{nodeIds:l,title:c.title,x:d,y:m}),this.virtualGroupPositions.set(c.id,{x:d,y:m})})}getCategoryColor(t){for(let[e,r]of this.autoGroupsByCategory)if(r.nodeIds.includes(t))return r.color;return this.STATUS_COLORS.open}getPageCategory(t){return this.pages.find(r=>r.id===t)?.category||""}getPageDescription(t){return this.pages.find(r=>r.id===t)?.description||""}getSampleNodeIds(){let t=[];for(let e of this.nodeGroups.values())t.push(...e.nodeIds);return t}getSampleNodeName(t){if(t.startsWith("SP-")){let r=this.specPlanData.find(i=>i.id===t);if(r)return r.subCategory||r.midCategory||r.request.substring(0,20)}if(t.includes("-comp-")){let r=t.split("-comp-"),i=r[0],a=r[1],o=this.pages.find(s=>s.id===i);if(o&&o.components)return a==="default"?"\uAE30\uBCF8 \uAD6C\uC131\uC694\uC18C":o.components[parseInt(a)]||"\uAD6C\uC131\uC694\uC18C"}let e=this.pages.find(r=>r.id===t);return e?e.name:"\uAD6C\uC131\uC694\uC18C"}getSpecPlanItem(t){return this.specPlanData.find(e=>e.id===t)}getNodePosition(t){return this.nodePositions.get(t)||{x:0,y:0}}onNodeMouseDown(t,e){this.isPenMode||this.isSpacePressed||t.button!==0||(t.stopPropagation(),this.draggingNodeId=e,this.dragStartX=t.clientX,this.dragStartY=t.clientY)}onCanvasMouseMove(t){if(this.draggingNodeId){let e=t.clientX-this.dragStartX,r=t.clientY-this.dragStartY,i=this.nodePositions.get(this.draggingNodeId)||{x:0,y:0},a=this.zoomLevel/100;this.nodePositions.set(this.draggingNodeId,{x:i.x+e/a,y:i.y+r/a}),this.dragStartX=t.clientX,this.dragStartY=t.clientY;return}if(this.isPanning){let e=t.clientX-this.panStartX,r=t.clientY-this.panStartY;this.offsetX+=e,this.offsetY+=r,this.panStartX=t.clientX,this.panStartY=t.clientY}}onCanvasMouseUp(){this.draggingNodeId=null,this.isPanning=!1}zoomIn(){this.zoomLevel<200&&(this.zoomLevel=Math.min(200,this.zoomLevel+10),this.zoomLevelChange.emit(this.zoomLevel))}zoomOut(){this.zoomLevel>50&&(this.zoomLevel=Math.max(50,this.zoomLevel-10),this.zoomLevelChange.emit(this.zoomLevel))}resetZoom(){this.zoomLevel=100,this.zoomLevelChange.emit(this.zoomLevel)}onWheel(t){(t.ctrlKey||t.metaKey)&&(t.preventDefault(),t.deltaY<0?this.zoomIn():this.zoomOut())}handleKeyboard(t){if(t.code==="Space"){let e=t.target;e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&(this.isSpacePressed=!0,t.preventDefault())}(t.ctrlKey||t.metaKey)&&(t.key==="+"||t.key==="="?(t.preventDefault(),this.zoomIn()):t.key==="-"?(t.preventDefault(),this.zoomOut()):t.key==="0"&&(t.preventDefault(),this.resetZoom()))}handleKeyUp(t){t.code==="Space"&&(this.isSpacePressed=!1)}onBlur(){this.isSpacePressed=!1}onCanvasMouseDown(t){(this.isSpacePressed||this.isPenMode)&&t.button===0&&(this.isPanning=!0,this.panStartX=t.clientX,this.panStartY=t.clientY,t.preventDefault())}togglePenMode(){this.isPenMode=!this.isPenMode,this.penModeChange.emit(this.isPenMode)}onNodeClick(t,e){this.isMultiSelectMode?(this.selectedNodeIds.has(e)?this.selectedNodeIds.delete(e):this.selectedNodeIds.add(e),t.stopPropagation()):t.shiftKey&&(this.selectedNodeIds.has(e)?this.selectedNodeIds.delete(e):this.selectedNodeIds.add(e),t.stopPropagation())}onNodeDoubleClick(t){let e;if(t.includes("-comp-")){let r=t.split("-comp-")[0];e=this.pages.find(i=>i.id===r)}else e=this.pages.find(r=>r.id===t);if(e){let r=e.projectModule||"desk",i=this.getProjectModuleRoute(r,e.id),a=document.querySelector("base")?.getAttribute("href")||"/",o=`${window.location.origin}${a}#${i}`;console.log("\u{1F517} Opening simulator in new window:",o),window.open(o,"_blank")}}getProjectModuleRoute(t,e){let r=t;return(!r||r==="desk")&&e&&(e.startsWith("EZCAL-")?r="calendar":e.startsWith("EZNOTE-")&&(r="note")),{calendar:"/calendar/pc",note:"/note/pc",project:"/project/pc",dashboard:"/dashboard/pc",desk:"/desk"}[r]||"/desk"}isNodeSelected(t){return this.selectedNodeIds.has(t)}groupSelectedNodes(){if(this.selectedNodeIds.size<2){this.snackbar.open("\uADF8\uB8F9\uD654\uD558\uB824\uBA74 \uCD5C\uC18C 2\uAC1C \uC774\uC0C1\uC758 \uB178\uB4DC\uB97C \uC120\uD0DD\uD558\uC138\uC694","\uB2EB\uAE30",{duration:3e3});return}let t=`group-${this.groupCounter++}`,e=Array.from(this.selectedNodeIds),r=100+this.groupCounter*50,i=100+this.groupCounter*50,a=80;e.forEach((o,s)=>{let c=r,l=i+s*a;this.nodePositions.set(o,{x:c,y:l})}),this.nodeGroups.set(t,{nodeIds:e,title:`\uADF8\uB8F9 ${this.groupCounter}`,x:r,y:i}),this.snackbar.open(`${e.length}\uAC1C\uC758 \uB178\uB4DC\uAC00 \uADF8\uB8F9\uD654\uB418\uC5C8\uC2B5\uB2C8\uB2E4`,"\uB2EB\uAE30",{duration:3e3}),this.selectedNodeIds.clear()}ungroupNodes(t){let e=this.nodeGroups.get(t);e&&(e.nodeIds.forEach(r=>this.selectedNodeIds.add(r)),this.nodeGroups.delete(t),this.snackbar.open("\uADF8\uB8F9\uC774 \uD574\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4","\uB2EB\uAE30",{duration:3e3}))}getGroupIdForNode(t){for(let[e,r]of this.nodeGroups)if(r.nodeIds.includes(t))return e;return null}getGroupNodes(t){return this.nodeGroups.get(t)?.nodeIds||[]}getGroupBounds(t){let e=this.nodeGroups.get(t);if(!e||e.nodeIds.length===0)return null;let r=this.virtualGroupPositions.get(t)||{x:e.x,y:e.y},i=r.x,a=r.y,o=i+320,s=e.nodeIds.length,c=85,l=110;e.description&&(l+=60);let d=a+l+s*c;return{minX:i,minY:a,maxX:o,maxY:d}}getCategoryGroupBounds(t){let e=this.autoGroupsByCategory.get(t);if(!e||e.nodeIds.length===0)return null;let r=1/0,i=1/0,a=-1/0,o=-1/0;return e.nodeIds.forEach(s=>{let c=this.getNodePosition(s);r=Math.min(r,c.x),i=Math.min(i,c.y),a=Math.max(a,c.x+160),o=Math.max(o,c.y+60)}),{minX:r,minY:i,maxX:a,maxY:o}}startEditingGroupTitle(t){let e=this.nodeGroups.get(t);e&&(this.editingGroupId=t,this.editingGroupTitle=e.title)}saveGroupTitle(t,e){let r=this.nodeGroups.get(t);r&&e.trim()&&(r.title=e.trim(),this.editingGroupId=null,this.editingGroupTitle="")}cancelEditingGroupTitle(){this.editingGroupId=null,this.editingGroupTitle=""}clearSelection(){this.selectedNodeIds.clear()}onGroupMouseDown(t,e){t.button===0&&(t.stopPropagation(),this.draggingGroupId=e,this.dragStartX=t.clientX,this.dragStartY=t.clientY)}onGroupMouseMove(t,e){if(this.draggingGroupId!==e||!this.draggingGroupId)return;let r=t.clientX-this.dragStartX,i=t.clientY-this.dragStartY,a=this.virtualGroupPositions.get(e);a&&(a.x+=r/(this.zoomLevel/100),a.y+=i/(this.zoomLevel/100)),this.dragStartX=t.clientX,this.dragStartY=t.clientY}onGroupMouseUp(){this.draggingGroupId=null}getTransformStyle(){return`translate(${this.offsetX}px, ${this.offsetY}px) scale(${this.zoomLevel/100})`}getProgressFromStatus(t){switch(t){case"completed":return 100;case"inProgress":return 50;case"open":default:return 0}}generateFlowchartData(){this.specPlanData.length!==0&&this.initializeScreensFromData()}selectScreen(t){if(this.wasDragged){this.wasDragged=!1;return}this.selectedScreenId=t.id}getSelectedScreen(){return this.flowchartScreens.find(t=>t.id===this.selectedScreenId)}closeDetailPanel(){this.selectedScreenId=null}getStatusLabel(t){return{open:"\uB300\uAE30",inProgress:"\uC9C4\uD589\uC911",completed:"\uC644\uB8CC",review:"\uAC80\uD1A0\uC911",blocked:"\uBCF4\uB958"}[t]||t}getScreenTypeLabel(t){return{screen:"\uD654\uBA74",modal:"\uBAA8\uB2EC",panel:"\uD328\uB110",sheet:"\uC2DC\uD2B8"}[t]||t}toggleScreenExpand(t,e){e.stopPropagation(),this.expandedScreenId=this.expandedScreenId===t?null:t}isScreenExpanded(t){return this.expandedScreenId===t}getGroupedFeatures(t){return this.flowchartService.groupFeaturesByMidCategory(t.features)}getScreenProgress(t){return this.flowchartService.calculateScreenProgress(t)}getEventTypeColor(t){return this.flowchartService.getEventColor(t)}flowchartZoomIn(){this.flowchartZoom=Math.min(200,this.flowchartZoom+10)}flowchartZoomOut(){this.flowchartZoom=Math.max(50,this.flowchartZoom-10)}flowchartFitToScreen(){this.flowchartZoom=100,this.flowchartPanX=0,this.flowchartPanY=0}autoLayoutFlowchart(){if(this.flowchartScreens.length===0)return;let t=this.flowchartService.autoLayoutScreens(this.flowchartScreens);for(let r of this.flowchartScreens)t[r.name]&&(r.position=t[r.name]);let e=this.flowchartService.findCollidingScreens(this.flowchartScreens,t);e.length>0?this.snackbar.open(`\u26A0\uFE0F \uCDA9\uB3CC \uAC10\uC9C0: ${e.join(", ")} (\uACB9\uCE68)`,"\uD655\uC778",{duration:3e3}):this.snackbar.open("\u2713 \uC790\uB3D9 \uC815\uB82C \uC644\uB8CC (\uCDA9\uB3CC \uC5C6\uC74C)","\uD655\uC778",{duration:2e3}),this.flowchartZoom=100,this.flowchartPanX=0,this.flowchartPanY=0}startFlowchartPan(t){t.button===0&&(this.isFlowchartPanning=!0,this.flowchartPanStartX=t.clientX-this.flowchartPanX,this.flowchartPanStartY=t.clientY-this.flowchartPanY)}onFlowchartPanMove(t){this.isFlowchartPanning&&(this.flowchartPanX=t.clientX-this.flowchartPanStartX,this.flowchartPanY=t.clientY-this.flowchartPanStartY)}endFlowchartPan(){this.isFlowchartPanning=!1}onFlowchartWheel(t){t.preventDefault();let e=t.deltaY>0?-10:10;this.flowchartZoom=Math.max(50,Math.min(200,this.flowchartZoom+e))}getFlowchartTransform(){return`translate(${this.flowchartPanX}px, ${this.flowchartPanY}px) scale(${this.flowchartZoom/100})`}calculateEdgePath(t,e){let a=this.getScreenPositionWithOffset(t),o=this.getScreenPositionWithOffset(e);return this.flowchartService.calculateEdgePath(ot($e({},a),{width:240,height:120}),ot($e({},o),{width:240,height:120}))}getTargetScreen(t){return this.flowchartScreens.find(e=>e.id===t)}onScreenDragStart(t,e){this.draggingScreenId=e.id,this.dragStartPosition={x:e.position.x,y:e.position.y},this.dragOffsetX=0,this.dragOffsetY=0,this.wasDragged=!1}onScreenDragMove(t,e){let r=t.distance,i=this.flowchartZoom/100;this.dragOffsetX=r.x/i,this.dragOffsetY=r.y/i,(Math.abs(this.dragOffsetX)>5||Math.abs(this.dragOffsetY)>5)&&(this.wasDragged=!0),e.position.x=Math.max(0,this.dragStartPosition.x+this.dragOffsetX),e.position.y=Math.max(0,this.dragStartPosition.y+this.dragOffsetY),t.source._dragRef.reset()}onScreenDragEnd(t,e){e.position.x=Math.max(0,e.position.x),e.position.y=Math.max(0,e.position.y),this.draggingScreenId=null,this.dragOffsetX=0,this.dragOffsetY=0,t.source._dragRef.reset(),this.hasUnsavedChanges=!0}getScreenPositionWithOffset(t){return t.position}initializeScreensFromData(){let t=new Map,e={"\uCE98\uB9B0\uB354 \uAD00\uB9AC":"\u{1F4C5}","\uCE98\uB9B0\uB354 \uBAA9\uB85D":"\u{1F4CB}","\uC5F0\uB3D9 \uAD00\uB9AC":"\u{1F517}","\uC77C\uC815 \uAD00\uB9AC":"\u270F\uFE0F",\uD611\uC5C5:"\u{1F465}",\uC124\uC815:"\u2699\uFE0F",\uD1B5\uACC4:"\u{1F4CA}",\uAC80\uC0C9:"\u{1F50D}",\uC54C\uB9BC:"\u{1F514}",AI:"\u{1F916}",\uD648:"\u{1F3E0}",\uBA54\uC778:"\u2B50"},r={"\uCE98\uB9B0\uB354 \uAD00\uB9AC":"#667eea","\uCE98\uB9B0\uB354 \uBAA9\uB85D":"#764ba2","\uC5F0\uB3D9 \uAD00\uB9AC":"#f093fb","\uC77C\uC815 \uAD00\uB9AC":"#4facfe",\uD611\uC5C5:"#43e97b",\uC124\uC815:"#fa709a",\uD1B5\uACC4:"#30cfd0",\uAC80\uC0C9:"#a8edea",\uC54C\uB9BC:"#fed6e3",AI:"#ff9a56",\uD648:"#a29bfe",\uBA54\uC778:"#0984e3"};this.specPlanData&&this.specPlanData.length>0&&this.specPlanData.forEach(x=>{let u=x.mainCategory;t.has(u)||t.set(u,{icon:e[u]||"\u{1F4C4}",color:r[u]||"#667eea",count:0});let v=t.get(u);v&&v.count++});let i=[],a=new Map,o=this.originalJsonData?.screenPositions,s=50,c=50,l=320,d=4,m=0;t.forEach((x,u)=>{let v=o?.[`PC - ${u}`]||{x:s+m%d*l,y:c+Math.floor(m/d)*l},h=o?.[`\uB178\uD2B8 - ${u}`]||{x:s+m%d*l,y:c+Math.floor(m/d)*l},T=this.flowchartService.SCREEN_HIERARCHY[u]?.depth??1,F={id:`SCR-PC-${i.length+1}`,name:`PC - ${u}`,icon:"\u{1F4BB}",description:`${u} (PC \uBC84\uC804)`,category:u,device:"pc",color:x.color,position:v,features:[],events:[],connections:[],screenType:"screen",depth:T},I=this.specPlanData.filter(W=>W.mainCategory===u).map(W=>({id:W.id,midCategory:W.midCategory,subCategory:W.subCategory,name:W.subCategory||W.midCategory,request:W.request,priority:W.priority,feasibility:W.feasibility,status:W.status||"open"}));F.features=I,i.push(F);let j={id:`SCR-MB-${i.length+1}`,name:`\uB178\uD2B8 - ${u}`,icon:"\u{1F4F1}",description:`${u} (\uB178\uD2B8 \uBC84\uC804)`,category:u,device:"mobile",color:x.color,position:h,features:I,events:[],connections:[],screenType:"screen",depth:T};i.push(j),a.set(u,{pc:F,mobile:j}),m++}),t.forEach((x,u)=>{let v=this.flowchartService.SCREEN_HIERARCHY[u],h=a.get(u);v&&v.children&&h&&v.children.forEach(w=>{let T=a.get(w);T&&(h.pc.connections.push({targetScreenId:T.pc.id,type:"navigate",label:""}),h.mobile.connections.push({targetScreenId:T.mobile.id,type:"navigate",label:""}))})}),this.flowchartScreens=i.filter(x=>x.device===this.selectedDeviceTab),this.loadAllScreens()}filterScreens(t){let e=t.toLowerCase().trim(),r=this.flowchartScreens.filter(i=>i.device===this.selectedDeviceTab).map(i=>ot($e({},i),{images:[],activeImageId:void 0,imageCount:0}));if(!e){this.screensWithImages=r;return}this.screensWithImages=r.filter(i=>i.name.toLowerCase().includes(e)||i.description.toLowerCase().includes(e))}selectDeviceTab(t){this.selectedDeviceTab=t,this.selectedScreenImageId=null,this.currentScreenDetail=null,this.generateFlowchartData(),this.loadAllScreens()}loadAllScreens(){this.screensWithImages=this.flowchartScreens.filter(t=>t.device===this.selectedDeviceTab).map(t=>ot($e({},t),{images:[],activeImageId:void 0,imageCount:0})),this.screensWithImages.length>0&&!this.selectedScreenImageId&&this.selectScreenForImage(this.screensWithImages[0])}selectScreenForImage(t){this.selectedScreenImageId=t.id,this.currentScreenDetail=t;let e=this.getIframeUrl();this.screenImageService.getScreenImages(t.id).subscribe({next:r=>{this.screenImagesList=r;let i=r.find(a=>a.isActive);this.activeImageId=i?.id||r[0]?.id||null},error:r=>{console.error("[IaCanvas] \uC774\uBBF8\uC9C0 \uB85C\uB4DC \uC2E4\uD328:",r),this.screenImagesList=[],this.activeImageId=null}})}toggleLiveViewMode(){this.isLiveViewMode=!this.isLiveViewMode}convertCategoryToRoute(t){return{"\uCE98\uB9B0\uB354 \uAD00\uB9AC":"calendar-management","\uCE98\uB9B0\uB354 \uBAA9\uB85D":"calendar-list","\uC77C\uC815 \uB4F1\uB85D":"event-registration","\uC77C\uC815 \uC218\uC815":"event-editing","\uCE98\uB9B0\uB354 \uC218\uC815":"calendar-editing","\uB178\uD2B8 \uAD00\uB9AC":"note-management","\uB178\uD2B8 \uBAA9\uB85D":"note-list","\uB178\uD2B8 \uB4F1\uB85D":"note-registration","\uB178\uD2B8 \uB4F1\uB85D/\uC218\uC815":"note-registration-editing","\uD3F4\uB354 \uB4F1\uB85D/\uC218\uC815":"folder-registration-editing","\uBCF4\uC644 \uAE30\uB2A5":"supplementary-features",\uC124\uC815:"settings"}[t]||"home"}getIframeUrl(){let t=this.folderType==="note"?"note":"calendar",e=this.selectedDeviceTab==="pc"?"pc":"mobile",r=this.currentScreenDetail?`/${this.convertCategoryToRoute(this.currentScreenDetail.category||this.currentScreenDetail.name)}`:"",i=`/#/${t}/${e}${r}`;return this.sanitizer.bypassSecurityTrustResourceUrl(i)}selectImage(t){this.activeImageId=t.id,this.selectedScreenImageId&&this.screenImageService.setActiveImage(this.selectedScreenImageId,t.id).subscribe({error:e=>console.error("[IaCanvas] \uD65C\uC131 \uC774\uBBF8\uC9C0 \uBCC0\uACBD \uC2E4\uD328:",e)})}getActiveImage(){return this.screenImagesList.find(t=>t.id===this.activeImageId)||null}getImagePreviewUrl(t){return t.imageSource.type==="base64"||t.imageSource.type==="url"?t.imageSource.value:""}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=yt({type:n,selectors:[["app-ia-canvas"]],viewQuery:function(e,r){if(e&1&&(nn(vm,7,fi),nn(bm,7),nn(wm,5)),e&2){let i;rn(i=an())&&(r.container=i.first),rn(i=an())&&(r.intentNameInput=i.first),rn(i=an())&&(r.fileInput=i.first)}},hostBindings:function(e,r){e&1&&re("keydown",function(a){return r.handleKeyboard(a)},di)("keyup",function(a){return r.handleKeyUp(a)},di)("blur",function(){return r.onBlur()},di)},inputs:{width:[1,"width"],height:[1,"height"],pages:"pages",userFlows:"userFlows",viewMode:"viewMode",isMultiSelectMode:"isMultiSelectMode",folderType:"folderType",specPlanData:"specPlanData",zoomLevel:"zoomLevel",isPenMode:"isPenMode"},outputs:{playSimulator:"playSimulator",zoomLevelChange:"zoomLevelChange",penModeChange:"penModeChange",simulatorRequested:"simulatorRequested"},standalone:!1,decls:84,vars:32,consts:[["screenSearch",""],[1,"chatflow-edit-container",3,"ngStyle"],[1,"top-toolbar"],[1,"view-mode-toggle"],[1,"toggle-btn",3,"click"],["width","16","height","16","viewBox","0 0 16 16","fill","currentColor"],["x","1","y","1","width","4","height","14","rx","1"],["x","6","y","3","width","4","height","10","rx","1"],["x","11","y","2","width","4","height","12","rx","1"],["x","1","y","1","width","6","height","6","rx","1"],["x","9","y","1","width","6","height","6","rx","1"],["x","1","y","9","width","6","height","6","rx","1"],["x","9","y","9","width","6","height","6","rx","1"],["x","2","y","1","width","12","height","12","rx","1","stroke","currentColor","stroke-width","1","fill","none"],["x","2","y","14","width","3","height","1","rx","0.5"],["x","6","y","14","width","3","height","1","rx","0.5"],["x","10","y","14","width","4","height","1","rx","0.5"],["cx","8","cy","3","r","2","fill","none","stroke","currentColor","stroke-width","1.5"],["cx","4","cy","11","r","2","fill","none","stroke","currentColor","stroke-width","1.5"],["cx","12","cy","11","r","2","fill","none","stroke","currentColor","stroke-width","1.5"],["d","M8 5v2M6 9L8 7M10 9L8 7","stroke","currentColor","stroke-width","1.5","fill","none"],["d","M3 1h10a2 2 0 012 2v10a2 2 0 01-2 2H3a2 2 0 01-2-2V3a2 2 0 012-2z","fill","none","stroke","currentColor","stroke-width","1.5"],["d","M4 5h8M4 8h8M4 11h5","stroke","currentColor","stroke-width","1.5","stroke-linecap","round"],["x","1","y","2","width","14","height","2","rx","0.5"],["x","1","y","5","width","10","height","2","rx","0.5"],["x","1","y","8","width","12","height","2","rx","0.5"],["x","1","y","11","width","8","height","2","rx","0.5"],[1,"data-source-info"],[1,"source-badge","calendar"],[1,"source-badge","note"],[1,"stats-info"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value"],[1,"stat-item","high"],[1,"save-toolbar"],["title","\uB85C\uCEEC\uC5D0 \uC800\uC7A5 (10\uCD08 \uC790\uB3D9\uC800\uC7A5\uB3C4 \uC9C4\uD589 \uC911)",1,"save-btn","primary",3,"click"],["d","M2 2v12h12V4.5L11.5 2H2zm1 1h7v3H3V3zm8 0h.5l2.5 2.5V13H3V7h10v6H3V3h8z"],["x","4","y","8","width","8","height","4","rx","0.5"],[1,"unsaved-dot"],["title","\uB370\uC774\uD130\uBCA0\uC774\uC2A4\uC5D0 \uC800\uC7A5 (Calendar/Note DB)",1,"save-btn","database",3,"click","disabled"],["d","M2 3h12v1H2V3zm0 3h12v1H2V6zm0 3h12v1H2V9zm0 3h12v1H2v-1z"],["cx","8","cy","8","r","6","fill","none","stroke","currentColor","stroke-width","1"],[1,"download-group"],["title","\uB2E4\uC6B4\uB85C\uB4DC",1,"save-btn","secondary",3,"click"],["d","M8 10l-3-3h2V3h2v4h2l-3 3z"],["d","M13 11v2H3v-2H2v3h12v-3h-1z"],[1,"download-dropdown"],[1,"loading-overlay"],["class","multiselect-toolbar",4,"ngIf"],["cdkDropListGroup","",1,"kanban-container"],[1,"hierarchical-canvas"],[1,"spec-plan-container"],[1,"screens-view-container"],[1,"wbs-view-container"],[1,"flowchart-container"],[1,"spinner"],[3,"click"],[1,"loading-spinner"],[1,"multiselect-toolbar"],[1,"selection-info"],["class","save-selection-btn",3,"click",4,"ngIf"],[1,"clear-btn",3,"click"],["d","M12 4L4 12M4 4L12 12","stroke","currentColor","stroke-width","1.5","stroke-linecap","round"],[1,"save-selection-btn",3,"click"],["x","1","y","1","width","5","height","5","stroke","currentColor","stroke-width","1","fill","none"],["x","10","y","1","width","5","height","5","stroke","currentColor","stroke-width","1","fill","none"],["x","1","y","10","width","5","height","5","stroke","currentColor","stroke-width","1","fill","none"],["x","10","y","10","width","5","height","5","stroke","currentColor","stroke-width","1","fill","none"],[1,"kanban-column"],[1,"kanban-column-header",3,"ngStyle"],[1,"column-title"],[1,"column-indicator",3,"ngStyle"],[1,"column-count"],["cdkDropList","",1,"kanban-column-content",3,"cdkDropListDropped","id","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"kanban-card",3,"high-priority","expanded"],[1,"empty-column"],["cdkDrag","",1,"kanban-card"],["cdkDragHandle","",1,"drag-handle",3,"click"],["cx","4","cy","4","r","1.5"],["cx","12","cy","4","r","1.5"],["cx","4","cy","8","r","1.5"],["cx","12","cy","8","r","1.5"],["cx","4","cy","12","r","1.5"],["cx","12","cy","12","r","1.5"],[1,"card-body",3,"click"],[1,"card-header"],[1,"card-categories"],[1,"category-badge","main",3,"ngStyle"],[1,"category-badge","mid"],[1,"category-badge","sub"],[1,"priority-flag"],[1,"card-title"],[1,"card-id"],[1,"card-request-preview"],[1,"card-scores"],[1,"score-item"],[1,"score-label"],[1,"score-value"],[1,"card-details"],[1,"card-note-preview"],[1,"expand-indicator"],["width","12","height","12","viewBox","0 0 12 12","fill","currentColor"],["d","M3 4.5L6 7.5L9 4.5","stroke","currentColor","stroke-width","1.5","fill","none","stroke-linecap","round"],["class","drag-placeholder",4,"cdkDragPlaceholder"],[1,"detail-section"],[1,"detail-label"],[1,"detail-content","request-content"],[1,"detail-section","info-row"],[1,"info-item"],[1,"info-label"],[1,"info-value"],[1,"detail-content","note-content"],[1,"drag-placeholder"],[1,"canvas-stats-bar"],[1,"stat-item","priority"],[1,"hierarchy-container"],[1,"main-category-card",3,"border-left-color"],[1,"main-category-card"],[1,"main-category-header"],[1,"main-category-title"],[1,"category-icon"],[1,"category-name"],[1,"main-category-stats"],[1,"mid-count"],[1,"item-count"],[1,"mid-categories-container"],[1,"mid-category-section"],[1,"mid-category-header"],[1,"mid-category-name"],[1,"mid-category-count"],[1,"items-list"],[1,"spec-item-card",3,"high-priority","expanded"],[1,"spec-item-card",3,"click"],[1,"feasibility-indicator"],[1,"item-content"],[1,"item-header"],[1,"item-title"],[1,"priority-badge"],[1,"kanban-status-badge"],[1,"status-dot"],[1,"item-scores"],[1,"score-badge","request"],[1,"score-icon"],[1,"score-num"],[1,"score-badge","feasibility"],[1,"item-details"],[1,"expand-icon"],["width","10","height","10","viewBox","0 0 10 10"],["d","M2 3.5L5 6.5L8 3.5","stroke","currentColor","stroke-width","1.5","fill","none"],[1,"detail-row"],[1,"detail-value"],[1,"detail-row","id-row"],[1,"detail-id"],[1,"spec-plan-table-wrapper"],[1,"spec-plan-table"],[1,"col-id"],[1,"col-status"],[1,"col-main"],[1,"col-mid"],[1,"col-sub"],[1,"col-request"],[1,"col-priority"],[1,"col-feasibility"],[1,"col-note"],[3,"high-priority","completed"],[1,"id-badge"],[1,"status-badge"],[1,"category-tag","main"],[1,"request-text"],[1,"score-badge"],[1,"note-text"],[1,"screens-list-panel"],[1,"panel-header"],[1,"count"],[1,"device-tabs"],[1,"tab-btn",3,"click"],[1,"material-icons"],[1,"screens-search"],["type","text","placeholder","\uD654\uBA74 \uAC80\uC0C9...",3,"keyup"],[1,"screens-list"],[1,"empty-state"],[1,"screens-detail-panel"],[1,"no-selection"],[1,"screen-list-item",3,"selected"],[1,"screen-list-item",3,"click"],[1,"screen-icon"],[1,"screen-info"],[1,"screen-name-wrapper"],[1,"screen-name"],[1,"screen-meta"],[1,"image-count"],[1,"detail-header"],[1,"header-info"],[1,"large-icon"],[1,"title-section"],[1,"description"],[1,"header-actions"],[1,"mode-btn",3,"click"],[1,"live-view-section",3,"mobile-frame"],[1,"live-view-section"],[1,"iframe-container"],["frameborder","0",1,"live-iframe",3,"src"],[1,"mobile-home-bar"],[1,"image-viewer-section"],[1,"images-section"],[1,"section-title"],[1,"no-images"],[1,"images-grid"],[1,"image-preview"],[1,"preview-img",3,"src","alt"],[1,"image-info-overlay"],[1,"image-title"],[1,"image-grid-item",3,"active"],[1,"image-grid-item",3,"click"],[1,"image-thumbnail"],[3,"src","alt"],[1,"active-badge"],[1,"image-title-small"],[1,"image-version"],[3,"folderType"],[1,"flowchart-container",3,"wheel","mousedown","mousemove","mouseup","mouseleave"],[1,"flowchart-toolbar"],[1,"toolbar-group"],["title","\uD655\uB300",1,"toolbar-btn",3,"click"],[1,"zoom-level"],["title","\uCD95\uC18C",1,"toolbar-btn",3,"click"],["title","\uD654\uBA74 \uB9DE\uCDA4",1,"toolbar-btn",3,"click"],["title","\uC790\uB3D9 \uC815\uB82C",1,"toolbar-btn","auto-layout",3,"click"],[1,"btn-label"],[1,"toolbar-label"],[1,"device-tab-btn",3,"click"],[1,"divider"],[1,"screen-type-legend"],[1,"legend-item","screen-type"],[1,"dot","screen"],[1,"dot","modal"],[1,"dot","panel"],[1,"dot","sheet"],[1,"status-legend"],[1,"legend-item","status"],[1,"dot","open"],[1,"dot","in-progress"],[1,"dot","completed"],[1,"flowchart-canvas"],["width","5000","height","5000",1,"edges-layer"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","9","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7","fill","#666"],[1,"screen-nodes"],["cdkDrag","",1,"screen-node",3,"cdkDragData","left","top","selected","expanded","type-screen","type-modal","type-panel","type-sheet"],[1,"empty-flowchart"],[1,"detail-panel"],["marker-end","url(#arrowhead)",1,"edge-path",3,"class"],["marker-end","url(#arrowhead)",1,"edge-path"],["cdkDrag","",1,"screen-node",3,"cdkDragStarted","cdkDragMoved","cdkDragEnded","click","cdkDragData"],[1,"node-header"],[1,"node-icon"],[1,"node-title"],[1,"screen-type-badge"],[1,"expand-btn",3,"click"],[1,"features-preview"],[1,"preview-group"],[1,"preview-mid"],[1,"preview-count"],[1,"features-section","expanded"],[1,"feature-group"],[1,"events-section"],[1,"events-header"],[1,"event-tags"],[1,"event-tag",3,"class","title"],[1,"progress-bar-container"],[1,"progress-label"],[1,"progress-bar"],[1,"progress-fill"],[1,"group-header"],[1,"feature-count"],[1,"feature-list"],[1,"feature-item",3,"class"],[1,"feature-item"],[1,"feature-name"],[1,"feature-request",3,"title"],[1,"progress-badge"],[1,"event-tag",3,"title"],[1,"hint"],[1,"detail-panel",3,"click","wheel"],[1,"detail-icon"],[1,"detail-title-section"],[1,"detail-title"],[1,"close-btn",3,"click"],[1,"detail-content"],[1,"detail-summary"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"detail-progress"],[1,"detail-features"],[1,"detail-group"],[1,"detail-events"],[1,"events-list"],[1,"event-item",3,"class"],[1,"detail-connections"],[1,"detail-group-header"],[1,"group-name"],[1,"group-count"],[1,"detail-group-items"],[1,"detail-item"],[1,"status-indicator"],[1,"item-name"],[1,"item-status-badge"],[1,"item-request"],[1,"item-meta"],[1,"meta-item","priority"],[1,"meta-item","feasibility"],[1,"meta-item","progress"],[1,"request-label"],[1,"event-item"],[1,"event-type-badge"],[1,"event-info"],[1,"event-name"],[1,"event-trigger"],[1,"connections-list"],[1,"connection-item"],[1,"connection-item",3,"click"],[1,"connection-icon"],[1,"connection-name"],[1,"connection-type"],[1,"material-icons","arrow"]],template:function(e,r){e&1&&(f(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),re("click",function(){return r.viewMode="kanban"}),Me(),f(4,"svg",5),ee(5,"rect",6)(6,"rect",7)(7,"rect",8),p(),g(8," \uCE78\uBC18 "),p(),Re(),f(9,"button",4),re("click",function(){return r.viewMode="canvas"}),Me(),f(10,"svg",5),ee(11,"rect",9)(12,"rect",10)(13,"rect",11)(14,"rect",12),p(),g(15," \uCE94\uBC84\uC2A4 "),p(),Re(),f(16,"button",4),re("click",function(){return r.viewMode="screens"}),Me(),f(17,"svg",5),ee(18,"rect",13)(19,"rect",14)(20,"rect",15)(21,"rect",16),p(),g(22," \uD654\uBA74 "),p(),Re(),f(23,"button",4),re("click",function(){return r.viewMode="flowchart"}),Me(),f(24,"svg",5),ee(25,"circle",17)(26,"circle",18)(27,"circle",19)(28,"path",20),p(),g(29," IA "),p(),Re(),f(30,"button",4),re("click",function(){return r.viewMode="specPlan"}),Me(),f(31,"svg",5),ee(32,"path",21)(33,"path",22),p(),g(34," \uAE30\uD68D\uC548 "),p(),Re(),f(35,"button",4),re("click",function(){return r.viewMode="wbs"}),Me(),f(36,"svg",5),ee(37,"rect",23)(38,"rect",24)(39,"rect",25)(40,"rect",26),p(),g(41," WBS "),p()(),Re(),f(42,"div",27),ae(43,Sm,2,0,"span",28)(44,Em,2,0,"span",29),p(),f(45,"div",30)(46,"span",31)(47,"span",32),g(48,"\uC804\uCCB4"),p(),f(49,"span",33),g(50),p()(),f(51,"span",34)(52,"span",32),g(53,"\uAE34\uAE09"),p(),f(54,"span",33),g(55),p()()(),f(56,"div",35)(57,"button",36),re("click",function(){return r.saveToLocalStorage()}),Me(),f(58,"svg",5),ee(59,"path",37)(60,"rect",38),p(),g(61," \uB85C\uCEEC \uC800\uC7A5 "),ae(62,Tm,1,0,"span",39),p(),Re(),f(63,"button",40),re("click",function(){return r.saveToDatabase()}),Me(),f(64,"svg",5),ee(65,"path",41)(66,"circle",42),p(),ae(67,Dm,2,0)(68,Am,1,0),p(),Re(),f(69,"div",43)(70,"button",44),re("click",function(){return r.toggleDownloadMenu()}),Me(),f(71,"svg",5),ee(72,"path",45)(73,"path",46),p(),g(74," \uB2E4\uC6B4\uB85C\uB4DC "),p(),ae(75,Fm,7,0,"div",47),p()()(),ae(76,Im,4,0,"div",48),Ut(77,Rm,8,2,"div",49),ae(78,Xm,3,0,"div",50),ae(79,Qm,20,3,"div",51),ae(80,tx,26,0,"div",52),ae(81,mx,25,7,"div",53),ae(82,xx,2,1,"div",54),ae(83,Ux,75,12,"div",55),p()),e&2&&(we("ngStyle",Br(30,Pm,r.height()?r.height():"")),_(3),ve("active",r.viewMode==="kanban"),_(6),ve("active",r.viewMode==="canvas"),_(7),ve("active",r.viewMode==="screens"),_(7),ve("active",r.viewMode==="flowchart"),_(7),ve("active",r.viewMode==="specPlan"),_(5),ve("active",r.viewMode==="wbs"),_(8),oe(r.folderType==="calendar"?43:44),_(7),ge("",r.specPlanData.length,"\uAC74"),_(5),ge("",r.getHighPriorityCount(),"\uAC74"),_(2),ve("has-changes",r.hasUnsavedChanges),_(5),oe(r.hasUnsavedChanges?62:-1),_(),we("disabled",r.isLoading),_(4),oe(r.isLoading?67:68),_(8),oe(r.showDownloadMenu?75:-1),_(),oe(r.isLoading?76:-1),_(),we("ngIf",r.selectedNodeIds.size>0),_(),oe(r.viewMode==="kanban"?78:-1),_(),oe(r.viewMode==="canvas"?79:-1),_(),oe(r.viewMode==="specPlan"?80:-1),_(),oe(r.viewMode==="screens"?81:-1),_(),oe(r.viewMode==="wbs"?82:-1),_(),oe(r.viewMode==="flowchart"?83:-1))},dependencies:[lr,Fo,Go,Xo,dr,mi,Yo,Tn,Ro,Bo],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;width:100%;height:100%;background:#f5f5f5}.chatflow-edit-container[_ngcontent-%COMP%]{width:100%;height:100%;padding:15px;box-sizing:border-box;display:flex;flex-direction:column;gap:12px;background:transparent}.top-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex-wrap:wrap}.view-mode-toggle[_ngcontent-%COMP%]{display:flex;gap:4px;padding:4px;background:#fff;border-radius:8px;border:1px solid #e5e7eb;width:fit-content;box-shadow:0 1px 3px #0000000d}.view-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 14px;border:none;border-radius:6px;background:transparent;cursor:pointer;font-size:13px;font-weight:500;color:#6b7280;transition:all .2s ease}.view-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.6}.view-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.view-mode-toggle[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background:#667eea;color:#fff;box-shadow:0 2px 4px #667eea4d}.view-mode-toggle[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:1}.data-source-info[_ngcontent-%COMP%]{display:flex;align-items:center}.data-source-info[_ngcontent-%COMP%]   .source-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 14px;border-radius:8px;font-size:13px;font-weight:600}.data-source-info[_ngcontent-%COMP%]   .source-badge.calendar[_ngcontent-%COMP%]{background:#eff6ff;color:#2563eb;border:1px solid #bfdbfe}.data-source-info[_ngcontent-%COMP%]   .source-badge.note[_ngcontent-%COMP%]{background:#f5f3ff;color:#7c3aed;border:1px solid #ddd6fe}.stats-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.stats-info[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#f8fafc;border-radius:6px;border:1px solid #e2e8f0}.stats-info[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:11px;color:#64748b}.stats-info[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#1e293b}.stats-info[_ngcontent-%COMP%]   .stat-item.high[_ngcontent-%COMP%]{background:#fef2f2;border-color:#fecaca}.stats-info[_ngcontent-%COMP%]   .stat-item.high[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%], .stats-info[_ngcontent-%COMP%]   .stat-item.high[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#dc2626}.save-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-left:auto}.save-toolbar[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 14px;border:1px solid #e2e8f0;border-radius:8px;background:#fff;cursor:pointer;font-size:12px;font-weight:500;color:#475569;transition:all .2s ease;position:relative}.save-toolbar[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.7}.save-toolbar[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.save-toolbar[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{opacity:1}.save-toolbar[_ngcontent-%COMP%]   .save-btn.primary[_ngcontent-%COMP%]{background:#667eea;border-color:#667eea;color:#fff}.save-toolbar[_ngcontent-%COMP%]   .save-btn.primary[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:1}.save-toolbar[_ngcontent-%COMP%]   .save-btn.primary[_ngcontent-%COMP%]:hover{background:#5a67d8;border-color:#5a67d8}.save-toolbar[_ngcontent-%COMP%]   .save-btn.primary.has-changes[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}.save-toolbar[_ngcontent-%COMP%]   .save-btn.secondary[_ngcontent-%COMP%]{background:#f0fdf4;border-color:#86efac;color:#16a34a}.save-toolbar[_ngcontent-%COMP%]   .save-btn.secondary[_ngcontent-%COMP%]:hover{background:#dcfce7}.save-toolbar[_ngcontent-%COMP%]   .save-btn.database[_ngcontent-%COMP%]{background:#fbbf24;border-color:#fbbf24;color:#fff;font-weight:600}.save-toolbar[_ngcontent-%COMP%]   .save-btn.database[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:1}.save-toolbar[_ngcontent-%COMP%]   .save-btn.database[_ngcontent-%COMP%]:hover:not(:disabled){background:#f59e0b;border-color:#f59e0b;transform:translateY(-2px);box-shadow:0 4px 12px #f59e0b4d}.save-toolbar[_ngcontent-%COMP%]   .save-btn.database[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.save-toolbar[_ngcontent-%COMP%]   .save-btn.database[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border:2px solid rgba(255,255,255,.3);border-top:2px solid white;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.save-toolbar[_ngcontent-%COMP%]   .save-btn.danger[_ngcontent-%COMP%]{color:#dc2626}.save-toolbar[_ngcontent-%COMP%]   .save-btn.danger[_ngcontent-%COMP%]:hover{background:#fef2f2;border-color:#fecaca}.save-toolbar[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]   .unsaved-dot[_ngcontent-%COMP%]{position:absolute;top:-4px;right:-4px;width:10px;height:10px;background:#ef4444;border-radius:50%;border:2px solid white}.save-toolbar[_ngcontent-%COMP%]   .download-group[_ngcontent-%COMP%]{position:relative}.save-toolbar[_ngcontent-%COMP%]   .download-group[_ngcontent-%COMP%]   .download-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;margin-top:8px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;box-shadow:0 4px 12px #00000026;z-index:1000;min-width:180px;overflow:hidden;padding:4px 0}.save-toolbar[_ngcontent-%COMP%]   .download-group[_ngcontent-%COMP%]   .download-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;width:100%;text-align:left;padding:10px 16px;background:none;border:none;font-size:14px;color:#374151;cursor:pointer;transition:background .15s}.save-toolbar[_ngcontent-%COMP%]   .download-group[_ngcontent-%COMP%]   .download-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#111827}@keyframes _ngcontent-%COMP%_pulse{0%,to{box-shadow:0 0 #667eea66}50%{box-shadow:0 0 0 8px #667eea00}}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#ffffffe6;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;z-index:100}.loading-overlay[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #e2e8f0;border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.loading-overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;color:#64748b}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.kanban-container[_ngcontent-%COMP%]{display:flex;gap:16px;flex:1;overflow-x:auto;padding-bottom:16px}.kanban-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:8px}.kanban-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:4px}.kanban-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.kanban-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.kanban-column[_ngcontent-%COMP%]{flex:0 0 360px;min-width:360px;background:#f8fafc;border-radius:12px;border:1px solid #e2e8f0;display:flex;flex-direction:column;max-height:calc(100vh - 180px)}.kanban-column[_ngcontent-%COMP%]   .kanban-column-header[_ngcontent-%COMP%]{padding:16px;border-top:3px solid;border-radius:12px 12px 0 0;background:#fff;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e2e8f0}.kanban-column[_ngcontent-%COMP%]   .kanban-column-header[_ngcontent-%COMP%]   .column-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-weight:600;font-size:14px;color:#1e293b}.kanban-column[_ngcontent-%COMP%]   .kanban-column-header[_ngcontent-%COMP%]   .column-title[_ngcontent-%COMP%]   .column-indicator[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%}.kanban-column[_ngcontent-%COMP%]   .kanban-column-header[_ngcontent-%COMP%]   .column-count[_ngcontent-%COMP%]{background:#f1f5f9;color:#64748b;font-size:12px;font-weight:600;padding:4px 10px;border-radius:100px}.kanban-column[_ngcontent-%COMP%]   .kanban-column-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:10px}.kanban-column[_ngcontent-%COMP%]   .kanban-column-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.kanban-column[_ngcontent-%COMP%]   .kanban-column-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.kanban-column[_ngcontent-%COMP%]   .kanban-column-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#e2e8f0;border-radius:3px}.kanban-column[_ngcontent-%COMP%]   .kanban-column-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#cbd5e1}.kanban-card[_ngcontent-%COMP%]{background:#fff;border-radius:10px;border:1px solid #e2e8f0;padding:14px 14px 14px 32px;cursor:pointer;transition:all .2s ease;position:relative}.kanban-card[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;left:8px;top:14px;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:grab;color:#cbd5e1;transition:color .2s ease;z-index:10}.kanban-card[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]:hover{color:#667eea}.kanban-card[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]:active{cursor:grabbing}.kanban-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex:1}.kanban-card[_ngcontent-%COMP%]:hover{border-color:#cbd5e1;box-shadow:0 4px 12px #00000014;transform:translateY(-2px)}.kanban-card[_ngcontent-%COMP%]:hover   .drag-handle[_ngcontent-%COMP%]{color:#94a3b8}.kanban-card.high-priority[_ngcontent-%COMP%]{border-left:3px solid #ef4444;background:linear-gradient(to right,#ef444408,#fff);padding-left:32px}.kanban-card.expanded[_ngcontent-%COMP%]{border-color:#667eea;box-shadow:0 8px 20px #667eea26}.kanban-card.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 12px 40px #0003;border-color:#667eea;opacity:.95;transform:rotate(2deg)}.kanban-card.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.kanban-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px}.kanban-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-categories[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.kanban-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .category-badge[_ngcontent-%COMP%]{font-size:10px;font-weight:600;padding:3px 8px;border-radius:4px}.kanban-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .category-badge.main[_ngcontent-%COMP%]{color:#fff}.kanban-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .category-badge.mid[_ngcontent-%COMP%]{background:#f1f5f9;color:#64748b}.kanban-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .category-badge.sub[_ngcontent-%COMP%]{background:#e0e7ff;color:#4f46e5;font-size:9px}.kanban-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .priority-flag[_ngcontent-%COMP%]{font-size:14px}.kanban-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1e293b;margin-bottom:4px;line-height:1.4}.kanban-card[_ngcontent-%COMP%]   .card-id[_ngcontent-%COMP%]{font-size:10px;color:#94a3b8;font-family:monospace;margin-bottom:8px}.kanban-card[_ngcontent-%COMP%]   .card-request-preview[_ngcontent-%COMP%]{font-size:12px;color:#64748b;line-height:1.5;margin-bottom:12px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]{display:flex;gap:16px;padding-top:10px;border-top:1px dashed #e2e8f0}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-label[_ngcontent-%COMP%]{font-size:10px;color:#94a3b8;font-weight:500}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-value[_ngcontent-%COMP%]{font-size:12px;font-weight:600;display:flex;align-items:center;gap:6px}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-value.priority-high[_ngcontent-%COMP%]{color:#ef4444}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-value.priority-medium[_ngcontent-%COMP%]{color:#f59e0b}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-value.priority-low[_ngcontent-%COMP%]{color:#6b7280}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-value.feasibility-high[_ngcontent-%COMP%]{color:#10b981}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-value.feasibility-medium[_ngcontent-%COMP%]{color:#f59e0b}.kanban-card[_ngcontent-%COMP%]   .card-scores[_ngcontent-%COMP%]   .score-item[_ngcontent-%COMP%]   .score-value.feasibility-low[_ngcontent-%COMP%]{color:#ef4444}.kanban-card[_ngcontent-%COMP%]   .card-note-preview[_ngcontent-%COMP%]{margin-top:10px;padding:8px 10px;background:#fef3c7;border-radius:6px;font-size:11px;color:#92400e;line-height:1.4}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]{margin-top:14px;padding-top:14px;border-top:1px solid #e2e8f0;animation:_ngcontent-%COMP%_slideDown .2s ease}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section[_ngcontent-%COMP%]{margin-bottom:12px}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#64748b;margin-bottom:6px}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]{font-size:12px;color:#374151;line-height:1.6}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section[_ngcontent-%COMP%]   .detail-content.request-content[_ngcontent-%COMP%]{white-space:pre-line;background:#f8fafc;padding:10px;border-radius:6px;border:1px solid #e2e8f0}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section[_ngcontent-%COMP%]   .detail-content.note-content[_ngcontent-%COMP%]{background:#fef3c7;padding:8px 10px;border-radius:6px;color:#92400e}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section.info-row[_ngcontent-%COMP%]{display:flex;gap:20px}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section.info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section.info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:10px;color:#94a3b8;font-weight:500}.kanban-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .detail-section.info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:11px;color:#475569;font-weight:600;background:#f1f5f9;padding:2px 8px;border-radius:4px}.kanban-card[_ngcontent-%COMP%]   .expand-indicator[_ngcontent-%COMP%]{position:absolute;bottom:6px;right:10px;color:#94a3b8;transition:transform .2s ease}.kanban-card[_ngcontent-%COMP%]   .expand-indicator[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transition:transform .2s ease}.kanban-card[_ngcontent-%COMP%]   .expand-indicator[_ngcontent-%COMP%]   svg.rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.empty-column[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:40px 20px;color:#94a3b8;font-size:13px;font-style:italic;border:2px dashed #e2e8f0;border-radius:8px;margin:8px;min-height:100px}.drag-placeholder[_ngcontent-%COMP%]{background:#667eea1a;border:2px dashed #667eea;border-radius:10px;min-height:80px;margin:10px 0;transition:all .2s ease}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .kanban-card[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.kanban-column-content.cdk-drop-list-receiving[_ngcontent-%COMP%]{background:#667eea0d;border:2px dashed rgba(102,126,234,.3);border-radius:8px;margin:4px}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;max-height:0}to{opacity:1;max-height:500px}}.multiselect-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#3b82f614;border-radius:10px;border:1px solid rgba(59,130,246,.2);animation:_ngcontent-%COMP%_slideDown .2s ease}.multiselect-toolbar[_ngcontent-%COMP%]   .selection-info[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#6b7280;margin-right:8px}.multiselect-toolbar[_ngcontent-%COMP%]   .save-selection-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#3b82f6;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:12px;font-weight:600;transition:all .2s ease}.multiselect-toolbar[_ngcontent-%COMP%]   .save-selection-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px;stroke:currentColor;fill:none}.multiselect-toolbar[_ngcontent-%COMP%]   .save-selection-btn[_ngcontent-%COMP%]:hover{background:#2563eb;transform:scale(1.05)}.multiselect-toolbar[_ngcontent-%COMP%]   .save-selection-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.multiselect-toolbar[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#f3f4f6;color:#6b7280;border:1px solid #d1d5db;border-radius:6px;cursor:pointer;font-size:12px;font-weight:500;transition:all .2s ease}.multiselect-toolbar[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px;stroke:currentColor;fill:none}.multiselect-toolbar[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#9ca3af}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:12px 20px;background:#fffffff2;border-radius:14px;margin-bottom:16px;box-shadow:0 2px 12px #667eea14;border:1px solid rgba(102,126,234,.12)}.zoom-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;background:#667eea0a;border-radius:8px}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;transition:all .2s ease}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6;border-color:#9ca3af}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active:not(:disabled){background:#e5e7eb}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;line-height:1}.zoom-controls[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#667eea;width:50px;text-align:center}.pen-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;transition:all .2s ease;margin-left:auto}.pen-button[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.pen-button[_ngcontent-%COMP%]:active{background:#e5e7eb}.pen-button.pen-active[_ngcontent-%COMP%]{background:#667eea;border-color:#667eea;box-shadow:0 0 8px #667eea4d}.pen-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;line-height:1}.view-toggle[_ngcontent-%COMP%]{display:flex;gap:4px;padding:4px;background:#e5e7eb4d;border-radius:6px;border:1px solid #e5e7eb}.view-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{padding:6px 12px;border:none;border-radius:4px;background:transparent;cursor:pointer;font-size:14px;font-weight:500;color:#6b7280;transition:all .2s ease}.view-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb80;color:#374151}.view-toggle[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background:#fff;color:#667eea;box-shadow:0 1px 3px #0000001a}.connection-guide[_ngcontent-%COMP%]{display:flex;gap:16px;padding:12px 16px;background:#10b9810d;border:1px solid rgba(16,185,129,.2);border-radius:10px;font-size:13px}.connection-guide[_ngcontent-%COMP%]   .guide-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#374151}.connection-guide[_ngcontent-%COMP%]   .guide-item.info-item[_ngcontent-%COMP%]{font-weight:500}.connection-guide[_ngcontent-%COMP%]   .guide-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:18px}.spec-plan-container[_ngcontent-%COMP%]{flex:1;overflow:auto;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000000d;border:1px solid #e5e7eb}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table-wrapper[_ngcontent-%COMP%]{min-width:100%;overflow-x:auto}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:13px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background:linear-gradient(to bottom,#f8fafc,#f1f5f9)}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:2px solid #e2e8f0}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 12px;text-align:left;font-weight:600;color:#475569;white-space:nowrap;font-size:12px;text-transform:uppercase;letter-spacing:.5px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-id[_ngcontent-%COMP%]{width:80px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-status[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-main[_ngcontent-%COMP%]{width:100px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-mid[_ngcontent-%COMP%]{width:120px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-sub[_ngcontent-%COMP%]{width:150px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-request[_ngcontent-%COMP%]{min-width:250px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-priority[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-feasibility[_ngcontent-%COMP%]{width:80px;text-align:center}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-note[_ngcontent-%COMP%]{min-width:150px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f1f5f9;transition:all .2s ease}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8fafc}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.high-priority[_ngcontent-%COMP%]{background:linear-gradient(to right,rgba(239,68,68,.05),transparent)}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.high-priority[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-left:3px solid #ef4444}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.completed[_ngcontent-%COMP%]{opacity:.7}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.completed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;color:#94a3b8}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.completed[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.completed[_ngcontent-%COMP%]   .category-tag[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.completed[_ngcontent-%COMP%]   .score-badge[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.completed[_ngcontent-%COMP%]   .id-badge[_ngcontent-%COMP%]{text-decoration:none}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;vertical-align:top;color:#334155}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.col-priority[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.col-feasibility[_ngcontent-%COMP%]{text-align:center}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .id-badge[_ngcontent-%COMP%]{font-family:monospace;font-size:11px;color:#64748b;background:#f1f5f9;padding:4px 8px;border-radius:4px}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:20px;font-size:11px;font-weight:600;border:1px solid}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .category-tag[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:4px;font-size:11px;font-weight:600}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .category-tag.main[_ngcontent-%COMP%]{color:#fff}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .score-badge[_ngcontent-%COMP%]{display:inline-block;min-width:32px;padding:4px 8px;border-radius:6px;font-size:12px;font-weight:600;text-align:center;background:#f1f5f9;color:#64748b}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .score-badge.priority-high[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .score-badge.feasibility-high[_ngcontent-%COMP%]{background:#10b98126;color:#059669}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .score-badge.priority-medium[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .score-badge.feasibility-medium[_ngcontent-%COMP%]{background:#f59e0b26;color:#d97706}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .score-badge.priority-low[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .score-badge.feasibility-low[_ngcontent-%COMP%]{background:#ef444426;color:#dc2626}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .request-text[_ngcontent-%COMP%], .spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .note-text[_ngcontent-%COMP%]{max-width:300px;line-height:1.5;white-space:pre-wrap;word-break:break-word}.spec-plan-container[_ngcontent-%COMP%]   .spec-plan-table[_ngcontent-%COMP%]   .note-text[_ngcontent-%COMP%]{color:#64748b;font-size:12px}.hierarchical-canvas[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:0;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-radius:12px}.hierarchical-canvas[_ngcontent-%COMP%]   .canvas-stats-bar[_ngcontent-%COMP%]{display:flex;gap:24px;padding:16px 24px;background:#fff;border-bottom:1px solid #e2e8f0;position:sticky;top:0;z-index:10}.hierarchical-canvas[_ngcontent-%COMP%]   .canvas-stats-bar[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.hierarchical-canvas[_ngcontent-%COMP%]   .canvas-stats-bar[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:12px;color:#64748b;font-weight:500}.hierarchical-canvas[_ngcontent-%COMP%]   .canvas-stats-bar[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#1e293b}.hierarchical-canvas[_ngcontent-%COMP%]   .canvas-stats-bar[_ngcontent-%COMP%]   .stat-item.priority[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#ef4444}.hierarchical-canvas[_ngcontent-%COMP%]   .hierarchy-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;padding:24px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;border-left:5px solid #667eea;box-shadow:0 4px 20px #0000000f;overflow:hidden;transition:all .3s ease}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 30px #0000001a;transform:translateY(-2px)}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #f1f5f9}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]   .main-category-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]   .main-category-title[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;color:#fff}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]   .main-category-title[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#1e293b}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]   .main-category-stats[_ngcontent-%COMP%]{display:flex;gap:16px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]   .main-category-stats[_ngcontent-%COMP%]   .mid-count[_ngcontent-%COMP%], .hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]   .main-category-stats[_ngcontent-%COMP%]   .item-count[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#64748b;background:#f1f5f9;padding:6px 12px;border-radius:20px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .main-category-header[_ngcontent-%COMP%]   .main-category-stats[_ngcontent-%COMP%]   .item-count[_ngcontent-%COMP%]{color:#667eea;background:#667eea1a}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .mid-categories-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:16px;padding:20px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .mid-category-section[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;border:1px solid #e2e8f0;overflow:hidden}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .mid-category-section[_ngcontent-%COMP%]   .mid-category-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;background:linear-gradient(to right,#f1f5f9,#f8fafc);border-bottom:1px solid #e2e8f0}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .mid-category-section[_ngcontent-%COMP%]   .mid-category-header[_ngcontent-%COMP%]   .mid-category-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#475569}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .mid-category-section[_ngcontent-%COMP%]   .mid-category-header[_ngcontent-%COMP%]   .mid-category-count[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#fff;background:#94a3b8;padding:2px 10px;border-radius:12px;min-width:24px;text-align:center}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .mid-category-section[_ngcontent-%COMP%]   .items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding:12px;max-height:400px;overflow-y:auto}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;padding:12px 14px;background:#fff;border-radius:10px;border:1px solid #e2e8f0;cursor:pointer;transition:all .2s ease;position:relative}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]:hover{border-color:#cbd5e1;box-shadow:0 4px 12px #0000000f;transform:translate(4px)}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card.high-priority[_ngcontent-%COMP%]{border-left:3px solid #ef4444;background:linear-gradient(to right,#ef444408,#fff)}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card.expanded[_ngcontent-%COMP%]{background:#f8fafc;border-color:#667eea;box-shadow:0 6px 20px #667eea1f}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .feasibility-indicator[_ngcontent-%COMP%]{width:4px;height:100%;min-height:40px;border-radius:2px;position:absolute;left:0;top:0}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .feasibility-indicator.high[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#10b981,#059669)}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .feasibility-indicator.medium[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#f59e0b,#d97706)}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .feasibility-indicator.low[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#ef4444,#dc2626)}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]{flex:1;min-width:0;padding-left:8px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-header[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#1e293b;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-header[_ngcontent-%COMP%]   .priority-badge[_ngcontent-%COMP%]{font-size:12px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .kanban-status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:20px;font-size:10px;font-weight:600;border:1px solid;margin:6px 0}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .kanban-status-badge[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{width:6px;height:6px;border-radius:50%}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-scores[_ngcontent-%COMP%]{display:flex;gap:8px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-scores[_ngcontent-%COMP%]   .score-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:3px 8px;border-radius:6px;font-size:11px;font-weight:600;background:#f1f5f9;color:#64748b}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-scores[_ngcontent-%COMP%]   .score-badge[_ngcontent-%COMP%]   .score-icon[_ngcontent-%COMP%]{font-size:10px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-scores[_ngcontent-%COMP%]   .score-badge.high[_ngcontent-%COMP%]{background:#10b9811a;color:#059669}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px dashed #e2e8f0}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{margin-bottom:10px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{display:block;font-size:10px;font-weight:600;color:#94a3b8;text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-size:12px;color:#475569;line-height:1.5;white-space:pre-wrap}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .detail-row.id-row[_ngcontent-%COMP%]{margin-bottom:0;text-align:right}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .detail-row.id-row[_ngcontent-%COMP%]   .detail-id[_ngcontent-%COMP%]{font-size:10px;color:#94a3b8;font-family:monospace}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .expand-icon[_ngcontent-%COMP%]{color:#94a3b8;transition:transform .2s ease;flex-shrink:0;padding-top:4px}.hierarchical-canvas[_ngcontent-%COMP%]   .main-category-card[_ngcontent-%COMP%]   .spec-item-card[_ngcontent-%COMP%]   .expand-icon.expanded[_ngcontent-%COMP%]{transform:rotate(180deg)}.chatflow-canvas[_ngcontent-%COMP%]{flex:1;position:relative;overflow:hidden;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000000d;border:1px solid #e5e7eb;cursor:grab}.chatflow-canvas.panning[_ngcontent-%COMP%]{cursor:grabbing}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(rgba(229,231,235,.5) 1px,transparent 1px),linear-gradient(90deg,rgba(229,231,235,.5) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:auto;z-index:1}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]{position:absolute;border:1px solid #e2e8f0;border-radius:12px;background:#ffffffe6;pointer-events:none;transition:border-color .2s ease,box-shadow .2s ease;z-index:1;-webkit-user-select:none;user-select:none;box-shadow:0 4px 15px #0000000d;overflow:hidden}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{position:relative;padding:16px;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-bottom:1px solid #e2e8f0;display:flex;flex-direction:column;gap:6px;min-height:50px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-header-top[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .page-badge[_ngcontent-%COMP%]{font-size:10px;font-weight:800;padding:3px 8px;background:#64748b;color:#fff;border-radius:5px;letter-spacing:.8px;flex-shrink:0}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-label-bar[_ngcontent-%COMP%]{color:#1e293b;font-size:16px;font-weight:750;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;letter-spacing:-.3px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .category-tag[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;font-size:11px;font-weight:500;color:#94a3b8;background:#fff;padding:2px 10px;border-radius:100px;border:1px solid #e2e8f0;box-shadow:0 1px 2px #00000008}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]   .group-description[_ngcontent-%COMP%]{padding:10px 16px;font-size:12px;color:#64748b;line-height:1.5;background:#f8fafc80;border-bottom:1px dashed #e2e8f0;min-height:30px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .group-container[_ngcontent-%COMP%]:hover{background:#fffffff2;border-color:#cbd5e1;box-shadow:0 8px 25px #0000001a;transform:translateY(-2px)}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node[_ngcontent-%COMP%]{position:absolute;width:280px;background:#fff;border-radius:8px;padding:10px 14px;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease,border-color .2s ease,background-color .2s ease;box-shadow:0 2px 5px #0000000d;color:#334155;border:1px solid #e2e8f0;z-index:10}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;position:relative}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-icon-canvas[_ngcontent-%COMP%]{width:28px;height:28px;background:#f1f5f9;color:#64748b;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:14px;transition:all .2s ease}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-priority-indicator[_ngcontent-%COMP%]{width:4px;height:100%;position:absolute;left:0;top:0;border-radius:2px 0 0 2px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-priority-indicator.high[_ngcontent-%COMP%]{background:#10b981}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-priority-indicator.medium[_ngcontent-%COMP%]{background:#f59e0b}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-priority-indicator.low[_ngcontent-%COMP%]{background:#ef4444}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas[_ngcontent-%COMP%]{flex:1;min-width:0}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas.spec-node[_ngcontent-%COMP%]{padding-left:8px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas.spec-node[_ngcontent-%COMP%]   .node-category-badge[_ngcontent-%COMP%]{font-size:9px;font-weight:600;color:#667eea;background:#667eea1a;padding:2px 6px;border-radius:4px;display:inline-block;margin-bottom:4px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas.spec-node[_ngcontent-%COMP%]   .node-scores[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:4px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas.spec-node[_ngcontent-%COMP%]   .node-scores[_ngcontent-%COMP%]   .score[_ngcontent-%COMP%]{font-size:10px;color:#94a3b8;font-weight:500}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas.spec-node[_ngcontent-%COMP%]   .node-scores[_ngcontent-%COMP%]   .score.high[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas[_ngcontent-%COMP%]   .node-name-canvas[_ngcontent-%COMP%]{font-weight:600;font-size:13px;color:#1e293b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-info-canvas[_ngcontent-%COMP%]   .node-type-label-canvas[_ngcontent-%COMP%]{font-size:9px;color:#94a3b8;font-weight:600;text-transform:uppercase;letter-spacing:.4px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-open-btn[_ngcontent-%COMP%]{width:24px;height:24px;background:#f1f5f9;border:none;border-radius:4px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#64748b;transition:all .2s ease;padding:0;flex-shrink:0;opacity:1}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-open-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-open-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:#3b82f6;transform:scale(1.1)}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]   .node-content-canvas[_ngcontent-%COMP%]   .node-open-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]:hover{border-color:#3b82f6;box-shadow:0 4px 12px #3b82f626;transform:translate(4px)}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node[_ngcontent-%COMP%]:hover   .node-icon-canvas[_ngcontent-%COMP%]{background:#eff6ff;color:#3b82f6}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node.high-priority[_ngcontent-%COMP%]{border-left:3px solid #ef4444;background:linear-gradient(to right,#ef44440d,#fff)}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node.selected[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff;box-shadow:0 0 0 2px #3b82f61a,0 4px 12px #3b82f626}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node.selected[_ngcontent-%COMP%]   .node-name-canvas[_ngcontent-%COMP%]{color:#2563eb}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.component-node.selected[_ngcontent-%COMP%]   .node-icon-canvas[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .draggable-node[_ngcontent-%COMP%]{cursor:grab;-webkit-user-select:none;user-select:none}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .draggable-node.dragging[_ngcontent-%COMP%]{cursor:grabbing!important;box-shadow:0 15px 35px #00000026!important;transform:scale(1.02)!important;z-index:100!important;opacity:.9}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.in-group[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.chatflow-canvas[_ngcontent-%COMP%]   .canvas-content[_ngcontent-%COMP%]   .node.in-group.selected[_ngcontent-%COMP%]{border-left-color:#1d4ed8}.wbs-container[_ngcontent-%COMP%]{padding:24px;height:100%;display:flex;flex-direction:column;background:#f8fafc;overflow:hidden}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-shrink:0}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#1e293b}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .wbs-legend[_ngcontent-%COMP%]{display:flex;gap:16px}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .wbs-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:12px;color:#64748b}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .wbs-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:3px}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;gap:8px}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .wbs-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 14px;border:1px solid #e2e8f0;border-radius:8px;background:#fff;cursor:pointer;font-size:12px;font-weight:500;color:#475569;transition:all .2s ease}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .wbs-btn[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .wbs-btn.primary[_ngcontent-%COMP%]{background:#667eea;border-color:#667eea;color:#fff}.wbs-container[_ngcontent-%COMP%]   .wbs-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .wbs-btn.primary[_ngcontent-%COMP%]:hover{background:#5a67d8}.wbs-container[_ngcontent-%COMP%]   .wbs-empty[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;background:#fff;border-radius:12px;border:2px dashed #e2e8f0}.wbs-container[_ngcontent-%COMP%]   .wbs-empty[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:48px}.wbs-container[_ngcontent-%COMP%]   .wbs-empty[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;color:#1e293b}.wbs-container[_ngcontent-%COMP%]   .wbs-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#64748b}.wbs-container[_ngcontent-%COMP%]   .wbs-empty[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 24px;background:#667eea;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease}.wbs-container[_ngcontent-%COMP%]   .wbs-empty[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]:hover{background:#5a67d8;transform:translateY(-1px)}.wbs-container[_ngcontent-%COMP%]   .wbs-empty[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:currentColor;stroke-width:2}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]{flex:1;display:flex;background:#fff;border-radius:12px;border:1px solid #e2e8f0;overflow:hidden;min-height:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]{width:400px;flex-shrink:0;border-right:1px solid #e2e8f0;display:flex;flex-direction:column}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]{border-bottom:1px solid #e2e8f0;background:#f8fafc}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{display:flex;padding:12px 8px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#64748b;text-transform:uppercase}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]{flex:1;padding-left:12px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .col-responsible[_ngcontent-%COMP%]{width:60px;text-align:center}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .col-progress[_ngcontent-%COMP%]{width:80px;text-align:center}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-header[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]   .col-date[_ngcontent-%COMP%]{width:50px;text-align:center}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 8px;border-bottom:1px solid #f1f5f9;transition:background .15s ease}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]:hover{background:#f8fafc}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-0[_ngcontent-%COMP%]{background:#f8fafc;font-weight:600}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-0[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]{padding-left:12px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-1[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]{padding-left:32px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row.level-2[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]{padding-left:52px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]{flex:1;min-width:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .progress-indicator[_ngcontent-%COMP%]{width:4px;height:20px;border-radius:2px;flex-shrink:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .progress-indicator.high[_ngcontent-%COMP%]{background:#10b981}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .progress-indicator.medium[_ngcontent-%COMP%]{background:#f59e0b}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .progress-indicator.low[_ngcontent-%COMP%]{background:#ef4444}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .folder-icon[_ngcontent-%COMP%]{color:#f59e0b;flex-shrink:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .task-icon[_ngcontent-%COMP%]{color:#94a3b8;flex-shrink:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-size:13px;color:#1e293b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-tree-name[_ngcontent-%COMP%]   .tree-content[_ngcontent-%COMP%]   .linked-count[_ngcontent-%COMP%]{font-size:10px;background:#e0e7ff;color:#4f46e5;padding:2px 6px;border-radius:10px;flex-shrink:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-responsible[_ngcontent-%COMP%]{width:60px;text-align:center}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-responsible[_ngcontent-%COMP%]   .responsible-badge[_ngcontent-%COMP%]{display:inline-block;font-size:10px;padding:3px 8px;background:#f1f5f9;border-radius:4px;color:#475569}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-responsible[_ngcontent-%COMP%]   .responsible-badge.small[_ngcontent-%COMP%]{font-size:9px;padding:2px 6px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-progress[_ngcontent-%COMP%]{width:80px;display:flex;align-items:center;gap:6px}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-progress[_ngcontent-%COMP%]   .progress-bar-mini[_ngcontent-%COMP%]{flex:1;height:6px;background:#e2e8f0;border-radius:3px;overflow:hidden}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-progress[_ngcontent-%COMP%]   .progress-bar-mini[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;border-radius:3px;transition:width .3s ease}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:11px;color:#64748b;width:32px;text-align:right}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .task-list-side[_ngcontent-%COMP%]   .side-body[_ngcontent-%COMP%]   .task-row[_ngcontent-%COMP%]   .col-date[_ngcontent-%COMP%]{width:50px;text-align:center;font-size:11px;color:#64748b}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow-x:auto;min-width:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]{border-bottom:1px solid #e2e8f0;background:#f8fafc;flex-shrink:0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #e2e8f0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]   .month-cell[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#1e293b;padding:8px 0;text-align:center;border-right:1px solid #e2e8f0}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .month-row[_ngcontent-%COMP%]   .month-cell[_ngcontent-%COMP%]:last-child{border-right:none}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]{display:flex}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4px 0;border-right:1px solid #f1f5f9}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.today[_ngcontent-%COMP%]{background:#eff6ff}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.today[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border-radius:50%;width:18px;height:18px;display:flex;align-items:center;justify-content:center}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.weekend[_ngcontent-%COMP%]{background:#fef2f2}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell.weekend[_ngcontent-%COMP%]   .day-name[_ngcontent-%COMP%]{color:#ef4444}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-size:11px;font-weight:500;color:#1e293b}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-header[_ngcontent-%COMP%]   .day-row[_ngcontent-%COMP%]   .day-cell[_ngcontent-%COMP%]   .day-name[_ngcontent-%COMP%]{font-size:9px;color:#94a3b8}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]{flex:1;position:relative;overflow-y:auto}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .today-line[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:2px;background:#ef4444;z-index:10}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .today-line[_ngcontent-%COMP%]:before{content:"\\c624\\b298";position:absolute;top:4px;left:4px;font-size:10px;color:#ef4444;font-weight:600;white-space:nowrap}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-row[_ngcontent-%COMP%]{height:38px;border-bottom:1px solid #f1f5f9;position:relative}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-row[_ngcontent-%COMP%]   .gantt-bar[_ngcontent-%COMP%]{position:absolute;top:6px;height:26px;border-radius:4px;display:flex;align-items:center;overflow:hidden;cursor:pointer;transition:all .2s ease}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-row[_ngcontent-%COMP%]   .gantt-bar[_ngcontent-%COMP%]:hover{filter:brightness(1.05);box-shadow:0 2px 8px #00000026}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-row[_ngcontent-%COMP%]   .gantt-bar.group-bar[_ngcontent-%COMP%]   .bar-progress[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;opacity:.3}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-row[_ngcontent-%COMP%]   .gantt-bar.group-bar[_ngcontent-%COMP%]   .bar-label[_ngcontent-%COMP%]{position:relative;z-index:1;padding:0 10px;font-size:11px;font-weight:600;color:#fff;white-space:nowrap;text-shadow:0 1px 2px rgba(0,0,0,.2)}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-row[_ngcontent-%COMP%]   .gantt-bar.task-bar[_ngcontent-%COMP%]{border:1px solid}.wbs-container[_ngcontent-%COMP%]   .gantt-wrapper[_ngcontent-%COMP%]   .gantt-chart-side[_ngcontent-%COMP%]   .gantt-body[_ngcontent-%COMP%]   .gantt-row[_ngcontent-%COMP%]   .gantt-bar.task-bar[_ngcontent-%COMP%]   .bar-progress[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]{display:flex;gap:16px;margin-top:16px;flex-shrink:0}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;background:#fff;border-radius:8px;border:1px solid #e2e8f0}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:12px;color:#64748b}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1e293b}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]   .stat-card.completed[_ngcontent-%COMP%]{background:#f0fdf4;border-color:#86efac}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]   .stat-card.completed[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#16a34a}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]   .stat-card.in-progress[_ngcontent-%COMP%]{background:#fffbeb;border-color:#fcd34d}.wbs-container[_ngcontent-%COMP%]   .wbs-stats[_ngcontent-%COMP%]   .stat-card.in-progress[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#d97706}.wbs-view-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.wbs-view-container[_ngcontent-%COMP%]   app-wbs-doc[_ngcontent-%COMP%]{flex:1;display:block;height:100%}.flowchart-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;background:#f8fafc;border-radius:12px;overflow:hidden;position:relative;cursor:grab}.flowchart-container[_ngcontent-%COMP%]:active{cursor:grabbing}.flowchart-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#fff;border-bottom:1px solid #e2e8f0;z-index:10;gap:16px;flex-wrap:wrap}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:6px;padding:6px 12px;height:32px;border:1px solid #e2e8f0;border-radius:6px;background:#fff;cursor:pointer;transition:all .2s ease}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px;color:#64748b}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn[_ngcontent-%COMP%]   .btn-label[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#475569;display:none}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn.auto-layout[_ngcontent-%COMP%]{width:auto;padding:6px 14px;background:#fff;border-color:#cbd5e1}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn.auto-layout[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{display:none}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn.auto-layout[_ngcontent-%COMP%]   .btn-label[_ngcontent-%COMP%]{display:inline;color:#475569}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn.auto-layout[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#94a3b8}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-btn.auto-layout[_ngcontent-%COMP%]:active{transform:scale(.98)}.flowchart-toolbar[_ngcontent-%COMP%]   .device-tab-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:6px;padding:6px 12px;height:32px;border:1px solid #cbd5e1;border-radius:6px;background:#fff;cursor:pointer;transition:all .2s ease;font-size:13px;font-weight:500;color:#475569}.flowchart-toolbar[_ngcontent-%COMP%]   .device-tab-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.flowchart-toolbar[_ngcontent-%COMP%]   .device-tab-btn[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#94a3b8}.flowchart-toolbar[_ngcontent-%COMP%]   .device-tab-btn.active[_ngcontent-%COMP%]{background:#3b82f6;border-color:#3b82f6;color:#fff}.flowchart-toolbar[_ngcontent-%COMP%]   .device-tab-btn.active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#fff}.flowchart-toolbar[_ngcontent-%COMP%]   .device-tab-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.flowchart-toolbar[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{min-width:50px;text-align:center;font-size:13px;font-weight:500;color:#475569}.flowchart-toolbar[_ngcontent-%COMP%]   .toolbar-label[_ngcontent-%COMP%]{font-size:13px;color:#64748b;margin-right:4px}.flowchart-toolbar[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{color:#d1d5db;margin:0 8px}.screen-type-legend[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:12px;font-weight:500;color:#374151}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:2px;border:2px solid}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.screen[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.screen[_ngcontent-%COMP%]{background:#dbeafe;border-color:#3b82f6}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.modal[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.modal[_ngcontent-%COMP%]{background:#f3e8ff;border-color:#a855f7}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.panel[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.panel[_ngcontent-%COMP%]{background:#d1fae5;border-color:#22c55e}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.sheet[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.sheet[_ngcontent-%COMP%]{background:#ffedd5;border-color:#f97316}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.open[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.open[_ngcontent-%COMP%]{background:#94a3b8;border-color:#64748b;border-radius:50%}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.in-progress[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.in-progress[_ngcontent-%COMP%]{background:#3b82f6;border-color:#2563eb;border-radius:50%}.screen-type-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.completed[_ngcontent-%COMP%], .status-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.completed[_ngcontent-%COMP%]{background:#22c55e;border-color:#16a34a;border-radius:50%}.flowchart-canvas[_ngcontent-%COMP%]{flex:1;position:relative;min-height:600px;transform-origin:0 0;transition:transform .1s ease-out}.edges-layer[_ngcontent-%COMP%]{position:absolute;top:0;left:0;pointer-events:none;z-index:1}.edges-layer[_ngcontent-%COMP%]   .edge-path[_ngcontent-%COMP%]{fill:none;stroke:#94a3b8;stroke-width:2;stroke-linecap:round}.edges-layer[_ngcontent-%COMP%]   .edge-path.edge-primary[_ngcontent-%COMP%]{stroke:#3b82f6;stroke-width:3}.edges-layer[_ngcontent-%COMP%]   .edge-path.edge-secondary[_ngcontent-%COMP%]{stroke:#94a3b8;stroke-dasharray:5,5}.edges-layer[_ngcontent-%COMP%]   .edge-path.edge-conditional[_ngcontent-%COMP%]{stroke:#f59e0b;stroke-dasharray:10,5}.screen-nodes[_ngcontent-%COMP%]{position:relative;z-index:2}.screen-node[_ngcontent-%COMP%]{position:absolute;width:280px;background:#fff;border-radius:12px;border:2px solid #e2e8f0;box-shadow:0 4px 12px #00000014;cursor:move;transition:box-shadow .2s ease,transform .1s ease;overflow:hidden}.screen-node[_ngcontent-%COMP%]:hover{box-shadow:0 8px 24px #0000001f;transform:translateY(-2px)}.screen-node.selected[_ngcontent-%COMP%]{box-shadow:0 0 0 3px #667eea4d,0 8px 24px #00000026}.screen-node.expanded[_ngcontent-%COMP%]{width:320px}.screen-node.type-screen[_ngcontent-%COMP%]{border-color:#3b82f6;border-style:solid}.screen-node.type-modal[_ngcontent-%COMP%]{border-color:#a855f7;border-style:dashed;border-radius:8px}.screen-node.type-panel[_ngcontent-%COMP%]{border-color:#22c55e;border-style:solid;border-left-width:4px}.screen-node.type-sheet[_ngcontent-%COMP%]{border-color:#f97316;border-style:dotted;border-bottom-width:4px}.node-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 14px;color:#fff;font-weight:600}.node-header[_ngcontent-%COMP%]   .node-icon[_ngcontent-%COMP%]{font-size:20px;opacity:.9}.node-header[_ngcontent-%COMP%]   .node-title[_ngcontent-%COMP%]{flex:1;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.node-header[_ngcontent-%COMP%]   .screen-type-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;font-size:10px;font-weight:600;border-radius:4px;background:#fff3;color:#fff;white-space:nowrap;margin-left:4px}.node-header[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:26px;height:26px;border:none;border-radius:6px;background:#fff3;cursor:pointer;transition:background .2s ease}.node-header[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px;color:#fff}.node-header[_ngcontent-%COMP%]   .expand-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.event-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px;padding:12px 14px;background:#f8fafc;border-bottom:1px solid #e2e8f0}.event-tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 10px;border-radius:20px;font-size:11px;font-weight:600;cursor:default}.event-tag.pageview[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.event-tag.action[_ngcontent-%COMP%]{background:#dcfce7;color:#15803d}.event-tag.conversion[_ngcontent-%COMP%]{background:#f3e8ff;color:#7e22ce}.event-tag.navigation[_ngcontent-%COMP%]{background:#ffedd5;color:#c2410c}.event-tag.error[_ngcontent-%COMP%]{background:#fee2e2;color:#b91c1c}.features-section[_ngcontent-%COMP%]{padding:12px 14px;max-height:300px;overflow-y:auto}.feature-group[_ngcontent-%COMP%]{margin-bottom:12px}.feature-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.feature-group[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 8px;background:#f1f5f9;border-radius:6px;font-size:12px;font-weight:600;color:#475569;margin-bottom:8px}.feature-group[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.feature-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 0 8px}.feature-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:6px 8px;font-size:12px;color:#334155;border-radius:4px;transition:background .15s ease}.feature-item[_ngcontent-%COMP%]:hover{background:#f8fafc}.feature-item[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;flex-shrink:0}.feature-item[_ngcontent-%COMP%]   .status-dot.pending[_ngcontent-%COMP%]{background:#94a3b8}.feature-item[_ngcontent-%COMP%]   .status-dot.in_progress[_ngcontent-%COMP%]{background:#f59e0b}.feature-item[_ngcontent-%COMP%]   .status-dot.completed[_ngcontent-%COMP%]{background:#22c55e}.feature-item[_ngcontent-%COMP%]   .status-dot.review[_ngcontent-%COMP%]{background:#8b5cf6}.feature-item[_ngcontent-%COMP%]   .status-dot.blocked[_ngcontent-%COMP%]{background:#ef4444}.feature-item[_ngcontent-%COMP%]   .progress-badge[_ngcontent-%COMP%]{margin-left:auto;padding:2px 8px;background:#e2e8f0;border-radius:10px;font-size:10px;font-weight:600;color:#475569}.progress-bar-container[_ngcontent-%COMP%]{padding:12px 14px;background:#f8fafc;border-top:1px solid #e2e8f0}.progress-bar-container[_ngcontent-%COMP%]   .progress-label[_ngcontent-%COMP%]{font-size:11px;color:#64748b;margin-bottom:6px}.progress-bar-container[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{height:6px;background:#e2e8f0;border-radius:3px;overflow:hidden}.progress-bar-container[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#22c55e,#4ade80);border-radius:3px;transition:width .3s ease}.empty-flowchart[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#64748b}.empty-flowchart[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:64px;color:#cbd5e1;margin-bottom:16px}.empty-flowchart[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:15px;text-align:center}.empty-flowchart[_ngcontent-%COMP%]   p.hint[_ngcontent-%COMP%]{margin-top:8px;font-size:13px;color:#94a3b8}.screen-node.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.4}.screen-node.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 12px 40px #0003}.screen-node.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.features-preview[_ngcontent-%COMP%]{padding:10px 14px;background:#f8fafc;border-bottom:1px solid #e2e8f0}.features-preview[_ngcontent-%COMP%]   .preview-group[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;margin:3px 4px;padding:5px 10px;background:#fff;border:1px solid #e2e8f0;border-radius:6px;font-size:12px}.features-preview[_ngcontent-%COMP%]   .preview-group[_ngcontent-%COMP%]   .preview-mid[_ngcontent-%COMP%]{color:#334155;font-weight:500}.features-preview[_ngcontent-%COMP%]   .preview-group[_ngcontent-%COMP%]   .preview-count[_ngcontent-%COMP%]{color:#94a3b8;font-size:11px}.features-section.expanded[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.features-section.expanded[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.features-section.expanded[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}.features-section.expanded[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.feature-group[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .feature-count[_ngcontent-%COMP%]{margin-left:auto;padding:2px 8px;background:#e2e8f0;border-radius:10px;font-size:10px;font-weight:600;color:#64748b}.feature-item[_ngcontent-%COMP%]{flex-wrap:wrap}.feature-item[_ngcontent-%COMP%]   .feature-name[_ngcontent-%COMP%]{flex:1;min-width:100px}.feature-item[_ngcontent-%COMP%]   .feature-request[_ngcontent-%COMP%]{width:100%;margin-top:4px;padding:4px 8px;background:#f1f5f9;border-radius:4px;font-size:11px;color:#64748b;line-height:1.4}.events-section[_ngcontent-%COMP%]{padding:12px 14px;border-top:1px solid #e2e8f0;background:#fefce8}.events-section[_ngcontent-%COMP%]   .events-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:12px;font-weight:600;color:#854d0e;margin-bottom:8px}.events-section[_ngcontent-%COMP%]   .events-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px}.events-section[_ngcontent-%COMP%]   .event-tags[_ngcontent-%COMP%]{padding:0;background:transparent;border:none}.detail-panel[_ngcontent-%COMP%]{position:absolute;top:60px;right:16px;width:400px;max-height:calc(100% - 80px);background:#fff;border-radius:12px;box-shadow:0 8px 32px #00000026;z-index:100;display:flex;flex-direction:column;overflow:hidden;animation:_ngcontent-%COMP%_slideIn .2s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translate(20px)}to{opacity:1;transform:translate(0)}}.detail-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;color:#fff}.detail-header[_ngcontent-%COMP%]   .detail-icon[_ngcontent-%COMP%]{font-size:28px}.detail-header[_ngcontent-%COMP%]   .detail-title-section[_ngcontent-%COMP%]{flex:1}.detail-header[_ngcontent-%COMP%]   .detail-title-section[_ngcontent-%COMP%]   .detail-title[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600}.detail-header[_ngcontent-%COMP%]   .detail-title-section[_ngcontent-%COMP%]   .detail-id[_ngcontent-%COMP%]{font-size:11px;opacity:.8}.detail-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;border:none;border-radius:8px;background:#fff3;cursor:pointer;transition:background .2s}.detail-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px;color:#fff}.detail-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.detail-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px}.detail-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.detail-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}.detail-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.detail-summary[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:16px}.detail-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;padding:12px;background:#f8fafc;border-radius:8px;border:1px solid #e2e8f0}.detail-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:11px;color:#64748b;margin-bottom:4px}.detail-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#1e293b}.detail-progress[_ngcontent-%COMP%]{margin-bottom:20px}.detail-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{height:8px;background:#e2e8f0;border-radius:4px;overflow:hidden}.detail-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#22c55e,#4ade80);border-radius:4px;transition:width .3s ease}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0 0 12px;padding-bottom:8px;border-bottom:1px solid #e2e8f0;font-size:14px;font-weight:600;color:#334155}.section-title[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px;color:#64748b}.detail-features[_ngcontent-%COMP%]{margin-bottom:20px}.detail-group[_ngcontent-%COMP%]{margin-bottom:16px}.detail-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.detail-group-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 12px;background:#f1f5f9;border-radius:8px;margin-bottom:8px}.detail-group-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px;color:#64748b}.detail-group-header[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]{flex:1;font-size:13px;font-weight:600;color:#334155}.detail-group-header[_ngcontent-%COMP%]   .group-count[_ngcontent-%COMP%]{padding:2px 8px;background:#e2e8f0;border-radius:10px;font-size:11px;color:#64748b}.detail-group-items[_ngcontent-%COMP%]{padding-left:8px}.detail-item[_ngcontent-%COMP%]{padding:12px;margin-bottom:8px;background:#fff;border:1px solid #e2e8f0;border-radius:8px;transition:box-shadow .2s}.detail-item[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #0000000f}.detail-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.item-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.item-header[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;flex-shrink:0}.item-header[_ngcontent-%COMP%]   .status-indicator.open[_ngcontent-%COMP%]{background:#94a3b8}.item-header[_ngcontent-%COMP%]   .status-indicator.inProgress[_ngcontent-%COMP%]{background:#f59e0b}.item-header[_ngcontent-%COMP%]   .status-indicator.completed[_ngcontent-%COMP%]{background:#22c55e}.item-header[_ngcontent-%COMP%]   .status-indicator.review[_ngcontent-%COMP%]{background:#8b5cf6}.item-header[_ngcontent-%COMP%]   .status-indicator.blocked[_ngcontent-%COMP%]{background:#ef4444}.item-header[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{flex:1;font-size:13px;font-weight:500;color:#1e293b}.item-header[_ngcontent-%COMP%]   .item-status-badge[_ngcontent-%COMP%]{padding:3px 8px;border-radius:12px;font-size:10px;font-weight:600}.item-header[_ngcontent-%COMP%]   .item-status-badge.open[_ngcontent-%COMP%]{background:#f1f5f9;color:#64748b}.item-header[_ngcontent-%COMP%]   .item-status-badge.inProgress[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.item-header[_ngcontent-%COMP%]   .item-status-badge.completed[_ngcontent-%COMP%]{background:#dcfce7;color:#16a34a}.item-header[_ngcontent-%COMP%]   .item-status-badge.review[_ngcontent-%COMP%]{background:#f3e8ff;color:#7c3aed}.item-header[_ngcontent-%COMP%]   .item-status-badge.blocked[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.item-request[_ngcontent-%COMP%]{padding:8px 10px;background:#f8fafc;border-radius:6px;font-size:12px;color:#475569;line-height:1.5;margin-bottom:8px}.item-request[_ngcontent-%COMP%]   .request-label[_ngcontent-%COMP%]{font-weight:600;color:#64748b;margin-right:4px}.item-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.item-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:11px;color:#64748b}.item-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px}.item-meta[_ngcontent-%COMP%]   .meta-item.priority[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#f59e0b}.item-meta[_ngcontent-%COMP%]   .meta-item.feasibility[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#22c55e}.item-meta[_ngcontent-%COMP%]   .meta-item.progress[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#3b82f6}.detail-events[_ngcontent-%COMP%]{margin-bottom:20px}.events-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.event-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px 12px;background:#f8fafc;border-radius:8px;border-left:3px solid}.event-item.pageview[_ngcontent-%COMP%]{border-color:#3b82f6}.event-item.action[_ngcontent-%COMP%]{border-color:#22c55e}.event-item.conversion[_ngcontent-%COMP%]{border-color:#a855f7}.event-item.navigation[_ngcontent-%COMP%]{border-color:#f97316}.event-item.error[_ngcontent-%COMP%]{border-color:#ef4444}.event-item[_ngcontent-%COMP%]   .event-type-badge[_ngcontent-%COMP%]{padding:3px 8px;border-radius:4px;font-size:10px;font-weight:600;text-transform:uppercase}.event-item[_ngcontent-%COMP%]   .event-type-badge.pageview[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.event-item[_ngcontent-%COMP%]   .event-type-badge.action[_ngcontent-%COMP%]{background:#dcfce7;color:#15803d}.event-item[_ngcontent-%COMP%]   .event-type-badge.conversion[_ngcontent-%COMP%]{background:#f3e8ff;color:#7e22ce}.event-item[_ngcontent-%COMP%]   .event-type-badge.navigation[_ngcontent-%COMP%]{background:#ffedd5;color:#c2410c}.event-item[_ngcontent-%COMP%]   .event-type-badge.error[_ngcontent-%COMP%]{background:#fee2e2;color:#b91c1c}.event-item[_ngcontent-%COMP%]   .event-info[_ngcontent-%COMP%]{flex:1}.event-item[_ngcontent-%COMP%]   .event-info[_ngcontent-%COMP%]   .event-name[_ngcontent-%COMP%]{display:block;font-size:13px;font-weight:500;color:#334155}.event-item[_ngcontent-%COMP%]   .event-info[_ngcontent-%COMP%]   .event-trigger[_ngcontent-%COMP%]{font-size:11px;color:#94a3b8}.detail-connections[_ngcontent-%COMP%]   .connections-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.detail-connections[_ngcontent-%COMP%]   .connection-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px 12px;background:#f8fafc;border-radius:8px;cursor:pointer;transition:background .2s}.detail-connections[_ngcontent-%COMP%]   .connection-item[_ngcontent-%COMP%]:hover{background:#e2e8f0}.detail-connections[_ngcontent-%COMP%]   .connection-item[_ngcontent-%COMP%]   .connection-icon[_ngcontent-%COMP%]{font-size:20px}.detail-connections[_ngcontent-%COMP%]   .connection-item[_ngcontent-%COMP%]   .connection-name[_ngcontent-%COMP%]{flex:1;font-size:13px;font-weight:500;color:#334155}.detail-connections[_ngcontent-%COMP%]   .connection-item[_ngcontent-%COMP%]   .connection-type[_ngcontent-%COMP%]{padding:2px 8px;background:#e2e8f0;border-radius:4px;font-size:10px;color:#64748b}.detail-connections[_ngcontent-%COMP%]   .connection-item[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{font-size:16px;color:#94a3b8}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 0 #667eeab3}70%{box-shadow:0 0 0 10px #667eea00}to{box-shadow:0 0 #667eea00}}.screens-view-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:280px 1fr;gap:12px;height:100%;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#f8f9fa;border-right:1px solid #e0e0e0;overflow:hidden}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid #e0e0e0}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:600;color:#333}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{font-size:12px;color:#999;background:#f0f0f0;padding:2px 6px;border-radius:4px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .device-tabs[_ngcontent-%COMP%]{display:flex;padding:8px;gap:4px;background:#eee;border-bottom:1px solid #e0e0e0}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .device-tabs[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:6px;border:none;background:transparent;border-radius:4px;font-size:12px;font-weight:500;color:#666;cursor:pointer;transition:all .2s}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .device-tabs[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .device-tabs[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]:hover{background:#0000000d}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .device-tabs[_ngcontent-%COMP%]   .tab-btn.active[_ngcontent-%COMP%]{background:#fff;color:#667eea;box-shadow:0 1px 3px #0000001a}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-search[_ngcontent-%COMP%]{padding:8px 12px;border-bottom:1px solid #e0e0e0}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border:1px solid #e0e0e0;border-radius:4px;font-size:12px;outline:none}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 0 2px #667eea1a}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 0}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ccc;border-radius:3px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#999}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:150px;color:#999;text-align:center}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;opacity:.5;margin-bottom:8px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;cursor:pointer;border-left:3px solid transparent;transition:all .2s ease}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]:hover{background:#f0f0f0}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item.selected[_ngcontent-%COMP%]{background:#e8ecff;border-left-color:#667eea}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item.selected[_ngcontent-%COMP%]   .screen-name[_ngcontent-%COMP%]{color:#667eea;font-weight:600}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]   .screen-icon[_ngcontent-%COMP%]{font-size:20px;flex-shrink:0;min-width:24px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]   .screen-info[_ngcontent-%COMP%]{flex:1;min-width:0}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]   .screen-info[_ngcontent-%COMP%]   .screen-name-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]   .screen-info[_ngcontent-%COMP%]   .screen-name-wrapper[_ngcontent-%COMP%]   .screen-name[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]   .screen-info[_ngcontent-%COMP%]   .screen-meta[_ngcontent-%COMP%]{font-size:11px;color:#999;margin-top:2px}.screens-view-container[_ngcontent-%COMP%]   .screens-list-panel[_ngcontent-%COMP%]   .screens-list[_ngcontent-%COMP%]   .screen-list-item[_ngcontent-%COMP%]   .screen-info[_ngcontent-%COMP%]   .screen-meta[_ngcontent-%COMP%]   .image-count[_ngcontent-%COMP%]{display:inline-block}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;padding:16px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .no-selection[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#999;text-align:center}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .no-selection[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;opacity:.5;margin-bottom:12px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .no-selection[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]{margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0;display:flex;justify-content:space-between;align-items:center}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .large-icon[_ngcontent-%COMP%]{font-size:32px;flex-shrink:0}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{flex:1}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;color:#333}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin:4px 0 0;font-size:13px;color:#666}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-mode-toggle[_ngcontent-%COMP%]{display:flex;background:#f0f2f5;padding:4px;border-radius:8px;gap:2px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-mode-toggle[_ngcontent-%COMP%]   .mode-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;border:none;background:transparent;border-radius:6px;font-size:12px;font-weight:600;color:#666;cursor:pointer;transition:all .2s}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-mode-toggle[_ngcontent-%COMP%]   .mode-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-mode-toggle[_ngcontent-%COMP%]   .mode-btn.active[_ngcontent-%COMP%]{background:#fff;color:#667eea;box-shadow:0 1px 3px #0000001a}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .view-mode-toggle[_ngcontent-%COMP%]   .mode-btn[_ngcontent-%COMP%]:hover:not(.active){background:#0000000d}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .live-view-section[_ngcontent-%COMP%]{width:100%;height:700px;background:#f8f9fa;border-radius:12px;overflow:hidden;border:1px solid #e0e0e0;margin-bottom:24px;display:flex;justify-content:center;align-items:center;padding:20px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .live-view-section[_ngcontent-%COMP%]   .iframe-container[_ngcontent-%COMP%]{width:100%;height:100%;background:#fff;box-shadow:0 4px 20px #00000014}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .live-view-section.mobile-frame[_ngcontent-%COMP%]{background:#eef0f2}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .live-view-section.mobile-frame[_ngcontent-%COMP%]   .iframe-container[_ngcontent-%COMP%]{width:375px;height:667px;border-radius:32px;border:8px solid #333;position:relative;overflow:hidden;background:#fff}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .live-view-section.mobile-frame[_ngcontent-%COMP%]   .mobile-home-bar[_ngcontent-%COMP%]{position:absolute;bottom:8px;left:50%;transform:translate(-50%);width:120px;height:4px;background:#333;border-radius:2px;z-index:10}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .live-view-section[_ngcontent-%COMP%]   .live-iframe[_ngcontent-%COMP%]{width:100%;height:100%;border:none;background:#fff}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]{margin-bottom:24px;padding:12px;background:#f8f9fa;border-radius:6px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]{position:relative;width:100%;height:300px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:12px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .preview-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-info-overlay[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;background:#0009;color:#fff;padding:8px 12px;font-size:12px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-preview[_ngcontent-%COMP%]   .image-info-overlay[_ngcontent-%COMP%]   .image-title[_ngcontent-%COMP%]{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-metadata[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:12px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#999;font-weight:500;font-size:10px;text-transform:uppercase}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .image-viewer-section[_ngcontent-%COMP%]   .image-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333;font-weight:500}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:600;color:#333}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]{padding:20px;text-align:center;color:#999;background:#f8f9fa;border-radius:4px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .no-images[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:8px}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;cursor:pointer;padding:6px;border:2px solid #e0e0e0;border-radius:4px;transition:all .2s ease}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 2px 6px #667eea26}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item.active[_ngcontent-%COMP%]{border-color:#667eea;background:#f0f2ff;box-shadow:0 2px 6px #667eea40}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item[_ngcontent-%COMP%]   .image-thumbnail[_ngcontent-%COMP%]{position:relative;width:100%;aspect-ratio:1;background:#e0e0e0;border-radius:2px;overflow:hidden}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item[_ngcontent-%COMP%]   .image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item[_ngcontent-%COMP%]   .image-thumbnail[_ngcontent-%COMP%]   .active-badge[_ngcontent-%COMP%]{position:absolute;top:2px;right:2px;width:20px;height:20px;background:#667eea;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:600}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item[_ngcontent-%COMP%]   .image-title-small[_ngcontent-%COMP%]{font-size:11px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.screens-view-container[_ngcontent-%COMP%]   .screens-detail-panel[_ngcontent-%COMP%]   .images-section[_ngcontent-%COMP%]   .images-grid[_ngcontent-%COMP%]   .image-grid-item[_ngcontent-%COMP%]   .image-version[_ngcontent-%COMP%]{font-size:10px;color:#999}']})};function $x(n,t){if(n&1){let e=Oe();f(0,"app-ia-canvas",2),re("zoomLevelChange",function(i){J(e);let a=k();return Q(a.onZoomChange(i))})("penModeChange",function(i){J(e);let a=k();return Q(a.isPenMode=i)})("simulatorRequested",function(i){J(e);let a=k();return Q(a.onSimulatorRequested(i))}),p()}if(n&2){let e=k();we("pages",e.currentProjectData.ia.pages)("userFlows",e.currentProjectData.ia.userFlows)("folderType",e.folderType)("viewMode","canvas")("zoomLevel",e.canvasZoomLevel)("isPenMode",e.isPenMode)("isMultiSelectMode",e.isMultiSelectMode)}}var or=class n{constructor(t){this.projectSpecsService=t}folderType="calendar";simulatorRequested=new Rt;currentProjectData=null;isLoading=!1;errorMessage=null;viewMode="planning";canvasZoomLevel=100;isPenMode=!1;isMultiSelectMode=!1;showDownloadMenu=!1;ZOOM_STORAGE_KEY="ia-canvas-zoom";destroy$=new tn;functionSteps={zoom:{current:0,total:3,labels:["\uAE30\uBCF8","\uCD95\uC18C","\uD655\uB300"]},penMode:{current:0,total:2,labels:["\uC77C\uBC18","\uD39C"]},multiSelect:{current:0,total:2,labels:["\uB2E8\uC77C","\uB2E4\uC911"]},viewMode:{current:1,total:2,labels:["\uCE94\uBC84\uC2A4","\uAE30\uD68D\uC548"]},download:{current:0,total:1,labels:["\uB2E4\uC6B4\uB85C\uB4DC"]}};ngOnInit(){let t=localStorage.getItem(this.ZOOM_STORAGE_KEY);t&&(this.canvasZoomLevel=parseInt(t,10)),this.subscribeToProjectSpecs()}saveZoomLevel(t){localStorage.setItem(this.ZOOM_STORAGE_KEY,t.toString())}ngOnChanges(t){t.folderType&&!t.folderType.firstChange&&this.updateCurrentData()}ngAfterViewInit(){this.updateCurrentData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}subscribeToProjectSpecs(){this.projectSpecsService.loading$.pipe(nt(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.projectSpecsService.error$.pipe(nt(this.destroy$)).subscribe(t=>{this.errorMessage=t}),this.projectSpecsService.specs$.pipe(nt(this.destroy$)).subscribe(()=>{this.updateCurrentData()})}updateCurrentData(){let t=this.projectSpecsService.getProjectSpecSync(this.folderType);t&&(this.currentProjectData={name:t.name,ia:t.ia})}onViewModeChange(t){(t==="canvas"||t==="planning")&&this.updateViewMode(t)}zoomIn(){this.canvasZoomLevel<200&&(this.canvasZoomLevel=Math.min(200,this.canvasZoomLevel+10),this.saveZoomLevel(this.canvasZoomLevel),this.updateFunctionStep("zoom",2))}zoomOut(){this.canvasZoomLevel>50&&(this.canvasZoomLevel=Math.max(50,this.canvasZoomLevel-10),this.saveZoomLevel(this.canvasZoomLevel),this.updateFunctionStep("zoom",1))}onZoomChange(t){this.canvasZoomLevel=t,this.saveZoomLevel(t)}togglePenMode(){this.isPenMode=!this.isPenMode,this.updateFunctionStep("penMode",this.isPenMode?1:0)}toggleMultiSelectMode(){this.isMultiSelectMode=!this.isMultiSelectMode,this.updateFunctionStep("multiSelect",this.isMultiSelectMode?1:0)}updateViewMode(t){this.viewMode=t;let e=0;t==="planning"&&(e=1),this.updateFunctionStep("viewMode",e)}updateFunctionStep(t,e){this.functionSteps[t]&&(this.functionSteps[t].current=e)}getStepProgress(t){let e=this.functionSteps[t];return e?`${e.current+1}/${e.total}`:""}getStepLabel(t){let e=this.functionSteps[t];return e&&e.labels[e.current]?e.labels[e.current]:""}onSimulatorRequested(t){t.projectModule||(t.projectModule=this.folderType),this.simulatorRequested.emit(t)}toggleDownloadMenu(){this.showDownloadMenu=!this.showDownloadMenu}downloadDB(){let t=this.projectSpecsService.getProjectSpecSync(this.folderType);if(!t)return;let e=`${t.name}_DB.json`,r=JSON.stringify(t,null,2),i=new Blob([r],{type:"application/json"}),a=window.URL.createObjectURL(i),o=document.createElement("a");o.href=a,o.download=e,o.click(),window.URL.revokeObjectURL(a),this.showDownloadMenu=!1}downloadExcel(t){let e=this.projectSpecsService.getProjectSpecSync(this.folderType);if(!e)return;let r=[],i="",a="FF1E293B",o=[];if(t==="spec")i=`${e.name}_Spec.xlsx`,r=e.specifications.map(u=>({ID:u.id,\uBD84\uB958:u.category||"",\uD654\uBA74\uBA85:u.title,\uB0B4\uC6A9:u.description,\uC6B0\uC120\uC21C\uC704:u.priority,\uC0C1\uD0DC:u.status,\uC0C1\uC138:u.details||"",PC\uC0AC\uC591:u.pcSpec||"",Mobile\uC0AC\uC591:u.mobileSpec||""})),o=[{wch:12},{wch:14},{wch:16},{wch:30},{wch:12},{wch:10},{wch:30},{wch:20},{wch:20}];else if(t==="wbs"){i=`${e.name}_WBS.xlsx`,a="FF2E5090";let u=(v,h=0)=>{let w=[];return v.forEach(T=>{w.push({ID:T.id,Level:h,\uC791\uC5C5\uBA85:"  ".repeat(h)+T.name,\uC2DC\uC791\uC77C:T.startDate,\uC885\uB8CC\uC77C:T.endDate,\uC9C4\uCC99\uB960:T.progress+"%",\uB2F4\uB2F9\uC790:T.responsible,\uBD80\uBAA8ID:T.parent||""}),T.subtasks&&T.subtasks.length>0&&(w=w.concat(u(T.subtasks,h+1)))}),w};e.wbs&&e.wbs.tasks&&(r=u(e.wbs.tasks)),o=[{wch:12},{wch:8},{wch:25},{wch:15},{wch:15},{wch:10},{wch:15},{wch:12}]}if(r.length===0){alert("\uB2E4\uC6B4\uB85C\uB4DC\uD560 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),this.showDownloadMenu=!1;return}let s=Te.json_to_sheet(r),c={fill:{fgColor:{rgb:a}},font:{bold:!0,color:{rgb:"FFFFFFFF"},size:11},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},l={alignment:{vertical:"top",wrapText:!0},border:{left:{},right:{},top:{},bottom:{}}},d=Te.decode_range(s["!ref"]||"A1");for(let u=d.s.c;u<=d.e.c;++u){let v=Te.encode_col(u)+"1";s[v]&&(s[v].s=c)}for(let u=d.s.r+1;u<=d.e.r;++u)for(let v=d.s.c;v<=d.e.c;++v){let h=Te.encode_cell({r:u,c:v});s[h]&&(s[h].s=l)}s["!cols"]=o;let m=Te.book_new(),x=t==="spec"?"Specification":"WBS";Te.book_append_sheet(m,s,x),En(m,i),this.showDownloadMenu=!1}static \u0275fac=function(e){return new(e||n)(lt(Wt))};static \u0275cmp=yt({type:n,selectors:[["app-ia-doc"]],inputs:{folderType:"folderType"},outputs:{simulatorRequested:"simulatorRequested"},standalone:!1,features:[un],decls:2,vars:1,consts:[[1,"ia-doc-container"],[1,"ia-canvas-wrapper",3,"pages","userFlows","folderType","viewMode","zoomLevel","isPenMode","isMultiSelectMode"],[1,"ia-canvas-wrapper",3,"zoomLevelChange","penModeChange","simulatorRequested","pages","userFlows","folderType","viewMode","zoomLevel","isPenMode","isMultiSelectMode"]],template:function(e,r){e&1&&(f(0,"div",0),ae(1,$x,1,7,"app-ia-canvas",1),p()),e&2&&(_(),oe(r.currentProjectData?1:-1))},dependencies:[ta],styles:[".ia-doc-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;background:linear-gradient(135deg,#f5f7fa,#f0f4f8);padding:15px;overflow-y:auto;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;gap:12px}.toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:12px 20px;background:#fffffff2;border-radius:14px;box-shadow:0 2px 12px #667eea14;border:1px solid rgba(102,126,234,.12)}.zoom-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;background:#667eea0a;border-radius:8px}.zoom-controls[_ngcontent-%COMP%]   .control-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;transition:all .2s ease}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6;border-color:#9ca3af}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active:not(:disabled){background:#e5e7eb}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;line-height:1}.zoom-controls[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#667eea;width:50px;text-align:center}.zoom-controls[_ngcontent-%COMP%]   .step-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-left:8px;padding:4px 10px;background:#667eea14;border-radius:6px;font-size:11px;font-weight:600}.zoom-controls[_ngcontent-%COMP%]   .step-indicator[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{color:#667eea;font-weight:700}.zoom-controls[_ngcontent-%COMP%]   .step-indicator[_ngcontent-%COMP%]   .step-progress[_ngcontent-%COMP%]{color:#9ca3af;font-size:10px}.zoom-controls[_ngcontent-%COMP%]   .step-indicator[_ngcontent-%COMP%]   .step-name[_ngcontent-%COMP%]{color:#6b7280;font-size:10px;margin-left:4px}.download-group[_ngcontent-%COMP%]   .download-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;transition:all .2s ease}.download-group[_ngcontent-%COMP%]   .download-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.download-group[_ngcontent-%COMP%]   .download-btn[_ngcontent-%COMP%]:active{background:#e5e7eb}.download-group[_ngcontent-%COMP%]   .download-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;margin-top:8px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;box-shadow:0 4px 12px #00000026;z-index:1000;min-width:180px;overflow:hidden;padding:4px 0}.download-group[_ngcontent-%COMP%]   .download-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;width:100%;text-align:left;padding:10px 16px;background:none;border:none;font-size:14px;color:#374151;cursor:pointer;transition:background .15s}.download-group[_ngcontent-%COMP%]   .download-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#111827}.pen-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;transition:all .2s ease}.pen-button[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.pen-button[_ngcontent-%COMP%]:active{background:#e5e7eb}.pen-button.pen-active[_ngcontent-%COMP%]{background:#667eea;border-color:#667eea;box-shadow:0 0 8px #667eea4d}.pen-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;line-height:1}.control-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;position:relative}.control-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;transition:all .2s ease}.control-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.control-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{background:#e5e7eb}.control-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;line-height:1}.control-group.with-step[_ngcontent-%COMP%]{gap:6px}.step-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:4px 10px;background:#667eea14;border-radius:6px;font-size:11px;font-weight:600}.step-indicator[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{color:#667eea;font-weight:700}.step-indicator[_ngcontent-%COMP%]   .step-progress[_ngcontent-%COMP%]{color:#9ca3af;font-size:10px}.step-indicator[_ngcontent-%COMP%]   .step-name[_ngcontent-%COMP%]{color:#6b7280;font-size:10px;margin-left:4px}.control-panel-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;font-size:16px;transition:all .2s ease}.control-panel-toggle[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#9ca3af}.control-panel-toggle[_ngcontent-%COMP%]:active{background:#e5e7eb}.control-panel-toggle.active[_ngcontent-%COMP%]{background:#3b82f6;border-color:#3b82f6;box-shadow:0 0 8px #3b82f64d}.control-panel-toggle[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;line-height:1}.view-toggle[_ngcontent-%COMP%]{display:flex;gap:4px;padding:4px;background:#e5e7eb4d;border-radius:6px;border:1px solid #e5e7eb;margin-left:auto;position:relative}.view-toggle.with-step[_ngcontent-%COMP%]{gap:8px}.view-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{padding:6px 12px;border:none;border-radius:4px;background:transparent;cursor:pointer;font-size:14px;font-weight:500;color:#6b7280;transition:all .2s ease}.view-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb80;color:#374151}.view-toggle[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background:#fff;color:#667eea;box-shadow:0 1px 3px #0000001a}.ia-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fccb90,#d57eeb);color:#fff;padding:16px 30px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 4px 20px #fccb904d}.ia-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1;text-align:center}.ia-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:700;letter-spacing:-.5px}.ia-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .folder-tag[_ngcontent-%COMP%]{margin-left:8px;font-size:14px;font-weight:500;opacity:.8}.ia-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:3px 0 0;font-size:12px;opacity:.9}.ia-header[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]{display:flex;gap:8px;margin-left:20px}.ia-header[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:6px;background:#fff3;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:all .3s ease}.ia-header[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.ia-header[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background:#fff;color:#d57eeb;font-weight:600}.ia-canvas-wrapper[_ngcontent-%COMP%]{flex:1;width:100%;height:100%}.ia-planning-content[_ngcontent-%COMP%]{flex:1;width:100%;height:100%;overflow:auto;border-radius:14px;background:#fff;box-shadow:0 4px 20px #0000000d}.ia-content[_ngcontent-%COMP%]{flex:1;padding:30px;overflow-y:auto}.ia-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.ia-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.ia-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#0003;border-radius:4px}.ia-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#0000004d}.ia-legend[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;background:#fff;padding:15px 20px;border-radius:8px;box-shadow:0 2px 8px #00000014;flex-wrap:wrap}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px;color:#555}.legend-icon[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:4px}.ia-planning-content[_ngcontent-%COMP%]{flex:1;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 20px #0000000d;border:1px solid #edf2f7}"]})};function Xx(n,t){if(n&1&&(f(0,"div",77)(1,"span",78),g(2,"AI Engine"),p(),f(3,"span",79),g(4),p()()),n&2){let e=k(3);_(4),ne(e.currentProjectSpec.systemArchitecture.aiEngine)}}function Gx(n,t){if(n&1&&(f(0,"div",77)(1,"span",78),g(2,"File Storage"),p(),f(3,"span",79),g(4),p()()),n&2){let e=k(3);_(4),ne(e.currentProjectSpec.systemArchitecture.fileStorage)}}function Yx(n,t){if(n&1&&(f(0,"div",7)(1,"h2"),g(2,"\uCD94\uAC00 \uC2DC\uC2A4\uD15C \uAD6C\uC131"),p(),f(3,"div",76),ae(4,Xx,5,1,"div",77),ae(5,Gx,5,1,"div",77),p()()),n&2){let e=k(2);_(4),oe(e.currentProjectSpec.systemArchitecture.aiEngine?4:-1),_(),oe(e.currentProjectSpec.systemArchitecture.fileStorage?5:-1)}}function Kx(n,t){if(n&1&&(f(0,"header",2)(1,"div",3)(2,"h1"),g(3),p(),f(4,"p",4),g(5,"System Architecture Specification"),p()(),f(6,"div",5),g(7,"v1.0.0"),p()(),f(8,"div",6)(9,"div",7)(10,"h2"),g(11,"\uD575\uC2EC \uAE30\uC220 \uC2A4\uD0DD"),p(),f(12,"div",8)(13,"div",9)(14,"div",10)(15,"span",11),g(16,"html"),p()(),f(17,"div",12)(18,"h3"),g(19,"Frontend"),p(),f(20,"p"),g(21),p()()(),f(22,"div",9)(23,"div",10)(24,"span",11),g(25,"dns"),p()(),f(26,"div",12)(27,"h3"),g(28,"Backend"),p(),f(29,"p"),g(30),p()()(),f(31,"div",9)(32,"div",10)(33,"span",11),g(34,"storage"),p()(),f(35,"div",12)(36,"h3"),g(37,"Database"),p(),f(38,"p"),g(39),p()()(),f(40,"div",9)(41,"div",10)(42,"span",11),g(43,"cloud_done"),p()(),f(44,"div",12)(45,"h3"),g(46,"Deployment"),p(),f(47,"p"),g(48),p()()()()(),ae(49,Yx,6,2,"div",7),f(50,"div",13)(51,"h2"),g(52,"\uC2DC\uC2A4\uD15C \uAD6C\uC131\uB3C4"),p(),f(53,"div",14),ee(54,"div",15),f(55,"div",16)(56,"div",17),ee(57,"div",18),f(58,"span",11),g(59,"desktop_windows"),p(),f(60,"span",19),g(61,"WPF"),p(),f(62,"span",20),g(63,"C#"),p()(),f(64,"div",21),ee(65,"div",18),f(66,"span",11),g(67,"computer"),p(),f(68,"span",19),g(69,"Electron"),p(),f(70,"span",20),g(71,"MAC"),p()(),f(72,"div",22),ee(73,"div",18),f(74,"span",11),g(75,"smartphone"),p(),f(76,"span",19),g(77,"iOS"),p(),f(78,"span",20),g(79,"Swift"),p()(),f(80,"div",23),ee(81,"div",18),f(82,"span",11),g(83,"android"),p(),f(84,"span",19),g(85,"AOS"),p(),f(86,"span",20),g(87,"Kotlin"),p()()(),f(88,"div",24)(89,"div",25)(90,"span",11),g(91,"swap_horiz"),p(),f(92,"span",26),g(93,"postMessage Interface"),p()()(),Me(),f(94,"svg",27),ee(95,"path",28)(96,"polygon",29)(97,"path",30)(98,"polygon",29)(99,"path",31)(100,"polygon",32)(101,"path",33)(102,"polygon",32)(103,"path",34)(104,"polygon",35),p(),Re(),f(105,"div",36)(106,"div",37)(107,"span",11),g(108,"language"),p(),f(109,"span",38),g(110,"WEBVIEW"),p()()(),f(111,"div",39),ee(112,"div",40),p(),f(113,"div",41)(114,"div",42)(115,"div",43),Me(),f(116,"svg",44),ee(117,"polygon",45)(118,"polygon",46)(119,"path",47),p()(),Re(),f(120,"span",48),g(121,"Angular(SPA)"),p()(),f(122,"div",49)(123,"div",50),g(124,"AOT Compile"),p(),f(125,"div",50),g(126,"ivy renderer"),p(),f(127,"div",50),g(128,"Signal"),p()()(),Me(),f(129,"svg",51)(130,"defs")(131,"linearGradient",52),ee(132,"stop",53)(133,"stop",54),p()(),ee(134,"path",55)(135,"polygon",56),p(),Re(),f(136,"div",57)(137,"div",58)(138,"div",59)(139,"span",11),g(140,"memory"),p(),f(141,"span",60),g(142,"WebAssembly Bridge"),p()(),f(143,"div",61)(144,"div",62)(145,"span",63),g(146,"C++"),p()(),f(147,"div",62)(148,"span",63),g(149,"Rust"),p()(),f(150,"div",62)(151,"span",63),g(152,"Go"),p()()(),f(153,"div",64)(154,"span",65),g(155,"\u2699\uFE0F"),p(),f(156,"span"),g(157,"Web Worker"),p()()()(),f(158,"div",66)(159,"div",67)(160,"span",11),g(161,"brush"),p(),f(162,"p"),g(163,"UI/UX \uC601\uC5ED \uACF5\uD1B5 Angular(SPA) \uAD6C\uD604"),p()(),f(164,"div",67)(165,"span",11),g(166,"integration_instructions"),p(),f(167,"p"),g(168,"\uAE30\uB2A5 \uAD6C\uD604 \uB124\uC774\uD2F0\uBE0C \uC5F0\uB3D9"),p()(),f(169,"div",67)(170,"span",11),g(171,"widgets"),p(),f(172,"p"),g(173,"\uB124\uC774\uD2F0\uBE0C \uC704\uC82F UX \uC81C\uACF5"),p()(),f(174,"div",67)(175,"span",11),g(176,"cloud_off"),p(),f(177,"p"),g(178,"\uB85C\uCEEC \uAE30\uBC18 (\uBC31\uC5D4\uB4DC \uCD5C\uC18C\uD654)"),p()()()()(),f(179,"div",68)(180,"h2"),g(181,"\uC544\uD0A4\uD14D\uCC98 \uC124\uACC4 \uCCA0\uD559 \uBC0F \uAE30\uB300\uD6A8\uACFC"),p(),f(182,"div",69)(183,"div",70)(184,"div",71)(185,"span",11),g(186,"auto_awesome"),p(),f(187,"h3"),g(188,"\uD1B5\uD569 \uBE0C\uB79C\uB4DC UX \uBC0F \uC131\uACF5 \uC804\uB7B5"),p()(),f(189,"div",72)(190,"p"),g(191,"UI/UX \uACF5\uD1B5\uD654\uB294 \uBCF8 \uD504\uB85C\uC81D\uD2B8\uC758 "),f(192,"strong"),g(193,"\uD575\uC2EC \uC131\uACF5 \uC694\uC778"),p(),g(194,"\uC785\uB2C8\uB2E4. \uC0AC\uC6A9\uC790\uB294 \uBAA8\uB4E0 \uD50C\uB7AB\uD3FC\uC5D0\uC11C \uC77C\uAD00\uB418\uACE0 \uC138\uB828\uB41C \uBE0C\uB79C\uB4DC \uACBD\uD5D8\uC744 \uC6D0\uD569\uB2C8\uB2E4. VS Code, Figma\uC640 \uAC19\uC740 \uC138\uACC4\uC801\uC778 \uC0DD\uC0B0\uC131 \uB3C4\uAD6C\uB4E4\uC774 SPA(Single Page Application)\uB85C \uAC1C\uBC1C\uB418\uB294 \uC774\uC720\uB3C4 \uC5EC\uAE30\uC5D0 \uC788\uC2B5\uB2C8\uB2E4. \uD50C\uB7AB\uD3FC\uBCC4\uB85C UI\uB97C \uC81C\uC5B4\uD558\uB294 \uBC29\uC2DD\uC740 \uAD00\uB9AC\uC758 \uD30C\uD3B8\uD654\uB97C \uCD08\uB798\uD558\uC5EC \uC815\uAD50\uD55C \uD488\uC9C8 \uAD00\uB9AC\uB97C \uBD88\uAC00\uB2A5\uD558\uAC8C \uB9CC\uB4ED\uB2C8\uB2E4."),p()()(),f(195,"div",73)(196,"div",71)(197,"span",11),g(198,"memory"),p(),f(199,"h3"),g(200,"\uACE0\uC131\uB2A5 \uBA40\uD2F0\uD504\uB85C\uC138\uC2A4 \uC544\uD0A4\uD14D\uCC98"),p()(),f(201,"div",72)(202,"p"),g(203,"\uB2E8\uC21C\uD55C \uD654\uBA74 \uD45C\uC2DC\uB97C \uB118\uC5B4 \uBCF5\uC7A1\uD55C \uAE30\uB2A5\uC774 \uC720\uAE30\uC801\uC73C\uB85C \uC791\uB3D9\uD558\uB294 UI/UX\uB294 \uBA54\uBAA8\uB9AC \uBC0F CPU \uC131\uB2A5\uACFC \uCD5C\uC801\uD654\uC5D0 \uC9C1\uACB0\uB429\uB2C8\uB2E4. \uBCF8 \uC2DC\uC2A4\uD15C\uC740 "),f(204,"strong"),g(205,"Chromium OS"),p(),g(206," \uD658\uACBD\uC744 \uC911\uC2EC\uC73C\uB85C, \uACE0\uC131\uB2A5 \uC5F0\uC0B0\uC774 \uD544\uC694\uD55C \uAD6C\uAC04\uC740 "),f(207,"strong"),g(208,"WASM(WebAssembly)"),p(),g(209,"\uC744 \uC801\uADF9 \uD65C\uC6A9\uD558\uC5EC \uB124\uC774\uD2F0\uBE0C \uC218\uC900\uC758 \uC18D\uB3C4\uB97C \uAD6C\uD604\uD558\uACE0 UI \uC751\uB2F5\uC131\uC744 \uC644\uBCBD\uD788 \uBCF4\uC7A5\uD569\uB2C8\uB2E4."),p()()(),f(210,"div",74)(211,"div",71)(212,"span",11),g(213,"settings_input_component"),p(),f(214,"h3"),g(215,"\uB124\uC774\uD2F0\uBE0C \uC790\uC6D0\uC758 \uC735\uD569"),p()(),f(216,"div",72)(217,"p"),g(218,"\uD06C\uB85C\uC2A4 \uD50C\uB7AB\uD3FC\uC758 \uD55C\uACC4\uB97C \uB118\uC5B4 OS\uC5D0 \uB0B4\uC7A5\uB41C \uAC15\uB825\uD55C \uC790\uC6D0\uC744 \uD65C\uC6A9\uD569\uB2C8\uB2E4. \uBB38\uC11C \uB3C4\uAD6C, "),f(219,"strong"),g(220,"STT(Speech-to-Text)"),p(),g(221,", "),f(222,"strong"),g(223,"TTS(Text-to-Speech)"),p(),g(224," \uB4F1 \uAC01 OS\uC758 \uCD5C\uC2E0 API\uB97C \uB124\uC774\uD2F0\uBE0C \uBE0C\uB9BF\uC9C0\uB97C \uD1B5\uD574 \uD1B5\uD569 \uC81C\uACF5\uD568\uC73C\uB85C\uC368, \uC6F9\uC758 \uC720\uC5F0\uD568\uACFC \uB124\uC774\uD2F0\uBE0C\uC758 \uD48D\uBD80\uD55C \uAE30\uB2A5\uC744 \uB3D9\uC2DC\uC5D0 \uD655\uBCF4\uD569\uB2C8\uB2E4."),p()()(),f(225,"div",75)(226,"div",71)(227,"span",11),g(228,"verified"),p(),f(229,"h3"),g(230,"\uD488\uC9C8 \uBCF4\uC99D \uBC0F \uC9C0\uC18D \uAC00\uB2A5\uC131"),p()(),f(231,"div",72)(232,"p"),g(233,"\uC5B8\uC5B4\uBCC4\uB85C \uD30C\uD3B8\uD654\uB41C UI \uC81C\uC5B4\uB294 \uACB0\uAD6D \uD504\uB85C\uC81D\uD2B8\uC758 \uC2E4\uD328\uB85C \uC774\uC5B4\uC9D1\uB2C8\uB2E4. \uBCF8 \uC544\uD0A4\uD14D\uCC98\uB294 \uB2E8\uC77C\uD654\uB41C UI/UX \uD1B5\uC81C \uC2DC\uC2A4\uD15C\uC744 \uD1B5\uD574 "),f(234,"strong"),g(235,"\uB192\uC740 \uC81C\uD488 \uD488\uC9C8"),p(),g(236,"\uC744 \uC720\uC9C0\uD558\uBA70, \uC720\uC9C0\uBCF4\uC218 \uBE44\uC6A9\uC744 \uD68D\uAE30\uC801\uC73C\uB85C \uC808\uAC10\uD569\uB2C8\uB2E4. \uD604\uB300\uC801\uC778 \uC18C\uD504\uD2B8\uC6E8\uC5B4 \uACF5\uD559 \uAD00\uC810\uC5D0\uC11C \uACE0\uD488\uC9C8 \uC18C\uD504\uD2B8\uC6E8\uC5B4\uB97C \uB9CC\uB4DC\uB294 \uC720\uC77C\uD55C \uC99D\uBA85\uB41C \uACBD\uB85C\uC785\uB2C8\uB2E4."),p()()()()()()),n&2){let e=k();_(3),ge("",e.currentProjectSpec.displayName," \uC2DC\uC2A4\uD15C \uC544\uD0A4\uD14D\uCC98"),_(18),ne(e.currentProjectSpec.systemArchitecture.frontend),_(9),ne(e.currentProjectSpec.systemArchitecture.backend),_(9),ne(e.currentProjectSpec.systemArchitecture.database),_(9),ne(e.currentProjectSpec.systemArchitecture.deployment),_(),oe(e.currentProjectSpec.systemArchitecture.aiEngine||e.currentProjectSpec.systemArchitecture.fileStorage?49:-1)}}function qx(n,t){n&1&&(f(0,"div",1),ee(1,"div",80),f(2,"p"),g(3,"\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4..."),p()())}var sr=class n{constructor(t){this.projectSpecsService=t}folderType="calendar";currentProjectSpec=null;isLoading=!1;errorMessage=null;destroy$=new tn;ngOnInit(){this.subscribeToProjectSpecs()}ngOnChanges(t){t.folderType&&!t.folderType.firstChange&&this.updateCurrentSpec()}ngAfterViewInit(){this.updateCurrentSpec()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}subscribeToProjectSpecs(){this.projectSpecsService.loading$.pipe(nt(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.projectSpecsService.error$.pipe(nt(this.destroy$)).subscribe(t=>{this.errorMessage=t}),this.projectSpecsService.specs$.pipe(nt(this.destroy$)).subscribe(()=>{this.updateCurrentSpec()})}updateCurrentSpec(){this.currentProjectSpec=this.projectSpecsService.getProjectSpecSync(this.folderType)||null}static \u0275fac=function(e){return new(e||n)(lt(Wt))};static \u0275cmp=yt({type:n,selectors:[["app-arch-doc"]],inputs:{folderType:"folderType"},standalone:!1,features:[un],decls:3,vars:1,consts:[[1,"arch-doc-container"],[1,"loading-container"],[1,"doc-header"],[1,"header-info"],[1,"subtitle"],[1,"version-tag"],[1,"doc-content"],[1,"arch-section"],[1,"tech-stack-grid"],[1,"tech-card"],[1,"card-icon"],[1,"material-icons"],[1,"card-content"],[1,"arch-section","diagrams"],[1,"architecture-diagram","modern-style"],[1,"glow-effect"],[1,"platform-layer"],[1,"platform-box","wpf","animate-box"],[1,"box-glow"],[1,"platform-title"],[1,"platform-lang"],[1,"platform-box","electron","animate-box"],[1,"platform-box","ios","animate-box"],[1,"platform-box","aos","animate-box"],[1,"bridge-label-container"],[1,"post-message-floating"],[1,"bridge-tag"],["viewBox","0 0 1000 150","preserveAspectRatio","none",1,"bridge-lines-svg"],["d","M125,0 Q125,60 500,70"],["points","495,67 500,70 495,73",1,"arrow-head"],["d","M375,0 Q375,55 500,70"],["d","M625,0 Q625,55 500,70"],["points","505,67 500,70 505,73",1,"arrow-head"],["d","M875,0 Q875,60 500,70"],["d","M500,80 L500,145"],["points","497,145 500,150 503,145",1,"arrow-head"],[1,"webview-layer"],[1,"webview-box","pulse-glow"],[1,"webview-title"],[1,"vertical-connector"],[1,"scroll-arrow"],[1,"spa-layer"],[1,"spa-box"],[1,"angular-logo-container"],["viewBox","0 0 250 250",1,"angular-logo-svg"],["fill","#DD0031","points","125,30 31.9,63.2 46.1,186.3 125,230 203.9,186.3 218.1,63.2"],["fill","#C3002F","points","125,30 125,230 203.9,186.3 218.1,63.2"],["fill","#FFFFFF","d","M125,52.1L66.8,182.6h21.7l11.7-29.2h49.4l11.7,29.2h21.7L125,52.1z M142,135.4H108l17-40.9L142,135.4z"],[1,"spa-title"],[1,"spa-details-card"],[1,"tech-tag"],["viewBox","0 0 800 120","preserveAspectRatio","none",1,"wasm-to-spa-svg"],["id","wasmToSpaGradient","x1","0%","y1","0%","x2","0%","y2","100%"],["offset","0%",2,"stop-color","#6366f1","stop-opacity","1"],["offset","100%",2,"stop-color","#8b5cf6","stop-opacity","1"],["d","M400,0 L400,120",1,"wasm-to-spa-line"],["points","397,120 400,130 403,120",1,"wasm-arrow-head"],[1,"wasm-layer"],[1,"wasm-module-unified"],[1,"wasm-module-header"],[1,"module-title"],[1,"wasm-module-content"],[1,"language-item"],[1,"lang-icon"],[1,"worker-badge-unified"],[1,"worker-icon"],[1,"architecture-notes-modern"],[1,"note-item"],[1,"arch-section","description"],[1,"description-grid"],[1,"desc-card","success-point"],[1,"desc-header"],[1,"desc-body"],[1,"desc-card","performance-point"],[1,"desc-card","resource-point"],[1,"desc-card","quality-point"],[1,"extra-arch-grid"],[1,"extra-item"],[1,"label"],[1,"value"],[1,"spinner"]],template:function(e,r){e&1&&(f(0,"div",0),ae(1,Kx,237,6)(2,qx,4,0,"div",1),p()),e&2&&(_(),oe(r.currentProjectSpec?1:2))},styles:['.arch-doc-container[_ngcontent-%COMP%]{padding:40px;background-color:#f8fafc;min-height:100%;color:#1e293b;font-family:Pretendard,sans-serif}.arch-doc-container[_ngcontent-%COMP%]   .doc-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;border-bottom:2px solid #e2e8f0;padding-bottom:20px;margin-bottom:30px}.arch-doc-container[_ngcontent-%COMP%]   .doc-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:28px;font-weight:700;color:#0f172a}.arch-doc-container[_ngcontent-%COMP%]   .doc-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:5px 0 0;color:#64748b;font-size:14px;letter-spacing:.05em}.arch-doc-container[_ngcontent-%COMP%]   .doc-header[_ngcontent-%COMP%]   .version-tag[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600}.arch-doc-container[_ngcontent-%COMP%]   .arch-section[_ngcontent-%COMP%]{margin-bottom:40px}.arch-doc-container[_ngcontent-%COMP%]   .arch-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#334155;margin-bottom:20px;display:flex;align-items:center}.arch-doc-container[_ngcontent-%COMP%]   .arch-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:before{content:"";display:inline-block;width:4px;height:18px;background-color:#3b82f6;margin-right:10px;border-radius:2px}.arch-doc-container[_ngcontent-%COMP%]   .tech-stack-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:20px}.arch-doc-container[_ngcontent-%COMP%]   .tech-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:20px;display:flex;align-items:center;transition:transform .2s,box-shadow .2s;box-shadow:0 1px 3px #0000000d}.arch-doc-container[_ngcontent-%COMP%]   .tech-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 15px -3px #0000001a}.arch-doc-container[_ngcontent-%COMP%]   .tech-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{width:48px;height:48px;background-color:#eff6ff;border-radius:10px;display:flex;align-items:center;justify-content:center;margin-right:16px}.arch-doc-container[_ngcontent-%COMP%]   .tech-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#3b82f6;font-size:28px}.arch-doc-container[_ngcontent-%COMP%]   .tech-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#64748b;text-transform:uppercase;letter-spacing:.05em}.arch-doc-container[_ngcontent-%COMP%]   .tech-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:16px;font-weight:600;color:#1e293b}.arch-doc-container[_ngcontent-%COMP%]   .extra-arch-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px}.arch-doc-container[_ngcontent-%COMP%]   .extra-item[_ngcontent-%COMP%]{background-color:#f1f5f9;padding:12px 20px;border-radius:8px;display:flex;flex-direction:column}.arch-doc-container[_ngcontent-%COMP%]   .extra-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#64748b;margin-bottom:4px}.arch-doc-container[_ngcontent-%COMP%]   .extra-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#334155}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]{background-color:#fff;background-image:linear-gradient(rgba(0,0,0,.05) 1px,transparent 1px),linear-gradient(90deg,rgba(0,0,0,.05) 1px,transparent 1px);background-size:30px 30px;border-radius:20px;padding:80px 40px;display:flex;flex-direction:column;align-items:center;color:#1e293b;position:relative;box-shadow:0 10px 40px #00000014;overflow:hidden;border:1px solid rgba(0,0,0,.1)}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .glow-effect[_ngcontent-%COMP%]{position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle at center,rgba(59,130,246,.03) 0%,transparent 60%);pointer-events:none}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]{display:flex;justify-content:space-around;width:100%;max-width:1000px;margin-bottom:80px;z-index:2}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]   .platform-box[_ngcontent-%COMP%]{position:relative;background:#fff;border:1px solid rgba(0,0,0,.1);border-radius:16px;width:130px;height:120px;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all .4s cubic-bezier(.175,.885,.32,1.275);cursor:default;box-shadow:0 4px 12px #0000000d}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]   .platform-box[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:32px;margin-bottom:10px;color:#3b82f6}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]   .platform-box[_ngcontent-%COMP%]   .platform-title[_ngcontent-%COMP%]{font-size:16px;font-weight:700;letter-spacing:1px;color:#334155}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]   .platform-box[_ngcontent-%COMP%]   .platform-lang[_ngcontent-%COMP%]{font-size:12px;opacity:.6;margin-top:4px;color:#64748b}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]   .platform-box[_ngcontent-%COMP%]:hover{transform:translateY(-8px);border-color:#3b82f6;box-shadow:0 12px 24px #3b82f626}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]   .platform-box[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{transform:scale(1.1)}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .platform-layer[_ngcontent-%COMP%]   .platform-box.electron[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#1f2937}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .bridge-lines-svg[_ngcontent-%COMP%]{position:absolute;top:180px;width:100%;max-width:1000px;left:50%;transform:translate(-50%);height:150px;pointer-events:none;z-index:1}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .bridge-lines-svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:none;stroke:#3b82f6;stroke-width:3;stroke-dasharray:10,5;animation:_ngcontent-%COMP%_dashFlow 10s linear infinite;opacity:.5;filter:drop-shadow(0 0 5px rgba(59,130,246,.3))}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .bridge-lines-svg[_ngcontent-%COMP%]   .arrow-head[_ngcontent-%COMP%]{fill:#3b82f6;opacity:.8}@keyframes _ngcontent-%COMP%_dashFlow{0%{stroke-dashoffset:300}to{stroke-dashoffset:0}}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .bridge-label-container[_ngcontent-%COMP%]{position:absolute;top:215px;left:50%;transform:translate(-50%);z-index:5;pointer-events:none}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .bridge-label-container[_ngcontent-%COMP%]   .post-message-floating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#475569;font-weight:700;font-size:14px;background:#ffffffe6;padding:10px 24px;border-radius:30px;border:1px solid #cbd5e1;box-shadow:0 4px 15px #0000000d,0 0 20px #3b82f61a;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);white-space:nowrap}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .bridge-label-container[_ngcontent-%COMP%]   .post-message-floating[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px;color:#3b82f6;animation:_ngcontent-%COMP%_pulse-icon 2s infinite}@keyframes _ngcontent-%COMP%_pulse-icon{0%{opacity:.6}50%{opacity:1;transform:scale(1.1)}to{opacity:.6}}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .webview-layer[_ngcontent-%COMP%]{margin-top:20px;z-index:2;display:flex;flex-direction:column;align-items:center}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .webview-layer[_ngcontent-%COMP%]   .webview-box[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#2563eb;border:2px solid #3b82f6;padding:15px 40px;border-radius:20px;display:flex;align-items:center;justify-content:center;gap:15px;box-shadow:0 15px 35px #3b82f61f,0 0 0 1px #3b82f60d inset;min-width:220px;transition:all .3s ease}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .webview-layer[_ngcontent-%COMP%]   .webview-box[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:30px;color:#3b82f6;flex-shrink:0}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .webview-layer[_ngcontent-%COMP%]   .webview-box[_ngcontent-%COMP%]   .webview-title[_ngcontent-%COMP%]{font-weight:800;font-size:22px;letter-spacing:1px;white-space:nowrap}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .webview-layer[_ngcontent-%COMP%]   .webview-box[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 20px 40px #3b82f633}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .webview-layer[_ngcontent-%COMP%]   .pulse-glow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseLight 2s infinite}@keyframes _ngcontent-%COMP%_pulseLight{0%{box-shadow:0 0 15px #3b82f61a}50%{box-shadow:0 0 30px #3b82f633}to{box-shadow:0 0 15px #3b82f61a}}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-bridge-line-svg[_ngcontent-%COMP%]{position:absolute;top:590px;width:100%;height:60px;pointer-events:none;z-index:2}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-bridge-line-svg[_ngcontent-%COMP%]   .bridge-line[_ngcontent-%COMP%]{fill:none;stroke:url(#bridgeGradient);stroke-width:2;stroke-dasharray:6,3;animation:_ngcontent-%COMP%_bridgeFlow 8s linear infinite;opacity:.6;filter:drop-shadow(0 0 3px rgba(99,102,241,.3))}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-bridge-line-svg[_ngcontent-%COMP%]   .bridge-arrow-head[_ngcontent-%COMP%]{fill:url(#bridgeGradient);opacity:.7}@keyframes _ngcontent-%COMP%_bridgeFlow{0%{stroke-dashoffset:200}to{stroke-dashoffset:0}}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-to-spa-svg[_ngcontent-%COMP%]{position:absolute;top:550px;width:100%;height:120px;pointer-events:none;z-index:2}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-to-spa-svg[_ngcontent-%COMP%]   .wasm-to-spa-line[_ngcontent-%COMP%]{fill:none;stroke:url(#wasmToSpaGradient);stroke-width:3;stroke-dasharray:8,4;animation:_ngcontent-%COMP%_wasmToSpaFlow 12s linear infinite;opacity:.7;filter:drop-shadow(0 0 5px rgba(99,102,241,.4))}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-to-spa-svg[_ngcontent-%COMP%]   .wasm-arrow-head[_ngcontent-%COMP%]{fill:url(#wasmToSpaGradient);opacity:.8}@keyframes _ngcontent-%COMP%_wasmToSpaFlow{0%{stroke-dashoffset:400}to{stroke-dashoffset:0}}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:30px 0;z-index:3}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px;padding:12px 30px;background:linear-gradient(135deg,#6366f1,#8b5cf6);border-radius:16px;color:#fff;box-shadow:0 8px 20px #6366f133;transition:all .3s cubic-bezier(.175,.885,.32,1.275);min-width:240px}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]   .wasm-module-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:800;font-size:14px;letter-spacing:.5px}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]   .wasm-module-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px;filter:drop-shadow(0 1px 3px rgba(0,0,0,.2))}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]   .wasm-module-content[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:center;align-items:center;padding:8px 0;border-top:1px solid rgba(255,255,255,.2);border-bottom:1px solid rgba(255,255,255,.2);width:100%}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]   .wasm-module-content[_ngcontent-%COMP%]   .language-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]   .wasm-module-content[_ngcontent-%COMP%]   .language-item[_ngcontent-%COMP%]   .lang-icon[_ngcontent-%COMP%]{padding:4px 10px;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;font-size:11px;font-weight:700;letter-spacing:.3px;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]   .worker-badge-unified[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:16px;font-size:12px;font-weight:600;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]   .worker-badge-unified[_ngcontent-%COMP%]   .worker-icon[_ngcontent-%COMP%]{font-size:12px;animation:_ngcontent-%COMP%_rotate-worker 2s linear infinite}@keyframes _ngcontent-%COMP%_rotate-worker{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .wasm-layer[_ngcontent-%COMP%]   .wasm-module-unified[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 12px 30px #6366f14d}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .vertical-connector[_ngcontent-%COMP%]{width:2px;height:50px;background:#3b82f6;opacity:.3;margin:15px 0;position:relative}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .vertical-connector[_ngcontent-%COMP%]   .scroll-arrow[_ngcontent-%COMP%]{position:absolute;top:-5px;left:-4px;width:10px;height:10px;border-left:2px solid #3b82f6;border-top:2px solid #3b82f6;transform:rotate(45deg)}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;z-index:2;margin-top:40px}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-box[_ngcontent-%COMP%]{position:relative;background:#fff;color:#dd0031;padding:50px 60px 25px;border-radius:20px;display:flex;flex-direction:column;align-items:center;gap:15px;box-shadow:0 10px 40px #0000000d,0 0 0 1px #dd00311a inset;transition:all .4s cubic-bezier(.175,.885,.32,1.275);cursor:default;min-width:260px}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-box[_ngcontent-%COMP%]   .angular-logo-container[_ngcontent-%COMP%]{position:absolute;top:-45px;left:50%;transform:translate(-50%);width:90px;height:90px;background:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 24px #dd003126;padding:12px;border:1px solid rgba(221,0,49,.05)}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-box[_ngcontent-%COMP%]   .angular-logo-container[_ngcontent-%COMP%]   .angular-logo-svg[_ngcontent-%COMP%]{width:100%;height:100%;animation:_ngcontent-%COMP%_pulse-logo 3s ease-in-out infinite}@keyframes _ngcontent-%COMP%_pulse-logo{0%{transform:scale(1);filter:drop-shadow(0 2px 5px rgba(221,0,49,.2))}50%{transform:scale(1.05);filter:drop-shadow(0 5px 15px rgba(221,0,49,.3))}to{transform:scale(1);filter:drop-shadow(0 2px 5px rgba(221,0,49,.2))}}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-box[_ngcontent-%COMP%]   .spa-title[_ngcontent-%COMP%]{font-weight:900;font-size:26px;letter-spacing:-.5px;text-shadow:none;white-space:nowrap}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-box[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 20px 50px #0000001a,0 0 0 1px #dd003133 inset}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-box[_ngcontent-%COMP%]:hover   .angular-logo-container[_ngcontent-%COMP%]{transform:translate(-50%) translateY(-5px) scale(1.05);box-shadow:0 15px 35px #dd003140}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-details-card[_ngcontent-%COMP%]{margin-top:30px;display:flex;gap:12px;flex-wrap:wrap;justify-content:center;max-width:500px}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-details-card[_ngcontent-%COMP%]   .tech-tag[_ngcontent-%COMP%]{background:#fff5f5;border:1px solid #feb2b2;color:#c53030;padding:6px 14px;border-radius:30px;font-size:13px;font-weight:700;box-shadow:0 2px 5px #00000008;transition:all .2s ease}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .spa-layer[_ngcontent-%COMP%]   .spa-details-card[_ngcontent-%COMP%]   .tech-tag[_ngcontent-%COMP%]:hover{background:#feb2b2;color:#fff;transform:scale(1.05)}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .architecture-notes-modern[_ngcontent-%COMP%]{position:absolute;left:30px;bottom:30px;display:grid;grid-template-columns:1fr 1fr;gap:15px;text-align:left}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .architecture-notes-modern[_ngcontent-%COMP%]   .note-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .architecture-notes-modern[_ngcontent-%COMP%]   .note-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px;color:#3b82f6}.arch-doc-container[_ngcontent-%COMP%]   .architecture-diagram.modern-style[_ngcontent-%COMP%]   .architecture-notes-modern[_ngcontent-%COMP%]   .note-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#475569;font-weight:600}.arch-doc-container[_ngcontent-%COMP%]   .placeholder-diagram[_ngcontent-%COMP%]{background-color:#fff;border:2px dashed #e2e8f0;border-radius:12px;height:300px;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#94a3b8}.arch-doc-container[_ngcontent-%COMP%]   .placeholder-diagram[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px}.arch-doc-container[_ngcontent-%COMP%]   .placeholder-diagram[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .description-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:25px;margin-top:20px}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:16px;padding:24px;transition:all .3s ease;box-shadow:0 4px 6px -1px #0000000d}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 12px 20px -5px #0000001a;border-color:#3b82f6}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card.success-point[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{background:#f0fdf4;color:#22c55e}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card.performance-point[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{background:#fff7ed;color:#f97316}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card.resource-point[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{background:#eff6ff;color:#3b82f6}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card.quality-point[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{background:#faf5ff;color:#a855f7}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card[_ngcontent-%COMP%]   .desc-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:16px;color:#0f172a}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card[_ngcontent-%COMP%]   .desc-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{background:#eff6ff;color:#3b82f6;padding:8px;border-radius:10px;font-size:24px}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card[_ngcontent-%COMP%]   .desc-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:700}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card[_ngcontent-%COMP%]   .desc-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:15px;line-height:1.6;color:#475569}.arch-doc-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   .desc-card[_ngcontent-%COMP%]   .desc-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#f1f5f9;padding:2px 6px;border-radius:4px;font-family:inherit;color:#3b82f6;font-weight:600}.arch-doc-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:100px 0;color:#64748b}.arch-doc-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid #3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']})};var Tr=class n{deviceInfoSubject=new st(this.detectDevice());deviceInfo$=this.deviceInfoSubject.asObservable();constructor(){Co(window,"resize").pipe(ai(300),Hn(()=>this.detectDevice()),bo(this.detectDevice())).subscribe(t=>this.deviceInfoSubject.next(t))}detectDevice(){let t=window.innerWidth,e=window.innerHeight,r=t<768,i=t>=768&&t<1024,a=t>=1024;return{isMobile:r,isTablet:i,isDesktop:a,screenWidth:t,screenHeight:e}}get isMobile(){return this.deviceInfoSubject.value.isMobile}get isTablet(){return this.deviceInfoSubject.value.isTablet}get isDesktop(){return this.deviceInfoSubject.value.isDesktop}get currentDeviceInfo(){return this.deviceInfoSubject.value}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Ot({token:n,factory:n.\u0275fac,providedIn:"root"})};var Jx=["container"],Qx=["containerBody"];function e_(n,t){n&1&&(Me(),ee(0,"path",21))}function t_(n,t){n&1&&(Me(),ee(0,"path",22))}function n_(n,t){if(n&1&&(f(0,"span",19),g(1),p()),n&2){let e=k(2);_(),ge("(",e.folderType==="calendar"?"Calendar":"Note",")")}}function r_(n,t){if(n&1){let e=Oe();f(0,"div",8),re("dblclick",function(){J(e);let i=k();return Q(i.maximize())}),f(1,"div",9)(2,"button",10),re("click",function(){J(e);let i=k();return Q(i.closeWindow())}),Me(),f(3,"svg",11),ee(4,"path",12),p()(),Re(),f(5,"button",13),re("click",function(i){J(e);let a=k();return Q(a.minimize(i))}),Me(),f(6,"svg",11),ee(7,"path",14),p()(),Re(),f(8,"button",15),re("click",function(){J(e);let i=k();return Q(i.maximize())}),Me(),f(9,"svg",11),Ut(10,e_,1,0,"path",16)(11,t_,1,0,"path",17),p()()(),Re(),f(12,"span",18),g(13),ae(14,n_,2,1,"span",19),p(),ee(15,"div",20),p()}if(n&2){let e=k();_(2),Lt("aria-label","Close"),_(3),Lt("aria-label","Minimize"),_(3),Lt("aria-label",e.isMaximized?"Restore":"Maximize"),_(2),we("ngIf",!e.isMaximized),_(),we("ngIf",e.isMaximized),_(2),ge(" ",e.metaData.label," "),_(),oe(e.folderType?14:-1)}}function i_(n,t){if(n&1){let e=Oe();f(0,"div",23),re("mousedown",function(i){J(e);let a=k();return Q(a.onClick(i))}),p()}}function a_(n,t){if(n&1){let e=Oe();f(0,"button",24),re("click",function(){J(e);let i=k();return Q(i.maximize())}),Me(),f(1,"svg",25),ee(2,"path",26),p()()}}function o_(n,t){if(n&1&&ee(0,"iframe",7),n&2){let e=k();we("src",e.iframeUrl,li)}}function s_(n,t){n&1&&So(0,null,1)}var na=class n{constructor(t,e){this.cdr=t;this.sanitizer=e}id;zIndex;metaData;folderType;isMobileApp=!1;isActive=!1;initialMaximized=!1;set zoomLevel(t){this.zoomLevelSignal.set(t)}get zoomLevel(){return this.zoomLevelSignal()}moveToFront=new Rt;close=new Rt;minimizeWindow=new Rt;maximizeChange=new Rt;windowStyleChange=new Rt;simulatorRequested=new Rt;zoomLevelSignal=$n(100);zoomTransform=Ao(()=>`scale(${this.zoomLevelSignal()/100})`);container;cdkDrag;containerBody;componentRef;iframeUrl=null;isMaximized=!1;windowStyle={position:"absolute",width:"900px",height:"700px",top:`${Math.floor(Math.random()*100)+50}px`,left:`${Math.floor(Math.random()*200)+100}px`,display:"flex",flexDirection:"column",boxShadow:"0px 10px 30px rgba(0, 0, 0, 0.3)",borderRadius:"12px",overflow:"hidden"};isDragging=!1;dragStartX=0;dragStartY=0;elementStartX=0;elementStartY=0;activePointerId=null;subscriptions=[];ngAfterContentInit(){console.log("Zoom Level after content init:",this.zoomLevel)}ngOnInit(){if(!this.metaData)return;if(this.isMobileApp?this.windowStyle=ot($e({},this.windowStyle),{width:"393px",height:"852px",borderRadius:"10px"}):this.windowStyle=ot($e({},this.windowStyle),{width:`${Math.round(1200)}px`,height:`${Math.round(900)}px`}),this.metaData.component){if(this.containerBody.clear(),this.componentRef=this.containerBody.createComponent(this.metaData.component),this.folderType&&this.componentRef.instance&&(this.componentRef.instance.folderType=this.folderType),this.componentRef.instance&&this.componentRef.instance.simulatorRequested){let r=this.componentRef.instance.simulatorRequested.subscribe(i=>{this.simulatorRequested.emit(i)});this.subscriptions.push(r)}}else if(this.metaData.route){let i=`${window.location.origin+window.location.pathname}#${this.metaData.route}`;this.iframeUrl=this.sanitizer.bypassSecurityTrustResourceUrl(i)}let t=parseInt(this.windowStyle.top,10),e=parseInt(this.windowStyle.left,10);this.windowStyleChange.emit({top:t,left:e}),this.initialMaximized&&setTimeout(()=>this.maximize(),0)}ngOnChanges(t){(t.zIndex||t.isActive)&&(this.windowStyle=ot($e({},this.windowStyle),{zIndex:this.isMaximized?1e4+this.zIndex:this.zIndex}),this.cdr.detectChanges())}onClick(t){this.moveToFront.emit(this.id)}minimize(t){t.stopPropagation(),this.minimizeWindow.emit(this.id)}onContainerWheel(t){t.stopPropagation()}maximize(){this.isMaximized?(this.isMobileApp?(this.windowStyle=ot($e({},this.windowStyle),{position:"absolute",width:"393px",height:"852px",top:"50px",left:"calc(50% - 196.5px)",borderRadius:"10px"}),this.windowStyleChange.emit({top:50,left:0})):(this.windowStyle=ot($e({},this.windowStyle),{position:"absolute",width:`${Math.round(900)}px`,height:`${Math.round(700)}px`,top:"50px",left:"100px",borderRadius:"12px"}),this.windowStyleChange.emit({top:50,left:100})),this.cdkDrag._dragRef.setFreeDragPosition({x:0,y:0})):(this.windowStyle=ot($e({},this.windowStyle),{position:"fixed",top:"0px",left:"0px",transform:"none",width:"100vw",height:"100vh",borderRadius:"0",zIndex:1e4+this.zIndex}),this.windowStyleChange.emit({top:0,left:0}),this.cdkDrag._dragRef.reset(),this.cdkDrag._dragRef.setFreeDragPosition({x:0,y:0})),this.isMaximized=!this.isMaximized,this.maximizeChange.emit({id:this.id,isMaximized:this.isMaximized})}closeWindow(){this.componentRef&&(this.componentRef.destroy(),this.componentRef=null),this.containerBody&&this.containerBody.length>0&&this.containerBody.detach(0),this.close.emit(this.id)}onPointerDown(t){if(!this.isDragTarget(t.target))return;t.preventDefault(),t.stopPropagation(),this.isDragging=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY,this.activePointerId=t.pointerId;let r=this.container.nativeElement.getBoundingClientRect();this.elementStartX=r.left,this.elementStartY=r.top,t.target.setPointerCapture(t.pointerId),this.moveToFront.emit(this.id),document.addEventListener("pointermove",this.onPointerMove,!0),document.addEventListener("pointerup",this.onPointerUp,!0)}onPointerMove=t=>{if(!this.isDragging||this.activePointerId!==t.pointerId)return;t.preventDefault(),t.stopPropagation();let e=t.clientX-this.dragStartX,r=t.clientY-this.dragStartY,i=this.elementStartX+e,a=this.elementStartY+r;this.windowStyle=ot($e({},this.windowStyle),{left:i+"px",top:a+"px"}),this.windowStyleChange.emit({top:a,left:i}),this.cdr.markForCheck()};onPointerUp=t=>{if(!(!this.isDragging||this.activePointerId!==t.pointerId)){if(t.preventDefault(),t.stopPropagation(),this.isDragging=!1,this.activePointerId=null,this.container){let e=this.container.nativeElement;try{e.releasePointerCapture(t.pointerId)}catch{}}document.removeEventListener("pointermove",this.onPointerMove,!0),document.removeEventListener("pointerup",this.onPointerUp,!0)}};isDragTarget(t){if(!t)return!1;let e=t;for(;e&&e!==this.container?.nativeElement;){if(e.classList.contains("container-header")||e.classList.contains("mobile-notch"))return!0;e=e.parentElement}return!1}ngOnDestroy(){this.isDragging&&(this.isDragging=!1,this.activePointerId=null,document.removeEventListener("pointermove",this.onPointerMove,!0),document.removeEventListener("pointerup",this.onPointerUp,!0)),this.subscriptions.forEach(t=>t.unsubscribe())}static \u0275fac=function(e){return new(e||n)(lt(ui),lt(An))};static \u0275cmp=yt({type:n,selectors:[["app-window-modal"]],viewQuery:function(e,r){if(e&1&&(nn(Jx,5,Po),nn(dr,5),nn(Qx,5,fi)),e&2){let i;rn(i=an())&&(r.container=i.first),rn(i=an())&&(r.cdkDrag=i.first),rn(i=an())&&(r.containerBody=i.first)}},hostBindings:function(e,r){e&1&&re("pointerdown",function(a){return r.onPointerDown(a)})},inputs:{id:"id",zIndex:"zIndex",metaData:"metaData",folderType:"folderType",isMobileApp:"isMobileApp",isActive:"isActive",initialMaximized:"initialMaximized",zoomLevel:"zoomLevel"},outputs:{moveToFront:"moveToFront",close:"close",minimizeWindow:"minimizeWindow",maximizeChange:"maximizeChange",windowStyleChange:"windowStyleChange",simulatorRequested:"simulatorRequested"},standalone:!1,features:[un],decls:8,vars:16,consts:[["container",""],["containerBody",""],["cdkDrag","",1,"modal-container",3,"mousedown","cdkDragDisabled"],["class","container-header","cdkDragHandle","",3,"dblclick",4,"ngIf"],[1,"container-body",3,"wheel"],["class","window-focus-overlay",3,"mousedown",4,"ngIf"],["class","fullscreen-exit-btn","title","\uC804\uCCB4\uD654\uBA74 \uC885\uB8CC",3,"click",4,"ngIf"],["frameborder","0",1,"app-iframe",3,"src"],["cdkDragHandle","",1,"container-header",3,"dblclick"],[1,"window-controls-left"],[1,"control-button","close",3,"click"],["viewBox","0 0 12 12","fill","currentColor"],["d","M2.22 2.22a.75.75 0 0 1 1.06 0L6 4.94l2.72-2.72a.75.75 0 1 1 1.06 1.06L7.06 6l2.72 2.72a.75.75 0 1 1-1.06 1.06L6 7.06l-2.72 2.72a.75.75 0 0 1-1.06-1.06L4.94 6 2.22 3.28a.75.75 0 0 1 0-1.06z"],[1,"control-button","minimize",3,"click"],["d","M2 6a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5A.75.75 0 0 1 2 6z"],[1,"control-button","maximize",3,"click"],["d","M3 3.5A1.5 1.5 0 0 1 4.5 2h3A1.5 1.5 0 0 1 9 3.5v5A1.5 1.5 0 0 1 7.5 10h-3A1.5 1.5 0 0 1 3 8.5v-5zm1.5-.5a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-3z",4,"ngIf"],["d","M3.5 3A1.5 1.5 0 0 0 2 4.5v4A1.5 1.5 0 0 0 3.5 10h5A1.5 1.5 0 0 0 10 8.5v-4A1.5 1.5 0 0 0 8.5 3h-5zM8.354 4.854a.5.5 0 0 0-.708-.708L6 5.793 4.354 4.146a.5.5 0 1 0-.708.708L5.293 6.5l-1.647 1.646a.5.5 0 0 0 .708.708L6 7.207l1.646 1.647a.5.5 0 0 0 .708-.708L6.707 6.5l1.647-1.646z",4,"ngIf"],[1,"header-label"],[1,"folder-tag"],[1,"spacer"],["d","M3 3.5A1.5 1.5 0 0 1 4.5 2h3A1.5 1.5 0 0 1 9 3.5v5A1.5 1.5 0 0 1 7.5 10h-3A1.5 1.5 0 0 1 3 8.5v-5zm1.5-.5a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-3z"],["d","M3.5 3A1.5 1.5 0 0 0 2 4.5v4A1.5 1.5 0 0 0 3.5 10h5A1.5 1.5 0 0 0 10 8.5v-4A1.5 1.5 0 0 0 8.5 3h-5zM8.354 4.854a.5.5 0 0 0-.708-.708L6 5.793 4.354 4.146a.5.5 0 1 0-.708.708L5.293 6.5l-1.647 1.646a.5.5 0 0 0 .708.708L6 7.207l1.646 1.647a.5.5 0 0 0 .708-.708L6.707 6.5l1.647-1.646z"],[1,"window-focus-overlay",3,"mousedown"],["title","\uC804\uCCB4\uD654\uBA74 \uC885\uB8CC",1,"fullscreen-exit-btn",3,"click"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M8 3v5H3M16 3v5h5M8 21v-5H3M16 21v-5h5"]],template:function(e,r){if(e&1){let i=Oe();f(0,"div",2,0),re("mousedown",function(o){return J(i),Q(r.onClick(o))}),Ut(2,r_,16,7,"div",3),f(3,"div",4),re("wheel",function(o){return J(i),Q(r.onContainerWheel(o))}),Ut(4,i_,1,0,"div",5)(5,a_,3,0,"button",6),ae(6,o_,1,1,"iframe",7)(7,s_,2,0,"ng-container"),p()()}e&2&&(To(r.windowStyle),De("transform",r.zoomTransform())("transform-origin","top center"),ve("maximized",r.isMaximized)("is-mobile-app",r.isMobileApp),we("cdkDragDisabled",r.isMaximized)("@modalAnimation",void 0),_(2),we("ngIf",!r.isMaximized),_(2),we("ngIf",!r.isActive),_(),we("ngIf",r.isMaximized),_(),oe(r.iframeUrl?6:7))},dependencies:[lr,dr,mi],styles:['@charset "UTF-8";.modal-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#f0f0f5b3;backdrop-filter:blur(60px) saturate(200%);-webkit-backdrop-filter:blur(60px) saturate(200%);border:1px solid rgba(255,255,255,.3);box-shadow:0 25px 75px #00000059,0 0 0 .5px #fff6 inset,0 1px 2px #ffffff4d inset;border-radius:10px;overflow:hidden;position:relative;transition:border-radius .3s ease,border-width .3s ease}.modal-container.maximized[_ngcontent-%COMP%]{border-radius:0;border-width:0;box-shadow:none}.modal-container[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#ffffff1a,#ffffff0d,#ffffff05);pointer-events:none;border-radius:10px}.container-header[_ngcontent-%COMP%]{display:flex;padding:10px 16px;cursor:move;align-items:center;justify-content:flex-start;gap:12px;min-height:40px;background:linear-gradient(180deg,#ffffffd9,#f8f8facc,#f6f6f8bf);backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border-bottom:1px solid rgba(0,0,0,.08);position:relative;touch-action:none;user-select:none;-webkit-user-select:none;-webkit-user-drag:none}.container-header[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.6) 50%,transparent 100%)}.container-header[_ngcontent-%COMP%]:active{cursor:grabbing}.window-controls-left[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;z-index:1}.control-button[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;border:.5px solid rgba(0,0,0,.15);cursor:pointer;display:flex;align-items:center;justify-content:center;padding:0;transition:all .15s ease;position:relative;box-shadow:0 1px 2px #00000026,inset 0 1px #fff6}.control-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:6px;height:6px;opacity:0;transition:opacity .15s ease}.container-header[_ngcontent-%COMP%]:hover   .control-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.7}.control-button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{opacity:1!important}.control-button.close[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff6057,#ff5f56)}.control-button.close[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ff4b42,#ff3b30);box-shadow:0 2px 4px #ff3b3066,inset 0 1px #ffffff80}.control-button.close[_ngcontent-%COMP%]:active{background:linear-gradient(135deg,#d93025,#c9211e)}.control-button.minimize[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffbd2e,#ffbc2d)}.control-button.minimize[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ffb01f,#ffa900);box-shadow:0 2px 4px #ffa90066,inset 0 1px #ffffff80}.control-button.minimize[_ngcontent-%COMP%]:active{background:linear-gradient(135deg,#e09b00,#d08800)}.control-button.maximize[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28ca42,#27c93f)}.control-button.maximize[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#20b038,#1fa832);box-shadow:0 2px 4px #1fa83266,inset 0 1px #ffffff80}.control-button.maximize[_ngcontent-%COMP%]:active{background:linear-gradient(135deg,#1a9930,#178528)}.header-label[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:calc(100% - 200px);font-weight:600;font-size:13px;color:#fff;text-align:center;letter-spacing:.2px}.header-label[_ngcontent-%COMP%]   .folder-tag[_ngcontent-%COMP%]{margin-left:6px;opacity:.7;font-size:12px;font-weight:500;color:#ffffffd9}.spacer[_ngcontent-%COMP%]{flex:1}.container-body[_ngcontent-%COMP%]{overflow:auto;flex:1;padding:0;margin:0;position:relative;background:linear-gradient(180deg,#ffffffe6,#fcfcfed9)}.container-body[_ngcontent-%COMP%]   .window-focus-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:9999;background:transparent}.fullscreen-exit-btn[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;width:40px;height:40px;border-radius:8px;background:#00000080;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1000;transition:all .2s ease;opacity:.6}.fullscreen-exit-btn[_ngcontent-%COMP%]:hover{opacity:1;background:#000000b3;transform:scale(1.1)}.fullscreen-exit-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.app-iframe[_ngcontent-%COMP%]{width:100%;height:100%;border:none;display:block;background:#fff}.modal-container.maximized.is-mobile-app[_ngcontent-%COMP%]{background:#000}.modal-container.maximized.is-mobile-app[_ngcontent-%COMP%]   .container-body[_ngcontent-%COMP%]{display:flex;justify-content:center;background:#1a1a1a}.modal-container.maximized.is-mobile-app[_ngcontent-%COMP%]   .container-body[_ngcontent-%COMP%]   .app-iframe[_ngcontent-%COMP%]{width:393px;height:100%;margin:0 auto;box-shadow:0 0 50px #00000080}.route-placeholder[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2)}.placeholder-content[_ngcontent-%COMP%]{text-align:center;color:#fff;padding:40px}.placeholder-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 20px;stroke:#fff;stroke-width:1.5;filter:drop-shadow(0 4px 8px rgba(0,0,0,.2))}.placeholder-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;font-size:24px;font-weight:600;text-shadow:0 2px 4px rgba(0,0,0,.2)}.placeholder-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:14px;opacity:.9}.info-text[_ngcontent-%COMP%]{margin-top:20px!important;font-size:12px!important;opacity:.7!important;font-style:italic}.container-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.container-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.container-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#0003;border-radius:4px}.container-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#0000004d}@media (prefers-color-scheme: dark){.modal-container[_ngcontent-%COMP%]{background:#282832b3;border-color:#ffffff26;box-shadow:0 25px 75px #0009,0 0 0 .5px #fff3 inset,0 1px 2px #ffffff1a inset}.modal-container[_ngcontent-%COMP%]:before{background:linear-gradient(135deg,#ffffff0d,#ffffff05,#ffffff03)}.container-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#373741e6,#2d2d37d9,#282832cc);border-bottom-color:#ffffff14}.container-header[_ngcontent-%COMP%]:after{background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.1) 50%,transparent 100%)}.header-label[_ngcontent-%COMP%]{color:#ffffffe6}.container-body[_ngcontent-%COMP%]{background:linear-gradient(180deg,#1e1e28e6,#191923d9)}.container-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#fff3}.container-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff4d}}'],data:{animation:[No("modalAnimation",[_a("void",xa({opacity:0,transform:"scale(0.3)"})),_a("*",xa({opacity:1,transform:"scale(1)"})),Ca("void => *",[ma("0.2s ease-out")]),Ca("* => void",[ma("0.2s ease-in")])])]}})};var ra=class n{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustHtml(t)}static \u0275fac=function(e){return new(e||n)(lt(An,16))};static \u0275pipe=Oo({name:"sanitizeHtml",type:n,pure:!0})};var P0=(n,t)=>t.id,d_=(n,t)=>t.label+"_"+n,f_=(n,t)=>t.id||n;function p_(n,t){if(n&1){let e=Oe();f(0,"span",41),g(1,","),p(),f(2,"span",42),re("click",function(){J(e);let i=k().$implicit,a=k(5);return Q(a.openOrFocusWindow(i))}),g(3),p()}if(n&2){let e=k().$implicit,r=k(5);_(2),ve("active",r.isWindowOpen(e)),_(),ge(" ",e.label," ")}}function g_(n,t){if(n&1&&ae(0,p_,4,3),n&2){let e=t.$implicit,r=k(5);oe(e.label!==r.activeWindow.metaData.label?0:-1)}}function u_(n,t){if(n&1&&(f(0,"div",40),ye(1,g_,1,1,null,null,d_),p()),n&2){let e=k(4);_(),ke(e.getOpenWindowsInFolder())}}function h_(n,t){if(n&1){let e=Oe();f(0,"div",21)(1,"span",37),g(2),p(),f(3,"span",38),g(4,"/"),p(),f(5,"span",39),re("click",function(){J(e);let i=k(3);return Q(i.openOrFocusWindow(i.activeWindow.metaData))}),g(6),p(),ae(7,u_,3,0,"div",40),p()}if(n&2){let e=k(3);_(2),ne(e.getActiveFolderLabel()),_(4),ge(" ",e.activeWindow.metaData.label," "),_(),oe(e.getOpenWindowsInFolder().length>1?7:-1)}}function m_(n,t){if(n&1&&(f(0,"div",23),Me(),f(1,"svg",18),ee(2,"path",43),p(),Re(),f(3,"span"),g(4),p()()),n&2){let e=k(3);_(4),ne(e.minimizedWindows.length)}}function x_(n,t){if(n&1){let e=Oe();f(0,"div",48),re("click",function(){let i=J(e).$implicit,a=k(4);return Q(a.setZoomLevel(i))}),g(1),p()}if(n&2){let e=t.$implicit,r=k(4);ve("active",e===r.zoomLevel),_(),ge(" ",e,"% ")}}function __(n,t){if(n&1){let e=Oe();f(0,"div",44),re("click",function(i){return J(e),Q(i.stopPropagation())}),ye(1,x_,2,3,"div",45,ko),ee(3,"div",46),f(4,"div",47),re("click",function(){J(e);let i=k(3);return Q(i.resetZoom())}),g(5," \uAE30\uBCF8\uAC12 \uC124\uC815 "),p()()}if(n&2){let e=k(3);_(),ke(e.zoomLevels)}}function C_(n,t){if(n&1){let e=Oe();f(0,"div",15)(1,"div",16)(2,"div",17),Me(),f(3,"svg",18),ee(4,"path",19),p(),Re(),f(5,"span",20),g(6,"MOBSOFT"),p()(),ae(7,h_,8,3,"div",21),p(),f(8,"div",22),ae(9,m_,5,1,"div",23),f(10,"div",24)(11,"button",25),re("click",function(){J(e);let i=k(2);return Q(i.decreaseZoom())}),Me(),f(12,"svg",18),ee(13,"path",26),p()(),Re(),f(14,"div",27)(15,"span",28),g(16),p(),f(17,"button",29),re("click",function(){J(e);let i=k(2);return Q(i.toggleZoomDropdown())}),Me(),f(18,"svg",18),ee(19,"path",30),p()(),ae(20,__,6,0,"div",31),p(),Re(),f(21,"button",32),re("click",function(){J(e);let i=k(2);return Q(i.increaseZoom())}),Me(),f(22,"svg",18),ee(23,"path",33),p()()(),Re(),f(24,"div",34),Me(),f(25,"svg",18),ee(26,"path",35),p()(),Re(),f(27,"div",36),g(28),p()()()}if(n&2){let e=k(2);ve("hidden",e.isAnyWindowMaximized()),_(7),oe(e.activeWindow?7:-1),_(2),oe(e.minimizedWindows.length>0?9:-1),_(2),we("disabled",e.zoomLevel===e.zoomLevels[0]),_(5),ge("",e.zoomLevel,"%"),_(4),oe(e.showZoomDropdown?20:-1),_(),we("disabled",e.zoomLevel===e.zoomLevels[e.zoomLevels.length-1]),_(7),ne(e.currentTime)}}function v_(n,t){if(n&1){let e=Oe();f(0,"div",51),re("click",function(){J(e);let i=k(3);return Q(i.goBack())}),f(1,"div",52),Me(),f(2,"svg",53),ee(3,"path",54),p()(),Re(),f(4,"div",55),g(5,"\uB4A4\uB85C"),p()()}n&2&&Lt("data-tooltip","\uB4A4\uB85C")}function b_(n,t){n&1&&(Me(),f(0,"svg",53),ee(1,"path",59),p())}function w_(n,t){if(n&1&&(Me(),ee(0,"svg",57),qt(1,"sanitizeHtml")),n&2){let e=k().$implicit,r=k(3);we("innerHTML",gi(1,1,r.getIconSvg(e.icon)),ci)}}function P_(n,t){if(n&1&&(f(0,"span",58),g(1),p()),n&2){let e=k(4);_(),ge("(",e.currentFolderType==="calendar"?"Calendar":"Note",")")}}function M_(n,t){if(n&1){let e=Oe();f(0,"div",51),re("click",function(){let i=J(e).$implicit,a=k(3);return Q(a.openWindow(i))}),f(1,"div",56),ae(2,b_,2,0,":svg:svg",53)(3,w_,2,3,":svg:svg",57),p(),f(4,"div",55),g(5),ae(6,P_,2,1,"span",58),p()()}if(n&2){let e=t.$implicit,r=k(3);Lt("data-tooltip",e.label),_(),De("background",r.getIconGradient(e.icon,e.label)),_(),oe(e.type==="folder"?2:3),_(3),ge(" ",e.label," "),_(),oe(!e.type||e.type==="doc"?6:-1)}}function O_(n,t){if(n&1&&(f(0,"div",49),ae(1,v_,6,1,"div",50),ye(2,M_,7,6,"div",50,f_),p()),n&2){let e=k(2);ve("hidden",e.isAnyWindowMaximized()),_(),oe(e.isInSubFolder()?1:-1),_(),ke(e.desktopIcons)}}function y_(n,t){if(n&1){let e=Oe();f(0,"app-window-modal",61),re("moveToFront",function(i){J(e);let a=k(3);return Q(a.moveToFront(i))})("close",function(i){J(e);let a=k(3);return Q(a.close(i))})("minimizeWindow",function(i){J(e);let a=k(3);return Q(a.minimizeWindow(i))})("maximizeChange",function(i){J(e);let a=k(3);return Q(a.onMaximizeChange(i))})("windowStyleChange",function(i){J(e);let a=k().$implicit,o=k(2);return Q(o.onWindowStyleChange(a.id,i))})("simulatorRequested",function(i){J(e);let a=k(3);return Q(a.openSimulatorWindow(i))}),p()}if(n&2){let e=k().$implicit,r=k(2);we("id",e.id)("zIndex",e.zIndex)("isActive",(r.activeWindow==null?null:r.activeWindow.id)===e.id)("metaData",e.metaData)("folderType",e.folderType)("isMobileApp",r.isMobileApp(e.metaData))("initialMaximized",e.isFullscreen||!1)("zoomLevel",r.zoomLevel)}}function k_(n,t){if(n&1&&ae(0,y_,1,8,"app-window-modal",60),n&2){let e=t.$implicit;oe(e.isMinimized?-1:0)}}function S_(n,t){n&1&&ee(0,"div",69)}function E_(n,t){if(n&1){let e=Oe();f(0,"div",67),re("click",function(){let i=J(e).$implicit,a=k(3);return Q(a.openWindow(i))}),f(1,"div",68),Me(),ee(2,"svg",57),qt(3,"sanitizeHtml"),p(),ae(4,S_,1,0,"div",69),p()}if(n&2){let e=t.$implicit,r=k(3);ve("active",r.isAppActive(e)),Lt("data-tooltip",e.label),_(),De("background",r.getIconGradient(e.icon,e.label)),_(),we("innerHTML",gi(3,7,r.getIconSvg(e.icon)),ci),_(2),oe(r.isAppActive(e)?4:-1)}}function T_(n,t){n&1&&ee(0,"div",65)}function D_(n,t){if(n&1){let e=Oe();f(0,"div",70),re("click",function(i){let a=J(e).$implicit;return k(3).restoreWindow(a.id),Q(i.stopPropagation())}),f(1,"div",71),Me(),ee(2,"svg",57),qt(3,"sanitizeHtml"),p(),Re(),ee(4,"div",72),p()}if(n&2){let e=t.$implicit,r=k(3);Lt("data-tooltip",e.metaData.label+" (\uCD5C\uC18C\uD654\uB428)"),_(),De("background",r.getIconGradient(e.metaData.icon,e.metaData.label)),_(),we("innerHTML",gi(3,4,r.getIconSvg(e.metaData.icon)),ci)}}function A_(n,t){if(n&1&&(f(0,"div",62)(1,"div",63),ye(2,E_,5,9,"div",64,yo),ae(4,T_,1,0,"div",65),ye(5,D_,5,6,"div",66,P0),p()()),n&2){let e=k(2);ve("hidden",e.isAnyWindowMaximized()),_(2),ke(e.icons),_(2),oe(e.minimizedWindows.length>0?4:-1),_(),ke(e.minimizedWindows)}}function F_(n,t){if(n&1&&(ae(0,C_,29,9,"div",2),f(1,"div",3),ee(2,"div",4),f(3,"div",5),ee(4,"div",6)(5,"div",7)(6,"div",8)(7,"div",9)(8,"div",10),p(),ee(9,"div",11),ae(10,O_,4,3,"div",12),f(11,"div",13),ye(12,k_,1,1,null,null,P0),p()(),ae(14,A_,7,3,"div",14)),n&2){let e=k();oe(e.isAnyWindowMaximized()?-1:0),_(10),oe(e.isAnyWindowMaximized()?-1:10),_(),De("transform",e.isAnyWindowMaximized()?"none":e.getZoomTransform()),_(),ke(e.windows),_(2),oe(e.isAnyWindowMaximized()?-1:14)}}function I_(n,t){n&1&&(f(0,"div",1)(1,"div",73),Me(),f(2,"svg",74),ee(3,"rect",75)(4,"line",76)(5,"line",77),p(),Re(),f(6,"h1",78),g(7,"PC\uC5D0\uC11C\uB9CC \uC81C\uACF5\uD569\uB2C8\uB2E4"),p(),f(8,"p",79),g(9,"\uC774 \uC11C\uBE44\uC2A4\uB294 \uB370\uC2A4\uD06C\uD1B1 \uD658\uACBD\uC5D0\uC11C\uB9CC \uC774\uC6A9 \uAC00\uB2A5\uD569\uB2C8\uB2E4."),p(),f(10,"p",80),g(11,"\uB354 \uD070 \uD654\uBA74\uC758 \uCEF4\uD4E8\uD130\uC5D0\uC11C \uC811\uC18D\uD574\uC8FC\uC138\uC694."),p()()())}function B_(){return`window-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}var ia=class n{constructor(t,e,r,i){this.cdr=t;this.deviceService=e;this.sanitizer=r;this.debugLogger=i;this.debugLogger.info("Desktop Component","Constructor called")}currentTime="";timeInterval;backgroundImage="";isMobile=!1;currentAppIndex=-1;primaryApps=[];allApps=[];showAppDrawer=!1;showAppSwitcher=!1;showMinimizedApps=!1;currentMinimizedIndex=0;runningApps=[];appIdCounter=0;isFullscreen=!1;currentFolderPath="root";get currentFolderType(){return this.currentFolderPath==="folder-calendar"?"calendar":this.currentFolderPath==="folder-note"?"note":"calendar"}desktopFolders={root:[{id:"folder-calendar",icon:"calendar",label:"Calendar",type:"folder",component:null,contents:[{component:ar,icon:"docs",label:"\uAE30\uB2A5\uC815\uC758\uC11C",route:"/docs/spec"},{component:Tn,icon:"project",label:"WBS",route:"/docs/wbs"},{component:or,icon:"form",label:"IA",route:"/docs/ia"},{component:sr,icon:"account_tree",label:"\uC544\uD0A4\uD14D\uCC98",route:"/docs/arch"}]},{id:"folder-note",icon:"note",label:"Note",type:"folder",component:null,contents:[{component:ar,icon:"docs",label:"\uAE30\uB2A5\uC815\uC758\uC11C",route:"/docs/spec"},{component:Tn,icon:"project",label:"WBS",route:"/docs/wbs"},{component:or,icon:"form",label:"IA",route:"/docs/ia"},{component:sr,icon:"account_tree",label:"\uC544\uD0A4\uD14D\uCC98",route:"/docs/arch"}]}],"folder-calendar":[{component:ar,icon:"docs",label:"\uAE30\uB2A5\uC815\uC758\uC11C",route:"/docs/spec"},{component:Tn,icon:"project",label:"WBS",route:"/docs/wbs"},{component:or,icon:"form",label:"IA",route:"/docs/ia"},{component:sr,icon:"account_tree",label:"\uC544\uD0A4\uD14D\uCC98",route:"/docs/arch"}],"folder-note":[{component:ar,icon:"docs",label:"\uAE30\uB2A5\uC815\uC758\uC11C",route:"/docs/spec"},{component:Tn,icon:"project",label:"WBS",route:"/docs/wbs"},{component:or,icon:"form",label:"IA",route:"/docs/ia"},{component:sr,icon:"account_tree",label:"\uC544\uD0A4\uD14D\uCC98",route:"/docs/arch"}]};get desktopIcons(){return this.desktopFolders[this.currentFolderPath]||[]}icons=[{component:null,icon:"calendar",label:"\uCE98\uB9B0\uB354 (PC)",route:"/calendar/pc"},{component:null,icon:"calendar",label:"\uCE98\uB9B0\uB354 (\uBAA8\uBC14\uC77C)",route:"/calendar/mobile"},{component:null,icon:"note",label:"\uB178\uD2B8 (PC)",route:"/note/pc"},{component:null,icon:"note",label:"\uB178\uD2B8 (\uBAA8\uBC14\uC77C)",route:"/note/mobile"},{component:null,icon:"play",label:"ezDown",route:"/ezdown"}];windows=[];zIndex=1e3;zoomLevel=100;zoomLevels=[50,75,100,125,150,175,200];showZoomDropdown=!1;get activeWindow(){return this.windows.filter(t=>!t.isMinimized).sort((t,e)=>e.zIndex-t.zIndex)[0]||null}get minimizedWindows(){return this.windows.filter(t=>t.isMinimized)}iconBoxStyle={width:"80px",height:"80px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"8px",cursor:"pointer",borderRadius:"12px",userSelect:"none",color:"white",gap:"8px",transition:"all 0.3s ease"};iconLabel={maxWidth:"100%",fontSize:"12px",textAlign:"center",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":2,"-webkit-box-orient":"vertical",lineHeight:1.2,height:"2.4em",wordWrap:"break-word",whiteSpace:"normal"};ngOnInit(){this.updateTime(),this.timeInterval=setInterval(()=>{this.updateTime()},1e3);let t=localStorage.getItem("desk-zoom-level");if(t){let e=parseInt(t,10);e>=50&&e<=200&&(this.zoomLevel=e)}this.deviceService.deviceInfo$.subscribe(e=>{this.isMobile=e.isMobile,this.setupMobileLayout(),this.cdr.detectChanges()}),this.setupMobileLayout(),this.setRandomBackgroundImage()}setRandomBackgroundImage(){let t=["loworld_1.png","loworld_2.png","loworld_3.png"],e=Math.floor(Math.random()*t.length),r=t[e],i=`/images/ai/${r}`;this.backgroundImage=i,this.debugLogger.info("Background Image",`\uB79C\uB364 \uC120\uD0DD: ${r}`),this.checkBackgroundImage(i)}checkBackgroundImage(t){this.debugLogger.info("Background Image",`\uC774\uBBF8\uC9C0 \uB85C\uB4DC \uC2DC\uB3C4: ${t}`);let e=new Image;e.onload=()=>{this.debugLogger.success("Background Image",`\uB85C\uB4DC \uC131\uACF5: ${t}`),this.debugLogger.info("Background Image",`\uD06C\uAE30: ${e.width} x ${e.height}`)},e.onerror=()=>{this.debugLogger.error("Background Image",`\uB85C\uB4DC \uC2E4\uD328: ${t}`),this.debugLogger.warn("Background Image","\uC774\uBBF8\uC9C0 \uACBD\uB85C\uB97C \uD655\uC778\uD558\uC138\uC694");let r=["images/ai/loworld_1.png","./images/ai/loworld_1.png","../../../../../../../public/images/ai/loworld_1.png","assets/images/ai/loworld_1.png"];this.debugLogger.info("Background Image",`\uB300\uCCB4 \uACBD\uB85C: ${r.join(", ")}`),this.testAlternativePaths(r)},e.src=t}testAlternativePaths(t){t.forEach((e,r)=>{let i=new Image;i.onload=()=>{this.debugLogger.success("Background Image",`\uB300\uCCB4 \uACBD\uB85C \uC131\uACF5: ${e}`)},i.onerror=()=>{this.debugLogger.error("Background Image",`\uB300\uCCB4 \uACBD\uB85C \uC2E4\uD328: ${e}`)},i.src=e})}ngOnDestroy(){this.timeInterval&&clearInterval(this.timeInterval)}updateTime(){let t=new Date,e=["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],r=t.getMonth()+1,i=t.getDate(),a=e[t.getDay()],o=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0");this.currentTime=`${r}\uC6D4 ${i}\uC77C (${a}) ${o}:${s}`}getFolderLabel(t){return this.activeWindow?"\uC2DC\uBBAC\uB808\uC774\uD130":t==="folder-calendar"||t==="calendar"?"Calendar":t==="folder-note"||t==="note"?"Note":""}getCurrentFolderItems(){return this.currentFolderPath==="root"?[]:this.desktopFolders[this.currentFolderPath]||[]}getOpenWindowsInFolder(){if(!this.activeWindow)return[];let t=this.activeWindow.folderType;return(this.desktopFolders[t]||[]).filter(r=>this.windows.some(i=>i.metaData.label===r.label&&i.folderType===t))}getActiveFolderLabel(){return!this.activeWindow||!this.activeWindow.folderType?"":this.getFolderLabel(this.activeWindow.folderType)}isWindowOpen(t){return this.activeWindow?.metaData.label===t.label}openOrFocusWindow(t){this.activeWindow?.metaData.label!==t.label&&this.openWindow(t)}setupMobileLayout(){this.isMobile?(this.primaryApps=[],this.allApps=[]):(this.primaryApps=[],this.allApps=[...this.icons])}switchToApp(t){if(this.isMobile&&t>=0&&t<this.icons.length){this.currentAppIndex=t;let e=this.icons[t];if(!this.runningApps.find(i=>i.metaData.route===e.route)){let i={id:`app-${this.appIdCounter++}`,zIndex:1e3,metaData:e,isMinimized:!1,isFullscreen:!1};this.runningApps.push(i)}this.showAppDrawer=!1,this.showAppSwitcher=!1}}openPrimaryApp(t){if(this.isMobile&&t>=0&&t<this.primaryApps.length){let e=this.primaryApps[t],r=this.icons.findIndex(i=>i.route===e.route);if(r!==-1){this.currentAppIndex=r;let i=this.icons[r];if(!this.runningApps.find(o=>o.metaData.route===i.route)){let o={id:`app-${this.appIdCounter++}`,zIndex:1e3,metaData:i,isMinimized:!1,isFullscreen:!1};this.runningApps.push(o)}this.showAppDrawer=!1,this.showAppSwitcher=!1}}}closeApp(){if(this.isMobile&&this.currentAppIndex!==-1){let t=this.icons[this.currentAppIndex];this.runningApps=this.runningApps.filter(e=>e.metaData.route!==t.route),this.currentAppIndex=-1}}onSwipeLeft(){this.isMobile&&this.currentAppIndex>=0&&this.currentAppIndex<this.icons.length-1&&(this.currentAppIndex++,this.switchToApp(this.currentAppIndex))}onSwipeRight(){this.isMobile&&this.currentAppIndex>0&&(this.currentAppIndex--,this.switchToApp(this.currentAppIndex))}toggleAppDrawer(){this.showAppDrawer=!this.showAppDrawer,this.showAppSwitcher=!1}openAppSwitcher(){this.isMobile&&(this.showAppSwitcher=!0,this.showAppDrawer=!1)}closeAppSwitcher(){this.showAppSwitcher=!1}isAnyWindowMaximized(){return this.windows.some(t=>t.isFullscreen)}onMaximizeChange(t){let e=this.windows.find(r=>r.id===t.id);e&&(e.isFullscreen=t.isMaximized,t.isMaximized&&this.moveToFront(t.id)),this.cdr.detectChanges()}switchToRunningApp(t){let e=this.runningApps.find(r=>r.id===t);if(e){e.isMinimized=!1;let r=this.allApps.findIndex(i=>i.route===e.metaData.route);r!==-1&&(this.currentAppIndex=r,this.showAppSwitcher=!1)}}closeRunningApp(t){this.runningApps=this.runningApps.filter(r=>r.id!==t);let e=this.runningApps.find(r=>r.id===t);e&&this.currentAppIndex!==-1&&this.allApps[this.currentAppIndex].route===e.metaData.route&&(this.currentAppIndex=-1)}minimizeCurrentApp(){if(this.isMobile&&this.currentAppIndex!==-1){let t=this.allApps[this.currentAppIndex],e=this.runningApps.find(r=>r.metaData.route===t.route);e&&(e.isMinimized=!0,e.screenshot=this.captureAppScreenshot(t)),this.currentAppIndex=-1,this.currentMinimizedIndex=0}}captureAppScreenshot(t){return`screenshot-${t.icon}`}toggleMinimizedApps(){this.showMinimizedApps=!this.showMinimizedApps,this.showMinimizedApps&&(this.currentMinimizedIndex=0,this.showAppSwitcher=!1,this.showAppDrawer=!1)}get minimizedApps(){return this.runningApps.filter(t=>t.isMinimized)}restoreMinimizedApp(t){let e=this.runningApps.find(r=>r.id===t);if(e){e.isMinimized=!1;let r=this.allApps.findIndex(i=>i.route===e.metaData.route);r!==-1&&(this.currentAppIndex=r,this.showMinimizedApps=!1)}}closeMinimizedApp(t,e){e&&e.stopPropagation();let r=this.runningApps.findIndex(i=>i.id===t);this.runningApps=this.runningApps.filter(i=>i.id!==t),this.currentMinimizedIndex>=this.minimizedApps.length&&this.minimizedApps.length>0&&(this.currentMinimizedIndex=this.minimizedApps.length-1)}nextMinimizedApp(){this.currentMinimizedIndex<this.minimizedApps.length-1&&this.currentMinimizedIndex++}prevMinimizedApp(){this.currentMinimizedIndex>0&&this.currentMinimizedIndex--}goToMinimizedApp(t){t>=0&&t<this.minimizedApps.length&&(this.currentMinimizedIndex=t)}isPrimaryApp(t){return this.primaryApps.some(e=>e.route===t.route)}isAppActive(t){return this.windows.some(e=>e.metaData.route===t.route)}isMobileApp(t){return t.route?.includes("mobile")||!1}openWindow(t){return bn(this,null,function*(){if(t.type==="folder"){this.currentFolderPath=t.id;return}let e=this.windows.find(i=>i.metaData.label===t.label&&i.metaData.route===t.route&&i.folderType===this.currentFolderType);if(e){this.moveToFront(e.id);return}let r=B_();this.windows=[...this.windows,{id:r,zIndex:this.zIndex++,metaData:t,folderType:this.currentFolderType,isFullscreen:!0,windowStyle:{top:20+this.windows.length*20,left:20+this.windows.length*20}}],setTimeout(()=>this.moveToFront(r),0)})}goBack(){this.currentFolderPath!=="root"&&(this.currentFolderPath="root")}isInSubFolder(){return this.currentFolderPath!=="root"}moveToFront(t){let e=this.windows.find(i=>i.id===t);if(!e)return;let r=Math.max(...this.windows.map(i=>Number(i.zIndex)),this.zIndex);r!==Number(e.zIndex)&&(this.windows=this.windows.map(i=>i.id===t?ot($e({},i),{zIndex:r+1}):i),this.zIndex=r+1,console.log("\u{1F7E3} Updated zIndex list:",this.windows.map(i=>({id:i.id,zIndex:i.zIndex}))),this.windows=[...this.windows])}openSimulatorWindow(t){console.log("\u{1F50D} Simulator Requested:",t);let e=t.projectModule||t.page?.projectModule;!e&&t.projectId&&(t.projectId.startsWith("EZCAL-")?e="calendar":t.projectId.startsWith("EZNOTE-")&&(e="note")),e=e||"desk",console.log("\u{1F4C2} Resolved Project Module:",e);let r=this.getProjectModuleRoute(e),i=document.querySelector("base")?.getAttribute("href")||"/",a=`${window.location.origin}${i}#${r}`,o=`simulator_${e}_${Date.now()}`,s="width=1400,height=900,menubar=no,toolbar=no,location=no,status=no,resizable=yes,scrollbars=yes";console.log("\u{1F517} Opening new window:",a),window.open(a,o,s)}getProjectModuleRoute(t){return{calendar:"/calendar/pc",note:"/note/pc",project:"/project/pc",dashboard:"/dashboard/pc",desk:"/desk"}[t]||"/desk"}formatProjectType(t){return{calendar:"Calendar",note:"Note",project:"Project",dashboard:"Dashboard",desk:"Desktop"}[t]||"Simulator"}close(t){this.windows=this.windows.filter(e=>e.id!==t)}minimizeWindow(t){let e=this.windows.find(r=>r.id===t);e&&(e.isMinimized=!0,this.windows=[...this.windows])}restoreWindow(t){let e=this.windows.find(r=>r.id===t);e&&(e.isMinimized=!1,this.moveToFront(t),this.windows=[...this.windows])}onWindowStyleChange(t,e){let r=this.windows.find(i=>i.id===t);r&&(r.windowStyle=e,this.windows=[...this.windows])}getIconSvg(t){return{novel:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>',docs:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>',erp:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>',loworld:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>',store:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>',"chat-talk":'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>',slack:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"/>',project:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>',form:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>',calendar:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>',note:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>',movie:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>',play:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3l14 9-14 9V3z"/>',account_tree:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 5h4v4H7V5zm0 10h4v4H7v-4zm10-5h4v4h-4v-4zM11 7h2a2 2 0 012 2v2a2 2 0 01-2 2h-2m4-2h2"/>'}[t]||""}getIconGradient(t,e=""){let r=e.includes("(\uBAA8\uBC14\uC77C)"),a={novel:{pc:"linear-gradient(135deg, #ff1493, #ff4500)",mobile:"linear-gradient(135deg, #ff6b9d, #ffb347)"},docs:{pc:"linear-gradient(135deg, #1e90ff, #00bfff)",mobile:"linear-gradient(135deg, #87ceeb, #4dd0e1)"},erp:{pc:"linear-gradient(135deg, #32cd32, #00ff7f)",mobile:"linear-gradient(135deg, #66bb6a, #81c784)"},loworld:{pc:"linear-gradient(135deg, #ff6347, #ffa500)",mobile:"linear-gradient(135deg, #ff8566, #ffb74d)"},store:{pc:"linear-gradient(135deg, #9370db, #8a2be2)",mobile:"linear-gradient(135deg, #ba68c8, #ab47bc)"},"chat-talk":{pc:"linear-gradient(135deg, #ff69b4, #ff1493)",mobile:"linear-gradient(135deg, #ff99cc, #ff69b4)"},slack:{pc:"linear-gradient(135deg, #10b981, #059669)",mobile:"linear-gradient(135deg, #4db8a8, #26a69a)"},project:{pc:"linear-gradient(135deg, #ff6b35, #f7931e)",mobile:"linear-gradient(135deg, #ff9657, #ffb74d)"},form:{pc:"linear-gradient(135deg, #ff6b35, #e65100)",mobile:"linear-gradient(135deg, #ff9657, #f4511e)"},calendar:{pc:"linear-gradient(135deg, #06b6d4, #0891b2)",mobile:"linear-gradient(135deg, #4dd0e1, #26c6da)"},note:{pc:"linear-gradient(135deg, #f97316, #ea580c)",mobile:"linear-gradient(135deg, #ffb74d, #ffa726)"},movie:{pc:"linear-gradient(135deg, #ec4899, #f43f5e)",mobile:"linear-gradient(135deg, #f472b6, #fb7185)"},play:{pc:"linear-gradient(135deg, #ff6b35, #ff8c42)",mobile:"linear-gradient(135deg, #ff9657, #ffb74d)"},download:{pc:"linear-gradient(135deg, #ff6b35, #ff8c42)",mobile:"linear-gradient(135deg, #ff9657, #ffb74d)"},account_tree:{pc:"linear-gradient(135deg, #4f46e5, #7c3aed)",mobile:"linear-gradient(135deg, #6366f1, #8b5cf6)"}}[t];return a?r?a.mobile:a.pc:"linear-gradient(135deg, #667eea, #764ba2)"}setZoomLevel(t){t>=50&&t<=200&&(this.zoomLevel=t,localStorage.setItem("desk-zoom-level",t.toString()),this.cdr.detectChanges())}increaseZoom(){let t=Math.min(200,this.zoomLevel+5);this.zoomLevel=t,localStorage.setItem("desk-zoom-level",t.toString()),this.cdr.detectChanges()}decreaseZoom(){let t=Math.max(50,this.zoomLevel-5);this.zoomLevel=t,localStorage.setItem("desk-zoom-level",t.toString()),this.cdr.detectChanges()}resetZoom(){this.setZoomLevel(100)}getZoomTransform(){return`scale(${this.zoomLevel/100})`}toggleZoomDropdown(){this.showZoomDropdown=!this.showZoomDropdown}closeZoomDropdown(t){t.target.closest(".zoom-control")||(this.showZoomDropdown=!1)}onMouseWheel(t){if(!t.target.closest(".desktop-wallpaper"))return;t.preventDefault(),t.stopPropagation();let e=1,i=t.deltaY<0?Math.min(200,this.zoomLevel+e):Math.max(50,this.zoomLevel-e);this.zoomLevel=i,localStorage.setItem("desk-zoom-level",i.toString()),this.cdr.detectChanges()}getSafeUrl(t){if(!t)return this.sanitizer.bypassSecurityTrustResourceUrl("about:blank");let r=`${window.location.origin+window.location.pathname}#${t}`;return this.sanitizer.bypassSecurityTrustResourceUrl(r)}static \u0275fac=function(e){return new(e||n)(lt(ui),lt(Tr),lt(An),lt(Qo))};static \u0275cmp=yt({type:n,selectors:[["app-desktop"]],hostBindings:function(e,r){e&1&&re("click",function(a){return r.closeZoomDropdown(a)},Mo)("wheel",function(a){return r.onMouseWheel(a)})},standalone:!1,decls:3,vars:4,consts:[[1,"desktop-container"],[1,"mobile-blocked-screen"],[1,"menu-bar",3,"hidden"],[1,"desktop-wallpaper"],[1,"wallpaper-gradient"],[1,"wallpaper-orbs"],[1,"orb","orb-1"],[1,"orb","orb-2"],[1,"orb","orb-3"],[1,"orb","orb-4"],[1,"orb","orb-5"],[1,"wallpaper-overlay"],[1,"desktop-icons",3,"hidden"],[1,"windows-scale-container"],[1,"dock-container",3,"hidden"],[1,"menu-bar"],[1,"menu-bar-left"],[1,"brand-logo"],["viewBox","0 0 24 24","fill","none","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],[1,"brand-name"],[1,"breadcrumb-path"],[1,"menu-bar-right"],["title","\uCD5C\uC18C\uD654\uB41C \uCC3D",1,"minimized-count"],[1,"zoom-control"],["title","\uCD95\uC18C (Ctrl/Cmd + -)",1,"zoom-btn",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 12H4"],[1,"zoom-display"],[1,"zoom-value"],["title","\uC90C \uB808\uBCA8 \uC120\uD0DD",1,"zoom-dropdown-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 14l-7 7m0 0l-7-7m7 7V3"],[1,"zoom-dropdown"],["title","\uD655\uB300 (Ctrl/Cmd + +)",1,"zoom-btn",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"menu-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"menu-time"],[1,"breadcrumb-item"],[1,"breadcrumb-separator"],[1,"breadcrumb-item","active",3,"click"],[1,"breadcrumb-siblings"],[1,"breadcrumb-comma"],[1,"breadcrumb-sibling",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 8h16M4 16h16"],[1,"zoom-dropdown",3,"click"],[1,"zoom-option",3,"active"],[1,"zoom-separator"],[1,"zoom-option","reset-option",3,"click"],[1,"zoom-option",3,"click"],[1,"desktop-icons"],[1,"desktop-icon"],[1,"desktop-icon",3,"click"],[1,"desktop-icon-wrapper",2,"background","linear-gradient(135deg, #888, #666)"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"desktop-icon-label"],[1,"desktop-icon-wrapper"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",3,"innerHTML"],[1,"icon-folder-tag"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"],[3,"id","zIndex","isActive","metaData","folderType","isMobileApp","initialMaximized","zoomLevel"],[3,"moveToFront","close","minimizeWindow","maximizeChange","windowStyleChange","simulatorRequested","id","zIndex","isActive","metaData","folderType","isMobileApp","initialMaximized","zoomLevel"],[1,"dock-container"],[1,"dock"],[1,"dock-icon",3,"active"],[1,"dock-separator"],[1,"dock-icon","minimized-window"],[1,"dock-icon",3,"click"],[1,"icon-wrapper"],[1,"active-indicator"],[1,"dock-icon","minimized-window",3,"click"],[1,"icon-wrapper","minimized"],[1,"minimized-indicator"],[1,"blocked-content"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"blocked-icon"],["x","2","y","3","width","20","height","14","rx","2","ry","2","stroke-width","2"],["x1","8","y1","21","x2","16","y2","21","stroke-width","2"],["x1","12","y1","17","x2","12","y2","21","stroke-width","2"],[1,"blocked-title"],[1,"blocked-description"],[1,"blocked-hint"]],template:function(e,r){e&1&&(f(0,"div",0),ae(1,F_,15,5),ae(2,I_,12,0,"div",1),p()),e&2&&(ve("mobile-layout",r.isMobile),_(),oe(r.isMobile?-1:1),_(),oe(r.isMobile?2:-1))},dependencies:[na,ra],styles:['@charset "UTF-8";.desktop-container[_ngcontent-%COMP%]{width:100vw;height:100vh;height:100dvh;position:relative;overflow:hidden;background:#000;display:flex;flex-direction:column}.menu-bar[_ngcontent-%COMP%]{height:24px;background:#14141ed9;backdrop-filter:blur(30px) saturate(180%);-webkit-backdrop-filter:blur(30px) saturate(180%);display:flex;justify-content:space-between;align-items:center;padding:0 16px;color:#fff;font-size:13px;font-weight:400;z-index:10000;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 1px 3px #0003;position:relative;transition:transform .3s cubic-bezier(.4,0,.2,1)}.menu-bar.hidden[_ngcontent-%COMP%]{transform:translateY(-100%);height:0;padding:0;border:none;pointer-events:none;opacity:0}.menu-bar[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.1) 50%,transparent 100%)}.menu-bar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.apple-logo[_ngcontent-%COMP%]{width:16px;height:16px;display:flex;align-items:center;justify-content:center;cursor:pointer}.apple-logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}.apple-logo[_ngcontent-%COMP%]:hover{opacity:.7}.menu-item[_ngcontent-%COMP%]{cursor:pointer;padding:2px 8px;border-radius:4px;transition:background .2s}.menu-item[_ngcontent-%COMP%]:hover{background:#ffffff1a}.menu-item.active[_ngcontent-%COMP%]{font-weight:600}.menu-bar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.minimized-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:4px 10px;background:#ffc10726;border-radius:12px;cursor:default;transition:all .2s}.minimized-count[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px;stroke:#ffc107e6}.minimized-count[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#ffc107}.minimized-count[_ngcontent-%COMP%]:hover{background:#ffc10740}.zoom-control[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px 8px;background:#6496c81f;border:1px solid rgba(100,150,200,.25);border-radius:8px;position:relative}.zoom-control[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]{width:20px;height:20px;display:flex;align-items:center;justify-content:center;border:none;background:#6496c833;border-radius:4px;cursor:pointer;color:#fff;transition:all .2s;padding:0}.zoom-control[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:12px;height:12px;stroke-width:2.5}.zoom-control[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#6496c866;transform:scale(1.1)}.zoom-control[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95)}.zoom-control[_ngcontent-%COMP%]   .zoom-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;min-width:60px;justify-content:center;position:relative}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-value[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#ffffffe6;min-width:35px;text-align:center}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown-btn[_ngcontent-%COMP%]{width:16px;height:16px;padding:0;border:none;background:transparent;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#ffffffb3;transition:all .2s}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:10px;height:10px;stroke-width:2.5}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown-btn[_ngcontent-%COMP%]:hover{color:#fff;transform:scale(1.15)}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:50%;transform:translate(-50%);margin-top:6px;background:#141e32f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(100,150,200,.3);border-radius:8px;min-width:100px;box-shadow:0 8px 32px #0000004d;z-index:10001;overflow:hidden}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown[_ngcontent-%COMP%]   .zoom-option[_ngcontent-%COMP%]{padding:8px 16px;font-size:11px;color:#ffffffb3;cursor:pointer;transition:all .15s;text-align:center}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown[_ngcontent-%COMP%]   .zoom-option[_ngcontent-%COMP%]:hover{background:#6496c833;color:#fff}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown[_ngcontent-%COMP%]   .zoom-option.active[_ngcontent-%COMP%]{background:#6496c866;color:#fff;font-weight:600}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown[_ngcontent-%COMP%]   .zoom-option.reset-option[_ngcontent-%COMP%]{font-size:10px;color:#ff9664cc}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown[_ngcontent-%COMP%]   .zoom-option.reset-option[_ngcontent-%COMP%]:hover{background:#ff966426;color:#ffb478}.zoom-control[_ngcontent-%COMP%]   .zoom-display[_ngcontent-%COMP%]   .zoom-dropdown[_ngcontent-%COMP%]   .zoom-separator[_ngcontent-%COMP%]{height:1px;background:#6496c833;margin:4px 0}.brand-logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px 12px;border-radius:8px;transition:background .2s;cursor:pointer}.brand-logo[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;stroke:currentColor}.brand-logo[_ngcontent-%COMP%]   .brand-name[_ngcontent-%COMP%]{font-size:13px;font-weight:600;letter-spacing:.5px}.brand-logo[_ngcontent-%COMP%]:hover{background:#ffffff1a}.breadcrumb-path[_ngcontent-%COMP%]{display:flex;align-items:center;gap:0;padding:0 12px;font-size:12px}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-item[_ngcontent-%COMP%]{color:#fff;cursor:pointer;transition:color .2s;padding:2px 4px;border-radius:3px}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-item[_ngcontent-%COMP%]:hover:not(.active){color:#d4d4d8}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-item.active[_ngcontent-%COMP%]{color:#fbbf24;font-weight:600}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-separator[_ngcontent-%COMP%]{color:#6b7280;margin:0 8px}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-siblings[_ngcontent-%COMP%]{display:flex;align-items:center;gap:0}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-siblings[_ngcontent-%COMP%]   .breadcrumb-comma[_ngcontent-%COMP%]{color:#9ca3af;margin:0 4px}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-siblings[_ngcontent-%COMP%]   .breadcrumb-sibling[_ngcontent-%COMP%]{color:#9ca3af;cursor:pointer;transition:all .2s;font-size:12px;padding:2px 4px;border-radius:3px}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-siblings[_ngcontent-%COMP%]   .breadcrumb-sibling[_ngcontent-%COMP%]:hover{color:#d4d4d8}.breadcrumb-path[_ngcontent-%COMP%]   .breadcrumb-siblings[_ngcontent-%COMP%]   .breadcrumb-sibling.active[_ngcontent-%COMP%]{color:#fbbf24;font-weight:600}.menu-icon[_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer}.menu-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}.menu-icon[_ngcontent-%COMP%]:hover{opacity:.7}.menu-time[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.5px}.desktop-wallpaper[_ngcontent-%COMP%]{flex:1;position:relative;overflow:hidden;background:#0a0e27}.desktop-icons[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;display:grid;grid-template-columns:repeat(3,100px);gap:20px 30px;z-index:100;transition:opacity .3s ease,transform .3s ease}.desktop-icons.hidden[_ngcontent-%COMP%]{opacity:0;pointer-events:none;transform:translate(-20px)}.desktop-icon[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;-webkit-user-select:none;user-select:none;transition:all .2s ease}.desktop-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.desktop-icon[_ngcontent-%COMP%]:hover   .desktop-icon-label[_ngcontent-%COMP%]{text-shadow:0 0 8px rgba(255,255,255,.5)}.desktop-icon[_ngcontent-%COMP%]:hover   .desktop-icon-wrapper[_ngcontent-%COMP%]{box-shadow:0 8px 24px #00000080}.desktop-icon[_ngcontent-%COMP%]:active{transform:scale(.95)}.desktop-icon-wrapper[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:12px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000004d,inset 0 1px 1px #fff3;transition:all .2s}.desktop-icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:36px;height:36px;stroke:#fff;stroke-width:2;filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}.desktop-icon-label[_ngcontent-%COMP%]{font-size:12px;color:#ffffffe6;text-align:center;max-width:90px;word-break:break-word;line-height:1.3;transition:text-shadow .2s;text-shadow:0 1px 3px rgba(0,0,0,.5)}.desktop-icon-label[_ngcontent-%COMP%]   .icon-folder-tag[_ngcontent-%COMP%]{display:block;font-size:9px;opacity:.7;margin-top:2px;font-weight:500}.windows-scale-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:center top;transition:transform .3s ease-out}.wallpaper-gradient[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(ellipse at top left,rgba(94,114,228,.4) 0%,transparent 50%),radial-gradient(ellipse at top right,rgba(147,51,234,.4) 0%,transparent 50%),radial-gradient(ellipse at bottom left,rgba(59,130,246,.4) 0%,transparent 50%),radial-gradient(ellipse at bottom right,rgba(236,72,153,.4) 0%,transparent 50%),linear-gradient(135deg,#1e3a8a,#312e81,#581c87,#831843,#1e40af);filter:blur(0)}.wallpaper-orbs[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}.orb[_ngcontent-%COMP%]{position:absolute;border-radius:50%;filter:blur(80px);opacity:.6;animation:_ngcontent-%COMP%_float 20s ease-in-out infinite;mix-blend-mode:screen}.orb-1[_ngcontent-%COMP%]{width:500px;height:500px;background:radial-gradient(circle,rgba(99,102,241,.8) 0%,transparent 70%);top:-10%;left:-10%;animation-delay:0s;animation-duration:25s}.orb-2[_ngcontent-%COMP%]{width:600px;height:600px;background:radial-gradient(circle,rgba(168,85,247,.7) 0%,transparent 70%);top:20%;right:-15%;animation-delay:-5s;animation-duration:30s}.orb-3[_ngcontent-%COMP%]{width:450px;height:450px;background:radial-gradient(circle,rgba(59,130,246,.6) 0%,transparent 70%);bottom:-10%;left:20%;animation-delay:-10s;animation-duration:28s}.orb-4[_ngcontent-%COMP%]{width:550px;height:550px;background:radial-gradient(circle,rgba(236,72,153,.7) 0%,transparent 70%);bottom:10%;right:10%;animation-delay:-15s;animation-duration:35s}.orb-5[_ngcontent-%COMP%]{width:400px;height:400px;background:radial-gradient(circle,rgba(147,197,253,.5) 0%,transparent 70%);top:50%;left:50%;transform:translate(-50%,-50%);animation-delay:-20s;animation-duration:32s}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translate(0) scale(1)}25%{transform:translate(30px,-30px) scale(1.1)}50%{transform:translate(-20px,20px) scale(.95)}75%{transform:translate(20px,30px) scale(1.05)}}.wallpaper-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:repeating-linear-gradient(0deg,rgba(255,255,255,.03) 0px,transparent 1px,transparent 2px,rgba(255,255,255,.03) 3px),repeating-linear-gradient(90deg,rgba(255,255,255,.03) 0px,transparent 1px,transparent 2px,rgba(255,255,255,.03) 3px);pointer-events:none;opacity:.3}.dock-container[_ngcontent-%COMP%]{position:fixed;bottom:8px;left:50%;transform:translate(-50%);z-index:9999;pointer-events:none;transition:transform .4s cubic-bezier(.4,0,.2,1)}.dock-container.hidden[_ngcontent-%COMP%]{transform:translate(-50%,150%)}.dock[_ngcontent-%COMP%]{background:#ffffff1f;backdrop-filter:blur(40px) saturate(200%);-webkit-backdrop-filter:blur(40px) saturate(200%);border:1px solid rgba(255,255,255,.25);border-radius:20px;padding:8px;display:flex;gap:8px;align-items:flex-end;box-shadow:0 12px 48px #0006,0 0 0 1px #ffffff1a inset,0 2px 4px #fff3 inset;pointer-events:all;position:relative}.dock[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(180deg,#ffffff26,#ffffff0d,#ffffff05);border-radius:20px;pointer-events:none}.dock-icon[_ngcontent-%COMP%]{position:relative;cursor:pointer;transition:transform .2s cubic-bezier(.34,1.56,.64,1);transform-origin:bottom}.dock-icon[_ngcontent-%COMP%]:hover{transform:translateY(-12px) scale(1.2)}.dock-icon[_ngcontent-%COMP%]:hover:before{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translate(-50%) translateY(-8px);background:#000c;color:#fff;padding:4px 12px;border-radius:6px;font-size:11px;white-space:nowrap;pointer-events:none;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.dock-icon[_ngcontent-%COMP%]:active{transform:scale(.95)}.dock-icon[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:14px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000004d,inset 0 1px 1px #ffffff4d;transition:box-shadow .2s}.dock-icon[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:32px;height:32px;stroke:#fff;stroke-width:2;filter:drop-shadow(0 2px 4px rgba(0,0,0,.2))}.dock-icon[_ngcontent-%COMP%]:hover   .icon-wrapper[_ngcontent-%COMP%]{box-shadow:0 6px 20px #0006,inset 0 1px 1px #fff6}.dock-icon[_ngcontent-%COMP%]   .active-indicator[_ngcontent-%COMP%]{width:4px;height:4px;background:#ffffffe6;border-radius:50%;position:absolute;bottom:-2px;left:50%;transform:translate(-50%);box-shadow:0 0 4px #fffc}.dock-icon.minimized-window[_ngcontent-%COMP%]   .icon-wrapper.minimized[_ngcontent-%COMP%]{opacity:.7;position:relative}.dock-icon.minimized-window[_ngcontent-%COMP%]   .icon-wrapper.minimized[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;border-radius:14px;background:#0000004d;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.dock-icon.minimized-window[_ngcontent-%COMP%]   .icon-wrapper.minimized[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;z-index:1}.dock-icon.minimized-window[_ngcontent-%COMP%]:hover   .icon-wrapper.minimized[_ngcontent-%COMP%]{opacity:.9}.dock-icon[_ngcontent-%COMP%]   .minimized-indicator[_ngcontent-%COMP%]{width:6px;height:6px;background:#ffc107e6;border-radius:50%;position:absolute;bottom:-2px;left:50%;transform:translate(-50%);box-shadow:0 0 6px #ffc107cc;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1;transform:translate(-50%) scale(1)}50%{opacity:.6;transform:translate(-50%) scale(1.2)}}.dock-separator[_ngcontent-%COMP%]{width:1px;height:48px;background:linear-gradient(to bottom,transparent,rgba(255,255,255,.2) 20%,rgba(255,255,255,.2) 80%,transparent);margin:0 4px;align-self:center}@media (max-width: 768px){.menu-bar[_ngcontent-%COMP%]{font-size:11px;padding:0 8px}.menu-bar-left[_ngcontent-%COMP%]{gap:12px}.menu-item[_ngcontent-%COMP%]{display:none}.menu-item.active[_ngcontent-%COMP%]{display:block}.dock[_ngcontent-%COMP%]{padding:6px;gap:6px;border-radius:16px}.dock-icon[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px}.dock-icon[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:28px;height:28px}.dock-icon[_ngcontent-%COMP%]:hover{transform:translateY(-8px) scale(1.15)}}@media (min-width: 769px) and (max-width: 1024px){.dock-icon[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:52px;height:52px}}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ffffff4d;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff80}.desktop-container.mobile-layout[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;min-height:100dvh;max-height:100vh;max-height:100dvh}.mobile-statusbar[_ngcontent-%COMP%]{height:44px;flex-shrink:0;background:#000c;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);display:flex;justify-content:space-between;align-items:center;padding:0 20px;color:#fff;font-size:14px;position:relative;z-index:1000}.mobile-statusbar[_ngcontent-%COMP%]   .statusbar-left[_ngcontent-%COMP%], .mobile-statusbar[_ngcontent-%COMP%]   .statusbar-right[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center}.mobile-statusbar[_ngcontent-%COMP%]   .statusbar-right[_ngcontent-%COMP%]{justify-content:flex-end;gap:8px}.mobile-statusbar[_ngcontent-%COMP%]   .statusbar-center[_ngcontent-%COMP%]{flex:0 0 auto}.mobile-statusbar[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-weight:600;font-size:15px}.mobile-statusbar[_ngcontent-%COMP%]   .notch[_ngcontent-%COMP%]{width:120px;height:28px;background:#000;border-radius:0 0 16px 16px}.mobile-statusbar[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{width:24px;height:24px;stroke-width:2}.mobile-content[_ngcontent-%COMP%]{flex:1;min-height:0;position:relative;overflow:hidden;background:linear-gradient(135deg,#667eea,#764ba2)}.home-screen[_ngcontent-%COMP%]{width:100%;height:100%;max-height:100%;position:relative;overflow:hidden;background:#000;background-size:cover;background-position:center;background-repeat:no-repeat;display:flex;flex-direction:column}.blur-background[_ngcontent-%COMP%]{display:none}.widget-area[_ngcontent-%COMP%]{position:relative;padding:60px 24px 20px;z-index:2;flex-shrink:0}.time-widget-ios[_ngcontent-%COMP%]{background:#ffffff05;backdrop-filter:blur(12px) saturate(110%);-webkit-backdrop-filter:blur(12px) saturate(110%);border-radius:28px;padding:24px;border:.5px solid rgba(255,255,255,.1);box-shadow:0 2px 8px #1f26870d,inset 0 1px #ffffff1a}.time-widget-ios[_ngcontent-%COMP%]   .time-display[_ngcontent-%COMP%]{font-size:56px;font-weight:200;color:#fff;letter-spacing:-1.5px;line-height:1;margin-bottom:4px;font-variant-numeric:tabular-nums;text-shadow:0 3px 16px rgba(0,0,0,.5)}.time-widget-ios[_ngcontent-%COMP%]   .date-display[_ngcontent-%COMP%]{font-size:17px;font-weight:500;color:#fffffff2;letter-spacing:-.3px;text-shadow:0 2px 8px rgba(0,0,0,.4)}.apps-container[_ngcontent-%COMP%]{position:relative;padding:20px 24px 140px;flex:1;min-height:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;z-index:2;padding-bottom:calc(140px + env(safe-area-inset-bottom,0px))}.apps-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.apps-grid-ios[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:24px 16px;padding:0 0 20px;min-height:min-content}.app-icon-ios[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;transition:transform .2s cubic-bezier(.175,.885,.32,1.275)}.app-icon-ios[_ngcontent-%COMP%]:active{transform:scale(.85)}.app-icon-ios[_ngcontent-%COMP%]:active   .icon-background[_ngcontent-%COMP%]{background:#ffffff0d;box-shadow:0 1px 6px #00000014,inset 0 1px #ffffff14}.icon-background[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:16px;display:flex;align-items:center;justify-content:center;background:#ffffff05;backdrop-filter:blur(10px) saturate(110%);-webkit-backdrop-filter:blur(10px) saturate(110%);border:.5px solid rgba(255,255,255,.1);box-shadow:0 2px 8px #0000001a,inset 0 1px #ffffff1a;transition:all .2s ease;position:relative}.icon-background[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(180deg,rgba(255,255,255,.1) 0%,rgba(255,255,255,.05) 50%,transparent 100%);border-radius:16px 16px 0 0;pointer-events:none}.icon-background[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:32px;height:32px;stroke-width:2;filter:drop-shadow(0 2px 6px rgba(0,0,0,.5));position:relative;z-index:1}.icon-label-ios[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#fff;text-align:center;max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 2px 8px rgba(0,0,0,.8),0 1px 2px rgb(0,0,0),0 0 1px rgb(0,0,0);letter-spacing:-.2px;background:linear-gradient(180deg,#00000026,#0000001a);backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);padding:4px 8px;border-radius:8px;margin-top:2px;border:.5px solid rgba(255,255,255,.08)}.dock-ios[_ngcontent-%COMP%]{position:absolute;bottom:24px;bottom:max(24px,env(safe-area-inset-bottom));left:50%;transform:translate(-50%);width:calc(100% - 48px);max-width:380px;z-index:10;padding:0 8px}.dock-background[_ngcontent-%COMP%]{position:absolute;inset:0;background:#ffffff08;backdrop-filter:blur(12px) saturate(110%);-webkit-backdrop-filter:blur(12px) saturate(110%);border-radius:24px;border:.5px solid rgba(255,255,255,.12);box-shadow:0 2px 12px #0000001a,inset 0 1px #ffffff1f}.dock-icons[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-around;align-items:flex-start;padding:12px 8px 8px;gap:8px}.dock-icon-ios[_ngcontent-%COMP%]{cursor:pointer;transition:transform .2s cubic-bezier(.175,.885,.32,1.275);display:flex;flex-direction:column;align-items:center;gap:6px}.dock-icon-ios[_ngcontent-%COMP%]:active{transform:scale(.85)}.dock-icon-bg[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:16px;display:flex;align-items:center;justify-content:center;background:#ffffff05;backdrop-filter:blur(10px) saturate(110%);-webkit-backdrop-filter:blur(10px) saturate(110%);border:.5px solid rgba(255,255,255,.1);box-shadow:0 2px 8px #0000001a,inset 0 1px #ffffff1a;position:relative}.dock-icon-bg[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(180deg,rgba(255,255,255,.1) 0%,rgba(255,255,255,.05) 50%,transparent 100%);border-radius:16px 16px 0 0;pointer-events:none}.dock-icon-bg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:32px;height:32px;stroke-width:2;filter:drop-shadow(0 2px 6px rgba(0,0,0,.5));position:relative;z-index:1}.dock-label-ios[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#fff;text-align:center;max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 2px 8px rgba(0,0,0,.8),0 1px 2px rgb(0,0,0),0 0 1px rgb(0,0,0);letter-spacing:-.2px;background:linear-gradient(180deg,#00000026,#0000001a);backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);padding:3px 7px;border-radius:6px;border:.5px solid rgba(255,255,255,.08)}.page-dots[_ngcontent-%COMP%]{position:absolute;bottom:105px;bottom:calc(105px + env(safe-area-inset-bottom,0px));left:50%;transform:translate(-50%);display:flex;gap:8px;z-index:10}.page-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:7px;height:7px;border-radius:50%;background:#fff6;transition:all .3s ease}.page-dots[_ngcontent-%COMP%]   .dot.active[_ngcontent-%COMP%]{background:#fff;width:7px}.home-indicator-ios[_ngcontent-%COMP%]{position:absolute;bottom:8px;bottom:max(8px,env(safe-area-inset-bottom));left:50%;transform:translate(-50%);width:140px;height:5px;background:#ffffff80;border-radius:3px;box-shadow:0 0 10px #0000001a;z-index:10}.app-viewer[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;background:#f5f5f7}.app-viewer.fullscreen[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;padding:0}.app-viewer.fullscreen[_ngcontent-%COMP%]   .app-slider[_ngcontent-%COMP%], .app-viewer.fullscreen[_ngcontent-%COMP%]   .app-slide[_ngcontent-%COMP%]{height:100%}.app-slider[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}.app-slide[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#fff;transition:transform .3s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column}.app-slide.active[_ngcontent-%COMP%]{z-index:10}.app-header[_ngcontent-%COMP%]{padding:8px 16px;background:linear-gradient(135deg,#667eea0d,#764ba20d);display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(0,0,0,.05);position:relative;min-height:56px;max-height:56px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.back-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#0000000d;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;flex-shrink:0}.back-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;stroke:#1d1d1f;stroke-width:2}.back-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#0000001a}.minimize-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#ffcc00e6;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;flex-shrink:0;box-shadow:0 2px 6px #0000001a}.minimize-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;stroke:#fff;stroke-width:2.5}.minimize-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#fc0}.fullscreen-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#34c759e6;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;flex-shrink:0;box-shadow:0 2px 6px #0000001a}.fullscreen-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;stroke:#fff;stroke-width:2.5}.fullscreen-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#34c759}.floating-exit-fullscreen[_ngcontent-%COMP%]{position:fixed;top:16px;right:16px;width:44px;height:44px;border:none;background:#ff3b30f2;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10000;box-shadow:0 4px 12px #ff3b3066,0 2px 4px #0003;transition:all .2s}.floating-exit-fullscreen[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;stroke:#fff;stroke-width:3}.floating-exit-fullscreen[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 16px #ff3b3080,0 2px 4px #0000004d}.floating-exit-fullscreen[_ngcontent-%COMP%]:active{transform:scale(.95)}.app-icon-small[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px #0000001f,inset 0 1px 1px #ffffff4d;flex-shrink:0}.app-icon-small[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;stroke:#fff;stroke-width:2}.app-icon-large[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:16px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #00000026,inset 0 1px 1px #ffffff4d}.app-icon-large[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:36px;height:36px;stroke:#fff;stroke-width:2}.app-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1d1d1f;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.app-body[_ngcontent-%COMP%]{flex:1;overflow:auto;position:relative;-webkit-overflow-scrolling:touch}.app-body[_ngcontent-%COMP%]   .app-iframe[_ngcontent-%COMP%]{width:100%;height:100%;border:none;display:block;overflow:auto}.app-body[_ngcontent-%COMP%]   .app-placeholder[_ngcontent-%COMP%]{text-align:center;color:#86868b;font-size:16px;margin-top:40px;padding:20px}.app-switcher[_ngcontent-%COMP%]{position:fixed;inset:0;background:linear-gradient(135deg,#667eeaf2,#764ba2f2);z-index:3000;display:flex;flex-direction:column;padding:60px 20px 20px;animation:_ngcontent-%COMP%_fadeIn .2s;overflow:hidden}.switcher-header[_ngcontent-%COMP%]{margin-bottom:20px}.switcher-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#fff;margin:0;text-shadow:0 2px 10px rgba(0,0,0,.2)}.switcher-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:16px;padding-bottom:20px}.no-apps[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center}.no-apps[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fffc;font-size:16px;text-align:center}.app-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 8px 24px #0003;cursor:pointer;transition:all .3s;position:relative}.app-card[_ngcontent-%COMP%]:active{transform:scale(.98)}.card-close-btn[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;width:32px;height:32px;border:none;background:#0009;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;transition:all .2s}.card-close-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px;stroke:#fff;stroke-width:2.5}.card-close-btn[_ngcontent-%COMP%]:active{transform:scale(.9);background:#000c}.card-preview[_ngcontent-%COMP%]{padding:16px}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px}.card-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #00000026,inset 0 1px 1px #ffffff4d}.card-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:28px;height:28px;stroke:#fff;stroke-width:2}.card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1d1d1f;margin:0}.card-content[_ngcontent-%COMP%]{background:#f5f5f7;border-radius:8px;padding:20px;min-height:100px;display:flex;align-items:center;justify-content:center}.card-placeholder[_ngcontent-%COMP%]{color:#86868b;font-size:14px;text-align:center;margin:0}.switcher-hint[_ngcontent-%COMP%]{padding:16px;text-align:center}.switcher-hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#ffffffe6;font-size:13px;margin:0;font-weight:500;text-shadow:0 1px 3px rgba(0,0,0,.2)}.app-drawer-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:2000;display:flex;align-items:flex-end;animation:_ngcontent-%COMP%_fadeIn .3s}.app-drawer[_ngcontent-%COMP%]{width:100%;max-height:70vh;background:#fff;border-radius:20px 20px 0 0;padding:20px;animation:_ngcontent-%COMP%_slideUp .3s cubic-bezier(.4,0,.2,1)}.drawer-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid rgba(0,0,0,.1)}.drawer-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#1d1d1f;margin:0}.drawer-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#0000000d;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}.drawer-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;stroke:#1d1d1f;stroke-width:2}.drawer-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#0000001a}.drawer-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;overflow-y:auto;max-height:calc(70vh - 100px);padding-bottom:20px}.drawer-app[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer}.drawer-app[_ngcontent-%COMP%]:active{transform:scale(.95)}.drawer-icon[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:14px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #00000026,inset 0 1px 1px #ffffff4d}.drawer-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:32px;height:32px;stroke:#fff;stroke-width:2}.drawer-label[_ngcontent-%COMP%]{font-size:12px;color:#1d1d1f;text-align:center;font-weight:500}.minimized-apps-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000b3;z-index:3500;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.minimized-slider[_ngcontent-%COMP%]{width:90%;max-width:400px;height:70vh;background:linear-gradient(180deg,#fffffffa,#f8f9faf5);border-radius:24px;padding:20px;box-shadow:0 20px 60px #0000004d;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_slideUpScale .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.slider-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid rgba(0,0,0,.08)}.slider-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#1a1a1a;margin:0}.close-slider-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#0000000d;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}.close-slider-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;stroke:#1d1d1f;stroke-width:2}.close-slider-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#0000001a}.slider-container[_ngcontent-%COMP%]{flex:1;position:relative;overflow:hidden}.minimized-slide[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;transition:transform .3s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column}.minimized-slide.active[_ngcontent-%COMP%]{z-index:1}.screenshot-preview[_ngcontent-%COMP%]{flex:1;background:linear-gradient(135deg,#667eea14,#764ba214);border-radius:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;position:relative;border:2px solid rgba(102,126,234,.15);overflow:hidden}.screenshot-preview[_ngcontent-%COMP%]:hover{border-color:#667eea4d}.screenshot-preview[_ngcontent-%COMP%]:active{transform:scale(.98);background:linear-gradient(135deg,#667eea1f,#764ba21f)}.quick-close-btn[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;width:32px;height:32px;border:none;background:#ff3b30f2;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;box-shadow:0 2px 8px #ff3b304d;transition:all .2s}.quick-close-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;stroke:#fff;stroke-width:2.5}.quick-close-btn[_ngcontent-%COMP%]:hover{background:#ff3b30;transform:scale(1.05)}.quick-close-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.screenshot-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;pointer-events:none}.preview-icon-large[_ngcontent-%COMP%]{width:140px;height:140px;border-radius:28px;display:flex;align-items:center;justify-content:center;box-shadow:0 12px 32px #00000040,inset 0 2px 4px #ffffff4d}.preview-icon-large[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:72px;height:72px;stroke:#fff;stroke-width:2}.app-name[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1d1d1f;margin:0;text-align:center}.restore-hint[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:50%;transform:translate(-50%);font-size:14px;color:#007aff;font-weight:600;background:#fffffff2;padding:10px 20px;border-radius:16px;box-shadow:0 4px 12px #00000026;pointer-events:none}.slide-indicators[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:8px;padding:16px 0 8px}.indicator-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#0003;cursor:pointer;transition:all .2s}.indicator-dot.active[_ngcontent-%COMP%]{width:24px;border-radius:4px;background:#007aff}.indicator-dot[_ngcontent-%COMP%]:hover:not(.active){background:#0000004d}.nav-btn[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);width:40px;height:40px;border:none;background:#fffffff2;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 4px 12px #00000026;transition:all .2s;z-index:10}.nav-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;stroke:#1d1d1f;stroke-width:2.5}.nav-btn.prev-btn[_ngcontent-%COMP%]{left:-50px}.nav-btn.next-btn[_ngcontent-%COMP%]{right:-50px}.nav-btn[_ngcontent-%COMP%]:active:not(.disabled){transform:translateY(-50%) scale(.95)}.nav-btn.disabled[_ngcontent-%COMP%]{opacity:.3;cursor:not-allowed}.minimized-apps-icon[_ngcontent-%COMP%]{position:relative;width:24px;height:24px;cursor:pointer;margin-right:8px}.minimized-apps-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;stroke:#fff}.minimized-apps-icon[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:-4px;min-width:16px;height:16px;background:#ff3b30;color:#fff;font-size:10px;font-weight:700;border-radius:8px;display:flex;align-items:center;justify-content:center;padding:0 4px;box-shadow:0 2px 4px #ff3b3066}@keyframes _ngcontent-%COMP%_slideUpScale{0%{transform:translateY(20px) scale(.95);opacity:0}to{transform:translateY(0) scale(1);opacity:1}}.card-minimize-btn[_ngcontent-%COMP%]{position:absolute;top:8px;right:40px;width:32px;height:32px;border:none;background:#ffcc00f2;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;box-shadow:0 2px 8px #00000026;transition:all .2s ease}.card-minimize-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;stroke:#fff;stroke-width:2.5}.card-minimize-btn[_ngcontent-%COMP%]:active{transform:scale(.9);background:#fc0}@media (max-width: 767px){.desktop-container.mobile-layout[_ngcontent-%COMP%]   .menu-bar[_ngcontent-%COMP%], .desktop-container.mobile-layout[_ngcontent-%COMP%]   .desktop-wallpaper[_ngcontent-%COMP%], .desktop-container.mobile-layout[_ngcontent-%COMP%]   .dock-container[_ngcontent-%COMP%]{display:none}}@media (max-width: 767px) and (max-height: 667px){.widget-area[_ngcontent-%COMP%]{padding:40px 20px 12px}.time-widget-ios[_ngcontent-%COMP%]{padding:16px;border-radius:20px}.time-widget-ios[_ngcontent-%COMP%]   .time-display[_ngcontent-%COMP%]{font-size:42px}.time-widget-ios[_ngcontent-%COMP%]   .date-display[_ngcontent-%COMP%]{font-size:14px}.apps-container[_ngcontent-%COMP%]{padding:12px 20px;margin-bottom:120px}.apps-grid-ios[_ngcontent-%COMP%]{gap:18px 12px}.app-icon-ios[_ngcontent-%COMP%]{gap:6px}.icon-background[_ngcontent-%COMP%]{width:54px;height:54px;border-radius:14px}.icon-background[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:28px;height:28px}.icon-label-ios[_ngcontent-%COMP%]{font-size:11px}.dock-ios[_ngcontent-%COMP%]{bottom:24px}.dock-icon-bg[_ngcontent-%COMP%]{width:54px;height:54px}.dock-icon-bg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:28px;height:28px}.page-dots[_ngcontent-%COMP%]{bottom:95px}}@media (max-width: 767px) and (min-height: 668px) and (max-height: 736px){.widget-area[_ngcontent-%COMP%]{padding:50px 22px 16px}.apps-container[_ngcontent-%COMP%]{padding:16px 22px;margin-bottom:130px}.apps-grid-ios[_ngcontent-%COMP%]{gap:20px 14px}}@media (max-width: 767px) and (min-height: 737px){.widget-area[_ngcontent-%COMP%]{padding:60px 24px 20px}.apps-container[_ngcontent-%COMP%]{padding:20px 24px;margin-bottom:140px}}@media (max-width: 767px) and (min-height: 844px){.time-widget-ios[_ngcontent-%COMP%]   .time-display[_ngcontent-%COMP%]{font-size:64px}.time-widget-ios[_ngcontent-%COMP%]   .date-display[_ngcontent-%COMP%]{font-size:18px}.apps-grid-ios[_ngcontent-%COMP%]{gap:28px 18px}.icon-background[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:17px}.icon-background[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:36px;height:36px}.dock-icon-bg[_ngcontent-%COMP%]{width:64px;height:64px}.dock-icon-bg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:36px;height:36px}}@media (min-width: 768px) and (max-width: 1023px){.mobile-content[_ngcontent-%COMP%]{padding:0 40px}.drawer-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(6,1fr)}.tabbar-content[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.apps-grid-ios[_ngcontent-%COMP%]{grid-template-columns:repeat(6,1fr);gap:32px 24px}.dock-ios[_ngcontent-%COMP%]{max-width:500px}}@media (max-width: 767px) and (orientation: landscape){.widget-area[_ngcontent-%COMP%]{padding:30px 20px 10px}.time-widget-ios[_ngcontent-%COMP%]{padding:16px}.time-widget-ios[_ngcontent-%COMP%]   .time-display[_ngcontent-%COMP%]{font-size:40px}.time-widget-ios[_ngcontent-%COMP%]   .date-display[_ngcontent-%COMP%]{font-size:13px}.apps-container[_ngcontent-%COMP%]{padding:10px 20px;margin-bottom:100px}.apps-grid-ios[_ngcontent-%COMP%]{grid-template-columns:repeat(6,1fr);gap:16px 12px}.icon-background[_ngcontent-%COMP%], .dock-icon-bg[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:13px}.icon-background[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .dock-icon-bg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:26px;height:26px}.dock-ios[_ngcontent-%COMP%]{bottom:20px}.dock-ios[_ngcontent-%COMP%]   .dock-icons[_ngcontent-%COMP%]{padding:10px 8px}.page-dots[_ngcontent-%COMP%]{bottom:80px}}.mobile-blocked-screen[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);flex-direction:column;padding:20px}.blocked-content[_ngcontent-%COMP%]{text-align:center;max-width:400px;animation:_ngcontent-%COMP%_slideUp .5s ease-out;display:flex;flex-direction:column;align-items:center}.blocked-icon[_ngcontent-%COMP%]{width:80px;height:80px;stroke:#fff;stroke-width:1.5;margin:0 auto 24px;opacity:.9;animation:_ngcontent-%COMP%_scaleIn .6s ease-out .1s both}.blocked-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#fff;margin-bottom:16px;animation:_ngcontent-%COMP%_fadeIn .6s ease-out .2s both}.blocked-description[_ngcontent-%COMP%]{font-size:16px;color:#ffffffd9;margin-bottom:12px;line-height:1.6;animation:_ngcontent-%COMP%_fadeIn .6s ease-out .3s both}.blocked-hint[_ngcontent-%COMP%]{font-size:14px;color:#ffffffb3;line-height:1.6;animation:_ngcontent-%COMP%_fadeIn .6s ease-out .4s both}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_scaleIn{0%{opacity:0;transform:scale(.8)}to{opacity:.9;transform:scale(1)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.control-button[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;border:.5px solid rgba(0,0,0,.15);cursor:pointer;display:flex;align-items:center;justify-content:center;padding:0;transition:all .15s ease;position:relative;box-shadow:0 1px 2px #00000026,inset 0 1px #fff6;background:transparent}.control-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:6px;height:6px;opacity:0;transition:opacity .15s ease}.control-button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{opacity:1!important}.control-button.close[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff6057,#ff5f56)}.control-button.close[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ff4b42,#ff3b30);box-shadow:0 2px 4px #ff3b3066,inset 0 1px #ffffff80}.control-button.close[_ngcontent-%COMP%]:active{background:linear-gradient(135deg,#d93025,#c9211e)}.control-button.minimize[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffbd2e,#ffbc2d)}.control-button.minimize[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ffb01f,#ffa900);box-shadow:0 2px 4px #ffa90066,inset 0 1px #ffffff80}.control-button.minimize[_ngcontent-%COMP%]:active{background:linear-gradient(135deg,#e09b00,#d08800)}.control-button.maximize[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28ca42,#27c93f)}.control-button.maximize[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#20b038,#1fa832);box-shadow:0 2px 4px #1fa83266,inset 0 1px #ffffff80}.control-button.maximize[_ngcontent-%COMP%]:active{background:linear-gradient(135deg,#1a9930,#178528)}']})};var R_=[{path:"",component:ia}],aa=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=pi({type:n});static \u0275inj=oi({imports:[va.forChild(R_),va]})};var M0=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=pi({type:n});static \u0275inj=oi({providers:[Tr,Wt],imports:[hi,Vo,Lo,Ko,aa,es,ts,Zo,Er]})};export{M0 as DeskModule};

import{a as ri,b as si,c as ci,d as li,e as Fe,g as di,h as pi,i as mi,j as ui,k as gi,l as fi,m as Ci,n as hi}from"./chunk-FAUSCL75.js";import{b as ai}from"./chunk-CHKLNUEY.js";import{b as oi}from"./chunk-XSMVTOWT.js";import{a as Zn,b as ei,c as ti,f as ni,h as ii}from"./chunk-VH46QHVT.js";import{a as St,b as Ot,c as Kn}from"./chunk-CNFBLV2T.js";import{b as qn,c as Yn,d as Gn}from"./chunk-M67LP46D.js";import{a as fn}from"./chunk-GW37IABN.js";import{a as Jn}from"./chunk-MF4Y76YC.js";import{a as yt,b as Pt,c as Ke,d as Hn}from"./chunk-OA4LYHC4.js";import{a as _e,b as Dt}from"./chunk-EKK6ZDMS.js";import{a as Xn}from"./chunk-SHYEF5ZL.js";import{c as Et}from"./chunk-LDRAMSE2.js";import"./chunk-MXPUJXMB.js";import{a as gn}from"./chunk-4DRAGH36.js";import{a as q,b as xt}from"./chunk-UGODGDG6.js";import{m as Wn}from"./chunk-2INUU37C.js";import"./chunk-F6ZRSYO5.js";import{e as de}from"./chunk-KDSCINN4.js";import"./chunk-HF4QSGZE.js";import{e as vt,i as Mt,j as Qn}from"./chunk-4OO3YKNZ.js";import"./chunk-7VYLHDWE.js";import"./chunk-GFYKK2KX.js";import{b as wt}from"./chunk-VALJVDL3.js";import{b as V,d as Ae,e as _t,f as Un,i as F,j as Te,p as R,q as Le}from"./chunk-OF2RMJHW.js";import{a as N,b as Ie}from"./chunk-LCTB47CK.js";import{a as Ne,b as Je,c as ht,e as K,f as X,g as Z,h as bt}from"./chunk-ACTHFZSI.js";import{W as zn,qa as ae,sa as A,ta as $n,va as Be}from"./chunk-TCIPLG6L.js";import{E as Ge,F as jn,c as W,h as U,m as Q,o as Rn}from"./chunk-BTFORE5L.js";import{b as Ct,c as Vn,d as L,g as un}from"./chunk-IQHB6EBY.js";import{$,Bb as Nn,Cb as Bn,Db as ut,Eb as y,F as vn,Gb as p,H as mt,Ia as Sn,Ib as u,Jb as In,Kb as An,La as On,Ma as pn,Mb as ee,Na as l,Nb as te,Ob as ne,Qc as Ye,Ra as _,Rc as xe,Sb as ue,Ta as He,Tb as Tn,Ub as J,Uc as ft,Xb as r,Ya as g,Yb as h,Za as be,Zb as x,_a as En,_b as ce,a as Qe,aa as he,ab as k,bc as P,c as pt,cb as j,cc as D,da as le,dc as S,dd as ke,ea as v,eb as kn,f as dn,g as Oe,ha as f,hc as Pe,ia as C,ja as Mn,jc as Ln,k as st,ka as wn,kc as gt,la as yn,lc as mn,md as Fn,oa as Pn,ob as O,pb as E,qb as Ee,sb as re,tb as se,ub as d,vb as i,wb as o,x as _n,xa as I,xb as M,za as Dn,zc as qe}from"./chunk-KCIJXSXQ.js";import{a as oe,b as Ue,h as z}from"./chunk-WWX6BADO.js";var ve=class a{constructor(t,e){this.router=t;this.debugLogger=e;let n=this.loadUserFromStorage();this.currentUserSubject=new Oe(n),this.currentUser$=this.currentUserSubject.asObservable()}STORAGE_KEY="expedition_auth_user";ADMIN_USERNAME=fn.decrypt(gn.auth.username);ADMIN_PASSWORD=fn.decrypt(gn.auth.password);currentUserSubject;currentUser$;loadUserFromStorage(){try{let t=localStorage.getItem(this.STORAGE_KEY);if(t){let e=JSON.parse(t);return e.loginTime=new Date(e.loginTime),e}}catch(t){console.warn("Failed to load user from storage",t)}return null}saveUserToStorage(t){try{t?localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)):localStorage.removeItem(this.STORAGE_KEY)}catch(e){console.warn("Failed to save user to storage",e)}}login(t,e){if(this.debugLogger.info("ExpeditionAuth","login \uD638\uCD9C\uB428"),this.debugLogger.info("ExpeditionAuth",`\uC785\uB825 username: ${t}`),t===this.ADMIN_USERNAME&&e===this.ADMIN_PASSWORD){this.debugLogger.success("ExpeditionAuth","\u2705 \uC778\uC99D \uC131\uACF5!");let n={username:this.ADMIN_USERNAME,loginTime:new Date};return this.currentUserSubject.next(n),this.saveUserToStorage(n),this.debugLogger.info("ExpeditionAuth",`\uC800\uC7A5 \uC644\uB8CC - isLoggedIn: ${this.isLoggedIn()}`),!0}return this.debugLogger.error("ExpeditionAuth","\u274C \uC778\uC99D \uC2E4\uD328"),!1}logout(){console.log("[ExpeditionAuth] \uB85C\uADF8\uC544\uC6C3");try{this.currentUserSubject.next(null),this.saveUserToStorage(null)}catch(t){console.error("[ExpeditionAuth] \uB85C\uADF8\uC544\uC6C3 \uC911 \uC624\uB958:",t)}finally{this.router.navigate(["/expedition/login"]).catch(t=>{console.error("[ExpeditionAuth] \uB124\uBE44\uAC8C\uC774\uC158 \uC608\uC678 \uBC1C\uC0DD:",t),window.location.hash="#/expedition/login"})}}isLoggedIn(){return this.currentUserSubject.value!==null}getCurrentUser(){return this.currentUserSubject.value}getUsername(){return this.getCurrentUser()?.username||""}static \u0275fac=function(e){return new(e||a)(le(L),le(de))};static \u0275prov=$({token:a,factory:a.\u0275fac,providedIn:"root"})};var kt=class a{constructor(t,e){this.authService=t;this.router=e;this.username=this.authService.getUsername()}username="";onLogout(){return z(this,null,function*(){console.warn("[ExpeditionComponent] \uB85C\uADF8\uC544\uC6C3 \uC2DC\uB3C4");let t=yield Et("\uB85C\uADF8\uC544\uC6C3 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?");console.warn("[ExpeditionComponent] confirmAsync \uACB0\uACFC:",t),t?(console.warn("[ExpeditionComponent] \uB85C\uADF8\uC544\uC6C3 \uD655\uC778\uB428"),this.authService.logout(),console.warn("[ExpeditionComponent] authService.logout() \uC644\uB8CC"),console.warn("[ExpeditionComponent] /expedition/login\uC73C\uB85C \uC774\uB3D9"),this.router.navigate(["/expedition/login"])):console.warn("[ExpeditionComponent] \uB85C\uADF8\uC544\uC6C3 \uCDE8\uC18C\uB428")})}static \u0275fac=function(e){return new(e||a)(_(ve),_(L))};static \u0275cmp=g({type:a,selectors:[["app-expedition"]],standalone:!1,decls:2,vars:0,consts:[[1,"expedition-container"]],template:function(e,n){e&1&&(i(0,"div",0),M(1,"router-outlet"),o())},dependencies:[Vn],styles:[".expedition-container[_ngcontent-%COMP%]{height:100vh;width:100vw;overflow:hidden;padding:0;margin:0}@media (max-width: 768px){.expedition-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;gap:20px}.expedition-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{text-align:center}.expedition-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.expedition-header[_ngcontent-%COMP%]   .user-section[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.expedition-main[_ngcontent-%COMP%]{padding:20px}}"]})};function wi(a,t){if(a&1){let e=y();i(0,"div",5),p("click",function(){let s=f(e).$implicit,c=u();return C(c.launchApp(s))}),i(1,"div",6),r(2),o(),i(3,"h4",7),r(4),o(),i(5,"p",8),r(6),o(),i(7,"div",9)(8,"span",10),r(9),o()()()}if(a&2){let e=t.$implicit,n=u();J("disabled",!e.available),l(2),h(e.icon),l(2),h(e.name),l(2),h(e.description),l(2),J("available",e.available),l(),x(" ",n.getAppStatusText(e)," ")}}var Nt=class a{constructor(t){this.router=t}apps=[{id:"chatflow",name:"\u{1F4AC} \uCC57\uD50C\uB85C\uC6B0",description:"\uB300\uD654\uD615 \uC2A4\uD1A0\uB9AC\uB97C \uB9CC\uB4E4\uC5B4\uBCF4\uC138\uC694",icon:"\u{1F4AC}",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",route:"/expedition/chatflow",available:!0},{id:"journal",name:"\u{1F4DD} \uC800\uB110",description:"\uC7A5\uAE30 \uD504\uB85C\uC81D\uD2B8\uB97C \uCD94\uC801\uD558\uACE0 \uAD00\uB9AC\uD558\uC138\uC694",icon:"\u{1F4DD}",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",route:"/expedition/journal",available:!1},{id:"gallery",name:"\u{1F5BC}\uFE0F \uAC24\uB7EC\uB9AC",description:"\uC5EC\uC815\uC758 \uC0AC\uC9C4\uACFC \uC601\uC0C1\uC744 \uBAA8\uC544\uBCF4\uC138\uC694",icon:"\u{1F5BC}\uFE0F",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",route:"/expedition/gallery",available:!1},{id:"timeline",name:"\u23F0 \uD0C0\uC784\uB77C\uC778",description:"\uC2DC\uAC04\uC21C\uC73C\uB85C \uC5EC\uC815\uC744 \uB418\uB3CC\uC544\uBCF4\uC138\uC694",icon:"\u23F0",color:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",route:"/expedition/timeline",available:!1},{id:"map",name:"\u{1F5FA}\uFE0F \uC9C0\uB3C4",description:"\uC5EC\uD589\uD55C \uC7A5\uC18C\uB97C \uC9C0\uB3C4\uC5D0 \uD45C\uC2DC\uD558\uC138\uC694",icon:"\u{1F5FA}\uFE0F",color:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",route:"/expedition/map",available:!1}];ngOnInit(){console.warn("[AppsLauncher] \uC571 \uB7F0\uCC98 \uCD08\uAE30\uD654")}launchApp(t){if(!t.available){console.warn("[AppsLauncher] \uC544\uC9C1 \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uB294 \uC571:",t.name),alert(`${t.name}\uC740(\uB294) \uC900\uBE44 \uC911\uC785\uB2C8\uB2E4.`);return}console.warn("[AppsLauncher] \uC571 \uC2E4\uD589:",t.name,"\u2192",t.route),this.router.navigate([t.route])}getAppStatusText(t){return t.available?"\uC2E4\uD589":"\uC900\uBE44 \uC911"}static \u0275fac=function(e){return new(e||a)(_(L))};static \u0275cmp=g({type:a,selectors:[["app-apps-launcher"]],standalone:!1,decls:8,vars:1,consts:[[1,"apps-launcher-container"],[1,"launcher-header"],[1,"subtitle"],[1,"apps-grid"],["class","app-card",3,"disabled","click",4,"ngFor","ngForOf"],[1,"app-card",3,"click"],[1,"app-icon"],[1,"app-name"],[1,"app-description"],[1,"app-status"],[1,"status-badge"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"header",1)(2,"h1"),r(3,"\u{1F5FA}\uFE0F \uC6D0\uC815\uB300"),o(),i(4,"p",2),r(5,"\uB2F9\uC2E0\uC758 \uC5EC\uC815\uC744 \uB2E4\uC591\uD55C \uBC29\uC2DD\uC73C\uB85C \uAE30\uB85D\uD558\uC138\uC694"),o()(),i(6,"main",3),j(7,wi,10,8,"div",4),o()()),e&2&&(l(7),d("ngForOf",n.apps))},dependencies:[Ye],styles:['.apps-launcher-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#667eea,#764ba2);padding:40px 20px}.launcher-header[_ngcontent-%COMP%]{text-align:center;color:#fff;margin-bottom:50px}.launcher-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:3rem;margin:0;font-weight:700;text-shadow:0 2px 10px rgba(0,0,0,.2)}.launcher-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.3rem;margin:15px 0 0;opacity:.95}.apps-grid[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:24px;padding:20px}.app-card[_ngcontent-%COMP%]{background:#fffffff2;border:1px solid rgba(255,255,255,.3);border-radius:16px;padding:24px;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #0000001a;position:relative;overflow:hidden;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.app-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:var(--app-gradient, linear-gradient(135deg, #667eea 0%, #764ba2 100%));opacity:0;transition:opacity .3s ease}.app-card[_ngcontent-%COMP%]:hover:not(.disabled){transform:translateY(-6px);box-shadow:0 8px 24px #00000026;border-color:#ffffff80}.app-card[_ngcontent-%COMP%]:hover:not(.disabled):before{opacity:1}.app-card[_ngcontent-%COMP%]:hover:not(.disabled)   .app-icon[_ngcontent-%COMP%]{transform:scale(1.15) rotate(5deg)}.app-card[_ngcontent-%COMP%]:hover:not(.disabled)   .status-badge.available[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;transform:scale(1.05)}.app-card.disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.6}.app-card.disabled[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:#fff6;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.app-card[_ngcontent-%COMP%]   .app-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:16px;transition:all .3s ease;filter:drop-shadow(0 2px 4px rgba(0,0,0,.1));display:block}.app-card[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;margin:0 0 8px;color:#1f2937}.app-card[_ngcontent-%COMP%]   .app-description[_ngcontent-%COMP%]{font-size:.95rem;color:#6b7280;margin:0 0 16px;line-height:1.5;min-height:44px}.app-card[_ngcontent-%COMP%]   .app-status[_ngcontent-%COMP%]{padding-top:12px;border-top:1px solid rgba(0,0,0,.08)}.app-card[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-block;padding:6px 16px;border-radius:16px;font-size:.85rem;font-weight:700;text-transform:uppercase;transition:all .3s ease;letter-spacing:.5px}.app-card[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]:not(.available){background:#9ca3af26;color:#9ca3af;border:1px solid rgba(156,163,175,.2)}.app-card[_ngcontent-%COMP%]   .status-badge.available[_ngcontent-%COMP%]{background:#667eea1a;color:#667eea;border:1px solid rgba(102,126,234,.3);font-weight:700}.app-card[_ngcontent-%COMP%]:nth-child(1){--app-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%)}.app-card[_ngcontent-%COMP%]:nth-child(2){--app-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%)}.app-card[_ngcontent-%COMP%]:nth-child(3){--app-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)}.app-card[_ngcontent-%COMP%]:nth-child(4){--app-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)}.app-card[_ngcontent-%COMP%]:nth-child(5){--app-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%)}.app-card[_ngcontent-%COMP%]:nth-child(6){--app-gradient: linear-gradient(135deg, #30cfd0 0%, #330867 100%)}@media (max-width: 768px){.launcher-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.launcher-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem}.apps-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px;padding:10px}.app-card[_ngcontent-%COMP%]{padding:20px}.app-card[_ngcontent-%COMP%]   .app-icon[_ngcontent-%COMP%]{font-size:2.5rem}.app-card[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-size:1.2rem}.app-card[_ngcontent-%COMP%]   .app-description[_ngcontent-%COMP%]{font-size:.9rem;min-height:auto}}']})};var ct=class a extends li{constructor(t){super(t)}static \u0275fac=function(e){return new(e||a)(_(Fe))};static \u0275cmp=g({type:a,selectors:[["app-chat-question"]],standalone:!1,features:[k],decls:7,vars:1,consts:[[1,"message-container","user-message"],[1,"message-bubble"],[1,"message-text"],[1,"message-avatar"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),r(3),o()(),i(4,"div",3)(5,"mat-icon"),r(6,"person"),o()()()),e&2&&(l(3),h(n.data.text))},dependencies:[N],styles:[".message-container[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin:16px 0;animation:_ngcontent-%COMP%_slideIn .3s ease-out}.message-container.user-message[_ngcontent-%COMP%]{flex-direction:row-reverse}.message-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#48c6ef,#6f86d6);color:#fff;flex-shrink:0;margin-left:12px;box-shadow:0 2px 8px #48c6ef4d}.message-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.message-bubble[_ngcontent-%COMP%]{max-width:75%;padding:12px 16px;border-radius:12px 12px 4px;background:linear-gradient(135deg,#48c6ef,#6f86d6);color:#fff;box-shadow:0 2px 8px #48c6ef33;word-wrap:break-word;white-space:pre-wrap;line-height:1.5}.message-text[_ngcontent-%COMP%]{font-size:14px}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]})};function yi(a,t){a&1&&(i(0,"div",3),M(1,"span")(2,"span")(3,"span"),o())}function Pi(a,t){if(a&1&&(i(0,"div",4),r(1),o()),a&2){let e=u();l(),h(e.data.text)}}var lt=class a extends si{static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-chat-answer"]],standalone:!1,features:[k],decls:7,vars:1,consts:[[1,"message-container","bot-message"],[1,"message-avatar"],[1,"message-bubble"],[1,"loading-dots"],[1,"message-text"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"mat-icon"),r(3,"smart_toy"),o()(),i(4,"div",2),O(5,yi,4,0,"div",3)(6,Pi,2,1,"div",4),o()()),e&2&&(l(5),E(n.data.isLoading?5:6))},dependencies:[N],styles:[".message-container[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin:16px 0;animation:_ngcontent-%COMP%_slideIn .3s ease-out}.message-container.bot-message[_ngcontent-%COMP%]{flex-direction:row}.message-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;flex-shrink:0;margin-right:12px;box-shadow:0 2px 8px #667eea4d}.message-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.message-bubble[_ngcontent-%COMP%]{max-width:75%;padding:12px 16px;border-radius:12px 12px 12px 4px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 2px 8px #667eea33;word-wrap:break-word;white-space:pre-wrap;line-height:1.5}.message-text[_ngcontent-%COMP%]{font-size:14px}.loading-dots[_ngcontent-%COMP%]{display:flex;gap:6px;padding:4px 0}.loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#fffc;animation:_ngcontent-%COMP%_bounce 1.4s infinite ease-in-out}.loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){animation-delay:-.32s}.loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:-.16s}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_bounce{0%,80%,to{transform:scale(.8);opacity:.5}40%{transform:scale(1);opacity:1}}"]})};function Di(a,t){if(a&1){let e=y();i(0,"button",2),p("click",function(){let s=f(e).$implicit,c=u();return C(c.onClick(s))}),r(1),o()}if(a&2){let e=t.$implicit;l(),h(e.buttonName)}}var Bt=class a extends ci{ngOnInit(){}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-chat-buttons-answer"]],standalone:!1,features:[k],decls:3,vars:0,consts:[[2,"display","flex","gap","5px"],["mat-flat-button",""],["mat-flat-button","",3,"click"]],template:function(e,n){e&1&&(i(0,"div",0),re(1,Di,2,1,"button",1,Ee),o()),e&2&&(l(),se(n.data.conditions))},dependencies:[A],encapsulation:2})};var Si=["content"],Oi=["textarea"],It=class a{chatbotContent;chatbotTextareaElement;width=qe(0);height=qe(0);chatbotActionService=v(Fe);subscription=new Qe;isEmpty=!0;ngOnInit(){this.chatbotActionService.chatbotContent=this.chatbotContent,this.chatbotActionService.chatStyleSetting={answer:lt,question:ct,button:Bt},this.subscription.add(this.chatbotActionService.messageCreated$.subscribe(()=>{this.isEmpty=!1})),setTimeout(()=>{this.showWelcomeMessage()},500)}showWelcomeMessage(){let t=[{text:"\uC548\uB155\uD558\uC138\uC694! \u{1F44B}",isLoading:!1,loadingSec:0},{text:"\uCC57\uD50C\uB85C\uC6B0 \uC2DC\uBBAC\uB808\uC774\uD130\uC5D0 \uC624\uC2E0 \uAC83\uC744 \uD658\uC601\uD569\uB2C8\uB2E4!",isLoading:!0,loadingSec:1},{text:`\uC67C\uCABD \uC5D0\uB514\uD130\uC5D0\uC11C \uB178\uB4DC\uB97C \uC5F0\uACB0\uD558\uACE0
\u25B6 \uC2E4\uD589 \uBC84\uD2BC\uC744 \uB20C\uB7EC \uC2DC\uBBAC\uB808\uC774\uC158\uC744 \uC2DC\uC791\uD574\uBCF4\uC138\uC694! \u{1F680}`,isLoading:!0,loadingSec:1.5}],e=0;t.forEach((n,s)=>{setTimeout(()=>{this.chatbotActionService.createChatComponent(lt,n)},e),e+=(n.loadingSec||0)*1e3+500})}ngOnDestroy(){this.subscription.unsubscribe()}onClearClick(){this.chatbotContent.clear(),this.isEmpty=!0}onKeyDown(t,e){if(e.stopPropagation(),e.isComposing||e.key!=="Enter"||e.shiftKey)return;e.preventDefault();let n=t.value.trim();n&&(this.chatbotActionService.createChatComponent(ct,{text:n}),this.chatbotActionService.questionCreated$&&this.chatbotActionService.questionCreated$.next(n),t.value="")}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["app-chatbot"]],viewQuery:function(e,n){if(e&1&&(ee(Si,7,He),ee(Oi,7)),e&2){let s;te(s=ne())&&(n.chatbotContent=s.first),te(s=ne())&&(n.chatbotTextareaElement=s.first)}},inputs:{width:[1,"width"],height:[1,"height"]},standalone:!1,decls:21,vars:0,consts:[["content",""],["textarea",""],[1,"chatbot-container"],[1,"chatbot-header"],[1,"header-title"],["mat-icon-button","","title","\uB300\uD654 \uCD08\uAE30\uD654",3,"click"],[1,"chat-messages"],[1,"chat-input-area"],["appearance","outline",1,"chat-input-field"],["matInput","","rows","2","placeholder","\uBA54\uC2DC\uC9C0\uB97C \uC785\uB825\uD558\uACE0 Enter\uB97C \uB204\uB974\uC138\uC694...","autocomplete","off",3,"keydown"],["align","end"]],template:function(e,n){if(e&1){let s=y();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"mat-icon"),r(4,"chat_bubble"),o(),i(5,"span"),r(6,"\uCC57\uBD07 \uC2DC\uBBAC\uB808\uC774\uD130"),o()(),i(7,"button",5),p("click",function(){return f(s),C(n.onClearClick())}),i(8,"mat-icon"),r(9,"refresh"),o()()(),i(10,"div",6),ut(11,null,0),o(),i(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),r(16,"\uBA54\uC2DC\uC9C0 \uC785\uB825"),o(),i(17,"textarea",9,1),p("keydown",function(m){f(s);let w=ue(18);return C(n.onKeyDown(w,m))}),o(),i(19,"mat-hint",10),r(20,"Enter: \uC804\uC1A1 | Shift+Enter: \uC904\uBC14\uAFC8"),o()()()()}},dependencies:[F,V,Ae,R,ae,N],styles:[".chatbot-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;min-height:0;background:linear-gradient(135deg,#667eea,#764ba2)}.chatbot-header[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;justify-content:space-between;padding:15px 20px;background:#fffffff2;border-bottom:2px solid rgba(102,126,234,.3)}.chatbot-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-weight:600;color:#667eea;font-size:16px}.chatbot-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.chatbot-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#667eea}.chatbot-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#667eea1a}.chat-messages[_ngcontent-%COMP%]{flex:1;min-height:0;padding:20px;overflow-y:auto;background:#fffffff2}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#667eea4d;border-radius:3px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#667eea80}.welcome-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center;color:#666;animation:_ngcontent-%COMP%_fadeIn .5s ease-in}.welcome-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#667eea;margin-bottom:20px;animation:_ngcontent-%COMP%_bounce 2s ease-in-out infinite}.welcome-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;line-height:1.6;margin:0}.welcome-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#667eea;font-weight:700}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_bounce{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.chat-input-area[_ngcontent-%COMP%]{flex-shrink:0!important;flex-basis:auto;padding:16px 20px;background:#fff!important;border-top:2px solid #667eea;box-shadow:0 -2px 10px #0000001a;z-index:10}.chat-input-field[_ngcontent-%COMP%]{width:100%;margin:0!important;display:block!important}.chat-input-field[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{background:#fff;border-radius:8px;padding:0}.chat-input-field[_ngcontent-%COMP%]     .mat-mdc-form-field-focus-overlay{background:#667eea0d}.chat-input-field[_ngcontent-%COMP%]     .mdc-text-field--focused .mdc-notched-outline__leading, .chat-input-field[_ngcontent-%COMP%]     .mdc-text-field--focused .mdc-notched-outline__notch, .chat-input-field[_ngcontent-%COMP%]     .mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#667eea!important;border-width:2px!important}.chat-input-field[_ngcontent-%COMP%]     textarea{resize:none;line-height:1.4;padding:8px 0}.chat-input-field[_ngcontent-%COMP%]     .mat-mdc-form-field-hint-wrapper{padding:0;margin-top:2px;font-size:11px}.chat-input-field[_ngcontent-%COMP%]     .mat-mdc-form-field-error-wrapper{padding:0}.chat-input-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{margin-top:0;min-height:16px}.chat-input-field[_ngcontent-%COMP%]     .mat-mdc-form-field-bottom-align:before{display:none}.mat-mdc-form-field-bottom-align[_ngcontent-%COMP%]:before{display:none}"]})};var pe=class{dialogRef=v(Ne);node=v(Je);onCancelClick(){this.dialogRef.close()}};function Ni(a,t){if(a&1&&(i(0,"mat-option",8),r(1),o()),a&2){let e=t.$implicit;d("value",e.id),l(),h(e.name)}}function Bi(a,t){if(a&1){let e=y();i(0,"div",4)(1,"div")(2,"mat-form-field")(3,"mat-label"),r(4),o(),i(5,"input",2),S("ngModelChange",function(s){let c=f(e).$implicit;return D(c.buttonName,s)||(c.buttonName=s),C(s)}),o()()(),i(6,"div")(7,"mat-form-field")(8,"mat-label"),r(9,"\uAC12(\uBCC0\uC218\uC5D0 \uB2F4\uC744)"),o(),i(10,"input",2),S("ngModelChange",function(s){let c=f(e).$implicit;return D(c.routingKey,s)||(c.routingKey=s),C(s)}),o()()(),i(11,"div")(12,"mat-form-field")(13,"mat-label"),r(14,"\uC5F0\uACB0\uD560 \uB178\uB4DC"),o(),i(15,"mat-select",7),S("valueChange",function(s){let c=f(e).$implicit;return D(c.targetNodeId,s)||(c.targetNodeId=s),C(s)}),re(16,Ni,2,2,"mat-option",8,Ee),o()()(),i(18,"div",9)(19,"button",3),p("click",function(){let s=f(e).$index,c=u();return C(c.onDeleteClick(s))}),i(20,"mat-icon"),r(21,"delete"),o()()()()}if(a&2){let e=t.$implicit,n=t.$index,s=u();l(4),x("\uBC84\uD2BC ",n+1," \uC774\uB984"),l(),P("ngModel",e.buttonName),l(5),P("ngModel",e.routingKey),l(5),P("value",e.targetNodeId),l(),se(s.connectables)}}var At=class a extends pe{name=this.node.name;variableName=this.node.data.variableName;conditions=structuredClone(this.node.data.conditions)??[];connectables=[];ngOnInit(){this.connectables=Object.values(this.node.rightConnectedList).map(t=>({id:t.node.id,name:t.node.name}))}onSaveClick(){this.node.data.variableName=this.variableName,this.node.data.conditions=this.conditions,this.node.name=this.name,console.log("split node data",this.node.data),this.dialogRef.close()}onAddClick(){this.conditions.push({buttonName:"",routingKey:"",targetNodeId:""})}onDeleteClick(t){this.conditions.splice(t,1)}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-button-node-edit-dialog"]],standalone:!1,features:[k],decls:21,vars:3,consts:[["mat-dialog-title",""],[2,"display","flex","flex-direction","column"],["matInput","",3,"ngModelChange","ngModel"],[3,"click"],[2,"border-radius","10px","background-color","rgb(247, 225, 247)","margin-bottom","10px","padding","10px"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"valueChange","value"],[3,"value"],[2,"text-align","center"]],template:function(e,n){e&1&&(i(0,"h2",0),r(1),o(),i(2,"mat-dialog-content",1)(3,"mat-form-field")(4,"mat-label"),r(5,"node \uC774\uB984"),o(),i(6,"input",2),S("ngModelChange",function(c){return D(n.name,c)||(n.name=c),c}),o()(),i(7,"mat-form-field")(8,"mat-label"),r(9,"\uAC12\uC744 \uB2F4\uC744 \uBCC0\uC218 \uC774\uB984"),o(),i(10,"input",2),S("ngModelChange",function(c){return D(n.variableName,c)||(n.variableName=c),c}),o()(),i(11,"button",3),p("click",function(){return n.onAddClick()}),i(12,"mat-icon"),r(13,"add"),o()(),re(14,Bi,22,4,"div",4,Ee),o(),i(16,"mat-dialog-actions")(17,"button",5),p("click",function(){return n.onCancelClick()}),r(18,"\uCDE8\uC18C"),o(),i(19,"button",6),p("click",function(){return n.onSaveClick()}),r(20,"\uC800\uC7A5"),o()()),e&2&&(l(),x("",n.node.type," \uB178\uB4DC \uC218\uC815"),l(5),P("ngModel",n.name),l(4),P("ngModel",n.variableName),l(4),se(n.conditions))},dependencies:[R,F,V,A,N,K,Z,X,Mt,vt,W,U,Q],encapsulation:2})};var Tt=class{constructor(t,e,n){this.svg=t;this.leftNode=e;this.rightNode=n}invisibleRef;visibleRef;init(){let t=window.debugLogger;t&&(t.info("\uCC57\uD50C\uB85C\uC6B0-SVG",`\u{1F3A8} SVG \uB77C\uC778 \uC0DD\uC131: ${this.leftNode.id} \u2192 ${this.rightNode.id}`),t.info("\uCC57\uD50C\uB85C\uC6B0-SVG",`   \uC2DC\uC791\uC810: (${this.leftNode.rightDotPosition.left}, ${this.leftNode.rightDotPosition.top})`),t.info("\uCC57\uD50C\uB85C\uC6B0-SVG",`   \uB05D\uC810: (${this.rightNode.leftDotPosition.left}, ${this.rightNode.leftDotPosition.top})`),t.info("\uCC57\uD50C\uB85C\uC6B0-SVG",`   SVG \uC694\uC18C: ${!!this.svg?.nativeElement}`)),this.visibleRef=document.createElementNS("http://www.w3.org/2000/svg","path"),this.setVisibleAttribute(this.visibleRef),this.svg.nativeElement.appendChild(this.visibleRef),t&&t.success("\uCC57\uD50C\uB85C\uC6B0-SVG","\u2705 Visible line \uCD94\uAC00\uB428"),this.invisibleRef=document.createElementNS("http://www.w3.org/2000/svg","path"),this.setInvisibleAttribute(this.invisibleRef),this.svg.nativeElement.appendChild(this.invisibleRef),this.invisibleRef.addEventListener("click",this.onClick.bind(this)),this.invisibleRef.addEventListener("hover",this.onHover.bind(this)),t&&t.success("\uCC57\uD50C\uB85C\uC6B0-SVG","\u2705 Invisible line (\uD074\uB9AD \uC601\uC5ED) \uCD94\uAC00\uB428")}onHover(){console.log("hover")}onClick(){console.log("ref",this),this.invisibleRef.setAttribute("stroke","red"),this.delete()}setInvisibleAttribute(t){let e=this.leftNode.rightDotPosition.left,n=this.leftNode.rightDotPosition.top,s=this.rightNode.leftDotPosition.left,c=this.rightNode.leftDotPosition.top,m=Math.abs(s-e)*.5,w=`M ${e} ${n} C ${e+m} ${n}, ${s-m} ${c}, ${s} ${c}`;t.setAttribute("d",w),t.setAttribute("stroke","transparent"),t.setAttribute("stroke-width","10"),t.setAttribute("fill","none"),t.classList.add("pointer")}setVisibleAttribute(t){let e=this.leftNode.rightDotPosition.left,n=this.leftNode.rightDotPosition.top,s=this.rightNode.leftDotPosition.left,c=this.rightNode.leftDotPosition.top,m=Math.abs(s-e)*.5,w=`M ${e} ${n} C ${e+m} ${n}, ${s-m} ${c}, ${s} ${c}`,T=window.debugLogger;T&&T.info("\uCC57\uD50C\uB85C\uC6B0-SVG",`\u{1F58A}\uFE0F \uCEE4\uBE0C \uB77C\uC778 \uC18D\uC131 \uC124\uC815: (${e},${n}) \u2192 (${s},${c})`),t.setAttribute("d",w),t.setAttribute("stroke","#4CAF50"),t.setAttribute("stroke-width","2"),t.setAttribute("fill","none")}delete(){this.invisibleRef.removeEventListener("click",this.onClick),this.invisibleRef.remove(),this.visibleRef.remove(),this.rightNode.addToUnconnected(),delete this.leftNode.rightConnectedList[this.rightNode.id],delete this.rightNode.leftConnectedList[this.leftNode.id]}move(){let t=window.debugLogger;t&&t.info("\uCC57\uD50C\uB85C\uC6B0-SVG",`\u2194\uFE0F \uB77C\uC778 \uC774\uB3D9: ${this.leftNode.id} \u2192 ${this.rightNode.id}`),this.setInvisibleAttribute(this.invisibleRef),this.setVisibleAttribute(this.visibleRef)}};var Lt=(a=21)=>crypto.getRandomValues(new Uint8Array(a)).reduce((t,e)=>(e&=63,e<36?t+=e.toString(36):e<62?t+=(e-26).toString(36).toUpperCase():e>62?t+="-":t+="_",t),"");var Re=class a{movingNode=null;svg;static \u0275fac=function(e){return new(e||a)};static \u0275prov=$({token:a,factory:a.\u0275fac})};var je=class a{nodeWidth=280;nodeHeight=120;zoomLevel=70;static \u0275fac=function(e){return new(e||a)};static \u0275prov=$({token:a,factory:a.\u0275fac})};var Me=class a{intentName="";_lineStartedNode=null;get lineStartedNode(){return this._lineStartedNode}set lineStartedNode(t){let e=window.debugLogger;e&&(t===null?(e.warn("\uCC57\uD50C\uB85C\uC6B0-\uC0C1\uD0DC","\u274C lineStartedNode\uAC00 null\uB85C \uC124\uC815\uB428"),console.trace("lineStartedNode null \uC124\uC815 \uC704\uCE58")):e.success("\uCC57\uD50C\uB85C\uC6B0-\uC0C1\uD0DC",`\u2705 lineStartedNode \uC124\uC815: ${t.id} (${t.type})`)),this._lineStartedNode=t}startNode=null;unconnectedNode={};createJsonData(){return{intentName:this.intentName,connected:this.createConnectedData(),unconnected:this.createUnconnectedData()}}variables={};createConnectedData(){if(console.log("play \uD655\uC778",this.startNode),!this.startNode)return{};let t={};return t.start=this.startNode.extractData(),this.extractRightNode(this.startNode,t),t}createUnconnectedData(){let t={};return Object.values(this.unconnectedNode).forEach(e=>{t[e.id]=e.extractData(),this.extractRightNode(e,t)}),t}extractRightNode(t,e){Object.keys(t.rightConnectedList).length!==0&&Object.values(t.rightConnectedList).forEach(n=>{e[n.node.id]||(e[n.node.id]=n.node.extractData(),this.extractRightNode(n.node,e))})}static \u0275fac=function(e){return new(e||a)};static \u0275prov=$({token:a,factory:a.\u0275fac})};var Y=class a{constructor(t,e,n,s){this.elementRef=t;this.chatflowActionService=e;this.chatflowSettingService=n;this.chatflowDataService=s}isItExcecuting=!1;id=Lt();top=200;left=0;data={};name="";leftConnectedList={};rightConnectedList={};_myRef=null;get myRef(){return this._myRef}set myRef(t){this._myRef=t,t&&setTimeout(()=>this.cacheNodeSize(),100)}matDialog=v(ht);snackbar=v(q);debugLogger=v(de);mouseDownPosition={x:0,y:0};beforePosition={top:0,left:0};isDraggingConnection=!1;tempLine=null;cachedHeight=0;cachedWidth=0;ngOnDestroy(){Object.values(this.rightConnectedList).forEach(t=>{t.line.delete()}),Object.values(this.leftConnectedList).forEach(t=>{t.line.delete()}),this.chatflowDataService.unconnectedNode[this.id]&&delete this.chatflowDataService.unconnectedNode[this.id],this.myRef=null}init(t,e){this.id=t.id,this.top=t.top,this.left=t.left,this.category=t.category,this.type=t.type,this.name=t.name,this.data=t.data,this.myRef=e}cacheNodeSize(){let e=this.elementRef.nativeElement.querySelector(".node-card");e&&e.offsetHeight>0?(this.cachedHeight=e.offsetHeight,this.cachedWidth=e.offsetWidth):(this.cachedHeight=this.chatflowSettingService.nodeHeight,this.cachedWidth=this.chatflowSettingService.nodeWidth)}get rightDotPosition(){return this.cachedHeight===0&&this.cacheNodeSize(),{top:this.top+this.cachedHeight/2,left:this.left+this.cachedWidth}}get leftDotPosition(){return this.cachedHeight===0&&this.cacheNodeSize(),{top:this.top+this.cachedHeight/2,left:this.left}}onMouseDown(t){t.button!==2&&(this.mouseDownPosition.x=t.clientX,this.mouseDownPosition.y=t.clientY,this.chatflowActionService.movingNode=this,this.beforePosition.top=this.top,this.beforePosition.left=this.left)}onMouseMove(t){this.left=this.beforePosition.left+t.clientX-this.mouseDownPosition.x,this.top=this.beforePosition.top+t.clientY-this.mouseDownPosition.y,Object.values(this.leftConnectedList).forEach(e=>{e.line.move()}),Object.values(this.rightConnectedList).forEach(e=>{e.line.move()}),this.triggerDebugUpdate()}triggerDebugUpdate(){let t=new CustomEvent("nodePositionChanged");window.dispatchEvent(t)}onLineStartClick(){this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`\u{1F517} \uC5F0\uACB0 \uC2DC\uC791: ${this.type} \uB178\uB4DC (${this.id})`),this.chatflowDataService.lineStartedNode=this,this.debugLogger.success("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`\u2705 \uC2DC\uC791 \uB178\uB4DC \uC124\uC815\uB428: ${this.id}`)}onOutputDotMouseDown(t){t.stopPropagation(),this.isDraggingConnection=!0,this.chatflowDataService.lineStartedNode=this,this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uB4DC\uB798\uADF8\uC5F0\uACB0",`\u{1F5B1}\uFE0F \uB4DC\uB798\uADF8 \uC5F0\uACB0 \uC2DC\uC791: ${this.type} \uB178\uB4DC (${this.id})`),this.chatflowActionService.svg&&(this.tempLine=document.createElementNS("http://www.w3.org/2000/svg","path"),this.tempLine.setAttribute("stroke","#64B5F6"),this.tempLine.setAttribute("stroke-width","2"),this.tempLine.setAttribute("fill","none"),this.tempLine.setAttribute("stroke-dasharray","5,5"),this.tempLine.setAttribute("pointer-events","none"),this.chatflowActionService.svg.nativeElement.appendChild(this.tempLine),this.updateTempLine(t.clientX,t.clientY));let e=s=>{this.isDraggingConnection&&this.updateTempLine(s.clientX,s.clientY)},n=s=>{setTimeout(()=>{this.isDraggingConnection=!1,this.tempLine&&(this.tempLine.remove(),this.tempLine=null),this.chatflowDataService.lineStartedNode=null,this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uB4DC\uB798\uADF8\uC5F0\uACB0","\u{1F51A} \uB4DC\uB798\uADF8 \uC885\uB8CC (\uC5F0\uACB0 \uC548\uB428)")},50),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",n)}updateTempLine(t,e){if(!this.tempLine)return;let n=this.rightDotPosition,s=this.chatflowActionService.svg.nativeElement.getBoundingClientRect(),c=this.chatflowSettingService.zoomLevel/100,m=(t-s.left)/c,w=(e-s.top)/c,T=Math.abs(m-n.left)*.5,H=`M ${n.left} ${n.top} C ${n.left+T} ${n.top}, ${m-T} ${w}, ${m} ${w}`;this.tempLine.setAttribute("d",H)}onInputDotMouseUp(t){if(t.stopPropagation(),!this.chatflowDataService.lineStartedNode||!this.chatflowDataService.lineStartedNode.isDraggingConnection)return;let e=this.chatflowDataService.lineStartedNode;if(this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uB4DC\uB798\uADF8\uC5F0\uACB0",`\u{1F3AF} \uC5F0\uACB0 \uC644\uB8CC \uC2DC\uB3C4: ${e.id} \u2192 ${this.id}`),e===this){this.debugLogger.warn("\uCC57\uD50C\uB85C\uC6B0-\uB4DC\uB798\uADF8\uC5F0\uACB0","\u26A0\uFE0F \uC790\uAE30 \uC790\uC2E0\uACFC\uB294 \uC5F0\uACB0\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.snackbar.open("\uAC19\uC740 \uB178\uB4DC\uB294 \uC5F0\uACB0\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.","",{duration:900,verticalPosition:"top"}),e.cleanupDragConnection();return}if(this.leftConnectedList[e.id]){this.debugLogger.warn("\uCC57\uD50C\uB85C\uC6B0-\uB4DC\uB798\uADF8\uC5F0\uACB0","\u26A0\uFE0F \uC774\uBBF8 \uC5F0\uACB0\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4."),this.snackbar.open("\uC774\uBBF8 \uC5F0\uACB0\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.","",{duration:900,verticalPosition:"top"}),e.cleanupDragConnection();return}Object.keys(this.leftConnectedList).length===0&&delete this.chatflowDataService.unconnectedNode[this.id];let n=this.drawLeftLine(e);e.rightConnectedList[this.id]={node:this,line:n},this.leftConnectedList[e.id]={node:e,line:n},e.cleanupDragConnection(),this.triggerDebugUpdate(),this.debugLogger.success("\uCC57\uD50C\uB85C\uC6B0-\uB4DC\uB798\uADF8\uC5F0\uACB0","\u2705 \uC5F0\uACB0 \uC644\uB8CC!"),this.snackbar.open("\uB178\uB4DC\uAC00 \uC5F0\uACB0\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{duration:900,verticalPosition:"top"})}cleanupDragConnection(){this.isDraggingConnection=!1,this.tempLine&&(this.tempLine.remove(),this.tempLine=null),this.chatflowDataService.lineStartedNode=null}onInputDotMouseEnter(t){if(this.chatflowDataService.lineStartedNode&&this.chatflowDataService.lineStartedNode.isDraggingConnection){let n=t.currentTarget.querySelector(".connector-dot");n&&(n.style.transform="scale(1.5)",n.style.background="rgba(76, 175, 80, 0.95)",n.style.borderColor="#4CAF50",n.style.boxShadow="0 0 24px rgba(76, 175, 80, 0.8), 0 0 0 6px rgba(76, 175, 80, 0.3)")}}onInputDotMouseLeave(t){let n=t.currentTarget.querySelector(".connector-dot");n&&(n.style.transform="",n.style.background="",n.style.borderColor="",n.style.boxShadow="")}onLineEndClick(){if(this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`\u{1F517} \uC5F0\uACB0 \uC885\uB8CC \uC2DC\uB3C4: ${this.type} \uB178\uB4DC (${this.id})`),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`   \uC2DC\uC791 \uB178\uB4DC: ${this.chatflowDataService.lineStartedNode?.id||"\uC5C6\uC74C"}`),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`   \uAE30\uC874 \uC67C\uCABD \uC5F0\uACB0: [${Object.keys(this.leftConnectedList).join(", ")}]`),!this.chatflowDataService.lineStartedNode){this.debugLogger.warn("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0","\u26A0\uFE0F \uC2DC\uC791 \uB178\uB4DC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. \uBA3C\uC800 OUT \uCEE4\uB125\uD130\uB97C \uD074\uB9AD\uD558\uC138\uC694."),this.snackbar.open("\uC2DC\uC791 \uBC84\uD2BC\uC744 \uBA3C\uC800 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.","",{duration:900,verticalPosition:"top"});return}Object.keys(this.leftConnectedList).length===0&&(this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`   \u{1F5D1}\uFE0F \uBBF8\uC5F0\uACB0 \uB178\uB4DC \uBAA9\uB85D\uC5D0\uC11C \uC81C\uAC70: ${this.id}`),delete this.chatflowDataService.unconnectedNode[this.id]),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`\u{1F4D0} \uC120 \uADF8\uB9AC\uAE30: ${this.chatflowDataService.lineStartedNode.id} \u2192 ${this.id}`);let t=this.drawLeftLine(this.chatflowDataService.lineStartedNode);this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0","\u{1F504} \uC5F0\uACB0 \uBAA9\uB85D \uC5C5\uB370\uC774\uD2B8 \uC911..."),this.chatflowDataService.lineStartedNode.rightConnectedList[this.id]={node:this,line:t},this.leftConnectedList[this.chatflowDataService.lineStartedNode.id]={node:this.chatflowDataService.lineStartedNode,line:t},this.debugLogger.success("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0","\u2705 \uC5F0\uACB0 \uC644\uB8CC!"),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`   ${this.chatflowDataService.lineStartedNode.id}\uC758 \uC624\uB978\uCABD \uC5F0\uACB0: [${Object.keys(this.chatflowDataService.lineStartedNode.rightConnectedList).join(", ")}]`),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0",`   ${this.id}\uC758 \uC67C\uCABD \uC5F0\uACB0: [${Object.keys(this.leftConnectedList).join(", ")}]`),this.chatflowDataService.lineStartedNode=null}drawLeftLine(t){this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC120\uADF8\uB9AC\uAE30",`\u{1F4CF} \uC120 \uC0DD\uC131 \uC2DC\uC791: ${t.id} \u2192 ${this.id}`),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC120\uADF8\uB9AC\uAE30",`   \uC2DC\uC791 \uC704\uCE58: (${t.rightDotPosition.left}, ${t.rightDotPosition.top})`),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC120\uADF8\uB9AC\uAE30",`   \uC885\uB8CC \uC704\uCE58: (${this.leftDotPosition.left}, ${this.leftDotPosition.top})`),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC120\uADF8\uB9AC\uAE30",`   SVG \uC874\uC7AC: ${!!this.chatflowActionService.svg}`);let e=new Tt(this.chatflowActionService.svg,t,this);return e.init(),this.debugLogger.success("\uCC57\uD50C\uB85C\uC6B0-\uC120\uADF8\uB9AC\uAE30","\u2705 \uC120 \uC0DD\uC131 \uC644\uB8CC!"),e}onEditClick(){let t=Ft[this.type].edit;t&&this.matDialog.open(t,{data:this})}extractData(){return{id:this.id,top:this.top,left:this.left,category:this.category,type:this.type,name:this.name,data:this.data,rightNodeIds:Object.keys(this.rightConnectedList),leftNodeIds:Object.keys(this.leftConnectedList)}}addToUnconnected(){this.chatflowDataService.unconnectedNode[this.id]=this}static \u0275fac=function(e){return new(e||a)(_(Dn),_(Re),_(je),_(Me))};static \u0275dir=En({type:a})};var Xe=class a extends Y{category="chatbot";type="button";data={variableName:"",conditions:[]};static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-button-node"]],standalone:!1,features:[k],decls:1,vars:1,consts:[[3,"nodeAbstract"]],template:function(e,n){e&1&&M(0,"app-node-template",0),e&2&&d("nodeAbstract",n)},encapsulation:2})};function Li(a,t){if(a&1&&(i(0,"div",1),r(1),o()),a&2){let e=u();l(),x(" \uBCC0\uC218: ",e.data.variableName," ")}}function Fi(a,t){a&1&&(i(0,"div",2),r(1," \uBCC0\uC218\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694 "),o())}var Ze=class a extends Y{category="chatbot";type="listen";data={variableName:""};static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-listen-node"]],standalone:!1,features:[k],decls:3,vars:2,consts:[[3,"nodeAbstract"],[1,"listen-content"],[1,"listen-content","empty"]],template:function(e,n){e&1&&(i(0,"app-node-template",0),O(1,Li,2,1,"div",1)(2,Fi,2,0,"div",2),o()),e&2&&(d("nodeAbstract",n),l(),E(n.data.variableName?1:2))},styles:[".listen-content[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px;color:#333;background-color:#9c27b00d;border-radius:4px;max-height:80px;overflow-y:auto;white-space:pre-wrap;word-break:break-word}.listen-content.empty[_ngcontent-%COMP%]{color:#999;font-style:italic}"]})};var et=class a extends Y{category="chatbot";type="question";static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-question-node"]],standalone:!1,features:[k],decls:1,vars:1,consts:[[3,"nodeAbstract"]],template:function(e,n){e&1&&M(0,"app-node-template",0),e&2&&d("nodeAbstract",n)},encapsulation:2})};function Ri(a,t){if(a&1&&(i(0,"div",1),r(1),o()),a&2){let e=u();l(),h(e.data.text)}}function ji(a,t){a&1&&(i(0,"div",2),r(1,"\uBC1C\uD654 \uB0B4\uC6A9\uC744 \uC785\uB825\uD558\uC138\uC694"),o())}var tt=class a extends Y{category="chatbot";type="speak";data={text:"",isLoading:!1,loadingSec:.8};static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-speak-node"]],standalone:!1,features:[k],decls:3,vars:2,consts:[[3,"nodeAbstract"],[1,"speak-content"],[1,"speak-content","empty"]],template:function(e,n){e&1&&(i(0,"app-node-template",0),O(1,Ri,2,1,"div",1)(2,ji,2,0,"div",2),o()),e&2&&(d("nodeAbstract",n),l(),E(n.data.text?1:2))},styles:[".speak-content[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px;line-height:1.5;color:#333;white-space:pre-wrap;word-break:break-word;max-height:150px;overflow-y:auto}.speak-content.empty[_ngcontent-%COMP%]{color:#999;font-style:italic}"]})};var nt=class a extends Y{category="chatbot";type="split";data={variableName:"",conditions:[]};static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-split-node"]],standalone:!1,features:[k],decls:1,vars:1,consts:[[3,"nodeAbstract"]],template:function(e,n){e&1&&M(0,"app-node-template",0),e&2&&d("nodeAbstract",n)},encapsulation:2})};var Rt=class a extends pe{name=this.node.name;variableName=this.node.data.variableName;onSaveClick(){this.node.data.variableName=this.variableName,this.node.name=this.name,this.dialogRef.close()}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-listen-node-edit-dialog"]],standalone:!1,features:[k],decls:16,vars:3,consts:[["mat-dialog-title",""],[2,"display","flex","flex-direction","column"],["matInput","",3,"ngModelChange","ngModel"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,n){e&1&&(i(0,"h2",0),r(1),o(),i(2,"mat-dialog-content",1)(3,"mat-form-field")(4,"mat-label"),r(5,"node \uC774\uB984"),o(),i(6,"input",2),S("ngModelChange",function(c){return D(n.name,c)||(n.name=c),c}),o()(),i(7,"mat-form-field")(8,"mat-label"),r(9,"\uBCC0\uC218 \uC774\uB984"),o(),i(10,"input",2),S("ngModelChange",function(c){return D(n.variableName,c)||(n.variableName=c),c}),o()()(),i(11,"mat-dialog-actions")(12,"button",3),p("click",function(){return n.onCancelClick()}),r(13,"\uCDE8\uC18C"),o(),i(14,"button",4),p("click",function(){return n.onSaveClick()}),r(15,"\uC800\uC7A5"),o()()),e&2&&(l(),x("",n.node.type," \uB178\uB4DC \uC218\uC815"),l(5),P("ngModel",n.name),l(4),P("ngModel",n.variableName))},dependencies:[R,F,V,A,K,Z,X,W,U,Q],encapsulation:2})};var jt=class a extends pe{text=this.node.data.text;name=this.node.name;loadingSec=this.node.data.loadingSec;isLoading=this.node.data.isLoading;ngOnInit(){}onSaveClick(){this.node.data.text=this.text,this.node.name=this.name,this.node.data.loadingSec=this.loadingSec,this.node.data.isLoading=this.isLoading,this.dialogRef.close()}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-question-node-edit-dialog"]],standalone:!1,features:[k],decls:23,vars:6,consts:[["mat-dialog-title",""],[2,"display","flex","flex-direction","column"],["matInput","",3,"ngModelChange","ngModel"],[1,"example-margin"],[3,"ngModelChange","ngModel"],[1,"example-margin",3,"value"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,n){e&1&&(i(0,"h2",0),r(1),o(),i(2,"mat-dialog-content",1)(3,"mat-form-field")(4,"mat-label"),r(5,"node \uC774\uB984"),o(),i(6,"input",2),S("ngModelChange",function(c){return D(n.name,c)||(n.name=c),c}),o()(),i(7,"mat-form-field")(8,"mat-label"),r(9,"\uBC1C\uD654 \uB0B4\uC6A9"),o(),i(10,"textarea",2),S("ngModelChange",function(c){return D(n.text,c)||(n.text=c),c}),o()(),i(11,"label",3),r(12,"\uB85C\uB529 \uC0AC\uC6A9"),o(),i(13,"mat-radio-group",4),S("ngModelChange",function(c){return D(n.isLoading,c)||(n.isLoading=c),c}),i(14,"mat-radio-button",5),r(15,"\uC0AC\uC6A9"),o(),i(16,"mat-radio-button",5),r(17,"\uBE44\uC0AC\uC6A9"),o()()(),i(18,"mat-dialog-actions")(19,"button",6),p("click",function(){return n.onCancelClick()}),r(20,"\uCDE8\uC18C"),o(),i(21,"button",7),p("click",function(){return n.onSaveClick()}),r(22,"\uC800\uC7A5"),o()()),e&2&&(l(),x("",n.node.type," \uB178\uB4DC \uC218\uC815"),l(5),P("ngModel",n.name),l(4),P("ngModel",n.text),l(3),P("ngModel",n.isLoading),l(),d("value",!0),l(2),d("value",!1))},dependencies:[R,F,V,A,K,Z,X,W,U,Q,St,Ot],encapsulation:2})};function zi(a,t){if(a&1){let e=y();i(0,"mat-form-field",6)(1,"mat-label"),r(2,"\uB85C\uB529 \uC2DC\uAC04(\uCD08)"),o(),i(3,"input",9),S("ngModelChange",function(s){f(e);let c=u();return D(c.loadingSec,s)||(c.loadingSec=s),C(s)}),o()()}if(a&2){let e=u();l(3),P("ngModel",e.loadingSec)}}var Vt=class a extends pe{text=this.node.data.text;name=this.node.name;loadingSec=this.node.data.loadingSec;isLoading=this.node.data.isLoading;ngOnInit(){}onSaveClick(){this.node.data.text=this.text,this.node.name=this.name,this.node.data.loadingSec=this.loadingSec,this.node.data.isLoading=this.isLoading,this.dialogRef.close()}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-speak-node-edit-dialog"]],standalone:!1,features:[k],decls:24,vars:7,consts:[["mat-dialog-title",""],[2,"display","flex","flex-direction","column"],["matInput","",3,"ngModelChange","ngModel"],[1,"example-margin"],[3,"ngModelChange","ngModel"],[1,"example-margin",3,"value"],[2,"margin-top","15px"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["matInput","","type","number",3,"ngModelChange","ngModel"]],template:function(e,n){e&1&&(i(0,"h2",0),r(1),o(),i(2,"mat-dialog-content",1)(3,"mat-form-field")(4,"mat-label"),r(5,"node \uC774\uB984"),o(),i(6,"input",2),S("ngModelChange",function(c){return D(n.name,c)||(n.name=c),c}),o()(),i(7,"mat-form-field")(8,"mat-label"),r(9,"\uBC1C\uD654 \uB0B4\uC6A9"),o(),i(10,"textarea",2),S("ngModelChange",function(c){return D(n.text,c)||(n.text=c),c}),o()(),i(11,"label",3),r(12,"\uB85C\uB529 \uC0AC\uC6A9"),o(),i(13,"mat-radio-group",4),S("ngModelChange",function(c){return D(n.isLoading,c)||(n.isLoading=c),c}),i(14,"mat-radio-button",5),r(15,"\uC0AC\uC6A9"),o(),i(16,"mat-radio-button",5),r(17,"\uBE44\uC0AC\uC6A9"),o()(),O(18,zi,4,1,"mat-form-field",6),o(),i(19,"mat-dialog-actions")(20,"button",7),p("click",function(){return n.onCancelClick()}),r(21,"\uCDE8\uC18C"),o(),i(22,"button",8),p("click",function(){return n.onSaveClick()}),r(23,"\uC800\uC7A5"),o()()),e&2&&(l(),x("",n.node.type," \uB178\uB4DC \uC218\uC815"),l(5),P("ngModel",n.name),l(4),P("ngModel",n.text),l(3),P("ngModel",n.isLoading),l(),d("value",!0),l(2),d("value",!1),l(2),E(n.isLoading?18:-1))},dependencies:[R,F,V,A,K,Z,X,W,Rn,U,Q,St,Ot],encapsulation:2})};function $i(a,t){if(a&1&&(i(0,"mat-option",8),r(1),o()),a&2){let e=t.$implicit;d("value",e.id),l(),h(e.name)}}function Wi(a,t){if(a&1){let e=y();i(0,"div",4)(1,"div")(2,"mat-form-field")(3,"mat-label"),r(4),o(),i(5,"input",2),S("ngModelChange",function(s){let c=f(e).$implicit;return D(c.routingKey,s)||(c.routingKey=s),C(s)}),o()()(),i(6,"div")(7,"mat-form-field")(8,"mat-label"),r(9,"\uC5F0\uACB0\uD560 \uB178\uB4DC"),o(),i(10,"mat-select",7),S("valueChange",function(s){let c=f(e).$implicit;return D(c.targetNodeId,s)||(c.targetNodeId=s),C(s)}),re(11,$i,2,2,"mat-option",8,Ee),o()()(),i(13,"div",9)(14,"button",3),p("click",function(){let s=f(e).$index,c=u();return C(c.onDeleteClick(s))}),i(15,"mat-icon"),r(16,"delete"),o()()()()}if(a&2){let e=t.$implicit,n=t.$index,s=u();l(4),x("\uC870\uAC74 ",n+1),l(),P("ngModel",e.routingKey),l(5),P("value",e.targetNodeId),l(),se(s.connectables)}}var zt=class a extends pe{name=this.node.name;variableName=this.node.data.variableName;conditions=structuredClone(this.node.data.conditions)??[];connectables=[];ngOnInit(){this.connectables=Object.values(this.node.rightConnectedList).map(t=>({id:t.node.id,name:t.node.name}))}onSaveClick(){this.node.data.variableName=this.variableName,this.node.data.conditions=this.conditions,this.node.name=this.name,console.log("split node data",this.node.data),this.dialogRef.close()}onAddClick(){this.conditions.push({routingKey:"",targetNodeId:""})}onDeleteClick(t){this.conditions.splice(t,1)}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-split-node-edit-dialog"]],standalone:!1,features:[k],decls:21,vars:3,consts:[["mat-dialog-title",""],[2,"display","flex","flex-direction","column"],["matInput","",3,"ngModelChange","ngModel"],[3,"click"],[2,"border-radius","10px","background-color","rgb(247, 225, 247)","margin-bottom","10px","padding","10px"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"valueChange","value"],[3,"value"],[2,"text-align","center"]],template:function(e,n){e&1&&(i(0,"h2",0),r(1),o(),i(2,"mat-dialog-content",1)(3,"mat-form-field")(4,"mat-label"),r(5,"node \uC774\uB984"),o(),i(6,"input",2),S("ngModelChange",function(c){return D(n.name,c)||(n.name=c),c}),o()(),i(7,"mat-form-field")(8,"mat-label"),r(9,"\uBCC0\uC218 \uC774\uB984"),o(),i(10,"input",2),S("ngModelChange",function(c){return D(n.variableName,c)||(n.variableName=c),c}),o()(),i(11,"button",3),p("click",function(){return n.onAddClick()}),i(12,"mat-icon"),r(13,"add"),o()(),re(14,Wi,17,3,"div",4,Ee),o(),i(16,"mat-dialog-actions")(17,"button",5),p("click",function(){return n.onCancelClick()}),r(18,"\uCDE8\uC18C"),o(),i(19,"button",6),p("click",function(){return n.onSaveClick()}),r(20,"\uC800\uC7A5"),o()()),e&2&&(l(),x("",n.node.type," \uB178\uB4DC \uC218\uC815"),l(5),P("ngModel",n.name),l(4),P("ngModel",n.variableName),l(4),se(n.conditions))},dependencies:[R,F,V,A,N,K,Z,X,Mt,vt,W,U,Q],encapsulation:2})};var hn={speak:{type:"speak",node:tt,edit:Vt},listen:{type:"listen",node:Ze,edit:Rt},split:{type:"split",node:nt,edit:zt},button:{type:"button",node:Xe,edit:At},question:{type:"question",node:et,edit:jt}};var Ve=class a extends Y{category="chatflow";type="end";id="end";top=0;left=400;ngOnInit(){}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-end-node"]],standalone:!1,features:[k],decls:2,vars:1,consts:[[3,"nodeAbstract"]],template:function(e,n){e&1&&(i(0,"app-node-template",0),r(1,"\uC885\uB8CC \uB178\uB4DC"),o()),e&2&&d("nodeAbstract",n)},encapsulation:2})};var ze=class a extends Y{category="chatflow";type="start";id="start";top=0;ngOnInit(){}static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-start-node"]],standalone:!1,features:[k],decls:2,vars:1,consts:[[3,"nodeAbstract"]],template:function(e,n){e&1&&(i(0,"app-node-template",0),r(1,"\uC2DC\uC791 \uB178\uB4DC"),o()),e&2&&d("nodeAbstract",n)},encapsulation:2})};function Ui(a,t){if(a&1&&(i(0,"div",4),r(1),o()),a&2){let e=u(2);l(),x("\u{1F4C1} ",e.data.path)}}function Qi(a,t){if(a&1&&(i(0,"div",1)(1,"div",3)(2,"mat-icon"),r(3,"insert_drive_file"),o(),i(4,"span"),r(5),o()(),O(6,Ui,2,1,"div",4),o()),a&2){let e=u();l(5),x("",e.data.fileName,".json"),l(),E(e.data.path?6:-1)}}function Hi(a,t){a&1&&(i(0,"div",2),r(1," \uCEE8\uD14D\uC2A4\uD2B8 \uC815\uBCF4\uB97C \uC785\uB825\uD558\uC138\uC694 "),o())}var it=class a extends Y{category="chatflow";type="contextChanger";data={path:"",fileName:"",returnContextName:""};static \u0275fac=(()=>{let t;return function(n){return(t||(t=I(a)))(n||a)}})();static \u0275cmp=g({type:a,selectors:[["app-context-changer-node"]],standalone:!1,features:[k],decls:3,vars:2,consts:[[3,"nodeAbstract"],[1,"context-changer-content"],[1,"context-changer-content","empty"],[1,"file-info"],[1,"path-info"]],template:function(e,n){e&1&&(i(0,"app-node-template",0),O(1,Qi,7,2,"div",1)(2,Hi,2,0,"div",2),o()),e&2&&(d("nodeAbstract",n),l(),E(n.data.fileName?1:2))},styles:[".context-changer-content[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px;color:#333;background-color:#ff980014;border-radius:4px;max-height:100px;overflow-y:auto}.context-changer-content.empty[_ngcontent-%COMP%]{color:#999;font-style:italic}.context-changer-content[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-weight:600;color:#ff9800;margin-bottom:4px}.context-changer-content[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.context-changer-content[_ngcontent-%COMP%]   .path-info[_ngcontent-%COMP%]{font-size:11px;color:#666;padding-left:24px}"]})};var $t=class a{constructor(t,e){this.dialogRef=t;this.data=e}onSave(){this.dialogRef.close(this.data)}onCancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||a)(_(Ne),_(Je))};static \u0275cmp=g({type:a,selectors:[["app-context-changer-node-edit-dialog"]],standalone:!1,decls:42,vars:3,consts:[["mat-dialog-title",""],[1,"dialog-section"],["appearance","outline",1,"full-width"],["matInput","","placeholder","\uC608: json/chatflows",3,"ngModelChange","ngModel"],["matInput","","placeholder","\uC608: welcome",3,"ngModelChange","ngModel"],["matInput","","placeholder","\uC608: main",3,"ngModelChange","ngModel"],[1,"info-box"],[1,"info-content"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,n){e&1&&(i(0,"h2",0),r(1,"\uCEE8\uD14D\uC2A4\uD2B8 \uBCC0\uACBD \uB178\uB4DC \uC124\uC815"),o(),i(2,"mat-dialog-content")(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),r(6,"JSON \uD30C\uC77C \uACBD\uB85C"),o(),i(7,"input",3),S("ngModelChange",function(c){return D(n.data.path,c)||(n.data.path=c),c}),o(),i(8,"mat-hint"),r(9,"public \uD3F4\uB354 \uAE30\uC900 \uC0C1\uB300 \uACBD\uB85C (\uC608: json/chatflows)"),o()(),i(10,"mat-form-field",2)(11,"mat-label"),r(12,"\uD30C\uC77C \uC774\uB984"),o(),i(13,"input",4),S("ngModelChange",function(c){return D(n.data.fileName,c)||(n.data.fileName=c),c}),o(),i(14,"mat-hint"),r(15,".json \uD655\uC7A5\uC790\uB294 \uC81C\uC678 (\uC608: welcome)"),o()(),i(16,"mat-form-field",2)(17,"mat-label"),r(18,"\uBCF5\uADC0\uD560 \uCEE8\uD14D\uC2A4\uD2B8 \uC774\uB984"),o(),i(19,"input",5),S("ngModelChange",function(c){return D(n.data.returnContextName,c)||(n.data.returnContextName=c),c}),o(),i(20,"mat-hint"),r(21,"\uC11C\uBE0C \uCC57\uD50C\uB85C\uC6B0 \uC885\uB8CC \uD6C4 \uB3CC\uC544\uC62C \uCEE8\uD14D\uC2A4\uD2B8 \uC774\uB984"),o()()(),i(22,"div",6)(23,"mat-icon"),r(24,"info"),o(),i(25,"div",7)(26,"strong"),r(27,"\uC0AC\uC6A9 \uBC29\uBC95:"),o(),i(28,"ol")(29,"li"),r(30,"\uC11C\uBE0C \uCC57\uD50C\uB85C\uC6B0 JSON \uD30C\uC77C\uC744 public \uD3F4\uB354\uC5D0 \uBC30\uCE58"),o(),i(31,"li"),r(32,"\uACBD\uB85C\uC640 \uD30C\uC77C\uBA85\uC744 \uC785\uB825 (\uC608: json/sub-flow, filename)"),o(),i(33,"li"),r(34,'\uD604\uC7AC \uCC57\uD50C\uB85C\uC6B0\uC758 \uCEE8\uD14D\uC2A4\uD2B8 \uC774\uB984\uC744 "\uBCF5\uADC0\uD560 \uCEE8\uD14D\uC2A4\uD2B8 \uC774\uB984"\uC5D0 \uC785\uB825'),o(),i(35,"li"),r(36,"\uC11C\uBE0C \uCC57\uD50C\uB85C\uC6B0\uAC00 \uC885\uB8CC\uB418\uBA74 \uC790\uB3D9\uC73C\uB85C \uD604\uC7AC \uCC57\uD50C\uB85C\uC6B0\uB85C \uBCF5\uADC0"),o()()()()(),i(37,"mat-dialog-actions",8)(38,"button",9),p("click",function(){return n.onCancel()}),r(39,"\uCDE8\uC18C"),o(),i(40,"button",10),p("click",function(){return n.onSave()}),r(41,"\uC800\uC7A5"),o()()),e&2&&(l(7),P("ngModel",n.data.path),l(6),P("ngModel",n.data.fileName),l(6),P("ngModel",n.data.returnContextName))},dependencies:[R,F,V,Ae,A,N,K,Z,X,W,U,Q],styles:[".dialog-section[_ngcontent-%COMP%]{padding:20px 0;display:flex;flex-direction:column;gap:16px}.full-width[_ngcontent-%COMP%]{width:100%}.info-box[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;background:linear-gradient(135deg,#ff980014,#ffc10714);border-radius:8px;border:1px dashed rgba(255,152,0,.3);margin-top:16px}.info-box[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ff9800;font-size:24px;width:24px;height:24px;flex-shrink:0}.info-box[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{flex:1;font-size:13px;line-height:1.6;color:#555}.info-box[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#333;font-size:14px}.info-box[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:8px 0 0;padding-left:20px}.info-box[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px;color:#666}.info-box[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-height:600px;overflow-y:auto}"]})};var bn={start:{type:"start",node:ze,edit:null},end:{type:"end",node:Ve,edit:null},contextChanger:{type:"contextChanger",node:it,edit:$t}};var xi={chatbot:{name:"\uCC57\uBD07",type:"chatbot",nodes:Object.values(hn)},chatflow:{name:"\uCC57\uD50C\uB85C\uC6B0",type:"chatflow",nodes:Object.values(bn).filter(a=>a.type!=="start"&&a.type!=="end")}},Ft=oe(oe({},bn),hn);var Wt=class{constructor(t){this.chatbotActionService=t;this.nodeLogics.speak=new ui(this),this.nodeLogics.start=new fi(this),this.nodeLogics.listen=new mi(this),this.nodeLogics.split=new gi(this),this.nodeLogics.end=new pi(this),this.nodeLogics.button=new di(this),this.nodeLogics.question=new Ci(this)}nodeLogics={};chatflowData={};variables={};$chatflowEnded=new dn;currentNode$=new dn;start(){this.execute("start")}execute(t){let e=window.debugLogger;e&&e.info("\uCC57\uD50C\uB85C\uC6B0-\uB85C\uC9C1",`\u{1F504} execute() \uD638\uCD9C\uB428 - nodeId: ${t}`);let n=this.chatflowData[t];if(!n){console.warn("id\uC5D0 \uD574\uB2F9\uD558\uB294 \uB178\uB4DC\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),e&&(e.error("\uCC57\uD50C\uB85C\uC6B0-\uB85C\uC9C1",`\u274C \uB178\uB4DC\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC74C: ${t}`),e.info("\uCC57\uD50C\uB85C\uC6B0-\uB85C\uC9C1",`   \uC0AC\uC6A9 \uAC00\uB2A5\uD55C \uB178\uB4DC: [${Object.keys(this.chatflowData).join(", ")}]`));return}this.nodeLogics[n.type]||(console.warn("\uD574\uB2F9 \uB178\uB4DC \uD0C0\uC785\uC5D0 \uB300\uD55C \uB85C\uC9C1\uC774 \uC5C6\uC2B5\uB2C8\uB2E4:",n.type),e&&e.error("\uCC57\uD50C\uB85C\uC6B0-\uB85C\uC9C1",`\u274C \uB178\uB4DC \uD0C0\uC785 \uB85C\uC9C1 \uC5C6\uC74C: ${n.type}`)),e&&e.info("\uCC57\uD50C\uB85C\uC6B0-\uB85C\uC9C1",`\u{1F4E4} currentNode$ \uBC1C\uD589: ${n.type} (${t})`),this.currentNode$.next(n),e&&e.info("\uCC57\uD50C\uB85C\uC6B0-\uB85C\uC9C1",`\u{1F4DD} readData \uC124\uC815 \uBC0F \uB85C\uC9C1 \uC2DC\uC791: ${n.type}`),this.nodeLogics[n.type].readData=n,this.nodeLogics[n.type].start()}init(){this.variables={},this.chatflowData={}}};var Ut=class{constructor(t){this.container=t}nodes=Ft;tmpNode={};locateChatflowNodes(t){let e=this.locateConnectedNode("start",t.connected);return this.locateUnconnectedNode(t.unconnected),this.tmpNode={},e}renderRightNodes(t,e,n){t.rightNodeIds.forEach(s=>{if(this.tmpNode[s]){let w=this.tmpNode[s],T=w.drawLeftLine(e.instance);e.instance.rightConnectedList[s]={node:w,line:T},w.leftConnectedList[e.instance.id]={node:e.instance,line:T};return}let c=this.locateConnectedNode(s,n);if(!c)return;let m=c.drawLeftLine(e.instance);e.instance.rightConnectedList[s]={node:c,line:m},c.leftConnectedList[e.instance.id]={node:e.instance,line:m},console.log("my instance",e.instance)})}locateConnectedNode(t,e){console.log("locateNodes",t);let n=e[t];if(!e[t])return console.warn("\uB178\uB4DC \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),null;if(!this.nodes[n.type])return console.warn("\uB9E4\uD551\uB41C \uCEF4\uD3EC\uB10C\uD2B8\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. \uD655\uC778\uD574\uC8FC\uC138\uC694."),null;let s=this.container.createComponent(this.nodes[n.type].node);return s.instance.init(n,s),n.leftNodeIds.length>1&&!this.tmpNode[n.id]&&(this.tmpNode[n.id]=s.instance),console.log("nodeId: ",t,"rightNodeIds ",n.rightNodeIds),this.renderRightNodes(n,s,e),s.instance}locateUnconnectedNode(t){Object.values(t).forEach(e=>{if(e.leftNodeIds.length>0)return;if(!this.nodes[e.type]){console.warn("\uB9E4\uD551\uB41C \uCEF4\uD3EC\uB10C\uD2B8\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. \uD655\uC778\uD574\uC8FC\uC138\uC694.",e);return}let n=this.container.createComponent(this.nodes[e.type].node);n.instance.init(e,n),this.renderRightNodes(e,n,t),n.instance.addToUnconnected()})}};var Qt=class a{chatflowDataService=v(Me);snackbarService=v(q);jsonData="";ngOnInit(){this.jsonData=JSON.stringify(this.chatflowDataService.createJsonData(),null,4)}onCopyClick(){this.snackbarService.open("\uD074\uB9BD\uBCF4\uB4DC\uC5D0 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{verticalPosition:"top",duration:1e3}),navigator.clipboard.writeText(this.jsonData).then(()=>{console.log("\uBCF5\uC0AC \uC131\uACF5")}).catch(t=>console.warn("\uBCF5\uC0AC \uC2E4\uD328:",t))}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["app-chatflow-json-dialog"]],standalone:!1,decls:5,vars:1,consts:[[2,"padding","10px"],["mat-raised-button","",3,"click"],[2,"height","500px","overflow-y","auto","border","1px solid grey","border-radius","10px","padding","10px"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"button",1),p("click",function(){return n.onCopyClick()}),r(2,"\uBCF5\uC0AC\uD558\uAE30"),o(),i(3,"pre",2),r(4),o()()),e&2&&(l(4),h(n.jsonData))},dependencies:[A],encapsulation:2})};var we=class a{dbName="ChatflowDB";storeName="chatflows";version=1;db;dbReady=new Oe(!1);constructor(){this.initDB()}initDB(){return z(this,null,function*(){return new Promise((t,e)=>{let n=indexedDB.open(this.dbName,this.version);n.onerror=()=>{console.error("IndexedDB \uC5F4\uAE30 \uC2E4\uD328:",n.error),e(n.error)},n.onsuccess=()=>{this.db=n.result,this.dbReady.next(!0),console.log("\u2705 ChatflowDB \uCD08\uAE30\uD654 \uC644\uB8CC"),t()},n.onupgradeneeded=s=>{let c=s.target.result;if(!c.objectStoreNames.contains(this.storeName)){let m=c.createObjectStore(this.storeName,{keyPath:"id"});m.createIndex("intentName","intentName",{unique:!1}),m.createIndex("updatedAt","updatedAt",{unique:!1}),m.createIndex("createdAt","createdAt",{unique:!1}),console.log("\u2705 ChatflowDB Object Store \uC0DD\uC131 \uC644\uB8CC")}}})})}waitForDB(){return z(this,null,function*(){if(!this.dbReady.value)return new Promise(t=>{let e=this.dbReady.subscribe(n=>{n&&(e.unsubscribe(),t())})})})}saveChatflow(t,e,n){return z(this,null,function*(){yield this.waitForDB();let s=e||Lt(),c=new Date().toISOString(),m=yield this.loadChatflow(s),w=Ue(oe({id:s},t),{createdAt:m?.createdAt||c,updatedAt:c,thumbnail:n||m?.thumbnail});return new Promise((T,H)=>{let dt=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(w);dt.onsuccess=()=>{console.log("\u2705 \uCC57\uD50C\uB85C\uC6B0 \uC800\uC7A5 \uC644\uB8CC:",s),T(s)},dt.onerror=()=>{console.error("\u274C \uCC57\uD50C\uB85C\uC6B0 \uC800\uC7A5 \uC2E4\uD328:",dt.error),H(dt.error)}})})}loadChatflow(t){return z(this,null,function*(){return yield this.waitForDB(),new Promise((e,n)=>{let m=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(t);m.onsuccess=()=>{e(m.result||null)},m.onerror=()=>{console.error("\u274C \uCC57\uD50C\uB85C\uC6B0 \uBD88\uB7EC\uC624\uAE30 \uC2E4\uD328:",m.error),n(m.error)}})})}getChatflowList(){return z(this,null,function*(){return yield this.waitForDB(),new Promise((t,e)=>{let m=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).index("updatedAt").openCursor(null,"prev"),w=[];m.onsuccess=T=>{let H=T.target.result;H?(w.push(H.value),H.continue()):(console.log(`\u2705 \uCC57\uD50C\uB85C\uC6B0 \uBAA9\uB85D \uC870\uD68C \uC644\uB8CC: ${w.length}\uAC1C`),t(w))},m.onerror=()=>{console.error("\u274C \uCC57\uD50C\uB85C\uC6B0 \uBAA9\uB85D \uC870\uD68C \uC2E4\uD328:",m.error),e(m.error)}})})}deleteChatflow(t){return z(this,null,function*(){return yield this.waitForDB(),new Promise((e,n)=>{let m=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(t);m.onsuccess=()=>{console.log("\u2705 \uCC57\uD50C\uB85C\uC6B0 \uC0AD\uC81C \uC644\uB8CC:",t),e(!0)},m.onerror=()=>{console.error("\u274C \uCC57\uD50C\uB85C\uC6B0 \uC0AD\uC81C \uC2E4\uD328:",m.error),n(m.error)}})})}searchChatflows(t){return z(this,null,function*(){let e=yield this.getChatflowList();if(!t.trim())return e;let n=t.toLowerCase();return e.filter(s=>s.intentName.toLowerCase().includes(n))})}getCount(){return z(this,null,function*(){return yield this.waitForDB(),new Promise((t,e)=>{let c=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).count();c.onsuccess=()=>{t(c.result)},c.onerror=()=>{e(c.error)}})})}duplicateChatflow(t){return z(this,null,function*(){let e=yield this.loadChatflow(t);if(!e)throw new Error("\uC6D0\uBCF8 \uCC57\uD50C\uB85C\uC6B0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");let n={intentName:`${e.intentName} (\uBCF5\uC0AC\uBCF8)`,connected:e.connected,unconnected:e.unconnected};return this.saveChatflow(n,void 0,e.thumbnail)})}clearAll(){return z(this,null,function*(){return yield this.waitForDB(),new Promise((t,e)=>{let c=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();c.onsuccess=()=>{console.log("\u2705 \uBAA8\uB4E0 \uCC57\uD50C\uB85C\uC6B0 \uC0AD\uC81C \uC644\uB8CC"),t()},c.onerror=()=>{console.error("\u274C \uCC57\uD50C\uB85C\uC6B0 \uC0AD\uC81C \uC2E4\uD328:",c.error),e(c.error)}})})}saveChatflow$(t,e,n){return st(this.saveChatflow(t,e,n))}loadChatflow$(t){return st(this.loadChatflow(t))}getChatflowList$(){return st(this.getChatflowList())}deleteChatflow$(t){return st(this.deleteChatflow(t))}static \u0275fac=function(e){return new(e||a)};static \u0275prov=$({token:a,factory:a.\u0275fac,providedIn:"root"})};var Yi=(a,t)=>t.id;function Gi(a,t){a&1&&(i(0,"div",6),M(1,"mat-spinner",13),i(2,"p"),r(3,"\uCC57\uD50C\uB85C\uC6B0 \uBAA9\uB85D\uC744 \uBD88\uB7EC\uC624\uB294 \uC911..."),o()())}function Ji(a,t){if(a&1&&(i(0,"mat-icon"),r(1,"search_off"),o(),i(2,"h3"),r(3,"\uAC80\uC0C9 \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),o(),i(4,"p"),r(5),o()),a&2){let e=u(2);l(5),x('"',e.searchQuery,'"\uC640(\uACFC) \uC77C\uCE58\uD558\uB294 \uCC57\uD50C\uB85C\uC6B0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.')}}function Ki(a,t){a&1&&(i(0,"mat-icon"),r(1,"description"),o(),i(2,"h3"),r(3,"\uC800\uC7A5\uB41C \uCC57\uD50C\uB85C\uC6B0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),o(),i(4,"p"),r(5,"\uC0C8\uB85C\uC6B4 \uCC57\uD50C\uB85C\uC6B0\uB97C \uB9CC\uB4E4\uC5B4\uBCF4\uC138\uC694!"),o())}function Xi(a,t){if(a&1&&(i(0,"div",7),O(1,Ji,6,1)(2,Ki,6,0),o()),a&2){let e=u();l(),E(e.searchQuery?1:2)}}function Zi(a,t){if(a&1&&M(0,"img",17),a&2){let e=u().$implicit;d("src",e.thumbnail,Sn)}}function eo(a,t){a&1&&(i(0,"mat-icon"),r(1,"account_tree"),o())}function to(a,t){if(a&1){let e=y();i(0,"div",15),p("click",function(){let s=f(e).$implicit,c=u(2);return C(c.onSelectChatflow(s))}),i(1,"div",16),O(2,Zi,1,1,"img",17)(3,eo,2,0,"mat-icon"),o(),i(4,"div",18)(5,"h3",19),r(6),o(),i(7,"div",20)(8,"span",21)(9,"mat-icon"),r(10,"widgets"),o(),r(11),o(),i(12,"span",22)(13,"mat-icon"),r(14,"schedule"),o(),r(15),o()()(),i(16,"div",23)(17,"button",24),p("click",function(s){let c=f(e).$implicit,m=u(2);return C(m.onDuplicateClick(c,s))}),i(18,"mat-icon"),r(19,"content_copy"),o()(),i(20,"button",25),p("click",function(s){let c=f(e).$implicit,m=u(2);return C(m.onDeleteClick(c,s))}),i(21,"mat-icon"),r(22,"delete"),o()()()()}if(a&2){let e=t.$implicit,n=u(2);J("selected",(n.selectedChatflow==null?null:n.selectedChatflow.id)===e.id),l(2),E(e.thumbnail?2:3),l(4),h(e.intentName),l(5),x(" ",n.getNodeCount(e),"\uAC1C \uB178\uB4DC "),l(4),x(" ",n.getFormattedDate(e.updatedAt)," ")}}function no(a,t){if(a&1&&(i(0,"div",8),re(1,to,23,6,"div",14,Yi),o()),a&2){let e=u();l(),se(e.filteredChatflows)}}function io(a,t){if(a&1&&(i(0,"span"),r(1),o()),a&2){let e=u(2);l(),x("| \uAC80\uC0C9 \uACB0\uACFC ",e.filteredChatflows.length,"\uAC1C")}}function oo(a,t){if(a&1&&(i(0,"div",9)(1,"span"),r(2),o(),O(3,io,2,1,"span"),o()),a&2){let e=u();l(2),x("\uC804\uCCB4 ",e.chatflows.length,"\uAC1C"),l(),E(e.searchQuery&&e.filteredChatflows.length!==e.chatflows.length?3:-1)}}var Ht=class a{dialogRef=v(Ne);storageService=v(we);snackbar=v(q);chatflows=[];filteredChatflows=[];searchQuery="";loading=!1;selectedChatflow=null;ngOnInit(){this.loadChatflows()}loadChatflows(){return z(this,null,function*(){this.loading=!0;try{this.chatflows=yield this.storageService.getChatflowList(),this.filteredChatflows=[...this.chatflows],console.log("\uCC57\uD50C\uB85C\uC6B0 \uBAA9\uB85D \uB85C\uB4DC:",this.chatflows.length)}catch(t){console.error("\uCC57\uD50C\uB85C\uC6B0 \uBAA9\uB85D \uB85C\uB4DC \uC2E4\uD328:",t),this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0 \uBAA9\uB85D\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.","",{duration:2e3,verticalPosition:"top"})}finally{this.loading=!1}})}onSearch(){let t=this.searchQuery.toLowerCase().trim();if(!t){this.filteredChatflows=[...this.chatflows];return}this.filteredChatflows=this.chatflows.filter(e=>e.intentName.toLowerCase().includes(t))}onSelectChatflow(t){this.selectedChatflow=t}onLoadClick(){if(!this.selectedChatflow){this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0\uB97C \uC120\uD0DD\uD574\uC8FC\uC138\uC694.","",{duration:1500,verticalPosition:"top"});return}this.dialogRef.close({action:"load",chatflow:this.selectedChatflow})}onDeleteClick(t,e){return z(this,null,function*(){if(e.stopPropagation(),!!confirm(`"${t.intentName}"\uC744(\uB97C) \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`))try{yield this.storageService.deleteChatflow(t.id),this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{duration:1500,verticalPosition:"top"}),yield this.loadChatflows()}catch(s){console.error("\uCC57\uD50C\uB85C\uC6B0 \uC0AD\uC81C \uC2E4\uD328:",s),this.snackbar.open("\uC0AD\uC81C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","",{duration:2e3,verticalPosition:"top"})}})}onDuplicateClick(t,e){return z(this,null,function*(){e.stopPropagation();try{let n=yield this.storageService.duplicateChatflow(t.id);this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0\uAC00 \uBCF5\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{duration:1500,verticalPosition:"top"}),yield this.loadChatflows()}catch(n){console.error("\uCC57\uD50C\uB85C\uC6B0 \uBCF5\uC81C \uC2E4\uD328:",n),this.snackbar.open("\uBCF5\uC81C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","",{duration:2e3,verticalPosition:"top"})}})}onCancelClick(){this.dialogRef.close()}getFormattedDate(t){let e=new Date(t),s=new Date().getTime()-e.getTime(),c=Math.floor(s/(1e3*60*60*24));if(c===0){let m=Math.floor(s/36e5);return m===0?`${Math.floor(s/6e4)}\uBD84 \uC804`:`${m}\uC2DC\uAC04 \uC804`}else return c===1?"\uC5B4\uC81C":c<7?`${c}\uC77C \uC804`:e.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}getNodeCount(t){let e=Object.keys(t.connected||{}).length,n=Object.keys(t.unconnected||{}).length;return e+n}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["app-chatflow-list-dialog"]],standalone:!1,decls:25,vars:6,consts:[[1,"chatflow-list-dialog"],["mat-dialog-title",""],[1,"search-bar"],["appearance","outline",1,"search-field"],["matInput","","placeholder","\uCC57\uD50C\uB85C\uC6B0 \uC774\uB984 \uAC80\uC0C9...",3,"ngModelChange","input","ngModel"],["matPrefix",""],[1,"loading-container"],[1,"empty-state"],[1,"chatflow-list"],[1,"stats-info"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","40"],[1,"chatflow-item",3,"selected"],[1,"chatflow-item",3,"click"],[1,"chatflow-thumbnail"],["alt","Thumbnail",3,"src"],[1,"chatflow-info"],[1,"chatflow-name"],[1,"chatflow-meta"],[1,"node-count"],[1,"update-time"],[1,"chatflow-actions"],["mat-icon-button","","matTooltip","\uBCF5\uC81C",3,"click"],["mat-icon-button","","color","warn","matTooltip","\uC0AD\uC81C",3,"click"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"h2",1)(2,"mat-icon"),r(3,"folder_open"),o(),i(4,"span"),r(5,"\uCC57\uD50C\uB85C\uC6B0 \uBD88\uB7EC\uC624\uAE30"),o()(),i(6,"mat-dialog-content")(7,"div",2)(8,"mat-form-field",3)(9,"mat-label"),r(10,"\uAC80\uC0C9"),o(),i(11,"input",4),S("ngModelChange",function(c){return D(n.searchQuery,c)||(n.searchQuery=c),c}),p("input",function(){return n.onSearch()}),o(),i(12,"mat-icon",5),r(13,"search"),o()()(),O(14,Gi,4,0,"div",6),O(15,Xi,3,1,"div",7),O(16,no,3,0,"div",8),O(17,oo,4,2,"div",9),o(),i(18,"mat-dialog-actions",10)(19,"button",11),p("click",function(){return n.onCancelClick()}),r(20," \uCDE8\uC18C "),o(),i(21,"button",12),p("click",function(){return n.onLoadClick()}),i(22,"mat-icon"),r(23,"open_in_new"),o(),r(24," \uBD88\uB7EC\uC624\uAE30 "),o()()()),e&2&&(l(11),P("ngModel",n.searchQuery),l(3),E(n.loading?14:-1),l(),E(!n.loading&&n.filteredChatflows.length===0?15:-1),l(),E(!n.loading&&n.filteredChatflows.length>0?16:-1),l(),E(!n.loading&&n.chatflows.length>0?17:-1),l(4),d("disabled",!n.selectedChatflow))},dependencies:[R,F,V,_t,A,ae,N,K,Z,X,W,U,Q,_e,wt],styles:[".chatflow-list-dialog[_ngcontent-%COMP%]{width:600px;max-height:80vh;display:flex;flex-direction:column}.chatflow-list-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.1)}.chatflow-list-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.chatflow-list-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.chatflow-list-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]{padding:0;overflow-y:auto;flex:1;min-height:400px;max-height:calc(80vh - 140px)}.chatflow-list-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid rgba(255,255,255,.1);margin:0;gap:12px}.chatflow-list-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px}.search-bar[_ngcontent-%COMP%]{padding:16px 24px;background:#ffffff05;border-bottom:1px solid rgba(255,255,255,.05)}.search-bar[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{width:100%;margin:0}.search-bar[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{background:#ffffff0d}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 24px;gap:16px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#ffffffb3}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 24px;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ffffff4d;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:500}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#fff9;font-size:14px}.chatflow-list[_ngcontent-%COMP%]{padding:8px}.chatflow-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:12px;margin-bottom:8px;border-radius:8px;background:#ffffff08;border:2px solid transparent;cursor:pointer;transition:all .2s ease}.chatflow-item[_ngcontent-%COMP%]:hover{background:#ffffff0f;border-color:#64b5f64d}.chatflow-item.selected[_ngcontent-%COMP%]{background:#64b5f626;border-color:#64b5f6}.chatflow-item.selected[_ngcontent-%COMP%]   .chatflow-name[_ngcontent-%COMP%]{color:#64b5f6}.chatflow-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.chatflow-thumbnail[_ngcontent-%COMP%]{flex-shrink:0;width:60px;height:60px;border-radius:6px;background:#ffffff0d;display:flex;align-items:center;justify-content:center;overflow:hidden}.chatflow-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.chatflow-thumbnail[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#fff6}.chatflow-info[_ngcontent-%COMP%]{flex:1;min-width:0}.chatflow-name[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:color .2s ease}.chatflow-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;font-size:13px;color:#fff9}.chatflow-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.chatflow-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.chatflow-meta[_ngcontent-%COMP%]   .node-count[_ngcontent-%COMP%]{color:#64b5f6cc}.chatflow-actions[_ngcontent-%COMP%]{display:flex;gap:4px;flex-shrink:0}.chatflow-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:0;transition:opacity .2s ease}.chatflow-item[_ngcontent-%COMP%]:hover   .chatflow-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .chatflow-item.selected[_ngcontent-%COMP%]   .chatflow-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:1}.stats-info[_ngcontent-%COMP%]{padding:12px 24px;background:#ffffff05;border-top:1px solid rgba(255,255,255,.05);font-size:13px;color:#fff9;text-align:center}.stats-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:8px}@media (max-width: 768px){.chatflow-list-dialog[_ngcontent-%COMP%]{width:100%;max-width:100vw}.chatflow-item[_ngcontent-%COMP%]{flex-wrap:wrap}.chatflow-item[_ngcontent-%COMP%]   .chatflow-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-end;margin-top:8px}.chatflow-item[_ngcontent-%COMP%]   .chatflow-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:1}}"]})};function ao(a,t){a&1&&(i(0,"div",8)(1,"mat-icon"),r(2,"info"),o(),i(3,"span"),r(4,"\uAE30\uC874 DB \uB370\uC774\uD130\uB97C \uB36E\uC5B4\uC501\uB2C8\uB2E4."),o()())}function ro(a,t){a&1&&(M(0,"mat-spinner",12),i(1,"span"),r(2,"\uC800\uC7A5 \uC911..."),o())}function so(a,t){if(a&1&&(Nn(0),i(1,"mat-icon"),r(2),o(),i(3,"span"),r(4),o(),Bn()),a&2){let e=u();l(2),h(e.isUpdate?"save":"save_as"),l(2),h(e.isUpdate?"\uC218\uC815":"\uC800\uC7A5")}}var Yt=class a{constructor(t){this.data=t}dialogRef=v(Ne);storageService=v(we);snackbar=v(q);chatflowName="";saving=!1;isUpdate=!1;Object=Object;ngOnInit(){this.chatflowName=this.data.chatflow.intentName||"",this.isUpdate=!!this.data.currentId}onSaveClick(){return z(this,null,function*(){if(!this.chatflowName.trim()){this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0 \uC774\uB984\uC744 \uC785\uB825\uD574\uC8FC\uC138\uC694.","",{duration:1500,verticalPosition:"top"});return}this.saving=!0;try{let t=Ue(oe({},this.data.chatflow),{intentName:this.chatflowName.trim()}),e=yield this.storageService.saveChatflow(t,this.data.currentId);this.snackbar.open(this.isUpdate?"\uCC57\uD50C\uB85C\uC6B0\uAC00 \uC218\uC815\uB418\uC5C8\uC2B5\uB2C8\uB2E4.":"\uCC57\uD50C\uB85C\uC6B0\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{duration:1500,verticalPosition:"top"}),this.dialogRef.close({success:!0,id:e,chatflow:t})}catch(t){console.error("\uCC57\uD50C\uB85C\uC6B0 \uC800\uC7A5 \uC2E4\uD328:",t),this.snackbar.open("\uC800\uC7A5 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","",{duration:2e3,verticalPosition:"top"}),this.saving=!1}})}onCancelClick(){this.dialogRef.close()}onKeyPress(t){t.key==="Enter"&&!this.saving&&this.onSaveClick()}static \u0275fac=function(e){return new(e||a)(_(Je))};static \u0275cmp=g({type:a,selectors:[["app-chatflow-save-dialog"]],standalone:!1,decls:35,vars:11,consts:[[1,"chatflow-save-dialog"],["mat-dialog-title",""],[1,"description"],["appearance","outline",1,"name-field"],["matInput","","placeholder","\uC608: \uACE0\uAC1D \uC0C1\uB2F4 \uCC57\uBD07","autofocus","",3,"ngModelChange","keypress","ngModel","disabled"],["matPrefix",""],[1,"save-info"],[1,"info-item"],[1,"update-notice"],["align","end"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"h2",1)(2,"mat-icon"),r(3),o(),i(4,"span"),r(5),o()(),i(6,"mat-dialog-content")(7,"p",2),r(8),o(),i(9,"mat-form-field",3)(10,"mat-label"),r(11,"\uCC57\uD50C\uB85C\uC6B0 \uC774\uB984"),o(),i(12,"input",4),S("ngModelChange",function(c){return D(n.chatflowName,c)||(n.chatflowName=c),c}),p("keypress",function(c){return n.onKeyPress(c)}),o(),i(13,"mat-icon",5),r(14,"edit"),o(),i(15,"mat-hint"),r(16,"DB\uC5D0 \uC800\uC7A5\uD560 \uCC57\uD50C\uB85C\uC6B0\uC758 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694"),o()(),i(17,"div",6)(18,"div",7)(19,"mat-icon"),r(20,"widgets"),o(),i(21,"span"),r(22),o()(),i(23,"div",7)(24,"mat-icon"),r(25,"extension"),o(),i(26,"span"),r(27),o()()(),O(28,ao,5,0,"div",8),o(),i(29,"mat-dialog-actions",9)(30,"button",10),p("click",function(){return n.onCancelClick()}),r(31," \uCDE8\uC18C "),o(),i(32,"button",11),p("click",function(){return n.onSaveClick()}),O(33,ro,3,0)(34,so,5,2,"ng-container"),o()()()),e&2&&(l(3),h(n.isUpdate?"save":"save_as"),l(2),h(n.isUpdate?"\uCC57\uD50C\uB85C\uC6B0 \uC218\uC815":"\uCC57\uD50C\uB85C\uC6B0 DB \uC800\uC7A5"),l(3),x(" ",n.isUpdate?"\uCC57\uD50C\uB85C\uC6B0\uB97C \uC218\uC815\uD558\uC5EC DB\uC5D0 \uC800\uC7A5\uD569\uB2C8\uB2E4.":"\uD604\uC7AC \uCC57\uD50C\uB85C\uC6B0\uB97C DB\uC5D0 \uC800\uC7A5\uD569\uB2C8\uB2E4."," "),l(4),P("ngModel",n.chatflowName),d("disabled",n.saving),l(10),x("\uC5F0\uACB0\uB41C \uB178\uB4DC: ",n.data.chatflow.connected?n.Object.keys(n.data.chatflow.connected).length:0,"\uAC1C"),l(5),x("\uB3C5\uB9BD \uB178\uB4DC: ",n.data.chatflow.unconnected?n.Object.keys(n.data.chatflow.unconnected).length:0,"\uAC1C"),l(),E(n.isUpdate?28:-1),l(2),d("disabled",n.saving),l(2),d("disabled",!n.chatflowName.trim()||n.saving),l(),E(n.saving?33:34))},dependencies:[R,F,V,Ae,_t,A,N,K,Z,X,W,U,Q,_e],styles:[".chatflow-save-dialog[_ngcontent-%COMP%]{width:450px}.chatflow-save-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.1)}.chatflow-save-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.chatflow-save-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.chatflow-save-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]{padding:24px}.chatflow-save-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid rgba(255,255,255,.1);margin:0;gap:12px}.chatflow-save-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.chatflow-save-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-right:4px}.description[_ngcontent-%COMP%]{margin:0 0 20px;color:#ffffffb3;font-size:14px;line-height:1.5}.name-field[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.name-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{background:#ffffff0d}.save-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding:16px;background:#ffffff08;border-radius:8px;border:1px solid rgba(255,255,255,.1)}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:14px;color:#fffc}.info-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#64b5f6cc}.update-notice[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-top:16px;padding:12px 16px;background:#ff98001a;border-radius:6px;border:1px solid rgba(255,152,0,.3)}.update-notice[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#ff9800}.update-notice[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;color:#ffffffe6}"]})};var lo=["container"],po=["svg"],mo=["intentName"],uo=["fileInput"],go=a=>({"height.px":a}),_i=(a,t,e)=>({"width.px":a,"height.px":t,transform:e,"transform-origin":"0 0"}),fo=(a,t)=>({"top.px":a,"left.px":t}),vi=(a,t)=>t.type;function Co(a,t){a&1&&(i(0,"mat-icon",23),r(1,"cloud_done"),o())}function ho(a,t){if(a&1){let e=y();i(0,"button",41),p("click",function(){let s=f(e).$implicit,c=u(2);return C(c.onAddingNodeClick(s.node))}),i(1,"mat-icon"),r(2,"add_box"),o(),i(3,"span"),r(4),o()()}if(a&2){let e=t.$implicit;l(4),h(e.type)}}function bo(a,t){if(a&1&&(i(0,"button",38)(1,"mat-icon"),r(2),o(),i(3,"span"),r(4),o(),i(5,"mat-icon",39),r(6,"chevron_right"),o()(),i(7,"mat-menu",null,7),re(9,ho,5,1,"button",40,vi),o()),a&2){let e=t.$implicit,n=ue(8);d("matMenuTriggerFor",n),l(2),h(e.type==="chatbot"?"chat":e.type==="ai"?"smart_toy":e.type==="chatflow"?"account_tree":"stars"),l(2),h(e.name),l(5),se(e.nodes)}}function xo(a,t){if(a&1&&(i(0,"div",62),r(1),o(),i(2,"p",63),r(3,"\u2705 \uCC57\uBD07\uC5D0\uC11C \uC774 \uC774\uB984\uC73C\uB85C \uBC1C\uD654\uD558\uBA74 \uCC57\uD50C\uB85C\uC6B0\uAC00 \uC2E4\uD589\uB429\uB2C8\uB2E4"),o()),a&2){u(2);let e=ue(57);l(),h(e)}}function _o(a,t){a&1&&(i(0,"div",64),r(1,"\uBBF8\uC124\uC815"),o(),i(2,"p",63),r(3,"\u26A0\uFE0F \uC778\uD150\uD2B8 \uC774\uB984\uC744 \uBA3C\uC800 \uC124\uC815\uD574\uC8FC\uC138\uC694"),o())}function vo(a,t){if(a&1){let e=y();i(0,"mat-tab-group",37)(1,"mat-tab",42)(2,"div",43)(3,"div",44)(4,"h4"),r(5,"\u{1F4D0} \uCE94\uBC84\uC2A4 \uC815\uBCF4"),o(),i(6,"div",45)(7,"h5"),r(8,"\u{1F4E6} \uB178\uB4DC \uCEE8\uD14C\uC774\uB108"),o(),i(9,"div",46)(10,"span",47),r(11,"\uC704\uCE58 (top, left):"),o(),i(12,"span",48),r(13),o()(),i(14,"div",46)(15,"span",47),r(16,"\uD06C\uAE30 (w \xD7 h):"),o(),i(17,"span",48),r(18),o()()(),i(19,"div",45)(20,"h5"),r(21,"\u{1F5BC}\uFE0F SVG \uCE94\uBC84\uC2A4 (\uB77C\uC778)"),o(),i(22,"div",46)(23,"span",47),r(24,"\uC704\uCE58 (top, left):"),o(),i(25,"span",48),r(26),o()(),i(27,"div",46)(28,"span",47),r(29,"\uD06C\uAE30 (w \xD7 h):"),o(),i(30,"span",48),r(31),o()()()(),i(32,"div",49)(33,"h4"),r(34,"\u{1F535} \uC2DC\uC791 \uB178\uB4DC (Start)"),o(),i(35,"div",46)(36,"span",47),r(37,"\uC704\uCE58 (top, left):"),o(),i(38,"span",48),r(39),o()(),i(40,"div",46)(41,"span",47),r(42,"\uD06C\uAE30 (w \xD7 h):"),o(),i(43,"span",48),r(44),o()(),i(45,"div",50)(46,"span",47),r(47,"OUT \uC5F0\uACB0\uC810:"),o(),i(48,"span",48),r(49),o()()(),i(50,"div",49)(51,"h4"),r(52,"\u{1F534} \uC885\uB8CC \uB178\uB4DC (End)"),o(),i(53,"div",46)(54,"span",47),r(55,"\uC704\uCE58 (top, left):"),o(),i(56,"span",48),r(57),o()(),i(58,"div",46)(59,"span",47),r(60,"\uD06C\uAE30 (w \xD7 h):"),o(),i(61,"span",48),r(62),o()(),i(63,"div",50)(64,"span",47),r(65,"IN \uC5F0\uACB0\uC810:"),o(),i(66,"span",48),r(67),o()()(),i(68,"div",49)(69,"h4"),r(70,"\u27A1\uFE0F \uC5F0\uACB0 \uB77C\uC778"),o(),i(71,"div",50)(72,"span",47),r(73,"\uC2DC\uC791\uC810 (x1, y1):"),o(),i(74,"span",48),r(75),o()(),i(76,"div",50)(77,"span",47),r(78,"\uB05D\uC810 (x2, y2):"),o(),i(79,"span",48),r(80),o()()(),i(81,"button",51),p("click",function(){f(e);let s=u();return C(s.updateDebugInfo())}),i(82,"mat-icon"),r(83,"refresh"),o(),r(84," \uC0C8\uB85C\uACE0\uCE68 "),o()()(),i(85,"mat-tab",52)(86,"div",43)(87,"div",53)(88,"h4"),r(89,"\u{1F3AF} \uC778\uD150\uD2B8 \uD14C\uC2A4\uD130"),o(),i(90,"p",54),r(91,"\uCC57\uBD07\uC5D0\uC11C \uBC1C\uD654\uD558\uBA74 \uD574\uB2F9 \uC778\uD150\uD2B8\uB97C \uC790\uB3D9\uC73C\uB85C \uCC3E\uC544 \uC2E4\uD589\uD569\uB2C8\uB2E4."),o(),i(92,"div",55)(93,"mat-icon"),r(94,"info"),o(),i(95,"div",56)(96,"strong"),r(97,"\uC0AC\uC6A9 \uBC29\uBC95:"),o(),i(98,"ol")(99,"li"),r(100,"\uC67C\uCABD \uCC57\uBD07 \uC2DC\uBBAC\uB808\uC774\uD130\uC5D0\uC11C \uBA54\uC2DC\uC9C0\uB97C \uC785\uB825\uD558\uC138\uC694"),o(),i(101,"li"),r(102,"\uD604\uC7AC \uD3B8\uC9D1 \uC911\uC778 \uC778\uD150\uD2B8 \uC774\uB984\uACFC \uC77C\uCE58\uD558\uBA74 \uC790\uB3D9 \uC2E4\uD589\uB429\uB2C8\uB2E4"),o(),i(103,"li"),r(104,"\uC778\uD150\uD2B8 \uC774\uB984\uC740 \uC0C1\uB2E8 \uD544\uB4DC\uC5D0\uC11C \uD655\uC778/\uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4"),o()()()(),i(105,"div",57)(106,"div",58)(107,"mat-icon"),r(108,"bookmark"),o(),i(109,"span"),r(110,"\uD604\uC7AC \uC778\uD150\uD2B8"),o()(),i(111,"div",59),O(112,xo,4,1)(113,_o,4,0),o()(),i(114,"div",60)(115,"h5"),r(116,"\u{1F4A1} \uD14C\uC2A4\uD2B8 \uC608\uC2DC"),o(),i(117,"div",61)(118,"strong"),r(119,"\uC778\uD150\uD2B8 \uC774\uB984:"),o(),r(120,' "\uC778\uC0AC\uD558\uAE30"'),M(121,"br"),i(122,"strong"),r(123,"\uCC57\uBD07 \uBC1C\uD654:"),o(),r(124,' "\uC778\uC0AC\uD558\uAE30" \uB610\uB294 "\uC548\uB155" \uB4F1 '),o(),i(125,"div",61)(126,"strong"),r(127,"\uC778\uD150\uD2B8 \uC774\uB984:"),o(),r(128,' "\uC8FC\uBB38\uBC1B\uAE30"'),M(129,"br"),i(130,"strong"),r(131,"\uCC57\uBD07 \uBC1C\uD654:"),o(),r(132,' "\uC8FC\uBB38\uBC1B\uAE30" \uB610\uB294 "\uC8FC\uBB38" \uB4F1 '),o()()()()()()}if(a&2){let e=u(),n=ue(57);l(13),ce("(",e.debugInfo.canvas.nodes.top,", ",e.debugInfo.canvas.nodes.left,")"),l(5),ce("",e.debugInfo.canvas.nodes.width," \xD7 ",e.debugInfo.canvas.nodes.height),l(8),ce("(",e.debugInfo.canvas.svg.top,", ",e.debugInfo.canvas.svg.left,")"),l(5),ce("",e.debugInfo.canvas.svg.width," \xD7 ",e.debugInfo.canvas.svg.height),l(8),ce("(",e.debugInfo.startNode.top,", ",e.debugInfo.startNode.left,")"),l(5),ce("",e.debugInfo.startNode.width," \xD7 ",e.debugInfo.startNode.height),l(5),ce("(",e.debugInfo.startNode.rightDot.left,", ",e.debugInfo.startNode.rightDot.top,")"),l(8),ce("(",e.debugInfo.endNode.top,", ",e.debugInfo.endNode.left,")"),l(5),ce("",e.debugInfo.endNode.width," \xD7 ",e.debugInfo.endNode.height),l(5),ce("(",e.debugInfo.endNode.leftDot.left,", ",e.debugInfo.endNode.leftDot.top,")"),l(8),ce("(",e.debugInfo.line.x1,", ",e.debugInfo.line.y1,")"),l(5),ce("(",e.debugInfo.line.x2,", ",e.debugInfo.line.y2,")"),l(32),E(n?112:113)}}var Gt=class a{container;svg;intentNameInput;fileInput;playSimulator=new kn;width=qe(1200);height=qe(0);get zoomLevel(){return this.chatflowSettingService.zoomLevel}set zoomLevel(t){this.chatflowSettingService.zoomLevel=t}get intentName(){return this.chatflowDataService.intentName}debugInfo={showPanel:!1,canvas:{nodes:{top:0,left:0,width:0,height:0},svg:{top:0,left:0,width:0,height:0}},startNode:{top:0,left:0,rightDot:{top:0,left:0},width:0,height:0},endNode:{top:0,left:0,leftDot:{top:0,left:0},width:0,height:0},line:{x1:0,y1:0,x2:0,y2:0},panelPosition:{top:20,left:window.innerWidth-420},isDragging:!1,dragOffset:{x:0,y:0}};nodesCategories=Object.values(xi);chatflowActionService=v(Re);chatflowSettingService=v(je);chatflowStorageService=v(we);dialog=v(ht);chatbotActionService=v(Fe);chatflowDataService=v(Me);httpClient=v(Fn);snackbar=v(q);debugLogger=v(de);router=v(L);chatflowLogicReader=new Wt(this.chatbotActionService);chatflowEditReader;subscription=new Qe;startNode=null;beforeNode=null;currentChatflowId;ngOnInit(){this.chatflowEditReader=new Ut(this.container),this.chatflowActionService.svg=this.svg;let t=this.container.createComponent(ze);this.startNode=t.instance,this.startNode.myRef=t;let e=this.container.createComponent(Ve);e.instance.myRef=e,setTimeout(()=>this.updateDebugInfo(),100),window.addEventListener("nodePositionChanged",()=>{this.updateDebugInfo()}),this.chatflowDataService.startNode=this.startNode,this.detectIntentInputEvent(),this.chatflowLogicReader.$chatflowEnded.pipe(mt(1)).subscribe(n=>{this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0\uAC00 \uC885\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{duration:900,verticalPosition:"top"})}),this.subscription.add(this.chatflowLogicReader.currentNode$.subscribe(n=>{if(!this.startNode){console.warn("startRef\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(!n){console.log("\uD604\uC7AC \uC9C4\uD589\uC911\uC778 \uB178\uB4DC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. \uC544\uB9C8\uB3C4 \uB05D\uB0AC\uC74C?");return}if(n.type==="start"){this.beforeNode=this.startNode,this.startNode.isItExcecuting=!0;return}if(!this.beforeNode){console.warn("beforeNode\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let s=this.beforeNode.rightConnectedList[n.id];if(!s){console.warn("id\uB97C \uCC3E\uC744 \uC218\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.",this.beforeNode);return}s.node.isItExcecuting=!0,this.beforeNode.isItExcecuting=!1,this.beforeNode=s.node}))}ngOnDestroy(){this.subscription.unsubscribe()}detectIntentInputEvent(){this.subscription.add(_n(this.intentNameInput.nativeElement,"keyup").pipe(vn(2e3)).subscribe(t=>{this.chatflowDataService.intentName=t.target.value}))}onAddingNodeClick(t){let e=this.container.createComponent(t);e.instance.myRef=e,e.instance.addToUnconnected()}onShareClick(){this.dialog.open(Qt,{})}onPlayClick(){this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC2DC\uBBAC\uB808\uC774\uC158","\u{1F3AE} \uC2DC\uBBAC\uB808\uC774\uC158 \uC2DC\uC791 \uBC84\uD2BC \uD074\uB9AD\uB428"),this.playSimulator.emit()}onUploadJsonClick(){this.fileInput.nativeElement.click()}onLoadFromStorageClick(){this.dialog.open(Ht,{width:"600px",maxHeight:"80vh"}).afterClosed().pipe(mt(1)).subscribe(e=>{e&&e.action==="load"&&e.chatflow&&this.loadChatflowFromStorage(e.chatflow)})}onSaveToStorageClick(){let t=this.chatflowDataService.createJsonData();this.dialog.open(Yt,{width:"450px",data:{chatflow:t,currentId:this.currentChatflowId}}).afterClosed().pipe(mt(1)).subscribe(n=>{n&&n.success&&(this.currentChatflowId=n.id,this.debugLogger.success("\uCC57\uD50C\uB85C\uC6B0-\uC800\uC7A5",`\u2705 \uCC57\uD50C\uB85C\uC6B0 \uC800\uC7A5 \uC644\uB8CC: ${n.id}`))})}loadChatflowFromStorage(t){try{this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uBD88\uB7EC\uC624\uAE30",`\u{1F4C2} \uCC57\uD50C\uB85C\uC6B0 \uBD88\uB7EC\uC624\uAE30 \uC2DC\uC791: ${t.intentName}`),this.container.clear(),this.chatflowDataService.intentName=t.intentName;let e=this.chatflowEditReader.locateChatflowNodes(t);this.chatflowDataService.startNode=e,this.startNode=e,this.currentChatflowId=t.id,setTimeout(()=>this.updateDebugInfo(),100),this.snackbar.open(`"${t.intentName}" \uCC57\uD50C\uB85C\uC6B0\uB97C \uBD88\uB7EC\uC654\uC2B5\uB2C8\uB2E4.`,"",{duration:2e3,verticalPosition:"top"}),this.debugLogger.success("\uCC57\uD50C\uB85C\uC6B0-\uBD88\uB7EC\uC624\uAE30","\u2705 \uCC57\uD50C\uB85C\uC6B0 \uBD88\uB7EC\uC624\uAE30 \uC644\uB8CC")}catch(e){this.debugLogger.error("\uCC57\uD50C\uB85C\uC6B0-\uBD88\uB7EC\uC624\uAE30",`\u274C \uCC57\uD50C\uB85C\uC6B0 \uBD88\uB7EC\uC624\uAE30 \uC2E4\uD328: ${e}`),console.error("\uCC57\uD50C\uB85C\uC6B0 \uBD88\uB7EC\uC624\uAE30 \uC624\uB958:",e),this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0\uB97C \uBD88\uB7EC\uC624\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","",{duration:2e3,verticalPosition:"top"})}}onFileSelected(t){let e=t.target;if(e.files&&e.files.length>0){let n=e.files[0];if(n.name.endsWith(".json")){let s=new FileReader;s.onload=c=>{if(!s.result){this.snackbar.open("\uB0B4\uC6A9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.","",{duration:900,verticalPosition:"top"});return}let m=JSON.parse(s.result);this.chatflowDataService.intentName=m.intentName,this.container.clear();let w=this.chatflowEditReader.locateChatflowNodes(m);this.chatflowDataService.startNode=w,this.startNode=w},s.readAsText(n)}else alert("JSON \uD30C\uC77C\uB9CC \uC5C5\uB85C\uB4DC \uAC00\uB2A5\uD569\uB2C8\uB2E4.")}}onMouseMove(t){this.chatflowActionService.movingNode&&(this.chatflowActionService.movingNode.onMouseMove(t),this.updateDebugInfo())}onMouseUp(t){this.chatflowActionService.movingNode&&(this.chatflowActionService.movingNode=null,this.updateDebugInfo())}zoomIn(){this.zoomLevel<200&&(this.zoomLevel=Math.min(200,this.zoomLevel+10))}zoomOut(){this.zoomLevel>50&&(this.zoomLevel=Math.max(50,this.zoomLevel-10))}resetZoom(){this.zoomLevel=100}onWheel(t){(t.ctrlKey||t.metaKey)&&(t.preventDefault(),t.deltaY<0?this.zoomIn():this.zoomOut())}handleKeyboard(t){(t.ctrlKey||t.metaKey)&&(t.key==="+"||t.key==="="?(t.preventDefault(),this.zoomIn()):t.key==="-"?(t.preventDefault(),this.zoomOut()):t.key==="0"&&(t.preventDefault(),this.resetZoom()))}updateDebugInfo(){if(!this.startNode)return;let t=Object.values(this.startNode.rightConnectedList)[0]?.node,e=this.startNode.elementRef?.nativeElement,n=T=>{if(!T)return null;let H=T.querySelector(".node-card");if(!H&&T.children.length>0){let rt=T.children[0];rt.classList.contains("node-card")&&(H=rt)}return!H&&T.classList.contains("node-card")&&(H=T),H||T},s=n(e),c=this.container.element.nativeElement.parentElement,m=this.svg.nativeElement,w=m.parentElement;if(this.debugInfo.canvas={nodes:{top:c?.offsetTop||0,left:c?.offsetLeft||0,width:c?.offsetWidth||0,height:c?.offsetHeight||0},svg:{top:w?.offsetTop||0,left:w?.offsetLeft||0,width:m?.clientWidth||0,height:m?.clientHeight||0}},this.debugInfo.startNode={top:this.startNode.top,left:this.startNode.left,width:s?.offsetWidth||0,height:s?.offsetHeight||0,rightDot:{top:this.startNode.rightDotPosition.top,left:this.startNode.rightDotPosition.left}},t){let T=t.elementRef?.nativeElement,H=n(T);this.debugInfo.endNode={top:t.top,left:t.left,width:H?.offsetWidth||0,height:H?.offsetHeight||0,leftDot:{top:t.leftDotPosition.top,left:t.leftDotPosition.left}},this.debugInfo.line={x1:this.startNode.rightDotPosition.left,y1:this.startNode.rightDotPosition.top,x2:t.leftDotPosition.left,y2:t.leftDotPosition.top}}else this.debugInfo.endNode={top:0,left:0,width:0,height:0,leftDot:{top:0,left:0}},this.debugInfo.line={x1:0,y1:0,x2:0,y2:0}}toggleDebugPanel(){this.debugInfo.showPanel=!this.debugInfo.showPanel}copyAllDebugInfo(){let t=`
\uFFFD \uCE94\uBC84\uC2A4 \uC815\uBCF4

\u{1F4E6} \uB178\uB4DC \uCEE8\uD14C\uC774\uB108
\uC704\uCE58: (${this.debugInfo.canvas.nodes.top}, ${this.debugInfo.canvas.nodes.left})
\uD06C\uAE30: ${this.debugInfo.canvas.nodes.width} \xD7 ${this.debugInfo.canvas.nodes.height}

\u{1F5BC}\uFE0F SVG \uCE94\uBC84\uC2A4 (\uB77C\uC778)
\uC704\uCE58: (${this.debugInfo.canvas.svg.top}, ${this.debugInfo.canvas.svg.left})
\uD06C\uAE30: ${this.debugInfo.canvas.svg.width} \xD7 ${this.debugInfo.canvas.svg.height}

---

\uFFFD\u{1F535} \uC2DC\uC791 \uB178\uB4DC (Start)
\uC704\uCE58: (${this.debugInfo.startNode.top}, ${this.debugInfo.startNode.left})
\uD06C\uAE30: ${this.debugInfo.startNode.width} \xD7 ${this.debugInfo.startNode.height}
OUT \uC5F0\uACB0\uC810: (${this.debugInfo.startNode.rightDot.left}, ${this.debugInfo.startNode.rightDot.top})

\u{1F534} \uC885\uB8CC \uB178\uB4DC (End)
\uC704\uCE58: (${this.debugInfo.endNode.top}, ${this.debugInfo.endNode.left})
\uD06C\uAE30: ${this.debugInfo.endNode.width} \xD7 ${this.debugInfo.endNode.height}
IN \uC5F0\uACB0\uC810: (${this.debugInfo.endNode.leftDot.left}, ${this.debugInfo.endNode.leftDot.top})

\u27A1\uFE0F \uC5F0\uACB0 \uB77C\uC778
\uC2DC\uC791\uC810: (${this.debugInfo.line.x1}, ${this.debugInfo.line.y1})
\uB05D\uC810: (${this.debugInfo.line.x2}, ${this.debugInfo.line.y2})
    `.trim();navigator.clipboard.writeText(t).then(()=>{this.snackbar.open("\uC804\uCCB4 \uC88C\uD45C \uC815\uBCF4 \uBCF5\uC0AC\uB428","",{duration:1500,verticalPosition:"top"})}).catch(e=>{console.error("\uBCF5\uC0AC \uC2E4\uD328:",e),this.snackbar.open("\uBCF5\uC0AC \uC2E4\uD328","",{duration:1500,verticalPosition:"top"})})}copyToClipboard(t,e){navigator.clipboard.writeText(t).then(()=>{this.snackbar.open(`${e} \uBCF5\uC0AC\uB428: ${t}`,"",{duration:1500,verticalPosition:"top"})}).catch(n=>{console.error("\uBCF5\uC0AC \uC2E4\uD328:",n),this.snackbar.open("\uBCF5\uC0AC \uC2E4\uD328","",{duration:1500,verticalPosition:"top"})})}onDebugPanelMouseDown(t){t.target.closest(".debug-header")&&(this.debugInfo.isDragging=!0,this.debugInfo.dragOffset={x:t.clientX-this.debugInfo.panelPosition.left,y:t.clientY-this.debugInfo.panelPosition.top},t.preventDefault())}onDebugPanelMouseMove(t){this.debugInfo.isDragging&&(this.debugInfo.panelPosition={left:t.clientX-this.debugInfo.dragOffset.x,top:t.clientY-this.debugInfo.dragOffset.y})}onDebugPanelMouseUp(){this.debugInfo.isDragging=!1}onLogout(){localStorage.removeItem("authToken"),localStorage.removeItem("username"),this.debugLogger.info("\uC2DC\uC2A4\uD15C","\uB85C\uADF8\uC544\uC6C3 \uC644\uB8CC"),this.snackbar.open("\uB85C\uADF8\uC544\uC6C3\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{duration:1500,verticalPosition:"top"}),setTimeout(()=>{this.router.navigate(["/login"])},500)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["app-chatflow-edit"]],viewQuery:function(e,n){if(e&1&&(ee(lo,7,He),ee(po,7),ee(mo,7),ee(uo,5)),e&2){let s;te(s=ne())&&(n.container=s.first),te(s=ne())&&(n.svg=s.first),te(s=ne())&&(n.intentNameInput=s.first),te(s=ne())&&(n.fileInput=s.first)}},hostBindings:function(e,n){e&1&&p("mousemove",function(c){return n.onMouseMove(c)})("mouseup",function(c){return n.onMouseUp(c)})("keydown",function(c){return n.handleKeyboard(c)},On)("mousemove",function(c){return n.onDebugPanelMouseMove(c)},pn)("mouseup",function(){return n.onDebugPanelMouseUp()},pn)},inputs:{width:[1,"width"],height:[1,"height"]},outputs:{playSimulator:"playSimulator"},standalone:!1,decls:113,vars:31,consts:[["saveMenu","matMenu"],["loadMenu","matMenu"],["intentName",""],["svg",""],["container",""],["mainMenu","matMenu"],["fileInput",""],["catMenu","matMenu"],[1,"chatflow-edit-container",3,"ngStyle"],[1,"toolbar"],["mat-raised-button","","color","primary",1,"add-node-btn",3,"matMenuTriggerFor"],[1,"toolbar-actions"],["mat-icon-button","","title","\uC2DC\uBBAC\uB808\uC774\uC158 \uC2E4\uD589",1,"action-btn",3,"click"],["mat-icon-button","","title","\uC800\uC7A5",1,"action-btn",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-icon-button","","title","\uBD88\uB7EC\uC624\uAE30",1,"action-btn",3,"matMenuTriggerFor"],[1,"zoom-controls"],["mat-icon-button","","title","\uCD95\uC18C (Ctrl + -)",3,"click","disabled"],[1,"zoom-level"],["mat-icon-button","","title","\uD655\uB300 (Ctrl + +)",3,"click","disabled"],["mat-icon-button","","title","\uC6D0\uB798 \uD06C\uAE30 (Ctrl + 0)",3,"click"],["appearance","outline",1,"intent-name-field"],["matInput","","placeholder","\uC608: \uC778\uC0AC\uD558\uAE30, \uC8FC\uBB38\uBC1B\uAE30, \uC0C1\uB2F4\uD558\uAE30","matTooltip","\uC774 \uCC57\uD50C\uB85C\uC6B0\uB97C \uAD6C\uBD84\uD558\uB294 \uACE0\uC720\uD55C \uC774\uB984\uC785\uB2C8\uB2E4. \uC800\uC7A5/\uBD88\uB7EC\uC624\uAE30 \uC2DC \uC0AC\uC6A9\uB429\uB2C8\uB2E4.",3,"value"],["matSuffix","","matTooltip","DB\uC5D0 \uC800\uC7A5\uB428",1,"saved-indicator"],[1,"connection-guide"],[1,"guide-item","info-item"],[1,"info-icon"],[1,"guide-item"],[1,"chatflow-canvas",3,"wheel"],[3,"ngStyle"],[1,"node-menu"],["type","file","accept",".json",2,"display","none",3,"change"],[1,"debug-panel",3,"ngStyle"],[1,"debug-header",3,"mousedown"],[3,"click"],[1,"header-buttons"],["mat-icon-button","","title","\uC804\uCCB4 \uBCF5\uC0AC",1,"copy-all-btn",3,"click"],["animationDuration","0ms",1,"debug-tabs"],["mat-menu-item","",1,"category-menu-item",3,"matMenuTriggerFor"],[1,"arrow"],["mat-menu-item","",1,"node-menu-item"],["mat-menu-item","",1,"node-menu-item",3,"click"],["label","\uC88C\uD45C \uC815\uBCF4"],[1,"debug-content","tab-content"],[1,"debug-section","canvas-section"],[1,"subsection"],[1,"debug-row"],[1,"label"],[1,"value"],[1,"debug-section"],[1,"debug-row","highlight"],["mat-stroked-button","",1,"refresh-btn",3,"click"],["label","\uC778\uD150\uD2B8 \uC2E4\uD589"],[1,"intent-runner-section"],[1,"description"],[1,"intent-info"],[1,"info-text"],[1,"current-intent-box"],[1,"box-header"],[1,"box-content"],[1,"test-examples"],[1,"example-item"],[1,"intent-badge","active"],[1,"status-text"],[1,"intent-badge","inactive"]],template:function(e,n){if(e&1){let s=y();i(0,"div",8)(1,"div",9)(2,"button",10)(3,"mat-icon"),r(4,"add_circle"),o(),i(5,"span"),r(6,"\uB178\uB4DC \uC0DD\uC131"),o()(),i(7,"div",11)(8,"button",12),p("click",function(){return f(s),C(n.onPlayClick())}),i(9,"mat-icon"),r(10,"play_circle"),o()(),i(11,"button",13)(12,"mat-icon"),r(13,"save"),o()(),i(14,"mat-menu",null,0)(16,"button",14),p("click",function(){return f(s),C(n.onSaveToStorageClick())}),i(17,"mat-icon"),r(18,"save"),o(),i(19,"span"),r(20,"DB\uC5D0 \uC800\uC7A5"),o()(),i(21,"button",14),p("click",function(){return f(s),C(n.onShareClick())}),i(22,"mat-icon"),r(23,"ios_share"),o(),i(24,"span"),r(25,"JSON \uB0B4\uBCF4\uB0B4\uAE30"),o()()(),i(26,"button",15)(27,"mat-icon"),r(28,"folder_open"),o()(),i(29,"mat-menu",null,1)(31,"button",14),p("click",function(){return f(s),C(n.onLoadFromStorageClick())}),i(32,"mat-icon"),r(33,"storage"),o(),i(34,"span"),r(35,"DB\uC5D0\uC11C \uBD88\uB7EC\uC624\uAE30"),o()(),i(36,"button",14),p("click",function(){return f(s),C(n.onUploadJsonClick())}),i(37,"mat-icon"),r(38,"upload_file"),o(),i(39,"span"),r(40,"JSON \uD30C\uC77C \uBD88\uB7EC\uC624\uAE30"),o()()()(),i(41,"div",16)(42,"button",17),p("click",function(){return f(s),C(n.zoomOut())}),i(43,"mat-icon"),r(44,"zoom_out"),o()(),i(45,"span",18),r(46),o(),i(47,"button",19),p("click",function(){return f(s),C(n.zoomIn())}),i(48,"mat-icon"),r(49,"zoom_in"),o()(),i(50,"button",20),p("click",function(){return f(s),C(n.resetZoom())}),i(51,"mat-icon"),r(52,"refresh"),o()()(),i(53,"mat-form-field",21)(54,"mat-label"),r(55,"\uC778\uD150\uD2B8 \uC774\uB984 (\uCC57\uD50C\uB85C\uC6B0 \uC2DD\uBCC4\uC790)"),o(),M(56,"input",22,2),i(58,"mat-hint"),r(59,"\uCC57\uD50C\uB85C\uC6B0\uB97C \uAD6C\uBD84\uD558\uB294 \uC774\uB984 (\uC608: \uC778\uC0AC, \uC0C1\uB2F4, \uC8FC\uBB38)"),o(),O(60,Co,2,0,"mat-icon",23),o()(),i(61,"div",24)(62,"div",25)(63,"mat-icon",26),r(64,"info"),o(),i(65,"span")(66,"strong"),r(67,"\uC778\uD150\uD2B8\uB780?"),o(),r(68,' \uCC57\uD50C\uB85C\uC6B0\uB97C \uAD6C\uBD84\uD558\uB294 \uC774\uB984\uC785\uB2C8\uB2E4 (\uC608: "\uC0C1\uB2F4\uD558\uAE30", "\uC8FC\uBB38\uBC1B\uAE30")'),o()(),i(69,"div",27)(70,"mat-icon"),r(71,"touch_app"),o(),i(72,"span")(73,"strong"),r(74,"\uC5F0\uACB0:"),o(),r(75," \uB178\uB4DC\uC758 OUT \uC810 \u2192 \uB2E4\uC74C \uB178\uB4DC\uC758 IN \uC810 \uD074\uB9AD"),o()(),i(76,"div",27)(77,"mat-icon"),r(78,"open_with"),o(),i(79,"span")(80,"strong"),r(81,"\uC774\uB3D9:"),o(),r(82," \uB178\uB4DC\uB97C \uB4DC\uB798\uADF8\uD558\uC5EC \uC704\uCE58 \uBCC0\uACBD"),o()(),i(83,"div",27)(84,"mat-icon"),r(85,"edit"),o(),i(86,"span")(87,"strong"),r(88,"\uD3B8\uC9D1:"),o(),r(89," \uB178\uB4DC \uD5E4\uB354\uC758 \uC5F0\uD544 \uC544\uC774\uCF58 \uD074\uB9AD"),o()()(),i(90,"div",28),p("wheel",function(m){return f(s),C(n.onWheel(m))}),Mn(),M(91,"svg",29,3),wn(),i(93,"div",29),ut(94,null,4),o()()(),i(96,"mat-menu",30,5),re(98,bo,11,3,null,null,vi),o(),i(100,"input",31,6),p("change",function(m){return f(s),C(n.onFileSelected(m))}),o(),i(102,"div",32)(103,"div",33),p("mousedown",function(m){return f(s),C(n.onDebugPanelMouseDown(m))}),i(104,"mat-icon"),r(105),o(),i(106,"span",34),p("click",function(){return f(s),C(n.toggleDebugPanel())}),r(107,"\uCC57\uD50C\uB85C\uC6B0 \uC815\uBCF4 \uD328\uB110"),o(),i(108,"div",35)(109,"button",36),p("click",function(m){return f(s),n.copyAllDebugInfo(),C(m.stopPropagation())}),i(110,"mat-icon"),r(111,"content_copy"),o()()()(),O(112,vo,133,25,"mat-tab-group",37),o()}if(e&2){let s=ue(15),c=ue(30),m=ue(97);d("ngStyle",Ln(18,go,n.height()?n.height():"")),l(2),d("matMenuTriggerFor",m),l(9),d("matMenuTriggerFor",s),l(15),d("matMenuTriggerFor",c),l(16),d("disabled",n.zoomLevel<=50),l(4),x("",n.zoomLevel,"%"),l(),d("disabled",n.zoomLevel>=200),l(9),d("value",n.chatflowDataService.intentName),l(4),E(n.currentChatflowId?60:-1),l(31),d("ngStyle",mn(20,_i,n.width(),n.height(),"scale("+n.zoomLevel/100+")")),l(2),d("ngStyle",mn(24,_i,n.width(),n.height(),"scale("+n.zoomLevel/100+")")),l(5),se(n.nodesCategories),l(4),J("collapsed",!n.debugInfo.showPanel),d("ngStyle",gt(28,fo,n.debugInfo.panelPosition.top,n.debugInfo.panelPosition.left)),l(),Tn("cursor",n.debugInfo.isDragging?"grabbing":"grab"),l(2),h(n.debugInfo.showPanel?"drag_indicator":"expand_less"),l(7),E(n.debugInfo.showPanel?112:-1)}},dependencies:[ft,R,F,V,Ae,Un,A,ae,N,Pt,yt,Ke,wt,qn,Yn],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;width:100%;height:100%;background:#f5f5f5}.chatflow-edit-container[_ngcontent-%COMP%]{width:100%;height:100%;padding:15px;box-sizing:border-box;display:flex;flex-direction:column;gap:12px;background:transparent}.toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:12px 20px;background:#fffffff2;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border-radius:14px;margin-bottom:16px;box-shadow:0 2px 12px #667eea14;border:1px solid rgba(102,126,234,.12)}.toolbar[_ngcontent-%COMP%]   .add-node-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:10px;padding:0 20px;height:40px;font-weight:600;font-size:14px;box-shadow:0 2px 8px #667eea40;transition:all .3s cubic-bezier(.4,0,.2,1);border:none;flex-shrink:0}.toolbar[_ngcontent-%COMP%]   .add-node-btn[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #667eea59;transform:translateY(-2px);background:linear-gradient(135deg,#7c8ef5,#8a5bb8)}.toolbar[_ngcontent-%COMP%]   .add-node-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 6px #667eea4d}.toolbar[_ngcontent-%COMP%]   .add-node-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px;font-size:20px;width:20px;height:20px}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px;background:#667eea0a;border-radius:10px;flex-shrink:0}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{width:40px;height:40px;background:#fff;color:#667eea;border-radius:8px;position:relative;transition:all .25s cubic-bezier(.4,0,.2,1);box-shadow:0 1px 3px #00000014;border:1px solid rgba(102,126,234,.15)}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;border-radius:8px;background:linear-gradient(135deg,#667eea1a,#764ba21a);opacity:0;transition:opacity .25s}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover{background:#fff;border-color:#667eea4d;box-shadow:0 2px 8px #667eea26;transform:translateY(-1px)}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover:before{opacity:1}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 4px #667eea33}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px;transition:transform .2s}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:nth-child(1):hover{color:#4caf50;border-color:#4caf504d}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:nth-child(2):hover{color:#ff9800;border-color:#ff98004d}.toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:nth-child(3):hover{color:#2196f3;border-color:#2196f34d}.toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:4px 10px;background:#667eea0f;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:10px;border:1px solid rgba(102,126,234,.15);flex-shrink:0;margin-left:auto}.toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;color:#667eea;transition:all .2s}.toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#667eea1a;transform:scale(1.05)}.toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{color:#00000042}.toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]   .zoom-level[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#667eea;min-width:48px;text-align:center;background:#667eea1a;padding:4px 10px;border-radius:6px}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]{margin-left:12px;flex-shrink:0;width:280px}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]   .saved-indicator[_ngcontent-%COMP%]{color:#4caf50;font-size:20px;animation:_ngcontent-%COMP%_pulse 2s infinite}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field{font-size:14px}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{background:#fff;padding:0}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding-top:10px;padding-bottom:10px;min-height:auto}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mdc-text-field{padding-left:14px;padding-right:14px}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     input{font-size:14px;line-height:1.4}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field-focus-overlay{background:#667eea08}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mdc-notched-outline__leading, .toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mdc-notched-outline__notch, .toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mdc-notched-outline__trailing{border-color:#667eea33!important}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field.mat-focused .mdc-notched-outline__leading, .toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field.mat-focused .mdc-notched-outline__notch, .toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field.mat-focused .mdc-notched-outline__trailing{border-color:#667eea!important;border-width:2px!important}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mdc-floating-label{font-size:13px}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]     .mat-mdc-form-field.mat-form-field-should-float .mdc-floating-label--float-above{font-size:11px}@media (max-width: 1200px){.toolbar[_ngcontent-%COMP%]{flex-wrap:wrap;gap:12px}.toolbar[_ngcontent-%COMP%]   .zoom-controls[_ngcontent-%COMP%]{margin-left:0}.toolbar[_ngcontent-%COMP%]   .intent-name-field[_ngcontent-%COMP%]{margin-left:0;width:100%;max-width:280px}}.connection-guide[_ngcontent-%COMP%]{display:flex;gap:20px;padding:12px 20px;background:#fffffff2;border-radius:10px;box-shadow:0 2px 8px #0000000f;flex-wrap:wrap}.connection-guide[_ngcontent-%COMP%]   .guide-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:12px;color:#555}.connection-guide[_ngcontent-%COMP%]   .guide-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#667eea}.connection-guide[_ngcontent-%COMP%]   .guide-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#667eea;font-weight:600}.connection-guide[_ngcontent-%COMP%]   .guide-item.info-item[_ngcontent-%COMP%]{flex:0 0 100%;background:linear-gradient(135deg,#667eea14,#764ba214);padding:8px 12px;border-radius:8px;border:1px dashed rgba(102,126,234,.3);margin-bottom:4px}.connection-guide[_ngcontent-%COMP%]   .guide-item.info-item[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{color:#667eea;font-size:20px;width:20px;height:20px}.connection-guide[_ngcontent-%COMP%]   .guide-item.info-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#667eea}.connection-guide[_ngcontent-%COMP%]   .guide-item.info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#555}.canvas[_ngcontent-%COMP%], .chatflow-canvas[_ngcontent-%COMP%]{position:relative;flex:1;background:linear-gradient(90deg,rgba(200,200,200,.1) 1px,transparent 1px),linear-gradient(rgba(200,200,200,.1) 1px,transparent 1px),#fff;background-size:20px 20px;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:16px;overflow:auto;box-shadow:inset 0 2px 8px #0000000d;border:1px solid rgba(255,255,255,.3);cursor:grab}.canvas[_ngcontent-%COMP%]:active, .chatflow-canvas[_ngcontent-%COMP%]:active{cursor:grabbing}.canvas[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .canvas[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .chatflow-canvas[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .chatflow-canvas[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{transition:transform .2s ease}.canvas[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .chatflow-canvas[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;pointer-events:none;z-index:100;transform-origin:0 0;overflow:visible}.canvas[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   line[_ngcontent-%COMP%], .chatflow-canvas[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   line[_ngcontent-%COMP%]{stroke:#667eea;stroke-width:4;opacity:.8;filter:drop-shadow(0 2px 6px rgba(102,126,234,.4));stroke-linecap:round}.canvas[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .chatflow-canvas[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;left:0;transform-origin:0 0}  .node-menu .mat-mdc-menu-panel{border-radius:12px;box-shadow:0 8px 24px #0000001f;overflow:hidden;min-width:200px}  .category-menu-item{display:flex;align-items:center;gap:12px;padding:14px 20px;font-size:15px;font-weight:600;color:#333}  .category-menu-item mat-icon:first-child{color:#667eea;font-size:22px;width:22px;height:22px}  .category-menu-item .arrow{margin-left:auto;color:#999;font-size:20px;width:20px;height:20px}  .category-menu-item:hover{background:linear-gradient(90deg,rgba(102,126,234,.1) 0%,transparent 100%)}  .node-menu-item{display:flex;align-items:center;gap:12px;padding:12px 20px;font-size:14px;color:#555}  .node-menu-item mat-icon{color:#764ba2;font-size:20px;width:20px;height:20px}  .node-menu-item:hover{background:#764ba214;color:#764ba2;font-weight:500}.debug-panel[_ngcontent-%COMP%]{position:fixed;width:400px;background:#ffffffbf;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:2px solid rgba(102,126,234,.2);overflow:hidden;z-index:1000;transition:width .3s ease;-webkit-user-select:none;user-select:none}.debug-panel.collapsed[_ngcontent-%COMP%]{width:180px}.debug-panel.collapsed[_ngcontent-%COMP%]   .debug-content[_ngcontent-%COMP%]{display:none}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 16px;background:#667eead9;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#fff;font-weight:600;font-size:14px;-webkit-user-select:none;user-select:none}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;cursor:pointer}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   .header-buttons[_ngcontent-%COMP%]{display:flex;gap:4px;align-items:center}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]{color:#fff;width:32px;height:32px;line-height:32px}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]:hover{background:#ff453a4d}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   .copy-all-btn[_ngcontent-%COMP%]{color:#fff;width:32px;height:32px;line-height:32px}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   .copy-all-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]   .copy-all-btn[_ngcontent-%COMP%]:hover{background:#fff3}.debug-panel[_ngcontent-%COMP%]   .debug-header[_ngcontent-%COMP%]:hover{background:#667eeaf2}.debug-panel[_ngcontent-%COMP%]   .debug-tabs[_ngcontent-%COMP%]{height:100%}.debug-panel[_ngcontent-%COMP%]   .debug-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-labels{background:#667eea0d;border-radius:8px 8px 0 0}.debug-panel[_ngcontent-%COMP%]   .debug-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-label{color:#666;font-weight:600}.debug-panel[_ngcontent-%COMP%]   .debug-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-label.mdc-tab--active{color:#667eea}.debug-panel[_ngcontent-%COMP%]   .debug-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:20px}.debug-panel[_ngcontent-%COMP%]   .debug-content[_ngcontent-%COMP%]{padding:16px;max-height:600px;overflow-y:auto}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:18px;font-weight:700;color:#333}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin:0 0 20px;font-size:14px;color:#666;line-height:1.6}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .intent-info[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;background:linear-gradient(135deg,#667eea14,#764ba214);border-radius:12px;border:1px dashed rgba(102,126,234,.3);margin-bottom:24px}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .intent-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea;font-size:24px;width:24px;height:24px;flex-shrink:0}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .intent-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{flex:1;font-size:13px;line-height:1.6;color:#555}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .intent-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#333;font-size:14px}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .intent-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:8px 0 0;padding-left:20px}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .intent-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px;color:#666}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .intent-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid rgba(102,126,234,.2);overflow:hidden;margin-bottom:24px;box-shadow:0 2px 8px #667eea14}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]   .box-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-weight:600;font-size:14px}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]   .box-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]{padding:20px}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]   .intent-badge[_ngcontent-%COMP%]{display:inline-block;padding:8px 16px;border-radius:20px;font-weight:600;font-size:16px;margin-bottom:12px}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]   .intent-badge.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea26,#764ba226);color:#667eea;border:2px solid #667eea}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]   .intent-badge.inactive[_ngcontent-%COMP%]{background:#0000000d;color:#999;border:2px dashed #ccc}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .current-intent-box[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{margin:0;font-size:13px;line-height:1.6;color:#666}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .test-examples[_ngcontent-%COMP%]{background:#ffc10714;border-radius:12px;padding:16px;border:1px solid rgba(255,193,7,.3)}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .test-examples[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:600;color:#f57c00}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .test-examples[_ngcontent-%COMP%]   .example-item[_ngcontent-%COMP%]{padding:12px;background:#fff;border-radius:8px;margin-bottom:8px;font-size:13px;line-height:1.8;color:#555;border-left:3px solid #ffa726}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .test-examples[_ngcontent-%COMP%]   .example-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.debug-panel[_ngcontent-%COMP%]   .intent-runner-section[_ngcontent-%COMP%]   .test-examples[_ngcontent-%COMP%]   .example-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333;font-weight:600}.debug-panel[_ngcontent-%COMP%]   .debug-section[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid rgba(0,0,0,.08)}.debug-panel[_ngcontent-%COMP%]   .debug-section[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.debug-panel[_ngcontent-%COMP%]   .debug-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:700;color:#333}.debug-panel[_ngcontent-%COMP%]   .debug-section.canvas-section[_ngcontent-%COMP%]{background:#667eea0d;padding:12px;border-radius:8px;border:1px solid rgba(102,126,234,.2)}.debug-panel[_ngcontent-%COMP%]   .debug-section.canvas-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#667eea;margin-bottom:16px}.debug-panel[_ngcontent-%COMP%]   .debug-section.canvas-section[_ngcontent-%COMP%]   .subsection[_ngcontent-%COMP%]{margin-bottom:12px;padding-left:8px;border-left:2px solid rgba(102,126,234,.3)}.debug-panel[_ngcontent-%COMP%]   .debug-section.canvas-section[_ngcontent-%COMP%]   .subsection[_ngcontent-%COMP%]:last-child{margin-bottom:0}.debug-panel[_ngcontent-%COMP%]   .debug-section.canvas-section[_ngcontent-%COMP%]   .subsection[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 8px;font-size:12px;font-weight:600;color:#555}.debug-panel[_ngcontent-%COMP%]   .debug-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;margin-bottom:4px;background:#00000005;border-radius:6px;font-size:13px}.debug-panel[_ngcontent-%COMP%]   .debug-row.highlight[_ngcontent-%COMP%]{background:#667eea1a;border-left:3px solid #667eea}.debug-panel[_ngcontent-%COMP%]   .debug-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:600;color:#666}.debug-panel[_ngcontent-%COMP%]   .debug-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:Courier New,monospace;color:#333;background:#fffc;padding:4px 8px;border-radius:4px;font-size:12px}.debug-panel[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]{width:100%;margin-top:12px;border-color:#667eea;color:#667eea;font-weight:600}.debug-panel[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]:hover{background:#667eea1a}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.6}}']})};var Jt=class a{contextManager=v(ri);chatbotActionService=v(Fe);snackbar=v(q);subscription=new Qe;ngOnInit(){this.initializeMainContext()}ngOnDestroy(){this.subscription.unsubscribe(),this.contextManager.clearAllContexts()}initializeMainContext(){let t=new hi("main",this.contextManager,this.chatbotActionService);this.contextManager.registerContext("main",t),this.contextManager.changeContext(t),this.subscription.add(t.$chatflowEnded.subscribe(()=>{this.snackbar.open("\uCC57\uD50C\uB85C\uC6B0\uAC00 \uC885\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","",{duration:900,verticalPosition:"top"})})),console.log("\uBA54\uC778 \uCEE8\uD14D\uC2A4\uD2B8 \uCD08\uAE30\uD654 \uC644\uB8CC")}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["app-chatflow"]],standalone:!1,decls:6,vars:3,consts:[[1,"chatflow-wrapper"],[2,"display","flex","width","100%","height","100vh","background","#1a1a2e"],[2,"width","400px","height","100%","border-right","1px solid #2a2a3e"],[3,"width"],[2,"width","calc(100% - 400px)","height","100%"],[3,"width","height"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),M(3,"app-chatbot",3),o(),i(4,"div",4),M(5,"app-chatflow-edit",5),o()()()),e&2&&(l(3),d("width",400),l(2),d("width",1800)("height",1200))},dependencies:[It,Gt],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})};var ye=class a{diaryEntries=[{entryDate:"2025-10-20",generationInfo:"10\uC6D4 20\uC77C\uC758 \uC6D0\uC815 \uAE30\uB85D",content:"\uCCAB \uC6D0\uC815\uC744 \uB5A0\uB0AC\uB2E4. \uB0AF\uC120 \uAE38\uC744 \uAC77\uB294 \uAC83\uC740 \uB450\uB835\uAE30\uB3C4 \uD558\uACE0 \uC124\uB808\uAE30\uB3C4 \uD588\uB2E4. \uC624\uB298 \uB9CC\uB09C \uC0AC\uB78C\uB4E4\uACFC\uC758 \uB300\uD654\uAC00 \uB0B4\uAC8C \uC0C8\uB85C\uC6B4 \uC601\uAC10\uC744 \uC8FC\uC5C8\uACE0, \uC55E\uC73C\uB85C\uC758 \uC5EC\uC815\uC774 \uAE30\uB300\uB41C\uB2E4.",emotion:"\uC124\uB818",event:"\uCCAB \uC6D0\uC815 \uC2DC\uC791"},{entryDate:"2025-10-21",generationInfo:"10\uC6D4 21\uC77C\uC758 \uC6D0\uC815 \uAE30\uB85D",content:"\uC0B0\uC744 \uB118\uACE0 \uAC15\uC744 \uAC74\uB11C\uB2E4. \uD798\uB4E0 \uC5EC\uC815\uC774\uC5C8\uC9C0\uB9CC \uB3D9\uB8CC\uB4E4\uACFC \uD568\uAED8\uC5EC\uC11C \uADF9\uBCF5\uD560 \uC218 \uC788\uC5C8\uB2E4. \uC800\uB141 \uCEA0\uD504\uD30C\uC774\uC5B4 \uC55E\uC5D0\uC11C \uB098\uB208 \uC774\uC57C\uAE30\uB4E4\uC774 \uB9C8\uC74C\uC744 \uB530\uB73B\uD558\uAC8C \uD588\uB2E4.",emotion:"\uAC10\uC0AC",event:"\uB3D9\uB8CC\uB4E4\uACFC\uC758 \uD611\uB825"},{entryDate:"2025-10-22",generationInfo:"10\uC6D4 22\uC77C\uC758 \uC6D0\uC815 \uAE30\uB85D",content:"\uC608\uC0C1\uCE58 \uBABB\uD55C \uD3ED\uD48D\uC744 \uB9CC\uB0AC\uB2E4. \uBAA8\uB4E0 \uAC83\uC774 \uACC4\uD68D\uB300\uB85C \uB418\uC9C0 \uC54A\uC744 \uB54C, \uC6B0\uB9AC\uB294 \uC9C4\uC815\uD55C \uC790\uC2E0\uC744 \uBC1C\uACAC\uD55C\uB2E4. \uC624\uB298\uC740 \uB098\uC758 \uD55C\uACC4\uB97C \uC2DC\uD5D8\uD558\uACE0 \uADF8\uAC83\uC744 \uC870\uAE08 \uB354 \uB113\uD78C \uB0A0\uC774\uB2E4.",emotion:"\uB3C4\uC804",event:"\uD3ED\uD48D \uADF9\uBCF5"},{entryDate:"2025-10-23",generationInfo:"10\uC6D4 23\uC77C\uC758 \uC6D0\uC815 \uAE30\uB85D",content:"\uBAA9\uC801\uC9C0\uAC00 \uC810\uC810 \uAC00\uAE4C\uC6CC\uC9C4\uB2E4. \uC5EC\uC815\uC758 \uB05D\uC774 \uBCF4\uC774\uC9C0\uB9CC, \uC774\uC81C\uB294 \uB3C4\uCC29\uBCF4\uB2E4 \uACFC\uC815\uC774 \uB354 \uC18C\uC911\uD558\uB2E4\uB294 \uAC83\uC744 \uAE68\uB2EC\uC558\uB2E4. \uB9E4\uC77C\uB9E4\uC77C\uC774 \uC0C8\uB85C\uC6B4 \uBC30\uC6C0\uC774\uACE0 \uC131\uC7A5\uC774\uB2E4.",emotion:"\uAE68\uB2EC\uC74C",event:"\uBAA9\uC801\uC9C0 \uC811\uADFC"}];entries$=new Oe(this.diaryEntries);constructor(){}getEntries(){return this.entries$.asObservable()}getEntryByDate(t){return this.diaryEntries.find(e=>e.entryDate===t)}createEntry(t){return new pt(e=>{if(this.diaryEntries.find(s=>s.entryDate===t.entryDate)){e.error({message:"\uD574\uB2F9 \uB0A0\uC9DC\uC758 \uC77C\uAE30\uAC00 \uC774\uBBF8 \uC874\uC7AC\uD569\uB2C8\uB2E4."});return}t.createdAt=new Date,t.updatedAt=new Date,this.diaryEntries.push(t),this.entries$.next([...this.diaryEntries]),e.next(t),e.complete()})}updateEntry(t,e){return new pt(n=>{let s=this.diaryEntries.findIndex(c=>c.entryDate===t);if(s===-1){n.error({message:"\uC77C\uAE30\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."});return}this.diaryEntries[s]=Ue(oe(oe({},this.diaryEntries[s]),e),{updatedAt:new Date}),this.entries$.next([...this.diaryEntries]),n.next(this.diaryEntries[s]),n.complete()})}deleteEntry(t){return new pt(e=>{let n=this.diaryEntries.findIndex(s=>s.entryDate===t);if(n===-1){e.error({message:"\uC77C\uAE30\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."});return}this.diaryEntries.splice(n,1),this.entries$.next([...this.diaryEntries]),e.next(!0),e.complete()})}getEntriesByDateRange(t,e){return this.diaryEntries.filter(n=>n.entryDate>=t&&n.entryDate<=e)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=$({token:a,factory:a.\u0275fac})};var me=class a{membershipData={isPremium:!1,entryCount:4,maxEntries:10,joinedAt:new Date("2025-10-20")};membership$=new Oe(this.membershipData);constructor(){}getMembership(){return this.membership$.asObservable()}getMembershipSync(){return this.membership$.value}isPremium(){return this.membershipData.isPremium}canCreateEntry(){return this.membershipData.isPremium?!0:this.membershipData.entryCount<this.membershipData.maxEntries}getRemainingEntries(){return this.membershipData.isPremium?-1:Math.max(0,this.membershipData.maxEntries-this.membershipData.entryCount)}incrementEntryCount(){this.membershipData.entryCount++,this.membership$.next(oe({},this.membershipData))}upgradeToPremium(){this.membershipData.isPremium=!0,this.membership$.next(oe({},this.membershipData))}resetMembership(){this.membershipData={isPremium:!1,entryCount:0,maxEntries:10,joinedAt:new Date},this.membership$.next(oe({},this.membershipData))}static \u0275fac=function(e){return new(e||a)};static \u0275prov=$({token:a,factory:a.\u0275fac})};function wo(a,t){if(a&1&&(i(0,"div",5)(1,"span",6),r(2,"\uB0A8\uC740 \uC77C\uAE30"),o(),i(3,"span",7),r(4),o()()),a&2){let e=u(2);l(3),J("warning",e.remainingEntries<3),l(),x(" ",e.remainingEntries," ")}}function yo(a,t){a&1&&(i(0,"div",5)(1,"span",6),r(2,"\uB0A8\uC740 \uC77C\uAE30"),o(),i(3,"span",10),r(4,"\u221E"),o()())}function Po(a,t){if(a&1){let e=y();i(0,"button",11),p("click",function(){f(e);let s=u(2);return C(s.upgradeToPremium())}),i(1,"mat-icon"),r(2,"upgrade"),o(),r(3," \uD504\uB9AC\uBBF8\uC5C4 \uC5C5\uADF8\uB808\uC774\uB4DC "),o()}}function Do(a,t){if(a&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"mat-icon"),r(4),o(),i(5,"span"),r(6),o()(),i(7,"div",4)(8,"div",5)(9,"span",6),r(10,"\uC791\uC131\uD55C \uC77C\uAE30"),o(),i(11,"span",7),r(12),o()(),j(13,wo,5,3,"div",8)(14,yo,5,0,"div",8),o()(),j(15,Po,4,0,"button",9),o()),a&2){let e=u();l(2),J("premium",e.membership.isPremium),l(2),h(e.membership.isPremium?"workspace_premium":"person"),l(2),h(e.membership.isPremium?"\uD504\uB9AC\uBBF8\uC5C4":"\uBB34\uB8CC"),l(6),h(e.membership.entryCount),l(),d("ngIf",!e.membership.isPremium),l(),d("ngIf",e.membership.isPremium),l(),d("ngIf",!e.membership.isPremium)}}var Xt=class a{constructor(t){this.membershipService=t}membership=null;remainingEntries=0;ngOnInit(){this.membershipService.getMembership().subscribe(t=>{this.membership=t,this.remainingEntries=this.membershipService.getRemainingEntries()})}upgradeToPremium(){confirm("\uD504\uB9AC\uBBF8\uC5C4\uC73C\uB85C \uC5C5\uADF8\uB808\uC774\uB4DC\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")&&(this.membershipService.upgradeToPremium(),alert("\uD504\uB9AC\uBBF8\uC5C4 \uBA64\uBC84\uC2ED\uC73C\uB85C \uC5C5\uADF8\uB808\uC774\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!"))}static \u0275fac=function(e){return new(e||a)(_(me))};static \u0275cmp=g({type:a,selectors:[["app-membership"]],standalone:!1,decls:1,vars:1,consts:[["class","membership-card",4,"ngIf"],[1,"membership-card"],[1,"membership-info"],[1,"status-badge"],[1,"stats"],[1,"stat-item"],[1,"label"],[1,"value"],["class","stat-item",4,"ngIf"],["mat-raised-button","","color","accent","class","upgrade-button",3,"click",4,"ngIf"],[1,"value","unlimited"],["mat-raised-button","","color","accent",1,"upgrade-button",3,"click"]],template:function(e,n){e&1&&j(0,Do,16,8,"div",0),e&2&&d("ngIf",n.membership)},dependencies:[xe,A,N],styles:[".membership-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:16px;padding:20px;margin-bottom:30px;color:#fff;box-shadow:0 4px 15px #667eea66}.membership-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.status-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#fff3;padding:8px 16px;border-radius:20px;font-weight:600}.status-badge.premium[_ngcontent-%COMP%]{background:#ffd7004d}.status-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.stats[_ngcontent-%COMP%]{display:flex;gap:30px}.stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end}.stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.85rem;opacity:.9;margin-bottom:4px}.stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700}.stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .value.warning[_ngcontent-%COMP%]{color:gold}.stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .value.unlimited[_ngcontent-%COMP%]{font-size:2rem}.upgrade-button[_ngcontent-%COMP%]{width:100%;height:48px;font-weight:600}.upgrade-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}@media (max-width: 768px){.membership-info[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:flex-start}.stats[_ngcontent-%COMP%]{width:100%;justify-content:space-around}}"]})};function Oo(a,t){if(a&1&&(i(0,"div",11),r(1),o()),a&2){let e=t.$implicit;l(),x(" ",e," ")}}function Eo(a,t){if(a&1&&(i(0,"div",15)(1,"div",16),r(2),o()()),a&2){let e=u().$implicit;l(2),x(" ",e.entry.emotion||"\u{1F4DD}"," ")}}function ko(a,t){if(a&1){let e=y();i(0,"div",12),p("click",function(){let s=f(e).$implicit,c=u();return C(c.onDayClick(s))}),i(1,"div",13),r(2),o(),j(3,Eo,3,1,"div",14),o()}if(a&2){let e=t.$implicit,n=u();J("other-month",!e.isCurrentMonth)("has-entry",e.hasEntry)("today",n.isToday(e)),l(2),h(e.date.getDate()),l(),d("ngIf",e.hasEntry&&e.entry)}}var Zt=class a{constructor(t,e,n){this.router=t;this.apiService=e;this.membershipService=n}currentDate=new Date;currentYear=this.currentDate.getFullYear();currentMonth=this.currentDate.getMonth();calendarDays=[];weekDays=["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"];entries=[];remainingEntries=0;ngOnInit(){this.loadEntries(),this.loadMembership(),this.generateCalendar()}loadEntries(){this.apiService.getEntries().subscribe(t=>{this.entries=t,this.generateCalendar()})}loadMembership(){this.membershipService.getMembership().subscribe(t=>{this.remainingEntries=this.membershipService.getRemainingEntries()})}generateCalendar(){this.calendarDays=[];let t=new Date(this.currentYear,this.currentMonth,1),e=new Date(this.currentYear,this.currentMonth+1,0),n=t.getDay(),s=new Date(this.currentYear,this.currentMonth,0);for(let m=n-1;m>=0;m--){let w=new Date(this.currentYear,this.currentMonth-1,s.getDate()-m);this.calendarDays.push({date:w,dateStr:this.formatDate(w),isCurrentMonth:!1,hasEntry:this.hasEntryForDate(this.formatDate(w))})}for(let m=1;m<=e.getDate();m++){let w=new Date(this.currentYear,this.currentMonth,m),T=this.formatDate(w),H=this.entries.find(rt=>rt.entryDate===T);this.calendarDays.push({date:w,dateStr:T,isCurrentMonth:!0,hasEntry:!!H,entry:H})}let c=42-this.calendarDays.length;for(let m=1;m<=c;m++){let w=new Date(this.currentYear,this.currentMonth+1,m);this.calendarDays.push({date:w,dateStr:this.formatDate(w),isCurrentMonth:!1,hasEntry:this.hasEntryForDate(this.formatDate(w))})}}hasEntryForDate(t){return this.entries.some(e=>e.entryDate===t)}formatDate(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${s}`}previousMonth(){this.currentMonth===0?(this.currentMonth=11,this.currentYear--):this.currentMonth--,this.generateCalendar()}nextMonth(){this.currentMonth===11?(this.currentMonth=0,this.currentYear++):this.currentMonth++,this.generateCalendar()}onDayClick(t){if(t.isCurrentMonth)if(t.hasEntry)this.router.navigate(["/expedition/diary/story",t.dateStr]);else{if(!this.membershipService.canCreateEntry()){alert("\uC77C\uAE30 \uC791\uC131 \uAC00\uB2A5 \uD69F\uC218\uB97C \uCD08\uACFC\uD588\uC2B5\uB2C8\uB2E4. \uD504\uB9AC\uBBF8\uC5C4\uC73C\uB85C \uC5C5\uADF8\uB808\uC774\uB4DC\uD558\uC138\uC694.");return}this.router.navigate(["/expedition/diary/maker",t.dateStr])}}getMonthName(){return`${this.currentYear}\uB144 ${this.currentMonth+1}\uC6D4`}isToday(t){let e=new Date;return t.date.getDate()===e.getDate()&&t.date.getMonth()===e.getMonth()&&t.date.getFullYear()===e.getFullYear()}static \u0275fac=function(e){return new(e||a)(_(L),_(ye),_(me))};static \u0275cmp=g({type:a,selectors:[["app-calendar"]],standalone:!1,decls:24,vars:3,consts:[[1,"calendar-container"],[1,"calendar-header"],["mat-icon-button","",3,"click"],[1,"weekdays"],["class","weekday",4,"ngFor","ngForOf"],[1,"calendar-grid"],["class","calendar-day",3,"other-month","has-entry","today","click",4,"ngFor","ngForOf"],[1,"legend"],[1,"legend-item"],[1,"legend-color","has-entry-color"],[1,"legend-color","today-color"],[1,"weekday"],[1,"calendar-day",3,"click"],[1,"day-number"],["class","entry-preview",4,"ngIf"],[1,"entry-preview"],[1,"emotion-badge"]],template:function(e,n){e&1&&(i(0,"div",0),M(1,"app-membership"),i(2,"div",1)(3,"button",2),p("click",function(){return n.previousMonth()}),i(4,"mat-icon"),r(5,"chevron_left"),o()(),i(6,"h2"),r(7),o(),i(8,"button",2),p("click",function(){return n.nextMonth()}),i(9,"mat-icon"),r(10,"chevron_right"),o()()(),i(11,"div",3),j(12,Oo,2,1,"div",4),o(),i(13,"div",5),j(14,ko,4,8,"div",6),o(),i(15,"div",7)(16,"div",8),M(17,"div",9),i(18,"span"),r(19,"\uAE30\uB85D \uC788\uC74C"),o()(),i(20,"div",8),M(21,"div",10),i(22,"span"),r(23,"\uC624\uB298"),o()()()()),e&2&&(l(7),h(n.getMonthName()),l(5),d("ngForOf",n.weekDays),l(2),d("ngForOf",n.calendarDays))},dependencies:[Ye,xe,ae,N,Xt],styles:[".calendar-container[_ngcontent-%COMP%]{padding:20px}.calendar-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:30px;padding:0 10px}.calendar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:#333}.calendar-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#667eea}.weekdays[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;margin-bottom:10px;padding:0 5px}.weekdays[_ngcontent-%COMP%]   .weekday[_ngcontent-%COMP%]{text-align:center;font-weight:600;color:#666;padding:10px 0}.weekdays[_ngcontent-%COMP%]   .weekday[_ngcontent-%COMP%]:first-child{color:#e74c3c}.weekdays[_ngcontent-%COMP%]   .weekday[_ngcontent-%COMP%]:last-child{color:#3498db}.calendar-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;margin-bottom:30px}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]{aspect-ratio:1;padding:10px;border:2px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .3s ease;position:relative;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 4px 12px #0000001a;border-color:#667eea}.calendar-grid[_ngcontent-%COMP%]   .calendar-day.other-month[_ngcontent-%COMP%]{opacity:.3;cursor:default}.calendar-grid[_ngcontent-%COMP%]   .calendar-day.other-month[_ngcontent-%COMP%]:hover{transform:none;box-shadow:none;border-color:#e0e0e0}.calendar-grid[_ngcontent-%COMP%]   .calendar-day.has-entry[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea15,#764ba215);border-color:#667eea}.calendar-grid[_ngcontent-%COMP%]   .calendar-day.today[_ngcontent-%COMP%]{border-color:#e74c3c;border-width:3px}.calendar-grid[_ngcontent-%COMP%]   .calendar-day.today[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{color:#e74c3c;font-weight:700}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:500;color:#333;margin-bottom:5px}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]   .entry-preview[_ngcontent-%COMP%]{margin-top:auto}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]   .entry-preview[_ngcontent-%COMP%]   .emotion-badge[_ngcontent-%COMP%]{font-size:1.5rem;text-align:center}.legend[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:center;padding:20px;background:#f8f9fa;border-radius:12px}.legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:4px}.legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color.has-entry-color[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color.today-color[_ngcontent-%COMP%]{background:#e74c3c}.legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem;color:#666}@media (max-width: 768px){.calendar-grid[_ngcontent-%COMP%]{gap:5px}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]{padding:5px}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-size:.9rem}.calendar-grid[_ngcontent-%COMP%]   .calendar-day[_ngcontent-%COMP%]   .emotion-badge[_ngcontent-%COMP%]{font-size:1rem}.weekdays[_ngcontent-%COMP%]{gap:5px}.weekdays[_ngcontent-%COMP%]   .weekday[_ngcontent-%COMP%]{font-size:.85rem}}"]})};function No(a,t){a&1&&(i(0,"mat-icon"),r(1,"rocket_launch"),o())}function Bo(a,t){a&1&&M(0,"mat-spinner",11)}var en=class a{constructor(t,e){this.router=t;this.membershipService=e}userName="";isLoading=!1;ngOnInit(){this.membershipService.getMembershipSync().userName&&this.router.navigate(["/expedition/calendar"])}onStart(){if(!this.userName.trim()){alert("\uC774\uB984\uC744 \uC785\uB825\uD574\uC8FC\uC138\uC694.");return}this.isLoading=!0,setTimeout(()=>{this.router.navigate(["/expedition/calendar"])},1e3)}static \u0275fac=function(e){return new(e||a)(_(L),_(me))};static \u0275cmp=g({type:a,selectors:[["app-init"]],standalone:!1,decls:38,vars:6,consts:[[1,"init-container"],[1,"init-content"],[1,"welcome-section"],[1,"input-section"],["appearance","outline",1,"full-width"],["matInput","","placeholder","\uC774\uB984 \uC785\uB825",3,"ngModelChange","keyup.enter","ngModel","disabled"],["mat-raised-button","","color","primary",1,"start-button",3,"click","disabled"],[4,"ngIf"],["diameter","20",4,"ngIf"],[1,"features-section"],[1,"feature"],["diameter","20"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),r(4,"\u{1F31F} \uC6D0\uC815\uB300\uC5D0 \uC624\uC2E0 \uAC83\uC744 \uD658\uC601\uD569\uB2C8\uB2E4!"),o(),i(5,"p"),r(6,"\uB2F9\uC2E0\uB9CC\uC758 \uC5EC\uC815\uC744 \uC2DC\uC791\uD574\uBCF4\uC138\uC694. \uB9E4\uC77C\uC758 \uAE30\uB85D\uC774 \uD2B9\uBCC4\uD55C \uC774\uC57C\uAE30\uAC00 \uB429\uB2C8\uB2E4."),o()(),i(7,"div",3)(8,"mat-form-field",4)(9,"mat-label"),r(10,"\uB2F9\uC2E0\uC758 \uC774\uB984\uC744 \uC54C\uB824\uC8FC\uC138\uC694"),o(),i(11,"input",5),S("ngModelChange",function(c){return D(n.userName,c)||(n.userName=c),c}),p("keyup.enter",function(){return n.onStart()}),o()(),i(12,"button",6),p("click",function(){return n.onStart()}),j(13,No,2,0,"mat-icon",7)(14,Bo,1,0,"mat-spinner",8),r(15),o()(),i(16,"div",9)(17,"div",10)(18,"mat-icon"),r(19,"calendar_today"),o(),i(20,"h3"),r(21,"\uB0A0\uC9DC\uBCC4 \uAE30\uB85D"),o(),i(22,"p"),r(23,"\uB9E4\uC77C\uC758 \uC21C\uAC04\uC744 \uCE98\uB9B0\uB354\uC5D0 \uAE30\uB85D\uD558\uC138\uC694"),o()(),i(24,"div",10)(25,"mat-icon"),r(26,"chat"),o(),i(27,"h3"),r(28,"\uB300\uD654\uD615 \uC791\uC131"),o(),i(29,"p"),r(30,"\uCC57\uBD07\uACFC \uB300\uD654\uD558\uBA70 \uC790\uC5F0\uC2A4\uB7FD\uAC8C \uC791\uC131"),o()(),i(31,"div",10)(32,"mat-icon"),r(33,"auto_stories"),o(),i(34,"h3"),r(35,"\uC2A4\uD1A0\uB9AC \uC0DD\uC131"),o(),i(36,"p"),r(37,"AI\uAC00 \uB2F9\uC2E0\uC758 \uAE30\uB85D\uC744 \uC774\uC57C\uAE30\uB85C"),o()()()()()),e&2&&(l(11),P("ngModel",n.userName),d("disabled",n.isLoading),l(),d("disabled",n.isLoading||!n.userName.trim()),l(),d("ngIf",!n.isLoading),l(),d("ngIf",n.isLoading),l(),x(" ",n.isLoading?"\uC900\uBE44 \uC911...":"\uC5EC\uC815 \uC2DC\uC791\uD558\uAE30"," "))},dependencies:[xe,W,U,Q,A,N,F,V,R,_e],styles:[".init-container[_ngcontent-%COMP%]{min-height:60vh;display:flex;align-items:center;justify-content:center;padding:20px}.init-content[_ngcontent-%COMP%]{max-width:600px;width:100%}.welcome-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.welcome-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;color:#333;margin-bottom:15px}.welcome-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;color:#666;line-height:1.6}.input-section[_ngcontent-%COMP%]{margin-bottom:50px}.input-section[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.input-section[_ngcontent-%COMP%]   .start-button[_ngcontent-%COMP%]{width:100%;height:56px;font-size:1.1rem;font-weight:600;margin-top:10px}.input-section[_ngcontent-%COMP%]   .start-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.input-section[_ngcontent-%COMP%]   .start-button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}.features-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:20px;margin-top:30px}.features-section[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{text-align:center;padding:20px;background:#f8f9fa;border-radius:12px;transition:transform .2s}.features-section[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.features-section[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#667eea;margin-bottom:10px}.features-section[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;margin:10px 0 5px;color:#333}.features-section[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;color:#666;margin:0}@media (max-width: 768px){.welcome-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}.features-section[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};function Ao(a,t){if(a&1){let e=y();i(0,"button",2),p("click",function(){f(e);let s=u();return C(s.editEntry())}),i(1,"mat-icon"),r(2,"edit"),o()()}}function To(a,t){if(a&1){let e=y();i(0,"button",2),p("click",function(){f(e);let s=u();return C(s.deleteEntry())}),i(1,"mat-icon"),r(2,"delete"),o()()}}function Lo(a,t){if(a&1&&(i(0,"div",14)(1,"mat-icon"),r(2,"sentiment_satisfied"),o(),i(3,"span"),r(4),o()()),a&2){let e=u(2);l(4),h(e.entry.emotion)}}function Fo(a,t){if(a&1&&(i(0,"div",14)(1,"mat-icon"),r(2,"event"),o(),i(3,"span"),r(4),o()()),a&2){let e=u(2);l(4),h(e.entry.event)}}function Ro(a,t){if(a&1&&(i(0,"div",17)(1,"h3"),r(2,"\u{1F4A1} \uACB0\uC815"),o(),i(3,"p"),r(4),o()()),a&2){let e=u(3);l(4),h(e.entry.decision)}}function jo(a,t){if(a&1&&(i(0,"div",17)(1,"h3"),r(2,"\u{1F914} \uC131\uCC30"),o(),i(3,"p"),r(4),o()()),a&2){let e=u(3);l(4),h(e.entry.reflection)}}function Vo(a,t){if(a&1&&(i(0,"div",15),j(1,Ro,5,1,"div",16)(2,jo,5,1,"div",16),o()),a&2){let e=u(2);l(),d("ngIf",e.entry.decision),l(),d("ngIf",e.entry.reflection)}}function zo(a,t){if(a&1&&(i(0,"div",7)(1,"div",8),r(2),o(),i(3,"div",9),j(4,Lo,5,1,"div",10)(5,Fo,5,1,"div",10),o(),i(6,"mat-card",11)(7,"mat-card-header")(8,"mat-card-title"),r(9),o()(),i(10,"mat-card-content")(11,"p",12),r(12),o()()(),j(13,Vo,3,2,"div",13),o()),a&2){let e=u();l(2),x(" \u{1F4C5} ",e.formatDate(e.entry.entryDate)," "),l(2),d("ngIf",e.entry.emotion),l(),d("ngIf",e.entry.event),l(4),h(e.entry.generationInfo),l(3),h(e.entry.content),l(),d("ngIf",e.entry.decision||e.entry.reflection)}}function $o(a,t){a&1&&(i(0,"div",18),M(1,"mat-spinner"),i(2,"p"),r(3,"\uC77C\uAE30\uB97C \uBD88\uB7EC\uC624\uB294 \uC911..."),o()())}var tn=class a{constructor(t,e,n,s){this.route=t;this.router=e;this.apiService=n;this.snackBar=s}entry=null;isLoading=!0;dateStr="";ngOnInit(){try{this.route.params.subscribe(t=>{if(this.dateStr=t.date,!this.dateStr)throw new Error("\uB0A0\uC9DC \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");this.loadEntry()})}catch(t){console.warn("[StoryViewer] ngOnInit \uC5D0\uB7EC:",t),this.showErrorAndRedirect("\uD398\uC774\uC9C0\uB97C \uB85C\uB4DC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}}loadEntry(){this.isLoading=!0;try{setTimeout(()=>{let t=this.apiService.getEntryByDate(this.dateStr);this.entry=t||null,this.isLoading=!1,this.entry||this.showErrorAndRedirect("\uC77C\uAE30\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")},500)}catch(t){console.warn("[StoryViewer] loadEntry \uC5D0\uB7EC:",t),this.showErrorAndRedirect("\uC77C\uAE30\uB97C \uBD88\uB7EC\uC624\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}}goBack(){this.router.navigate(["/expedition/diary/calendar"])}editEntry(){this.router.navigate(["/expedition/diary/maker",this.dateStr])}deleteEntry(){confirm("\uC815\uB9D0 \uC774 \uC77C\uAE30\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")&&this.apiService.deleteEntry(this.dateStr).subscribe({next:()=>{this.snackBar.open("\uC77C\uAE30\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","\uB2EB\uAE30",{duration:3e3}),this.router.navigate(["/expedition/diary/calendar"])},error:t=>{this.showErrorAndRedirect(t.message||"\uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}formatDate(t){let e=new Date(t),n=e.getFullYear(),s=e.getMonth()+1,c=e.getDate(),m=["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"][e.getDay()];return`${n}\uB144 ${s}\uC6D4 ${c}\uC77C (${m})`}showErrorAndRedirect(t){this.snackBar.open(t,"\uB2EB\uAE30",{duration:4e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["error-snackbar"]}),setTimeout(()=>{this.router.navigate(["/expedition/apps"])},500)}static \u0275fac=function(e){return new(e||a)(_(Ct),_(L),_(ye),_(q))};static \u0275cmp=g({type:a,selectors:[["app-story-viewer"]],standalone:!1,decls:12,vars:4,consts:[[1,"story-viewer-container"],[1,"viewer-header"],["mat-icon-button","",3,"click"],[1,"actions"],["mat-icon-button","",3,"click",4,"ngIf"],["class","viewer-content",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"viewer-content"],[1,"date-badge"],[1,"story-meta"],["class","meta-item",4,"ngIf"],[1,"story-card"],[1,"story-content"],["class","additional-info",4,"ngIf"],[1,"meta-item"],[1,"additional-info"],["class","info-section",4,"ngIf"],[1,"info-section"],[1,"loading-container"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),p("click",function(){return n.goBack()}),i(3,"mat-icon"),r(4,"arrow_back"),o()(),i(5,"h2"),r(6,"\uC6D0\uC815 \uAE30\uB85D"),o(),i(7,"div",3),j(8,Ao,3,0,"button",4)(9,To,3,0,"button",4),o()(),j(10,zo,14,6,"div",5)(11,$o,4,0,"div",6),o()),e&2&&(l(8),d("ngIf",n.entry),l(),d("ngIf",n.entry),l(),d("ngIf",!n.isLoading&&n.entry),l(),d("ngIf",n.isLoading))},dependencies:[xe,ae,N,Zn,ti,ni,ei,_e],styles:[".story-viewer-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.viewer-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:30px;padding-bottom:15px;border-bottom:2px solid #e0e0e0}.viewer-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:#333}.viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:5px}.viewer-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.date-badge[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:#667eea;margin-bottom:20px;padding:15px;background:#f8f9fa;border-radius:12px;text-align:center}.story-meta[_ngcontent-%COMP%]{display:flex;gap:15px;margin-bottom:25px;flex-wrap:wrap}.story-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 15px;background:#fff;border:2px solid #667eea;border-radius:20px;color:#667eea;font-weight:500}.story-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.story-card[_ngcontent-%COMP%]{margin-bottom:30px;border-radius:16px;box-shadow:0 4px 15px #0000001a}.story-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;border-radius:16px 16px 0 0;margin:-16px -16px 20px}.story-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]     mat-card-title{color:#fff;margin:0;font-size:1.3rem}.story-card[_ngcontent-%COMP%]   .story-content[_ngcontent-%COMP%]{font-size:1.1rem;line-height:1.8;color:#333;white-space:pre-wrap;word-break:keep-all}.additional-info[_ngcontent-%COMP%]{display:grid;gap:20px}.additional-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]{padding:20px;background:#f8f9fa;border-radius:12px;border-left:4px solid #667eea}.additional-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;color:#667eea;font-size:1.1rem}.additional-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.6;color:#555}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:100px 20px;gap:20px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:1.1rem}@media (max-width: 768px){.story-viewer-container[_ngcontent-%COMP%]{padding:15px}.viewer-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}.story-card[_ngcontent-%COMP%]   .story-content[_ngcontent-%COMP%]{font-size:1rem}}"]})};var Wo=["chatContainer"],Uo=["chatInput"];function Qo(a,t){a&1&&(i(0,"div",14),r(1," \u{1F916} "),o())}function Ho(a,t){a&1&&(i(0,"div",14),r(1," \u{1F464} "),o())}function qo(a,t){if(a&1&&(i(0,"div",10)(1,"div",11),j(2,Qo,2,0,"div",12),i(3,"div",13),r(4),o(),j(5,Ho,2,0,"div",12),o()()),a&2){let e=t.$implicit;J("question",e.type==="question")("answer",e.type==="answer"),l(2),d("ngIf",e.type==="question"),l(2),x(" ",e.content," "),l(),d("ngIf",e.type==="answer")}}function Yo(a,t){if(a&1){let e=y();i(0,"div",15)(1,"mat-form-field",16)(2,"input",17,0),S("ngModelChange",function(s){f(e);let c=u();return D(c.userInput,s)||(c.userInput=s),C(s)}),p("keyup.enter",function(){f(e);let s=u();return C(s.onSubmit())}),o()(),i(4,"button",18),p("click",function(){f(e);let s=u();return C(s.onSubmit())}),i(5,"mat-icon"),r(6,"send"),o()()()}if(a&2){let e=u();l(2),P("ngModel",e.userInput),l(2),d("disabled",!e.userInput.trim())}}function Go(a,t){a&1&&(i(0,"div",19),M(1,"mat-spinner",20),i(2,"p"),r(3,"\uC774\uC57C\uAE30\uB97C \uB9CC\uB4E4\uACE0 \uC788\uC2B5\uB2C8\uB2E4..."),o()())}var nn=class a{constructor(t,e,n,s){this.route=t;this.router=e;this.apiService=n;this.membershipService=s}chatContainer;chatInput;dateStr="";userInput="";isProcessing=!1;variables={};currentStep=0;chatMessages=[];questions=[{key:"emotion",text:"\uC624\uB298\uC758 \uD558\uB8E8\uB294 \uC5B4\uB5A0\uC168\uB098\uC694? \uAC00\uC7A5 \uBA3C\uC800 \uB5A0\uC624\uB974\uB294 \uAC10\uC815\uC744 \uC54C\uB824\uC8FC\uC138\uC694."},{key:"event",text:"\uC624\uB298 \uAC00\uC7A5 \uAE30\uC5B5\uC5D0 \uB0A8\uB294 \uC77C\uC740 \uBB34\uC5C7\uC774\uC5C8\uB098\uC694?"},{key:"decision",text:"\uC624\uB298 \uB0B4\uB9B0 \uC911\uC694\uD55C \uACB0\uC815\uC774\uB098 \uC120\uD0DD\uC774 \uC788\uB2E4\uBA74 \uC54C\uB824\uC8FC\uC138\uC694."},{key:"reflection",text:"\uC624\uB298\uC744 \uB3CC\uC544\uBCF4\uBA70 \uC5B4\uB5A4 \uC0DD\uAC01\uC774 \uB4DC\uC2DC\uB098\uC694?"}];ngOnInit(){if(this.route.params.subscribe(t=>{this.dateStr=t.dateStr}),!this.membershipService.canCreateEntry()){alert("\uC77C\uAE30 \uC791\uC131 \uAC00\uB2A5 \uD69F\uC218\uB97C \uCD08\uACFC\uD588\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/expedition/calendar"]);return}this.showQuestion()}showQuestion(){if(this.currentStep>=this.questions.length){this.generateStory();return}let t=this.questions[this.currentStep];setTimeout(()=>{this.chatMessages.push({type:"question",content:t.text}),this.scrollToBottom()},500)}onSubmit(){if(!this.userInput.trim()||this.isProcessing)return;let t=this.userInput.trim();this.chatMessages.push({type:"answer",content:t});let e=this.questions[this.currentStep];this.variables[e.key]=t,this.userInput="",this.currentStep++,this.scrollToBottom(),setTimeout(()=>{this.showQuestion()},800)}generateStory(){this.isProcessing=!0,this.chatMessages.push({type:"question",content:"\uBA4B\uC9C4 \uC774\uC57C\uAE30\uB97C \uB9CC\uB4E4\uACE0 \uC788\uC5B4\uC694... \u2728"}),this.scrollToBottom(),setTimeout(()=>{let t={entryDate:this.dateStr,generationInfo:`${this.formatDate(this.dateStr)}\uC758 \uC6D0\uC815 \uAE30\uB85D`,content:this.createStoryContent(),emotion:this.variables.emotion,event:this.variables.event,decision:this.variables.decision,reflection:this.variables.reflection,createdAt:new Date};this.apiService.createEntry(t).subscribe({next:()=>{this.membershipService.incrementEntryCount(),this.chatMessages.push({type:"question",content:"\u2705 \uC77C\uAE30\uAC00 \uC131\uACF5\uC801\uC73C\uB85C \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4! \uCE98\uB9B0\uB354\uC5D0\uC11C \uD655\uC778\uD574\uBCF4\uC138\uC694."}),setTimeout(()=>{this.router.navigate(["/expedition/story",this.dateStr])},2e3)},error:e=>{alert(e.message||"\uC77C\uAE30 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),this.isProcessing=!1}})},2e3)}createStoryContent(){let{emotion:t,event:e,decision:n,reflection:s}=this.variables;return`\uC624\uB298\uC740 ${t}\uC758 \uAC10\uC815\uC73C\uB85C \uAC00\uB4DD\uD55C \uD558\uB8E8\uC600\uB2E4. ${e}\uB77C\uB294 \uC77C\uC774 \uC788\uC5C8\uACE0, \uADF8 \uACFC\uC815\uC5D0\uC11C ${n}\uB77C\uB294 \uACB0\uC815\uC744 \uB0B4\uB838\uB2E4. \uD558\uB8E8\uB97C \uB9C8\uBB34\uB9AC\uD558\uBA70 ${s}\uB77C\uB294 \uC0DD\uAC01\uC774 \uB4E4\uC5C8\uB2E4. \uC774 \uBAA8\uB4E0 \uC21C\uAC04\uB4E4\uC774 \uBAA8\uC5EC \uC624\uB298\uC774\uB77C\uB294 \uD2B9\uBCC4\uD55C \uD558\uB8E8\uB97C \uB9CC\uB4E4\uC5C8\uB2E4.`}formatDate(t){let e=new Date(t),n=e.getMonth()+1,s=e.getDate();return`${n}\uC6D4 ${s}\uC77C`}scrollToBottom(){setTimeout(()=>{let t=document.querySelector(".chat-messages");t&&(t.scrollTop=t.scrollHeight)},100)}goBack(){return z(this,null,function*(){(yield Et("\uC791\uC131 \uC911\uC778 \uB0B4\uC6A9\uC774 \uC0AC\uB77C\uC9D1\uB2C8\uB2E4. \uC815\uB9D0 \uB098\uAC00\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"))&&this.router.navigate(["/expedition/diary/calendar"])})}static \u0275fac=function(e){return new(e||a)(_(Ct),_(L),_(ye),_(me))};static \u0275cmp=g({type:a,selectors:[["app-story-maker"]],viewQuery:function(e,n){if(e&1&&(ee(Wo,5,He),ee(Uo,5)),e&2){let s;te(s=ne())&&(n.chatContainer=s.first),te(s=ne())&&(n.chatInput=s.first)}},standalone:!1,decls:14,vars:4,consts:[["chatInput",""],[1,"story-maker-container"],[1,"maker-header"],["mat-icon-button","",3,"click"],[1,"date-info"],[1,"chat-area"],[1,"chat-messages"],["class","message-wrapper",3,"question","answer",4,"ngFor","ngForOf"],["class","chat-input-area",4,"ngIf"],["class","processing-indicator",4,"ngIf"],[1,"message-wrapper"],[1,"message-bubble"],["class","message-icon",4,"ngIf"],[1,"message-content"],[1,"message-icon"],[1,"chat-input-area"],["appearance","outline",1,"full-width"],["matInput","","placeholder","\uB2F5\uBCC0\uC744 \uC785\uB825\uD558\uC138\uC694...",3,"ngModelChange","keyup.enter","ngModel"],["mat-fab","","color","primary",3,"click","disabled"],[1,"processing-indicator"],["diameter","40"]],template:function(e,n){e&1&&(i(0,"div",1)(1,"div",2)(2,"button",3),p("click",function(){return n.goBack()}),i(3,"mat-icon"),r(4,"arrow_back"),o()(),i(5,"h2"),r(6,"\uC0C8\uB85C\uC6B4 \uC6D0\uC815 \uAE30\uB85D"),o(),i(7,"div",4),r(8),o()(),i(9,"div",5)(10,"div",6),j(11,qo,6,7,"div",7),o(),j(12,Yo,7,2,"div",8)(13,Go,4,0,"div",9),o()()),e&2&&(l(8),h(n.formatDate(n.dateStr)),l(3),d("ngForOf",n.chatMessages),l(),d("ngIf",!n.isProcessing),l(),d("ngIf",n.isProcessing))},dependencies:[Ye,xe,W,U,Q,ae,$n,N,F,R,_e],styles:[".story-maker-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - 180px);max-width:800px;margin:0 auto}.maker-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:20px;border-bottom:2px solid #e0e0e0;background:#fff}.maker-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.3rem;color:#333;flex:1;text-align:center}.maker-header[_ngcontent-%COMP%]   .date-info[_ngcontent-%COMP%]{font-size:.9rem;color:#667eea;font-weight:600;min-width:80px;text-align:right}.chat-area[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;background:#f8f9fa;overflow:hidden}.chat-messages[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px;display:flex;flex-direction:column;gap:15px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#667eea;border-radius:4px}.message-wrapper[_ngcontent-%COMP%]{display:flex;animation:_ngcontent-%COMP%_slideIn .3s ease-out}.message-wrapper.question[_ngcontent-%COMP%]{justify-content:flex-start}.message-wrapper.question[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:#fff;border:2px solid #667eea}.message-wrapper.answer[_ngcontent-%COMP%]{justify-content:flex-end}.message-wrapper.answer[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.message-bubble[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;max-width:70%;padding:15px 20px;border-radius:20px;box-shadow:0 2px 8px #0000001a}.message-bubble[_ngcontent-%COMP%]   .message-icon[_ngcontent-%COMP%]{font-size:24px;line-height:1}.message-bubble[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{flex:1;line-height:1.6;word-break:keep-all}.chat-input-area[_ngcontent-%COMP%]{display:flex;gap:10px;padding:20px;background:#fff;border-top:2px solid #e0e0e0;align-items:flex-end}.chat-input-area[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{flex:1}.chat-input-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:8px}.processing-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:30px;gap:15px;background:#fff;border-top:2px solid #e0e0e0}.processing-indicator[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#667eea;font-weight:500}@media (max-width: 768px){.story-maker-container[_ngcontent-%COMP%]{height:calc(100vh - 120px)}.maker-header[_ngcontent-%COMP%]{padding:15px}.maker-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem}.message-bubble[_ngcontent-%COMP%]{max-width:85%;padding:12px 15px}.chat-input-area[_ngcontent-%COMP%]{padding:15px}}"]})};var Jo=["loginComponent"],on=class a{constructor(t,e,n){this.authService=t;this.router=e;this.debugLogger=n}loginComponent;loginConfig={title:"\u{1F5FA}\uFE0F \uC6D0\uC815\uB300",subtitle:"\uB2F9\uC2E0\uC758 \uC5EC\uC815\uC744 \uAE30\uB85D\uD558\uACE0 \uACF5\uC720\uD558\uC138\uC694",moduleName:"expedition",showSocialLogin:!1,showRegisterLink:!1,backgroundAnimation:["\u{1F5FA}\uFE0F","\u26FA","\u{1F9ED}","\u{1F392}","\u{1F3D4}\uFE0F","\u{1F304}","\u26F0\uFE0F","\u{1F30D}"],themeColors:{primary:"#667eea",secondary:"#764ba2",accent:"#8b5cf6"}};ngOnInit(){this.debugLogger.info("ExpeditionLogin","ngOnInit \uD638\uCD9C\uB428"),this.debugLogger.info("ExpeditionLogin",`isLoggedIn: ${this.authService.isLoggedIn()}`),this.authService.isLoggedIn()&&(this.debugLogger.info("ExpeditionLogin","\uC774\uBBF8 \uB85C\uADF8\uC778\uB428 - /expedition/apps\uB85C \uB9AC\uB2E4\uC774\uB809\uD2B8"),this.router.navigate(["/expedition/apps"]))}onLogin(t){this.debugLogger.info("ExpeditionLogin",`\uB85C\uADF8\uC778 \uC2DC\uB3C4: ${t.username}`);let e=this.authService.login(t.username,t.password);this.debugLogger.info("ExpeditionLogin",`\uB85C\uADF8\uC778 \uACB0\uACFC: ${e}`),e?(this.debugLogger.success("ExpeditionLogin","\uB85C\uADF8\uC778 \uC131\uACF5! /expedition/apps\uB85C \uC774\uB3D9"),setTimeout(()=>{this.router.navigate(["/expedition/apps"]).then(n=>{this.debugLogger.info("ExpeditionLogin",`navigate \uACB0\uACFC: ${n}`)}).catch(n=>{this.debugLogger.error("ExpeditionLogin",`navigate \uC2E4\uD328: ${n}`)})},100)):(this.debugLogger.error("ExpeditionLogin","\uB85C\uADF8\uC778 \uC2E4\uD328 - \uC5D0\uB7EC \uBA54\uC2DC\uC9C0 \uD45C\uC2DC"),this.loginComponent&&this.loginComponent.setError("\uC0AC\uC6A9\uC790 \uC774\uB984 \uB610\uB294 \uBE44\uBC00\uBC88\uD638\uAC00 \uC62C\uBC14\uB974\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."))}static \u0275fac=function(e){return new(e||a)(_(ve),_(L),_(de))};static \u0275cmp=g({type:a,selectors:[["app-expedition-login"]],viewQuery:function(e,n){if(e&1&&ee(Jo,5),e&2){let s;te(s=ne())&&(n.loginComponent=s.first)}},standalone:!1,decls:2,vars:1,consts:[["loginComponent",""],[3,"loginSubmit","config"]],template:function(e,n){if(e&1){let s=y();i(0,"app-unified-login",1,0),p("loginSubmit",function(m){return f(s),C(n.onLogin(m))}),o()}e&2&&d("config",n.loginConfig)},dependencies:[Jn],encapsulation:2})};var an=class a{constructor(t,e,n){this.authService=t;this.router=e;this.debugLogger=n}canActivate(t,e){this.debugLogger.info("ExpeditionAuthGuard",`canActivate \uD638\uCD9C\uB428 - \uACBD\uB85C: ${e.url}`);let n=this.authService.isLoggedIn();return this.debugLogger.info("ExpeditionAuthGuard",`isLoggedIn: ${n}`),n?(this.debugLogger.success("ExpeditionAuthGuard","\u2705 \uC778\uC99D \uC131\uACF5 - \uC811\uADFC \uD5C8\uC6A9"),!0):(this.debugLogger.error("ExpeditionAuthGuard","\u274C \uC778\uC99D \uC2E4\uD328 - /expedition/login\uC73C\uB85C \uB9AC\uB2E4\uC774\uB809\uD2B8"),this.router.navigate(["/expedition/login"]),!1)}static \u0275fac=function(e){return new(e||a)(le(ve),le(L),le(de))};static \u0275prov=$({token:a,factory:a.\u0275fac,providedIn:"root"})};var ot=class a{constructor(t,e){this.router=t;this.snackBar=e}canActivate(t,e){try{let n=t.data?.requiredParams;if(n){for(let s of n)if(!t.params[s])return console.warn("[ExpeditionRouteErrorGuard] \uD544\uC218 \uD30C\uB77C\uBBF8\uD130 \uB204\uB77D:",s),this.showErrorAndRedirect(`\uD544\uC218 \uC815\uBCF4\uAC00 \uB204\uB77D\uB418\uC5C8\uC2B5\uB2C8\uB2E4: ${s}`),!1}return!0}catch(n){return console.warn("[ExpeditionRouteErrorGuard] \uB77C\uC6B0\uD2B8 \uD65C\uC131\uD654 \uC5D0\uB7EC:",n),this.showErrorAndRedirect("\uD398\uC774\uC9C0\uB97C \uB85C\uB4DC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),!1}}showErrorAndRedirect(t){this.snackBar.open(t,"\uB2EB\uAE30",{duration:4e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["error-snackbar"]}),setTimeout(()=>{this.router.navigate(["/expedition/apps"])},500)}static \u0275fac=function(e){return new(e||a)(le(L),le(q))};static \u0275prov=$({token:a,factory:a.\u0275fac,providedIn:"root"})};var Ko=[{path:"login",component:on},{path:"",component:kt,canActivate:[an],children:[{path:"apps",component:Nt},{path:"diary",canActivate:[ot],children:[{path:"calendar",component:Zt},{path:"init",component:en},{path:"story/:date",component:tn,canActivate:[ot],data:{requiredParams:["date"]}},{path:"maker/:dateStr",component:nn,canActivate:[ot],data:{requiredParams:["dateStr"]}},{path:"",redirectTo:"calendar",pathMatch:"full"}]},{path:"chatflow",component:Jt},{path:"",redirectTo:"apps",pathMatch:"full"}]}],rn=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=be({type:a});static \u0275inj=he({imports:[un.forChild(Ko),un]})};var sn=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=be({type:a});static \u0275inj=he({imports:[ke,xt,Ie,Be,ai,bt,Ge,Te,Le]})};var at=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=be({type:a});static \u0275inj=he({imports:[ke,sn,Te,Le,Be,oi,Ie]})};var Xo=["*"],Zo=(a,t)=>({"top.px":a,"left.px":t});function ea(a,t){if(a&1){let e=y();i(0,"div",15),p("mouseup",function(s){f(e);let c=u();return C(c.nodeAbstract.onInputDotMouseUp(s))})("mouseenter",function(s){f(e);let c=u();return C(c.nodeAbstract.onInputDotMouseEnter(s))})("mouseleave",function(s){f(e);let c=u();return C(c.nodeAbstract.onInputDotMouseLeave(s))}),M(1,"div",16),i(2,"div",17),r(3,"IN"),o(),i(4,"div",18),r(5,"\uB4DC\uB86D\uC73C\uB85C \uC5F0\uACB0"),o()()}}function ta(a,t){if(a&1){let e=y();i(0,"div",19),p("mousedown",function(s){f(e);let c=u();return C(c.nodeAbstract.onOutputDotMouseDown(s))}),M(1,"div",16),i(2,"div",17),r(3,"OUT"),o(),i(4,"div",18),r(5,"\uB4DC\uB798\uADF8\uB85C \uC5F0\uACB0"),o()()}}function na(a,t){a&1&&(i(0,"mat-icon"),r(1,"play_circle"),o())}function ia(a,t){a&1&&(i(0,"mat-icon"),r(1,"stop_circle"),o())}function oa(a,t){a&1&&(i(0,"mat-icon"),r(1,"chat"),o())}function aa(a,t){a&1&&(i(0,"mat-icon"),r(1,"mic"),o())}function ra(a,t){a&1&&(i(0,"mat-icon"),r(1,"help"),o())}function sa(a,t){a&1&&(i(0,"mat-icon"),r(1,"smart_button"),o())}function ca(a,t){a&1&&(i(0,"mat-icon"),r(1,"call_split"),o())}function la(a,t){a&1&&(i(0,"mat-icon"),r(1,"swap_horiz"),o())}function da(a,t){a&1&&(i(0,"mat-icon"),r(1,"widgets"),o())}function pa(a,t){if(a&1&&(i(0,"span",8),r(1),o()),a&2){let e=u();l(),h(e.nodeAbstract.name)}}function ma(a,t){if(a&1){let e=y();i(0,"button",20),p("click",function(){f(e);let s=u();return C(s.nodeAbstract.onEditClick())}),i(1,"mat-icon"),r(2,"edit"),o()()}}function ua(a,t){a&1&&(i(0,"div",11)(1,"mat-icon"),r(2,"touch_app"),o(),i(3,"span"),r(4,"OUT \uB3C4\uD2B8\uB97C \uB4DC\uB798\uADF8\uD558\uC5EC \uB2E4\uC74C \uB178\uB4DC\uC640 \uC5F0\uACB0"),o()())}function ga(a,t){if(a&1){let e=y();i(0,"button",12),p("click",function(){f(e);let s=u();return C(s.onNodeDeleteClick())}),i(1,"mat-icon"),r(2,"delete"),o(),i(3,"span"),r(4,"\uC0AD\uC81C"),o()()}}var Ce=class a{trigger;nodeAbstract;overlay=v(zn);debugLogger=v(de);onNodeDeleteClick(){if(!this.nodeAbstract.myRef){console.warn("ref does not exist");return}this.nodeAbstract.myRef.destroy()}onDisconnectClick(){this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0\uB04A\uAE30",`\u2702\uFE0F \uC5F0\uACB0 \uB04A\uAE30 \uC694\uCCAD: ${this.nodeAbstract.type} \uB178\uB4DC (${this.nodeAbstract.id})`);let t=Object.keys(this.nodeAbstract.leftConnectedList);t.length>0&&t.forEach(s=>{let c=this.nodeAbstract.leftConnectedList[s];this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0\uB04A\uAE30",`  \u2190 \uC67C\uCABD \uC5F0\uACB0 \uC81C\uAC70: ${s}`),c.line.delete()});let e=Object.keys(this.nodeAbstract.rightConnectedList);e.length>0&&e.forEach(s=>{let c=this.nodeAbstract.rightConnectedList[s];this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0\uB04A\uAE30",`  \u2192 \uC624\uB978\uCABD \uC5F0\uACB0 \uC81C\uAC70: ${s}`),c.line.delete()});let n=t.length+e.length;n>0?this.debugLogger.success("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0\uB04A\uAE30",`\u2705 ${n}\uAC1C \uC5F0\uACB0 \uB04A\uAE40`):this.debugLogger.warn("\uCC57\uD50C\uB85C\uC6B0-\uC5F0\uACB0\uB04A\uAE30","\u26A0\uFE0F \uB04A\uC744 \uC5F0\uACB0\uC774 \uC5C6\uC2B5\uB2C8\uB2E4")}onConnectorClick(t,e){t.stopPropagation(),t.preventDefault(),this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-UI",`\u{1F5B1}\uFE0F \uCEE4\uB125\uD130 \uD074\uB9AD: ${e==="right"?"OUT":"IN"} (${this.nodeAbstract.type} \uB178\uB4DC)`),e==="right"?(this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-UI","\u{1F7E2} OUT \uCEE4\uB125\uD130 \uD074\uB9AD \u2192 \uC5F0\uACB0 \uC2DC\uC791 \uD638\uCD9C"),this.nodeAbstract.onLineStartClick()):(this.debugLogger.info("\uCC57\uD50C\uB85C\uC6B0-UI","\u{1F534} IN \uCEE4\uB125\uD130 \uD074\uB9AD \u2192 \uC5F0\uACB0 \uC885\uB8CC \uD638\uCD9C"),this.nodeAbstract.onLineEndClick())}onContextMenuClick(t){console.log("onContextMenuClick",t),t.preventDefault(),this.trigger.menu.xPosition="after",this.trigger.menu.yPosition="below";let e=t.clientX,n=t.clientY,s=this.trigger.menuOpened.subscribe(()=>{let c=this.trigger._overlayRef;c&&c.updatePositionStrategy(this.overlay.position().flexibleConnectedTo({x:e,y:n}).withPositions([{originX:"start",originY:"top",overlayX:"start",overlayY:"top"}])),s.unsubscribe()});this.trigger.openMenu()}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["app-node-template"]],viewQuery:function(e,n){if(e&1&&ee(Ke,5),e&2){let s;te(s=ne())&&(n.trigger=s.first)}},inputs:{nodeAbstract:"nodeAbstract"},standalone:!1,ngContentSelectors:Xo,decls:31,vars:19,consts:[["menu","matMenu"],[1,"node-card",3,"mousedown","contextmenu","ngStyle"],["title","\uB4DC\uB86D\uD558\uC5EC \uC5F0\uACB0 \uC644\uB8CC",1,"connector","left"],["title","\uB4DC\uB798\uADF8\uD558\uC5EC \uC5F0\uACB0 \uC2DC\uC791",1,"connector","right"],[1,"node-header"],[1,"node-icon"],[1,"node-title"],[1,"type-badge"],[1,"node-name"],["mat-icon-button","","title","\uB178\uB4DC \uD3B8\uC9D1",1,"edit-btn"],[1,"node-body"],[1,"node-hint"],["mat-menu-item","",3,"click"],["mat-menu-item",""],[3,"matMenuTriggerFor"],["title","\uB4DC\uB86D\uD558\uC5EC \uC5F0\uACB0 \uC644\uB8CC",1,"connector","left",3,"mouseup","mouseenter","mouseleave"],[1,"connector-dot"],[1,"connector-label"],[1,"connector-hint"],["title","\uB4DC\uB798\uADF8\uD558\uC5EC \uC5F0\uACB0 \uC2DC\uC791",1,"connector","right",3,"mousedown"],["mat-icon-button","","title","\uB178\uB4DC \uD3B8\uC9D1",1,"edit-btn",3,"click"]],template:function(e,n){if(e&1){let s=y();In(),i(0,"div",1),p("mousedown",function(m){return f(s),C(n.nodeAbstract.onMouseDown(m))})("contextmenu",function(m){return f(s),C(n.onContextMenuClick(m))}),O(1,ea,6,0,"div",2),O(2,ta,6,0,"div",3),i(3,"div",4)(4,"div",5),O(5,na,2,0,"mat-icon")(6,ia,2,0,"mat-icon")(7,oa,2,0,"mat-icon")(8,aa,2,0,"mat-icon")(9,ra,2,0,"mat-icon")(10,sa,2,0,"mat-icon")(11,ca,2,0,"mat-icon")(12,la,2,0,"mat-icon")(13,da,2,0,"mat-icon"),o(),i(14,"div",6)(15,"span",7),r(16),o(),O(17,pa,2,1,"span",8),o(),O(18,ma,3,0,"button",9),o(),i(19,"div",10),An(20),o(),O(21,ua,5,0,"div",11),i(22,"mat-menu",null,0)(24,"button",12),p("click",function(){return f(s),C(n.onDisconnectClick())}),i(25,"mat-icon"),r(26,"link_off"),o(),i(27,"span"),r(28,"\uC5F0\uACB0 \uB04A\uAE30"),o()(),O(29,ga,5,0,"button",13),o()(),M(30,"div",14)}if(e&2){let s=ue(23);J("executing",n.nodeAbstract.isItExcecuting)("start-node",n.nodeAbstract.type==="start")("end-node",n.nodeAbstract.type==="end"),d("ngStyle",gt(16,Zo,n.nodeAbstract.top,n.nodeAbstract.left)),l(),E(n.nodeAbstract.type!=="start"?1:-1),l(),E(n.nodeAbstract.type!=="end"?2:-1),l(3),E(n.nodeAbstract.type==="start"?5:n.nodeAbstract.type==="end"?6:n.nodeAbstract.type==="speak"?7:n.nodeAbstract.type==="listen"?8:n.nodeAbstract.type==="question"?9:n.nodeAbstract.type==="button"?10:n.nodeAbstract.type==="split"?11:n.nodeAbstract.type==="contextChanger"?12:13),l(11),h(n.nodeAbstract.type),l(),E(n.nodeAbstract.name&&n.nodeAbstract.type!=="start"&&n.nodeAbstract.type!=="end"?17:-1),l(),E(n.nodeAbstract.type!=="start"&&n.nodeAbstract.type!=="end"?18:-1),l(3),E(n.nodeAbstract.type==="start"?21:-1),l(8),E(n.nodeAbstract.type!=="start"?29:-1),l(),d("matMenuTriggerFor",s)}},dependencies:[ft,ae,N,Pt,yt,Ke],styles:[".node-card[_ngcontent-%COMP%]{position:absolute;width:280px;min-height:120px;background:#ffffffb3;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.3);box-shadow:0 8px 32px #1f268726;overflow:visible;cursor:move}.node-card[_ngcontent-%COMP%]:hover{background:#fffc;box-shadow:0 8px 32px #1f268740;border-color:#667eea80}.node-card.executing[_ngcontent-%COMP%]{background:#4caf5033;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border:2px solid rgba(76,175,80,.5);animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}.node-card.start-node[_ngcontent-%COMP%]{background:#667eea26;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border:2px solid rgba(102,126,234,.5)}.node-card.start-node[_ngcontent-%COMP%]   .node-header[_ngcontent-%COMP%]{background:#667eea33;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#667eea}.node-card.start-node[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{background:#667eea4d;color:#667eea}.node-card.end-node[_ngcontent-%COMP%]{background:#f5576c26;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border:2px solid rgba(245,87,108,.5)}.node-card.end-node[_ngcontent-%COMP%]   .node-header[_ngcontent-%COMP%]{background:#f5576c33;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#f5576c}.node-card.end-node[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{background:#f5576c4d;color:#f5576c}.connector[_ngcontent-%COMP%]{position:absolute;width:60px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;z-index:200;transition:all .2s ease}.connector.left[_ngcontent-%COMP%]{left:-30px;top:50%;transform:translateY(-50%);cursor:crosshair}.connector.right[_ngcontent-%COMP%]{right:-30px;top:50%;transform:translateY(-50%);cursor:grab}.connector.right[_ngcontent-%COMP%]:active{cursor:grabbing}.connector[_ngcontent-%COMP%]:hover   .connector-dot[_ngcontent-%COMP%]{width:32px;height:32px;background:#764ba2f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:0 0 24px #764ba2cc,0 0 0 6px #764ba24d;border-width:5px}.connector[_ngcontent-%COMP%]:hover   .connector-label[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.connector[_ngcontent-%COMP%]:hover   .connector-hint[_ngcontent-%COMP%]{opacity:1}.connector-dot[_ngcontent-%COMP%]{width:24px;height:24px;background:#667eeae6;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border:4px solid rgba(255,255,255,.95);border-radius:50%;transition:all .2s ease;box-shadow:0 4px 16px #667eea80,0 0 0 4px #667eea33}.connector-label[_ngcontent-%COMP%]{position:absolute;bottom:-28px;font-size:12px;font-weight:700;color:#667eea;background:#ffffffe6;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);padding:4px 10px;border-radius:6px;opacity:0;transform:translateY(-5px);transition:all .2s ease;white-space:nowrap}.connector-hint[_ngcontent-%COMP%]{position:absolute;top:-38px;font-size:13px;font-weight:600;color:#667eeaf2;background:#fffffffa;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);padding:8px 14px;border-radius:8px;opacity:0;transition:all .3s ease;white-space:nowrap;box-shadow:0 4px 12px #667eea40;border:1px solid rgba(102,126,234,.2);pointer-events:none}.start-hint[_ngcontent-%COMP%]{font-size:9px;font-weight:600;color:#fff;background:#667eeae6;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);padding:4px 10px;border-radius:6px;white-space:nowrap;opacity:0;pointer-events:none;box-shadow:0 2px 8px #0003}.node-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:14px 16px;background:#667eea1a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#667eea;border-radius:16px 16px 0 0;overflow:visible}.node-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:44px;height:44px;background:#fff6;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border-radius:12px;border:1px solid rgba(255,255,255,.5)}.node-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;line-height:28px}.node-title[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:6px;min-width:0}.type-badge[_ngcontent-%COMP%]{display:inline-block;font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;background:#667eea33;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);padding:5px 12px;border-radius:6px;width:fit-content;border:1px solid rgba(102,126,234,.2)}.node-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;opacity:.9;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edit-btn[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;min-width:40px;background:#fff6;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:#667eea;border:1px solid rgba(255,255,255,.5)}.edit-btn[_ngcontent-%COMP%]:hover{background:#fff9}.edit-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px;line-height:22px}.node-body[_ngcontent-%COMP%]{padding:20px;color:#333;font-size:15px;line-height:1.7;min-height:70px;background:#ffffff4d;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border-radius:0 0 16px 16px;overflow:visible}.start-node[_ngcontent-%COMP%]   .node-body[_ngcontent-%COMP%], .end-node[_ngcontent-%COMP%]   .node-body[_ngcontent-%COMP%]{text-align:center;font-weight:500}.node-hint[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px;padding:14px 18px;background:#667eea14;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border-top:1px solid rgba(102,126,234,.1);font-size:13px;color:#667eea;font-weight:600;animation:_ngcontent-%COMP%_fadeInUp .5s ease}.node-hint[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.start-node[_ngcontent-%COMP%]   .node-hint[_ngcontent-%COMP%]{background:#667eea26;border-top-color:#667eea33}@keyframes _ngcontent-%COMP%_pulse{0%,to{box-shadow:0 8px 32px #4caf504d}50%{box-shadow:0 8px 32px #4caf5080}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}  .mat-mdc-menu-panel{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:12px;box-shadow:0 8px 32px #1f268733;overflow:hidden;border:1px solid rgba(255,255,255,.3)}  .mat-mdc-menu-item{display:flex;align-items:center;gap:12px;padding:12px 20px;font-size:14px}  .mat-mdc-menu-item mat-icon{color:#667eea;font-size:20px;width:20px;height:20px}  .mat-mdc-menu-item:hover{background:#667eea1a}"]})};var cn=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=be({type:a});static \u0275inj=he({providers:[Re,je,Me,we],imports:[ke,at,Le,Te,Be,Ie,Hn,bt,Qn,Ge,Kn,Dt,Xn,Gn]})};Pe(Xe,[Ce],[]);Pe(Ve,[Ce],[]);Pe(Ze,[Ce],[]);Pe(tt,[Ce],[]);Pe(nt,[Ce],[]);Pe(ze,[Ce],[]);Pe(et,[Ce],[]);Pe(it,[N,Ce],[]);var ln=class a{constructor(t){this.injector=t}router;snackBar;handleError(t){this.router||(this.router=this.injector.get(L)),this.snackBar||(this.snackBar=this.injector.get(q)),console.warn("[ExpeditionErrorHandler] \uC5D0\uB7EC \uBC1C\uC0DD:",t);let e=this.router.url;if(e.includes("/expedition")){let s="\uBB38\uC81C\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.";t?.message?s=t.message:typeof t=="string"&&(s=t),this.snackBar.open(s,"\uB2EB\uAE30",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["error-snackbar"]}),e.includes("/expedition/login")||(console.warn("[ExpeditionErrorHandler] \uC6D0\uC815\uB300 \uC571 \uB7F0\uCC98\uB85C \uC774\uB3D9"),this.router.navigate(["/expedition/apps"]).catch(c=>{console.warn("[ExpeditionErrorHandler] \uB124\uBE44\uAC8C\uC774\uC158 \uC2E4\uD328:",c)}))}else console.warn("[ExpeditionErrorHandler] \uBAA8\uB4C8 \uC678\uBD80 \uC5D0\uB7EC, \uAE30\uBCF8 \uCC98\uB9AC:",t);throw t}static \u0275fac=function(e){return new(e||a)(le(yn))};static \u0275prov=$({token:a,factory:a.\u0275fac})};var Mi=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=be({type:a});static \u0275inj=he({providers:[ye,me,ve,{provide:Pn,useClass:ln}],imports:[ke,rn,Wn,Ge,jn,Be,Ie,Te,Le,ii,Dt,xt,at,cn]})};export{Mi as ExpeditionModule};
